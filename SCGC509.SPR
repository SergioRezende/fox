*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        31/07/97             SCGC509.SPR               17:18:18 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1997 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 SCGC509/MS-DOS Setup Code - SECTION 1          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1

*~ WIZARDSCREEN
#DEFINE C_DBFEMPTY		'Database is empty, add a record?'
#DEFINE C_DELREC		'Apagar Registro Selecionado ?'
#DEFINE C_ENDFILE		'Final do Arquivo.'
#DEFINE C_CANCTRF		'Confirma o Cancelamento da Devolucao ? '
#DEFINE C_APROTRF		'Confirma o Aprovacao da Devolucao ? '
*---------------------------------------------------------------------*
* ARQUIVOS UTILIZADOS :                                               *
*              - DUPLICAT
*			   - BAIXIMPO
*			   - BORDIMPO
*              - EMPRESA
* OBJETIVOS : IMPORTACAO BAIXAS E MOVIMENTACAO DE DUPL. DO SISTEMA ANTIGO
*	
*---------------------------------------------------------------------*
******>>>> INICIO CONTROLE AMBIENTAL
ON KEY LABEL ESCAPE
PRIVATE isediting,isadding,isreading
PRIVATE wp_record
PRIVATE isreadonly,is2table,wzalias
PRIVATE LS509areant
LS509areant	= ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.wzalias	=	SELECT()
m.isediting	=	.F.
m.isadding	=	.F.
m.isreading =  	.F.
m.is2table 	= 	.F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
wp_ref_local =  .T.     &&  POSSUI CONTROLE DE REFRESH LOCAL

LFdup509	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFtmp509	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFemp509	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA

********>>>>>> INTERESE LOCAL
wl_cota     = .f.
iscancela   = .f.
isitens     = .f.     && indica se houve edicao doas itens durante ed. orca.
M.TAB_CST   = 0
******>>>> INICIO CONTROLE ARQUIVOS

*>> parametros repassados a btn_val


VLleitura = "" && OPERACOES DE REMESSA
                         * repassa chave de leitura p/ btn_val
VLlerfim  = ""  && 1o REG. DE OPERACOES DE REQUISICAO
           * repassa chave de leitura p/ btn_val (POSICAO FINAL + 1 REG)
VLcompara = ""
                         * repassa chave de comparacao p/ btn_val
VLchvlimi = ""  && otimiza browse
******>>>>>... PROCESSO DE TRANSACAO  (ARMAR ARQUIVOS P/ PROCESSO )
******>>>>>... PROCESSO DE TRANSACAO  (ARMAR ARQUIVOS P/ PROCESSO )
IF 	!UPtransacao("ARMAR","duplicat.dbf") OR ;
	!UPtransacao("ARMAR","duplicat.cdx")
	WAIT "NAO FOI POSSIVEL ATIVAR ARQUIVOS COM SEGURANCA.."
	DO ULdesativa   && DESATIVA ARQUIVO PARA TRANSACAO
	RETURN
ENDIF
*******************************************************
IF !USED("duplicat")
	LFdup509	= .T.
	IF ! NetUse("duplicat",.t.)
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("empresa")
	LFemp509	= .T.
	IF ! NetUse("empresa",.t.)
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

IF wp_flgfecha
	DO ULfecha 		&& FECHA ARQUIVOS ABERTOS
	DO ULdesativa   && DESATIVA ARQUIVO PARA TRANSACAO
	RETURN
ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF NOT WEXIST("scgc509") ;
	OR UPPER(WTITLE("SCGC509")) == "SCGC509.PJX" ;
	OR UPPER(WTITLE("SCGC509")) == "SCGC509.SCX" ;
	OR UPPER(WTITLE("SCGC509")) == "SCGC509.MNX" ;
	OR UPPER(WTITLE("SCGC509")) == "SCGC509.PRG" ;
	OR UPPER(WTITLE("SCGC509")) == "SCGC509.FRX" ;
	OR UPPER(WTITLE("SCGC509")) == "SCGC509.QPR"
	DEFINE WINDOW scgc509 ;
		FROM INT((SROW()-12)/2),INT((SCOL()-70)/2) ;
		TO INT((SROW()-12)/2)+11,INT((SCOL()-70)/2)+69 ;
		TITLE "[ Processa Baixas e Movimentacoes de Cobranca ]" ;
		FOOTER "[ 509 ]" ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		COLOR SCHEME 1
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 SCGC509/MS-DOS Setup Code - SECTION 2          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
******>>>> INICIO CONTROLE LOCAL


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     SCGC509/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("scgc509")
	ACTIVATE WINDOW scgc509 SAME
ELSE
	ACTIVATE WINDOW scgc509 NOSHOW
ENDIF
@ 6,25 SAY "a" ;
	SIZE 1,1, 0
@ 6,4 SAY "Periodo de" ;
	SIZE 1,10, 0
@ 1,0 TO 7,67
@ 2,4 SAY "Drive arq. a importar:" ;
	SIZE 1,22, 0
@ 4,4 SAY "Filial a Importar....:" ;
	SIZE 1,22, 0
@ 4,30 SAY "-" ;
	SIZE 1,1, 0
@ 2,27 GET m.drive ;
	SIZE 1,38 ;
	DEFAULT " " ;
	WHEN _rmr113b2k()
@ 4,27 GET m.empresa ;
	SIZE 1,2 ;
	DEFAULT " " ;
	PICTURE "99" ;
	WHEN _rmr113b49() ;
	VALID _rmr113b5m()
@ 4,31 GET m.nome_emp ;
	SIZE 1,20 ;
	DEFAULT " " ;
	PICTURE "@!K" ;
	WHEN .F.
@ 6,16 GET m.dt_inicio ;
	SIZE 1,8 ;
	DEFAULT {  /  /  } ;
	WHEN isediting ;
	VALID _rmr113b91()
@ 6,27 GET m.dt_fim ;
	SIZE 1,8 ;
	DEFAULT {  /  /  } ;
	WHEN isediting ;
	VALID m.dt_fim >= m.dt_inicio ;
	MESSAGE "Data Final deve ser maior ou igual a Inicial"
@ 9,3 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 9,29 GET m.imp_btn ;
	PICTURE "@*HN \<Importa" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _rmr113bb2() ;
	DISABLE
@ 9,55 GET m.canc_btn ;
	PICTURE "@*HT \<Saida" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _rmr113bf4()

IF NOT WVISIBLE("scgc509")
	ACTIVATE WINDOW scgc509
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*            MS-DOSREAD contains clauses from SCREEN scgc509     
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

READ CYCLE MODAL ;
	ACTIVATE READACT() ;
	DEACTIVATE READDEAC() ;
	NOLOCK

RELEASE WINDOW scgc509

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      SCGC509/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
DO ULfecha 		&& FECHA ARQUIVOS ABERTOS
DO ULdesativa   && DESATIVA ARQUIVO PARA TRANSACAO
RETURN

*********************************
*    P R O C E D I M E N T O S  *
*********************************


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*          SCGC509/MS-DOS Supporting Procedures and Functions    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
PROCEDURE ULfecha
	IF LFdup509		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("duplicat")
	ENDIF
	IF LFemp509		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(LS509areant)
		SELECT &LS509areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
	ON KEY LABEL CTRL-I
RETURN
******>>>>>... PROCESSO DE TRANSACAO  (DESARMAR ARQUIVOS P/ PROCESSO )
PROCEDURE ULdesativa
	=UPtransacao("DESARMAR","duplicat.dbf")
	=UPtransacao("DESARMAR","duplicat.cdx")
RETURN
*-------------->
PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	LN_prxobj = _CUROBJ
    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.imp_btn DISABLE
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn ENABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn DISABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN



*-------------------->>>>>>>>>
***********************************************************************
***********************************************************************
***********************************************************************

PROCEDURE ULconvbord		&& PROCESSA BORDEROS
	wp_flgfecha = .F.
	IF ! NetUse("bordimpo",.t.)
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
	IF !FILE(LSbrdtmp) OR wp_flgfecha
		=UP_fecha("bordimpo")
		RETURN
	ENDIF
	SELE bordimpo
	ZAP
	PACK
	APPEND FROM &LSbrdtmp TYPE SDF
	IF EOF()
		=UP_fecha("bordimpo")
		RETURN
	ENDIF

	SELE bordimpo
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO

	LFsegue = .t.
	LNregistro = RECNO()
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
*******************
	GO TOP
	DO WHILE !EOF() AND !wp_flgfecha
		=UPtermo()
	*>>>>>>>>>>>>>>>>>     INICIO CONVERSAO P/ ORCAMENT ou OUTROPER
		m.empresa 		= 	bordimpo.filial
		m.duplicata		=   bordimpo.dupl
		SELE duplicat
		SET ORDER TO TAG doc
		SEEK STR(m.empresa,3)+STR(m.duplicata,9)		
		IF !FOUND()
			IF RIGHT(orcament.situacao,1) <> "E"
			   DO OBJ_ALER.SPR WITH ;
			   "Duplicata nao foi encontrada. Certifique-se que o Fatara;
			   mento ja foi importado.  Doc : "+;
				"  "+str(m.duplicata,6)
				wp_flgfecha = .t.   				
			ENDIF
			SELE bordimpo
			SKIP
			LOOP
		ENDIF
*------->>>>>>>>>>>>    CAMPOS COM CORRESPONDENCIA DIRETA >>>>>>>>		
		=REGLOCK()
		m.banco			=	bordimpo.banco
		m.agencia		=	bordimpo.agencia
		GATHER MEMVAR MEMO
		SELE bordimpo
		SKIP
		UNLOCK ALL
	ENDDO
	=UP_fecha("bordimpo")
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO

RETURN

***********************************************************************

***********************************************************************
***********************************************************************
***********************************************************************

PROCEDURE ULconvbaix		&& PROCESSA BAIXAS
	wp_flgfecha = .F.
	IF ! NetUse("baiximpo",.t.)
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
	IF !FILE(LSbaitmp) OR wp_flgfecha
		=UP_fecha("baiximpo")
		RETURN
	ENDIF
	SELE baiximpo
	ZAP
	PACK
	APPEND FROM &LSbaitmp TYPE SDF
	IF EOF()
		=UP_fecha("baiximpo")
		RETURN
	ENDIF

	SELE baiximpo
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO

	LFsegue = .t.
	LNregistro = RECNO()
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
*******************
	GO TOP
	DO WHILE !EOF() AND !wp_flgfecha
		=UPtermo()
	*>>>>>>>>>>>>>>>>>     INICIO CONVERSAO P/ ORCAMENT ou OUTROPER
		m.duplicata		=   baiximpo.codigo
		SELE duplicat
		SET ORDER TO TAG doc
		SEEK STR(m.empresa,3)+STR(m.duplicata,9)		
		IF !FOUND()
			IF RIGHT(orcament.situacao,1) <> "E"
			   DO OBJ_ALER.SPR WITH ;
			   "Duplicata nao foi encontrada. Certifique-se que o Fatara;
			   mento ja foi importado.  Doc : "+;
				"  "+str(m.duplicata,6)
				wp_flgfecha = .t.   				
			ENDIF
			SELE baiximpo
			SKIP
			LOOP
		ENDIF
*------->>>>>>>>>>>>    CAMPOS COM CORRESPONDENCIA DIRETA >>>>>>>>		
		=REGLOCK()
		m.banco			=	baiximpo.banco
		m.dt_pgto		=	CTOD(SUBS(baiximpo.dt_pag,1,2)+"."+;
								 SUBS(baiximpo.dt_pag,3,2)+"."+;
								 SUBS(baiximpo.dt_pag,5,2))
		m.vlr_pgto		=	baiximpo.valor_pag / 100
		m.juros			=	baiximpo.valor_juro / 100
		m.dsp_cobr		=	baiximpo.valor_desp / 100
		m.desconto		=	baiximpo.valor_desc / 100
		m.regiao   		=   baiximpo.regiao
		m.dt_venc		=	CTOD(SUBS(baiximpo.dt_venc,1,2)+"."+;
								 SUBS(baiximpo.dt_venc,3,2)+"."+;
								 SUBS(baiximpo.dt_venc,5,2))
		GATHER MEMVAR MEMO
		SELE baiximpo
		SKIP
		UNLOCK ALL
	ENDDO
	=UP_fecha("baiximpo")
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO

RETURN

***********************************************************************


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RMR113B2K           m.drive WHEN                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SCGC509,     Record Number:    8   
*        Variable:            m.drive                            
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rmr113b2k     &&  m.drive WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RMR113B49           m.empresa WHEN                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SCGC509,     Record Number:    9   
*        Variable:            m.empresa                          
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rmr113b49     &&  m.empresa WHEN
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RMR113B5M           m.empresa VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SCGC509,     Record Number:    9   
*        Variable:            m.empresa                          
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rmr113b5m     &&  m.empresa VALID
#REGION 1
SELECT empresa
SET ORDER TO TAG empresa
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .F.
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT empresa
		RETURN .F.
	ENDIF
ELSE
	IF !SEEK(m.empresa)
		SELECT empresa
		RETURN .F.
	ENDIF
ENDIF
m.empresa   = empresa
m.nome_emp  = empresa.nome
m.tab_cst   = empresa.tab_cst
SHOW GET m.empresa
SHOW GET m.nome_emp
SELECT empresa
RETURN .T.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RMR113B91           m.dt_inicio VALID                  
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SCGC509,     Record Number:   11   
*        Variable:            m.dt_inicio                        
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rmr113b91     &&  m.dt_inicio VALID
#REGION 1
m.dt_fim = m.dt_inicio
SHOW GET m.dt_fim
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RMR113BB2           m.imp_btn VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SCGC509,     Record Number:   14   
*        Variable:            m.imp_btn                          
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rmr113bb2     &&  m.imp_btn VALID
#REGION 1
DO WHILE m.dt_inicio <= m.dt_fim
    m.drive = ALLTRIM(m.drive)
	IF RIGHT(m.drive,1) <> "\"
	    m.drive = ALLTRIM(m.drive)+"\"
	ENDIF
***** BORDERO

	LSbrdtmp = m.drive+"BD"+STR(DAY(m.dt_inicio),2)+;
			STR(MONTH(m.dt_inicio),2)+;
			STR(m.empresa,2)+".TXT"
	LSbrdtmp = STRTRAN(LSbrdtmp," ","0")

***** BAIXAS

	LSbaitmp = m.drive+"BX"+STR(DAY(m.dt_inicio),2)+;
			STR(MONTH(m.dt_inicio),2)+;
			STR(m.empresa,2)+".TXT"
	LSnbaimp = STRTRAN(LSbaitmp," ","0")

*********************************************************************
 	wp_flgfecha = .F.
	wp_msg = "PROCESSANDO BORDEROS DE  "+DTOC(m.dt_inicio)
	DO ULconvbord
	IF wp_flgfecha
		EXIT
	ENDIF
	wp_msg = "PROCESSANDO BAIXAS DE  "+DTOC(m.dt_inicio)
	DO ULconvbaix
	IF wp_flgfecha
		EXIT
	ENDIF
*********************************************************************
	m.dt_inicio = m.dt_inicio + 1	
ENDDO
SHOW GET m.imp_btn DISABLE

RETURN



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RMR113BF4           m.canc_btn VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SCGC509,     Record Number:   15   
*        Variable:            m.canc_btn                         
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rmr113bf4     &&  m.canc_btn VALID
#REGION 1
CLEAR GETS
CLEAR READ
isediting = .f.
RETURN .T.