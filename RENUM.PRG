SET TALK ON

SELE 0
USE GRP
SELE 0
USE GRUPO EXCLU
INDEX ON ORDEM  TO TP
GO TOP

CTR = 1
LEN_CLAS = LEN(ALLTRIM(CLASSIFICA))
CMP_CLAS = ALLTRIM(CLASSIFICA)
QBR_CLAS = LEFT(CMP_CLAS, LEN_CLAS - 3)



DO WHILE !EOF()
	LEN_NOVA = LEN(ALLTRIM(CLASSIFICA))
	CMP_NOVA = ALLTRIM(CLASSIFICA)
	QBR_NOVA = LEFT(CMP_NOVA, LEN_NOVA - 3)

	IF QBR_CLAS <> QBR_NOVA
		CTR = 1
		LEN_CLAS = LEN(ALLTRIM(CLASSIFICA))
		CMP_CLAS = ALLTRIM(CLASSIFICA)
		QBR_CLAS = LEFT(CMP_CLAS, LEN_CLAS - 3)
	ENDIF
 	REPLACE CLASSIFICA WITH QBR_CLAS+CHRTRAN(STR(CTR,3)," ","0") 
	SKIP
	CTR = CTR + 1
	IF CTR > 999
	   WAIT WINDOW " OCORREU CTR > 999"
	ENDIF
ENDDO
