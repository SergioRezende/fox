Lreg = RECNO()
SET TALK OFF
GO TOP

*A=IIF(EMPTY(FIELD(1))," ",FIELD(1))
*B=IIF(EMPTY(FIELD(2))," ",FIELD(2))
*C=IIF(EMPTY(FIELD(3))," ",FIELD(3))
*D=IIF(EMPTY(FIELD(4))," ",FIELD(4))
LINHA = 1

CA = 1
CB = CA+FSIZE(A)+1
CC = CA+FSIZE(B)+1
CD = CA+FSIZE(C)+1

CAB1 = A+SPACE( IIF(LEN(A) < FSIZE(A),FSIZE(A),LEN(A))) +"|"+;
	   B+SPACE( IIF(LEN(B) < FSIZE(B),FSIZE(B),LEN(B))) +"|"+;
	   C+SPACE( IIF(LEN(C) < FSIZE(C),FSIZE(C),LEN(C))) +"|"+;
	   D+SPACE( IIF(LEN(D) < FSIZE(D),FSIZE(D),LEN(D))) 

CAB2 = REPLICATE("-",LEN(A)+LEN(B)+LEN(C)+LEN(D)+8)
DEFINE WINDOW item ;
			FROM INT((SROW()-9)/2),INT((SCOL()-79)/2) ;
			TO INT((SROW()-9)/2)+8,INT((SCOL()-79)/2)+78 ;
			FLOAT ;
			GROW;
			NOCLOSE ;
			SHADOW ;
			ZOOM;
			MINIMIZE ;
			COLOR SCHEME 1
ACTIVATE WINDOW item
DO WHILE !EOF()
	CLEAR
	LINHA = 6
	@ 1,0 SAY PADC(" SCGC - Sistema de Controle e Gerencia Comercial",80)
	@ 2,0 SAY PADC(" RELATORIO GENERICO - "+ALIAS(),80)
	@ 3,0 SAY PADC(ALLTRIM(m.titulo),80)
	@ 4,0 SAY REPLICATE("-",80)
	@ 5,0 SAY CAB1
	@ 6,0 SAY REPLICATE("-",80)
	DO WHILE !EOF() AND LINHA < 60
		LINHA = LINHA +1

		IF !EMPTY(A)
			IF EMPTY(MA)
				@LINHA,CA SAY &A
			ELSE
				@LINHA,CA SAY &A PICT &MA
			ENDIF
			IF !EMPTY(B)
				IF EMPTY(MB)
					@LINHA,CB SAY &B
				ELSE
					@LINHA,CB SAY &B PICT &MB
				ENDIF
				IF !EMPTY(C)
					IF EMPTY(MC)
						@LINHA,CC SAY &C
					ELSE
						@LINHA,CC SAY &C PICT &MC
					ENDIF
					IF !EMPTY(D)
						IF EMPTY(MD)
							@LINHA,CD SAY &D
						ELSE
							@LINHA,CD SAY &D PICT &MD
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
		SKIP
	ENDDO
	LINHA = LINHA +1
	@ LINHA,0 SAY REPLICATE("-",80)
	LINHA = LINHA +1
	@ LINHA,0 SAY DTOC(DATE())+"  "+TIME()+"        [000]"
ENDDO
DEACTIVATE WINDOW item
RELEASE WINDOW item
GO Lreg
