*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        08/21/96            OBJ_VEND.SPR               14:42:06 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1996 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF NOT WEXIST("obj_vend") ;
	OR UPPER(WTITLE("OBJ_VEND")) == "OBJ_VEND.PJX" ;
	OR UPPER(WTITLE("OBJ_VEND")) == "OBJ_VEND.SCX" ;
	OR UPPER(WTITLE("OBJ_VEND")) == "OBJ_VEND.MNX" ;
	OR UPPER(WTITLE("OBJ_VEND")) == "OBJ_VEND.PRG" ;
	OR UPPER(WTITLE("OBJ_VEND")) == "OBJ_VEND.FRX" ;
	OR UPPER(WTITLE("OBJ_VEND")) == "OBJ_VEND.QPR"
	DEFINE WINDOW obj_vend ;
		FROM INT((SROW()-16)/2),INT((SCOL()-70)/2) ;
		TO INT((SROW()-16)/2)+15,INT((SCOL()-70)/2)+69 ;
		TITLE "[ Informa Servidores Comissionados Fixos ]" ;
		FOOTER "[OBJ_VENDA]" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		COLOR SCHEME 1
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                OBJ_VEND/MS-DOS Setup Code - SECTION 2          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
*---------------------------------------------------------------------*
* ARQUIVOS UTILIZADOS :                                               *
*              - FUNCAO
*              - USUARIO
* OBJETIVO : INFORMAR OS SERVIDORES COMISSIONADOS NAO CONCORRENTES NA FUNCAO
*---------------------------------------------------------------------*


******>>>> INICIO CONTROLE AMBIENTAL

ON KEY LABEL ESCAPE  WAIT WINDOW "Para sair selecione <Ok>."

wl_areant 	= ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

LFfunfecha	= .F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFusufecha	= .F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
wp_flgfecha = .F. 		&& defaut nao fechamento da secao
isediting	= .t.
PRIVATE wzalias
m.wzalias=SELECT()

******>>>> FIM CONTROLE AMBIENTAL

******>>>> INICIO CONTROLE ARQUIVOS
IF !USED("funcao")
	LFfunfecha	= .T.
	IF ! NetUse("funcao")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("usuario")
	LFusufecha	= .T.
	IF ! NetUse("usuario")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

DO CASE
	CASE !wp_flgfecha
		select funcao
		set order to  tag nivel
		*---------------------------->*******
		GO TOP
		SCATTER MEMVAR MEMO	
		IF EOF()
		   SCATTER MEMVAR BLANK MEMO	
		ENDIF       	
		VLnivnum = 0
		FOR VLnivnum = 1 TO 9
		    VLnivstr = STR(VLnivnum,1)
		    IF EMPTY(VTLservfx(VLnivnum))
			    servfx&VLnivstr = 0
		    ELSE
			    servfx&VLnivstr = VTLservfx(VLnivnum)
		    ENDIF
		    SELE usuario
		    SET ORDER TO TAG usuario
			IF !SEEK(m.servfx&VLnivstr)
				nome&VLnivstr   = ""
		    ELSE
				nome&VLnivstr   = nome
		    ENDIF
		    SELE funcao
		    FUNC&VLnivstr = m.funcao
		    DESC&VLnivstr = m.descricao
		    SKIP
		    IF EOF()
		    	SCATTER MEMVAR BLANK MEMO	
			    SKIP -1
		    ELSE
			    SCATTER MEMVAR MEMO	
			ENDIF       	
		ENDFOR	
		SELE usuario
ENDCASE

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     OBJ_VEND/MS-DOS Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("obj_vend")
	ACTIVATE WINDOW obj_vend SAME
ELSE
	ACTIVATE WINDOW obj_vend NOSHOW
ENDIF
@ 1,27 GET M.FUNC1 ;
	SIZE 1,3 ;
	DEFAULT " " ;
	WHEN .F.
@ 1,31 GET M.DESC1 ;
	SIZE 1,36 ;
	DEFAULT " " ;
	WHEN .F.
@ 1,5 GET m.servfx1 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN .t. ;
	VALID ULverserv("1") ;
	ERROR wp_msg	
@ 1,10 GET m.nome1 ;
	SIZE 1,14 ;
	DEFAULT " " ;
	WHEN .f.
@ 1,25 SAY "-" ;
	SIZE 1,1, 0
@ 2,27 GET M.FUNC2 ;
	SIZE 1,3 ;
	DEFAULT " " ;
	WHEN .F.
@ 2,31 GET M.DESC2 ;
	SIZE 1,36 ;
	DEFAULT " " ;
	WHEN .F.
@ 2,5 GET m.servfx2 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN .t. ;
	VALID ULverserv("2") ;
	ERROR wp_msg	
@ 2,10 GET m.nome2 ;
	SIZE 1,14 ;
	DEFAULT " " ;
	WHEN .f.
@ 2,25 SAY "-" ;
	SIZE 1,1, 0
@ 3,27 GET M.FUNC3 ;
	SIZE 1,3 ;
	DEFAULT " " ;
	WHEN .F.
@ 3,31 GET M.DESC3 ;
	SIZE 1,36 ;
	DEFAULT " " ;
	WHEN .F.
@ 3,5 GET m.servfx3 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN .t. ;
	VALID ULverserv("3") ;
	ERROR wp_msg	
@ 3,10 GET m.nome3 ;
	SIZE 1,14 ;
	DEFAULT " " ;
	WHEN .f.
@ 3,25 SAY "-" ;
	SIZE 1,1, 0
@ 1,2 SAY "1-" ;
	SIZE 1,2, 0
@ 2,2 SAY "2-" ;
	SIZE 1,2, 0
@ 3,2 SAY "3-" ;
	SIZE 1,2, 0
@ 4,27 GET M.FUNC4 ;
	SIZE 1,3 ;
	DEFAULT " " ;
	WHEN .F.
@ 4,31 GET M.DESC4 ;
	SIZE 1,36 ;
	DEFAULT " " ;
	WHEN .F.
@ 4,5 GET m.servfx4 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN .t. ;
	VALID ULverserv("4") ;
	ERROR wp_msg	
@ 4,10 GET m.nome4 ;
	SIZE 1,14 ;
	DEFAULT " " ;
	WHEN .f.
@ 4,25 SAY "-" ;
	SIZE 1,1, 0
@ 5,27 GET M.FUNC5 ;
	SIZE 1,3 ;
	DEFAULT " " ;
	WHEN .F.
@ 5,31 GET M.DESC5 ;
	SIZE 1,36 ;
	DEFAULT " " ;
	WHEN .F.
@ 5,5 GET m.servfx5 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN .t. ;
	VALID ULverserv("5") ;
	ERROR wp_msg	
@ 5,10 GET m.nome5 ;
	SIZE 1,14 ;
	DEFAULT " " ;
	WHEN .f.
@ 5,25 SAY "-" ;
	SIZE 1,1, 0
@ 4,2 SAY "4-" ;
	SIZE 1,2, 0
@ 5,2 SAY "5-" ;
	SIZE 1,2, 0
@ 6,27 GET M.FUNC6 ;
	SIZE 1,3 ;
	DEFAULT " " ;
	WHEN .F.
@ 6,31 GET M.DESC6 ;
	SIZE 1,36 ;
	DEFAULT " " ;
	WHEN .F.
@ 6,5 GET m.servfx6 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN .t. ;
	VALID ULverserv("6") ;
	ERROR wp_msg	
@ 6,10 GET m.nome6 ;
	SIZE 1,14 ;
	DEFAULT " " ;
	WHEN .f.
@ 6,25 SAY "-" ;
	SIZE 1,1, 0
@ 6,2 SAY "6-" ;
	SIZE 1,2, 0
@ 7,27 GET M.FUNC7 ;
	SIZE 1,3 ;
	DEFAULT " " ;
	WHEN .F.
@ 7,31 GET M.DESC7 ;
	SIZE 1,36 ;
	DEFAULT " " ;
	WHEN .F.
@ 7,5 GET m.servfx7 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN .t. ;
	VALID ULverserv("7") ;
	ERROR wp_msg	
@ 7,10 GET m.nome7 ;
	SIZE 1,14 ;
	DEFAULT " " ;
	WHEN .f.
@ 7,25 SAY "-" ;
	SIZE 1,1, 0
@ 7,2 SAY "7-" ;
	SIZE 1,2, 0
@ 8,27 GET M.FUNC8 ;
	SIZE 1,3 ;
	DEFAULT " " ;
	WHEN .F.
@ 8,31 GET M.DESC8 ;
	SIZE 1,36 ;
	DEFAULT " " ;
	WHEN .F.
@ 8,5 GET m.servfx8 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN .t. ;
	VALID ULverserv("8") ;
	ERROR wp_msg	
@ 8,10 GET m.nome8 ;
	SIZE 1,14 ;
	DEFAULT " " ;
	WHEN .f.
@ 8,25 SAY "-" ;
	SIZE 1,1, 0
@ 8,2 SAY "8-" ;
	SIZE 1,2, 0
@ 9,27 GET M.FUNC9 ;
	SIZE 1,3 ;
	DEFAULT " " ;
	WHEN .F.
@ 9,31 GET M.DESC9 ;
	SIZE 1,36 ;
	DEFAULT " " ;
	WHEN .F.
@ 9,5 GET m.servfx9 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN .t. ;
	VALID ULverserv("9") ;
	ERROR wp_msg	
@ 9,10 GET m.nome9 ;
	SIZE 1,14 ;
	DEFAULT " " ;
	WHEN .f.
@ 9,25 SAY "-" ;
	SIZE 1,1, 0
@ 9,2 SAY "9-" ;
	SIZE 1,2, 0
@ 12,30 GET m.del_btn ;
	PICTURE "@*HN \<Ok" ;
	SIZE 1,8,1 ;
	DEFAULT 1 ;
	VALID _rd60vifac() ;
	MESSAGE 'Abre Sistema Vendas'

IF NOT WVISIBLE("obj_vend")
	ACTIVATE WINDOW obj_vend
ENDIF

READ CYCLE

RELEASE WINDOW obj_vend

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     OBJ_VEND/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
RETURN



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*         OBJ_VEND/MS-DOS Supporting Procedures and Functions    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
FUNCTION ULverserv && verifica os codigo informados nos 9 niveis
PARAMETERS VLniv
	wp_msg = ""
    VLnum = INT(VAL(VLniv))
    VTLservfx(VLnum) = m.servfx&VLniv
	IF LASTKEY() = 9
		DO loc_dlog
		m.servfx&VLniv = usuario
		m.nome&VLniv   = nome
        IF LASTKEY() = 27
       	   wp_msg = "Procura Cancelada."
           RETURN .F.
        ENDIF
		SHOW GET m.servfx&VLniv
		SHOW GET m.nome&VLniv
    ELSE
		IF EMPTY(m.servfx&VLniv)
		   RETURN .T.
		ENDIF
		IF ! SEEK(m.servfx&VLniv)
		    wp_msg = "Usuario nao esta Cadastrado neste codigo."
			RETURN .F.
		ENDIF	
    ENDIF
	IF usuario.nivel_com <> INT(VAL(VLniv))
	   wp_msg = "Usuario nao pertence a esta funcao. Informe outro codigo."
	   RETURN .F.
	ENDIF
	m.nome&VLniv = nome
	SHOW GET m.nome&VLniv
RETURN .T.



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RD60VIFAC           m.del_btn VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         OBJ_VEND,     Record Number:   56  
*        Variable:            m.del_btn                          
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rd60vifac     &&  m.del_btn VALID
#REGION 1
CLEAR GETS
CLEAR READ
isediting = .f.
RETURN .T.