*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º 03/31/15             SCGC406.SPR               09:04:57 º
*       º                                                         º
*       ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
*       º                                                         º
*       º Author's Name                                           º
*       º                                                         º
*       º Copyright (c) 2015 Company Name                         º
*       º Address                                                 º
*       º City,     Zip                                           º
*       º                                                         º
*       º Description:                                            º
*       º This program was automatically generated by GENSCRN.    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC406/MS-DOS Setup Code - SECTION 1          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
***************
*~ WIZARDSCREEN

*---------------------------------------------------------------------*
* ARQUIVOS UTILIZADOS :                                               *
*              - SALDO
*              - GRUPO
*			   - EMPRESA
* OBJETIVOS : ABERTURA E FECHAMENTO DE SALDOS MENSSAIS
*	
*---------------------------------------------------------------------*
******>>>> INICIO CONTROLE AMBIENTAL

ON KEY LABEL ESCAPE

PRIVATE isediting,isadding
PRIVATE wp_record
PRIVATE isreadonly,is2table,wzalias
PRIVATE LS406areant
LS406areant	= ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.wzalias	=	SELECT()
m.isediting	=	.F.
m.isadding	=	.F.

m.is2table 	= 	.F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
wp_ref_local =  .f.     &&  POSSUI CONTROLE DE REFRESH LOCAL

LFsalfecha	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFgrufecha	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFempfecha	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA

LDfecha    =  wp_dtoper   && Informa o mes a ser fechado
LDabre     =  wp_dtoper   && Informa o mes a ser aberto
IF DAY(wp_dtoper) > 15
   LDabre  = GOMONTH(LDabre,1)  && Fechando mes atual e abrindo o prox.
ELSE
   LDfecha = GOMONTH(LDfecha,-1) && Fechando mes anter. e abrindo o atual
ENDIF

******>>>> INICIO CONTROLE ARQUIVOS

*>> parametros repassados a btn_val

VLleitura = ""         && repassa chave de leitura p/ btn_val
VLlerfim  = ""   && repassa chave de leitura p/ btn_val (POSIC.FINAL+1 REG)
VLcompara = ""        && repassa chave de comparacao p/ btn_val

IF !USED("saldo")
	LFsalfecha	= .T.
	IF ! NetUse("saldo")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("empresa")
	LFempfecha	= .T.
	IF ! NetUse("empresa")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("grupo")
	LFgrufecha	= .T.
	IF ! NetUse("grupo")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF wp_flgfecha
	DO ULfecha
	RETURN
ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                MS-DOS Window definitions                º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

IF NOT WEXIST("scgc406") ;
	OR UPPER(WTITLE("SCGC406")) == "SCGC406.PJX" ;
	OR UPPER(WTITLE("SCGC406")) == "SCGC406.SCX" ;
	OR UPPER(WTITLE("SCGC406")) == "SCGC406.MNX" ;
	OR UPPER(WTITLE("SCGC406")) == "SCGC406.PRG" ;
	OR UPPER(WTITLE("SCGC406")) == "SCGC406.FRX" ;
	OR UPPER(WTITLE("SCGC406")) == "SCGC406.QPR"
	DEFINE WINDOW scgc406 ;
		FROM INT((SROW()-14)/2),INT((SCOL()-67)/2) ;
		TO INT((SROW()-14)/2)+13,INT((SCOL()-67)/2)+66 ;
		TITLE "[ Abertura do Controle de Saldos ]" ;
		FOOTER "[406]" ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC406/MS-DOS Setup Code - SECTION 2          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1

******>>>> INICIO CONTROLE LOCAL

DO CASE
	CASE !wp_flgfecha
		SELECT SALDO
		ON KEY LABEL ESCAPE KEYBOARD 'S'  && ????????????
        LDabre = GOMONTH(LDfecha,1)
        SHOW GET LDabre
		SHOW GETS
		GO TOP
		SCATTER MEMVAR MEMO
		*-------------------------> criado pelo wizard
		m.wzalias=SELECT()
		m.isreadonly=IIF(ISREAD(),.T.,.F.)
		IF m.isreadonly
			WAIT WINDOW C_READONLY TIMEOUT 1
		ENDIF
		KEYBOARD "I"
ENDCASE







*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC406/MS-DOS Screen Layout               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
IF WVISIBLE("scgc406")
	ACTIVATE WINDOW scgc406 SAME
ELSE
	ACTIVATE WINDOW scgc406 NOSHOW
ENDIF
@ 3,9 SAY "-" ;
	SIZE 1,1, 0
@ 2,3 TO 4,31 ;
	COLOR SCHEME 23
@ 4,4 TO 4,30 ;
	COLOR SCHEME 24
@ 4,31 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,31 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,31 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,4 SAY "[Filial]" ;
	SIZE 1,8, 0
@ 10,3 TO 12,19 ;
	COLOR SCHEME 24
@ 12,4 TO 12,18 ;
	COLOR SCHEME 23
@ 11,19 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,19 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,19 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,25 TO 12,41 ;
	COLOR SCHEME 24
@ 12,26 TO 12,40 ;
	COLOR SCHEME 23
@ 11,41 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,41 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,41 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,47 TO 12,63 ;
	COLOR SCHEME 24
@ 12,48 TO 12,62 ;
	COLOR SCHEME 23
@ 11,63 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,63 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,63 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 0,0 TO 13,66 ;
	COLOR SCHEME 23
@ 13,1 TO 13,65 ;
	COLOR SCHEME 24
@ 13,66 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,66 TO 12,66 ;
	COLOR SCHEME 24
@ 0,2 SAY "[ Processamento Para Fechar e Abrir Registros de Saldos ]" ;
	SIZE 1,57, 0
@ 0,60 SAY "[406]" ;
	SIZE 1,5, 0
@ 0,66 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,3 TO 8,31 ;
	COLOR SCHEME 23
@ 8,4 TO 8,30 ;
	COLOR SCHEME 24
@ 8,31 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 7,31 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,31 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,4 SAY "[ Mes Para Fechamento ]" ;
	SIZE 1,23, 0
@ 6,35 TO 8,63 ;
	COLOR SCHEME 23
@ 8,36 TO 8,62 ;
	COLOR SCHEME 24
@ 8,63 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 7,63 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,63 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,6 GET m.empresa ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN _4bf0jgtgp() ;
	VALID _4bf0jgtgy()
@ 3,10 GET m.nome_emp ;
	SIZE 1,20 ;
	DEFAULT " " ;
	PICTURE "@!K" ;
	WHEN _4bf0jgth8()
@ 7,11 GET LDfecha ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _4bf0jgtix() ;
	VALID _4bf0jgtj3()
@ 7,44 GET LDabre ;
	SIZE 1,11 ;
	DEFAULT {  /  /  } ;
	WHEN isediting AND EMPTY(LDfecha) ;
	VALID m.LDfecha >= LDabre ;
	ERROR 'As duas Datas devem pertencer a meses consecutivos'
@ 11,7 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 11,29 GET m.imp_btn ;
	PICTURE "@*HN \<Processa" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _4bf0jgtj4() ;
	DISABLE
@ 11,52 GET m.exit_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _4bf0jgtj5() ;
	MESSAGE 'Close screen.'
@ 6,36 SAY "[ Mes Para Abertura ]" ;
	SIZE 1,21, 0
@ 3,34 SAY "999 =TODAS" ;
	SIZE 1,10, 0

IF NOT WVISIBLE("scgc406")
	ACTIVATE WINDOW scgc406
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º     MS-DOSREAD contains clauses from SCREEN scgc406     º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

READ CYCLE ;
	ACTIVATE READACT() ;
	DEACTIVATE READDEAC() ;
	NOLOCK

RELEASE WINDOW scgc406

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º               SCGC406/MS-DOS Cleanup Code               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
DO ULfecha
RETURN




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º   SCGC406/MS-DOS Supporting Procedures and Functions    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
PROCEDURE ULfecha
	IF LFsalfecha		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("saldo")
	ENDIF
	IF LFempfecha		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	IF LFgrufecha		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("grupo")
	ENDIF
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(LS406areant)
		SELECT &LS406areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
RETURN

***
PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	LN_prxobj = _CUROBJ
    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.imp_btn DISABLE
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn ENABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn DISABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN

**---->

PROCEDURE ULnovoproc
	PRIVATE LNqtde		&& Qtde em Estoque do Produto
	

	isediting = .f.
	SHOW GET m.imp_btn DISABLE
	*--------------------------------------------------------------*
	*   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
	*--------------------------------------------------------------*
	SELE GRUPO
	SET ORDER TO TAG classifica

	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()

	COUNT  	FOR cdg_tipo = 4 TO   LNimpressao

	LNimpressos = 0
	GO TOP
	*******************
    wl_tmp =  STRTRAN(STR(m.empresa,3),' ','0')
	wp_msg = "Processando Empresa : "+wl_tmp

	LNempresa = m.empresa	&& Com scatter m.empresa assumira 0
	DO WHILE !EOF() AND LFsegue

			IF grupo.cdg_tipo <> 4
				SKIP
				LOOP
			ENDIF

			=UPtermo()
		    wl_tmp =  STRTRAN(STR(LNempresa,3),' ','0')
			LNqtde = 0
			*----------------------------------------------------------*
			=W_DEFPROC("ESTOQUE.SPR")
			=ESsaldo(LNempresa	,grupo.codigo ,;
				 grupo.classifica , LDabre, LNqtde)
			*----------------------------------------------------------*
			*----------------------------------------------------------*
			SELE grupo

		    SCATTER MEMVAR

			SELE saldo
			SET ORDER TO TAG emp_mes
			SEEK STR(m.empresa,3)+STR(YEAR(LDfecha),4)+;
				 STR(MONTH(LDfecha),2)+grupo.CLASSIFICA
			IF FOUND()
				****************  FECHANDO REGISTRO ******************
				SCATTER MEMVAR MEMO && capit dad p/ proc de abert
			    IF REGLOCK()
			       REPLACE STATUS WITH 'F'  && status de fechado
			    ENDIF
				****************  ABRINDO REGISTRO ********************
			ELSE
			    m.sld_atu	= 0		&& NAO EXISTE REGISTRO ANTERIOR
	    		m.vlr_atu	= 0
 			ENDIF
			*-----------------------------------------------------------*
			=W_DEFPROC("ESTOQUE.SPR")
			=ESAbresaldo((LNempresa),(grupo.codigo),;
						(grupo.classifica),(LDabre),(LDabre))
			*-----------------------------------------------------------*
			SELECT grupo
			SET ORDER TO TAG classifica
			SKIP
	ENDDO
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
	*-----------------------------
    SET PRINTER TO SET('PRINTER',1)
	SET RELATION TO
	SET POINT TO
	SET SEPARATOR  TO
RETURN


PROCEDURE ULabretodas

    AUX_LDfecha = LDfecha
    AUX_LDabre  = LDabre


	IF m.empresa <> 999
		=ULnovoproc()
	ELSE
		SELECT empresa
		SET ORDER TO TAG empresa
		go top

		DO WHILE !EOF()
			m.empresa   = empresa.empresa
			m.nome_emp  = empresa.nome
		    LDfecha 	= AUX_LDfecha
		    LDabre  	= AUX_LDabre

			=ULnovoproc()

			SHOW GET m.empresa
			SHOW GET m.nome_emp
			SELECT empresa
			skip
		ENDDO
	ENDIF


RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4BF0JGTGP           m.empresa WHEN                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC406,     Record Number:   42   º
*       º Variable:            m.empresa                          º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      1                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4bf0jgtgp     &&  m.empresa WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4BF0JGTGY           m.empresa VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC406,     Record Number:   42   º
*       º Variable:            m.empresa                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      2                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4bf0jgtgy     &&  m.empresa VALID
#REGION 1
SELECT empresa
SET ORDER TO TAG empresa


IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .F.
   ON KEY LABEL ESCAPE DO BTN_VAL WITH 'DELETE'
   IF LASTKEY() = 27
		SELECT empresa
		RETURN .F.
	ENDIF
ENDIF

IF m.empresa= 999
	m.nome_emp  = "TODAS"
ELSE
	IF !SEEK(m.empresa)
		SELECT empresa
		RETURN .F.
	ENDIF
	m.empresa   = empresa
	m.nome_emp  = empresa.nome
ENDIF

SELECT empresa
SHOW GET m.empresa
SHOW GET m.nome_emp
SELECT empresa
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4BF0JGTH8           m.nome_emp WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC406,     Record Number:   43   º
*       º Variable:            m.nome_emp                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      3                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4bf0jgth8     &&  m.nome_emp WHEN
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(.f.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4BF0JGTIX           LDfecha WHEN                       º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC406,     Record Number:   44   º
*       º Variable:            LDfecha                            º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      4                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4bf0jgtix     &&  LDfecha WHEN
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4BF0JGTJ3           LDfecha VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC406,     Record Number:   44   º
*       º Variable:            LDfecha                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      5                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4bf0jgtj3     &&  LDfecha VALID
#REGION 1
LDabre = GOMONTH(LDfecha,1)
SHOW GET LDabre


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4BF0JGTJ4           m.imp_btn VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC406,     Record Number:   47   º
*       º Variable:            m.imp_btn                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      6                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4bf0jgtj4     &&  m.imp_btn VALID
#REGION 1
=ULnovoproc()
SHOW WINDOW SCGC406 TOP
SHOW GET m.imp_btn DISABLE

RETURN



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4BF0JGTJ5           m.exit_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC406,     Record Number:   48   º
*       º Variable:            m.exit_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      7                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4bf0jgtj5     &&  m.exit_btn VALID
#REGION 1
ON KEY LABEL ESCAPE
CLEAR READ
RETURN .T.