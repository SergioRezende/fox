*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ 03/19/09             SES0100.SPR               14:47:41 ╨
*       ╨                                                         ╨
*       гддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╤
*       ╨                                                         ╨
*       ╨ Author's Name                                           ╨
*       ╨                                                         ╨
*       ╨ Copyright (c) 2009 Company Name                         ╨
*       ╨ Address                                                 ╨
*       ╨ City,     Zip                                           ╨
*       ╨                                                         ╨
*       ╨ Description:                                            ╨
*       ╨ This program was automatically generated by GENSCRN.    ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨          SES0100/MS-DOS Setup Code - SECTION 1          ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
    = W_DEFPROC("rotinas.spr")
	ON KEY LABEL ESCAPE
	PRIVATE LFitemmov,LFsldressa
	PRIVATE LSalias
	PRIVATE wp_ref_local
	PRIVATE isediting
	wp_ref_local =  .f.     && NAO POSSUI CONTROLE DE REFRESH LOCAL
	m.isediting	 =	.F.
	LSalias	     = ALIAS()
    LFempresa    = NetArq("Empresa")
    LFitemmov    = NetArq("Itemmov")
	LFsaldo		 = NetArq("Saldo")
    IF (LFempresa+LFitemmov+LFsaldo) > 100000          && HOUVE FALHA ABERT
		DO ulfecha
    	RETURN(.F.)
    ENDIF

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨                MS-DOS Window definitions                ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

IF NOT WEXIST("ses0100") ;
	OR UPPER(WTITLE("SES0100")) == "SES0100.PJX" ;
	OR UPPER(WTITLE("SES0100")) == "SES0100.SCX" ;
	OR UPPER(WTITLE("SES0100")) == "SES0100.MNX" ;
	OR UPPER(WTITLE("SES0100")) == "SES0100.PRG" ;
	OR UPPER(WTITLE("SES0100")) == "SES0100.FRX" ;
	OR UPPER(WTITLE("SES0100")) == "SES0100.QPR"
	DEFINE WINDOW ses0100 ;
		FROM INT((SROW()-16)/2),INT((SCOL()-76)/2) ;
		TO INT((SROW()-16)/2)+15,INT((SCOL()-76)/2)+75 ;
		TITLE "[ Itens Movimentados ] " ;
		FOOTER "[0100]" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨          SES0100/MS-DOS Setup Code - SECTION 2          ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
	LarqGrupo = UPobterPath("GRUPO")+"GRUPO.DBF"
	SELECT classifica, descricao ;
		FROM  &LarqGrupo ;
		WHERE cdg_tipo = 1;
		ORDER BY classifica;
		INTO CURSOR TMP_GRUP
		
	LNDEFGRP = 0

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨              SES0100/MS-DOS Screen Layout               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
IF WVISIBLE("ses0100")
	ACTIVATE WINDOW ses0100 SAME
ELSE
	ACTIVATE WINDOW ses0100 NOSHOW
ENDIF
@ 1,2 TO 11,72 ;
	COLOR SCHEME 23
@ 11,3 TO 11,71 ;
	COLOR SCHEME 24
@ 11,72 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,72 TO 10,72 ;
	COLOR SCHEME 24
@ 1,72 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,0 TO 15,75 ;
	COLOR SCHEME 23
@ 15,1 TO 15,74 ;
	COLOR SCHEME 24
@ 15,75 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,75 TO 14,75 ;
	COLOR SCHEME 24
@ 0,75 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 12,6 TO 14,22 ;
	COLOR SCHEME 24
@ 14,7 TO 14,21 ;
	COLOR SCHEME 23
@ 13,22 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 14,22 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,22 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,29 TO 14,45 ;
	COLOR SCHEME 24
@ 14,30 TO 14,44 ;
	COLOR SCHEME 23
@ 13,45 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 14,45 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,45 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,52 TO 14,68 ;
	COLOR SCHEME 24
@ 14,53 TO 14,67 ;
	COLOR SCHEME 23
@ 13,68 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 14,68 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,68 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 3,51 SAY "a" ;
	SIZE 1,1, 0
@ 2,39 TO 4,63 ;
	COLOR SCHEME 23
@ 4,40 TO 4,62 ;
	COLOR SCHEME 24
@ 4,63 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,63 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,63 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,41 SAY "[Periodo]" ;
	SIZE 1,9, 0
@ 2,3 TO 4,34 ;
	COLOR SCHEME 23
@ 4,4 TO 4,33 ;
	COLOR SCHEME 24
@ 4,34 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,34 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,34 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,5 SAY "[Filial]" ;
	SIZE 1,8, 0
@ 3,8 SAY "-" ;
	SIZE 1,1, 0
@ 0,27 SAY "[ itens Movimentados ]" ;
	SIZE 1,22, 0
@ 7,4 TO 9,28 ;
	COLOR SCHEME 23
@ 7,6 SAY "[Grupo]" ;
	SIZE 1,7, 0
@ 9,5 TO 9,27 ;
	COLOR SCHEME 24
@ 9,28 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 8,28 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 7,28 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 8,7 SAY "-" ;
	SIZE 1,1, 0
@ 0,66 SAY "[SES100]" ;
	SIZE 1,8, 0
@ 3,5 GET m.empresa ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN _2lx0vpku3() ;
	VALID _2lx0vpku5()
@ 3,9 GET m.nome_emp ;
	SIZE 1,23 ;
	DEFAULT " " ;
	WHEN _2lx0vpkua()
@ 3,40 GET m.dt_inicio ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _2lx0vpkuc() ;
	VALID _2lx0vpkuf()
@ 3,53 GET m.dt_fim ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN isediting ;
	MESSAGE "Data Final deve ser maior ou igual a Inicial"
@ 6,4 GET LNDEFGRP ;
	PICTURE "@*C Nao definir grupo" ;
	SIZE 1,21 ;
	DEFAULT 0 ;
	WHEN _2lx0vpkui()
@ 8,5 GET m.GRUPO_SEL ;
	SIZE 1,2 ;
	DEFAULT " " ;
	PICTURE "99" ;
	WHEN _2lx0vpkw4() ;
	VALID _2lx0vpkw7()
@ 8,8 GET m.nome_grupo ;
	SIZE 1,18 ;
	DEFAULT " " ;
	WHEN _2lx0vpkwb()
@ 10,40 GET LNSALDOI ;
	PICTURE "@*C Imprime Saldo Atual" ;
	SIZE 1,23 ;
	DEFAULT 0 ;
	WHEN _2lx0vpkwc()
@ 13,10 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	WHEN _2lx0vpkwd() ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 13,33 GET m.imp_btn ;
	PICTURE "@*HN \<Imprime" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _2lx0vpkwe() ;
	DISABLE
@ 13,57 GET exit_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _2lx0vpkwf()

IF NOT WVISIBLE("ses0100")
	ACTIVATE WINDOW ses0100
ENDIF

READ CYCLE

RELEASE WINDOW ses0100

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨               SES0100/MS-DOS Cleanup Code               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
DO ULfecha
RETURN



*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨   SES0100/MS-DOS Supporting Procedures and Functions    ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
PROC ulfecha

	=UP_fecha("TMP_GRUPO")
	=UP_fecha("GRUPO")
	=UP_fecha("empresa"  ,LFempresa)
	=UP_fecha("duplicat" ,LFitemmov)
	=UP_fecha("banco"	 ,LFsaldo)


RETU

PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	LN_prxobj = _CUROBJ
	SHOW GET wp_empresa
	SHOW GET wp_nome_emp

    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.imp_btn DISABLE
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn ENABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn DISABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN

PROCEDURE ULITENSMOV


	*------------------------------------------------------------*
	*  INICIA GERACAO DE ARQUIVO TEMPORARIO
	*------------------------------------------------------------*
	LSarqtmp 	= "" 			&& EX: C:\TMP\TMP0001
	LSaliastmp 	= "ITM" 		&&     TMP001
	LSaliastmp  = UPopentmp(wp_dirtmp,LSarqtmp,LSaliastmp,1)

	
	IF EMPTY(LSaliastmp)
		IF !EMPTY(LSalias) AND USED(LSalias)
			SELECT &LSalias
		ENDIF
		POP KEY 			&& reabilita teclas de atalho def. anteriormente
		RETURN(.F.)
	ENDIF		
	WAIT WINDOW "AGUARDE. Gerando Arq. Temporario. " NOWAIT

	
	SELE ITEMMOV


	IF LNDEFGRP = 0
	    SELECT empresa,codigo,classifica, ;
    		   operacao,movestq,data, ;
    		   descricao,qtde ;
         FROM 	ITEMMOV ;
         WHERE    data 	>=  m.dt_inicio ;
		      AND data    <=  m.dt_fim ;
           	  AND empresa = m.empresa ;
           	  AND LEFT(classifica,2) = m.GRUPO_SEL;
    		  AND (;
    		  		(left(operacao,1) = "E" AND movestq = "S")  ;
    		  		OR ;
 			      	(left(operacao,1) = "S" AND movestq = "S")  ;
 			      );
		 ORDE BY classifica ;
         INTO CURSOR TMP_ITEM
	ELSE
	    SELECT empresa,codigo,classifica, ;
    		   operacao,movestq,data, ;
    		   descricao,qtde ;
         FROM 	ITEMMOV ;
         WHERE    data 	>=  m.dt_inicio ;
		      AND data    <=  m.dt_fim ;
           	  AND empresa = m.empresa ;
    		  AND (;
    		  		(left(operacao,1) = "E" AND movestq = "S")  ;
    		  		OR ;
 			      	(left(operacao,1) = "S" AND movestq = "S")  ;
 			      );
		 ORDE BY classifica ;
         INTO CURSOR TMP_ITEM
	ENDIF



	SELECT *, SUM(VAL(STR(0))) AS ENTRADA     , ;
			  SUM(VAL(STR(QTDE))) AS SAIDA ;
	 FROM TMP_ITEM;
    	WHERE (left(operacao,1) = "S" AND movestq = "S");
	    ORDE BY classifica ;
		GROUP BY classifica ;
	    INTO CURSOR TMP_SAID

	SELECT * FROM TMP_SAID ;
	UNION ;
	SELECT *, SUM(VAL(STR(QTDE))) AS ENTRADA  ,;
			  SUM(VAL(STR(0)))    AS SAIDA  ;
	  FROM TMP_ITEM;
    	WHERE (left(operacao,1) = "E" AND movestq = "S");
		GROUP BY classifica ;
    	INTO CURSOR TMP_UNION


    SELECT  EMPRESA,;
			CODIGO,;
			CLASSIFICA,;
			OPERACAO,;
			MOVESTQ,;
			DATA,;
			DESCRICAO,;
			QTDE,;
			SUM(ENTRADA) AS ENTRADA,;
			SUM(SAIDA)   AS SAIDA;
    FROM TMP_UNION ;
	    ORDE BY classifica ;
		GROUP BY classifica ;
	    INTO CURSOR TMP_GERAL


    SELECT *,;
        W_DEFPROC("estoque.spr")+;
        	ESsaldo(empresa,codigo,classifica,m.dt_inicio-1) AS SALD_ANT,;
        W_DEFPROC("estoque.spr")+;
        	ESsaldo(empresa,codigo,classifica,m.dt_fim) AS SALD_ATU;
     FROM TMP_GERAL GR ;
	    ORDE BY classifica ;
		GROUP BY classifica ;
	    INTO CURSOR TMP_FINAL



	WAIT WINDOW "Gerando Arquivo Temporario ! " nowait

	GO TOP

	SELE TMP_FINAL
	
***********-------
	go top
	IF EOF() AND BOF()
		=UP_fecha("TMP_ITEM")
		=UP_fecha("TMP_SAID")
		=UP_fecha("TMP_ENTR")
		=UP_fecha("TMP_UNION")
		=UP_fecha("TMP_GERAL")
		=UP_fecha("TMP_FINAL")
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
 		RETURN
 	ENDIF		
	
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue     = .t.
	LNregistro  = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
	
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	LF_fim     = .f.
    LSrel 	   = "SES0100"      && relatorio padrao
    LSorienta  = " FOR LFsegue "
	DO UPimpressao WITH 	LFLdireciona, LFLagrega, LFLfimagrega
	LFcontinua = LFsegue
************
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
	=UP_fecha("TMP_ITEM")
	=UP_fecha("TMP_SAID")
	=UP_fecha("TMP_ENTR")
	=UP_fecha("TMP_UNION")
	=UP_fecha("TMP_GERAL")
	=UP_fecha("TMP_FINAL")
RETURN



*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKU3           m.empresa WHEN                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   50   ╨
*       ╨ Variable:            m.empresa                          ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      1                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0vpku3     &&  m.empresa WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKU5           m.empresa VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   50   ╨
*       ╨ Variable:            m.empresa                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      2                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0vpku5     &&  m.empresa VALID
#REGION 1
SELECT empresa
SET ORDER TO TAG empresa
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .F.
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT empresa
		RETURN .F.
	ENDIF
ELSE
	IF !SEEK(m.empresa)
		SELECT empresa
		RETURN .F.
	ENDIF
ENDIF
m.empresa   = empresa
m.nome_emp  = empresa.nome
m.inscricao = empresa.inscricao
SHOW GET m.empresa
SHOW GET m.nome_emp
SELECT empresa
RETURN .T.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKUA           m.nome_emp WHEN                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   51   ╨
*       ╨ Variable:            m.nome_emp                         ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      3                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0vpkua     &&  m.nome_emp WHEN
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(.f.)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKUC           m.dt_inicio WHEN                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   52   ╨
*       ╨ Variable:            m.dt_inicio                        ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      4                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0vpkuc     &&  m.dt_inicio WHEN
#REGION 1
IF isediting
	ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ENDIF
RETURN(isediting)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKUF           m.dt_inicio VALID                  ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   52   ╨
*       ╨ Variable:            m.dt_inicio                        ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      5                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0vpkuf     &&  m.dt_inicio VALID
#REGION 1
m.dt_fim = m.dt_inicio
SHOW GET m.dt_fim
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN (.T.)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKUI           LNDEFGRP WHEN                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   54   ╨
*       ╨ Variable:            LNDEFGRP                           ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      6                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0vpkui     &&  LNDEFGRP WHEN
#REGION 1
 ON KEY LABEL ENTER  KEYBOARD "{RIGHTARROW}"
 ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKW4           m.GRUPO_SEL WHEN                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   55   ╨
*       ╨ Variable:            m.GRUPO_SEL                        ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      7                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0vpkw4     &&  m.GRUPO_SEL WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting AND LNDEFGRP = 0)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKW7           m.GRUPO_SEL VALID                  ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   55   ╨
*       ╨ Variable:            m.GRUPO_SEL                        ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      8                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0vpkw7     &&  m.GRUPO_SEL VALID
#REGION 1
SELECT tmp_grup
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .t.
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
    IF LASTKEY() = 27
		SELECT empresa
		RETURN .F.
	ENDIF
ELSE
	IF m.grupo_sel = "99"
		m.nome_grupo = "TODOS MOVIMENTADOS"
		SHOW GET m.nome_grupo
		SELECT empresa
		RETURN .T.
	ENDIF	

	LOCATE FOR classifica = m.grupo_sel

	IF !FOUND()
		SELECT empresa
		RETURN .F.
	ENDIF
ENDIF
m.grupo_sel   = tmp_grup.classifica
m.nome_grupo = tmp_grup.descricao
SHOW GET m.grupo_sel
SHOW GET m.nome_grupo
SELECT empresa
RETURN .T.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKWB           m.nome_grupo WHEN                  ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   56   ╨
*       ╨ Variable:            m.nome_grupo                       ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      9                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0vpkwb     &&  m.nome_grupo WHEN
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(.f.)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKWC           LNSALDOI WHEN                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   57   ╨
*       ╨ Variable:            LNSALDOI                           ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      10                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0vpkwc     &&  LNSALDOI WHEN
#REGION 1
 ON KEY LABEL ENTER  KEYBOARD "{RIGHTARROW}"
 ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKWD           m.edit_btn WHEN                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   58   ╨
*       ╨ Variable:            m.edit_btn                         ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      11                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0vpkwd     &&  m.edit_btn WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ON KEY LABEL ENTER



*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKWE           m.imp_btn VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   59   ╨
*       ╨ Variable:            m.imp_btn                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      12                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
***************************
FUNCTION _2lx0vpkwe     &&  m.imp_btn VALID
#REGION 1
LFLdireciona  = .F. && Ativa PRTSETUP para direcionar impressao DEF(.T.)
LFLagrega 	  = .T. && Agrega o ??.REL em ??.AGR			    DEF(.F.)
LFLfimagrega  = .F. && Qdo. Estiver agregando => encerra        DEF(.F.)
**********************************************************************

LFLfimagrega  = .T.  && Qdo. Estiver agregando => encerra        DEF(.F.)

LFcontinua = .t.  			&& CAPTURA O VALOR DE LFsegue

LNpagina = 1

DO ULITENSMOV
*-----------------------------
SHOW WINDOW SES0100 TOP
SELE ITEMMOV


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0VPKWF           exit_btn VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SES0100,     Record Number:   60   ╨
*       ╨ Variable:            exit_btn                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      13                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0vpkwf     &&  exit_btn VALID
#REGION 1
CLEAR READ
CLEAR GETS
