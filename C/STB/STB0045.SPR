*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ 03/19/09             STB0045.SPR               15:03:58 ╨
*       ╨                                                         ╨
*       гддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╤
*       ╨                                                         ╨
*       ╨ Author's Name                                           ╨
*       ╨                                                         ╨
*       ╨ Copyright (c) 2009 Company Name                         ╨
*       ╨ Address                                                 ╨
*       ╨ City,     Zip                                           ╨
*       ╨                                                         ╨
*       ╨ Description:                                            ╨
*       ╨ This program was automatically generated by GENSCRN.    ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨          STB0045/MS-DOS Setup Code - SECTION 1          ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
*~ WIZARDSCREEN
*---------------------------------------------------------------------*
* ARQUIVOS UTILIZADOS :                                               *
*              - EMPRESA
*              - CADTAB
*              - GRUPO
*              - PRECO 		=> tabela de precos
*              - PROD_CMS   => tabela de comissoes
* OBJETIVOS : GERAR OU ALTERAR TABELAS DE PRECO E COMISSAO
*---------------------------------------------------------------------*
******>>>> INICIO CONTROLE AMBIENTAL
CLEAR TYPEAHEAD
PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
******************************************************************
PRIVATE wl_areant, isediting,isadding,isreading,wp_record,wp_flgfecha
PRIVATE LFjanela, wp_ref_local
PRIVATE VLleitura, VLlerfim, VLcompara, VLchvlimi
PRIVATE LFemp, LFcad, LFpre, LFgru, LFcms
PRIVATE LFpreco,LFcomissao,LFdesconto
*****************************************************************
******************************************************************

ON KEY LABEL ESCAPE
wl_areant = ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.isediting	=	.F.
m.isadding	=	.F.
m.isreading =   .F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
LNcr_ant	= 0
***********>>>>> USO LOCAL <<<<< ******************************
DIMENSION wv_empresa(1,1)    	   && CONTERA EMPRESAS REG. NO SISTEMA
		  wi_empresa  = 2          && INDICE P/ SELECAO EMPRESA
          LN_emp	  = 0          && Num Regstros
***************************************************************
STORE .F. TO LFemp, LFcad, LFpre, LFgru, LFcms,;
			 LFpreco,LFcomissao,LFdesconto

wp_ref_local =  .f.     && NAO POSSUI CONTROLE DE REFRESH LOCAL

*****************>>>> INICIO CONTROLE ARQUIVOS<<<<<<<<

*>> parametros repassados a btn_val
VLleitura = ""   && repassa chave de leitura p/ btn_val
VLlerfim  = ""   && p/ leitura do ultimo reg + 1
VLcompara = ""   && repassa chave de comparacao p/ btn_val
VLchvlimi = ""   && otimiza browse
**************************************************************

IF !USED("empresa")
	LFemp	= .T.
	IF ! NetUse("empresa")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("cadtab")
	LFcad = .T.
	IF ! NetUse("cadtab")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("preco")
	LFpre	= .T.
	IF ! NetUse("preco")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("prod_cms")
	LFcms	= .T.
	IF ! NetUse("prod_cms")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("grupo")
	LFgru  	= .T.
	IF ! NetUse("grupo")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF wp_flgfecha
	do ULfecha
	RETURN
ENDIF

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨                MS-DOS Window definitions                ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

IF NOT WEXIST("stb0045") ;
	OR UPPER(WTITLE("STB0045")) == "STB0045.PJX" ;
	OR UPPER(WTITLE("STB0045")) == "STB0045.SCX" ;
	OR UPPER(WTITLE("STB0045")) == "STB0045.MNX" ;
	OR UPPER(WTITLE("STB0045")) == "STB0045.PRG" ;
	OR UPPER(WTITLE("STB0045")) == "STB0045.FRX" ;
	OR UPPER(WTITLE("STB0045")) == "STB0045.QPR"
	DEFINE WINDOW stb0045 ;
		FROM INT((SROW()-19)/2),INT((SCOL()-70)/2) ;
		TO INT((SROW()-19)/2)+18,INT((SCOL()-70)/2)+69 ;
		TITLE "[ Gera Tabelas de Preco e Comissao ]" ;
		FOOTER "stb0045" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨          STB0045/MS-DOS Setup Code - SECTION 2          ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1

DO ULtabempresa    && TRANSF. EMPRE. P/ TABELA
*-------------------------> criado pelo wizard
m.wzalias=SELECT()
m.isreadonly=IIF(ISREAD(),.T.,.F.)
IF m.isreadonly
	WAIT WINDOW C_READONLY TIMEOUT 1
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨              STB0045/MS-DOS Screen Layout               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
IF WVISIBLE("stb0045")
	ACTIVATE WINDOW stb0045 SAME
ELSE
	ACTIVATE WINDOW stb0045 NOSHOW
ENDIF
@ 3,15 SAY "-" ;
	SIZE 1,1, 0
@ 0,0 TO 18,69 ;
	COLOR SCHEME 23
@ 18,1 TO 18,68 ;
	COLOR SCHEME 24
@ 1,69 TO 17,69 ;
	COLOR SCHEME 24
@ 18,69 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,69 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,15 TO 8,54 ;
	COLOR SCHEME 23
@ 8,16 TO 8,53 ;
	COLOR SCHEME 24
@ 8,54 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,54 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,54 TO 7,54 ;
	COLOR SCHEME 24
@ 2,7 TO 4,39 ;
	COLOR SCHEME 23
@ 4,8 TO 4,38 ;
	COLOR SCHEME 24
@ 4,39 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,39 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,39 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 15,4 TO 17,12 ;
	COLOR SCHEME 24
@ 17,5 TO 17,11 ;
	COLOR SCHEME 23
@ 16,12 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,12 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 15,12 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 15,30 TO 17,38 ;
	COLOR SCHEME 24
@ 17,31 TO 17,37 ;
	COLOR SCHEME 23
@ 16,38 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,38 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 15,38 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 15,57 TO 17,65 ;
	COLOR SCHEME 24
@ 17,58 TO 17,64 ;
	COLOR SCHEME 23
@ 16,65 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,65 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 15,65 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 3,51 SAY "-" ;
	SIZE 1,1, 0
@ 2,42 TO 4,62 ;
	COLOR SCHEME 23
@ 4,43 TO 4,61 ;
	COLOR SCHEME 24
@ 4,62 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,62 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,62 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,8 SAY "[ Tabela e Empresa Origem ]" ;
	SIZE 1,27, 0
@ 2,43 SAY "[ Tabela Destino ]" ;
	SIZE 1,18, 0
@ 5,17 SAY "[ Empresas Destino ]" ;
	SIZE 1,20, 0
@ 3,25 SAY "-" ;
	SIZE 1,1, 0
@ 0,3 SAY "[ Copiar Tabelas de Precos, Descontos e Comissoes ]" ;
	SIZE 1,51, 0
@ 3,12 GET m.tbbase ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN _2lx0waiep() ;
	VALID _2lx0waies() ;
	MESSAGE "<TAB> = Zoom  ;  <ESC> = Sai " ;
	ERROR "Codigo de Tabela Nao Confere."
@ 3,16 GET m.sbase ;
	SIZE 1,1 ;
	DEFAULT " " ;
	WHEN _2lx0waiew() ;
	VALID _2lx0waiey()
@ 3,22 GET m.empbase ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN isediting AND m.tbbase > 0 ;
	VALID _2lx0waif2() ;
	MESSAGE "<TAB> = Zoom  ;  <ESC> = Sai " ;
	ERROR "Codigo de Tabela Nao Confere."
@ 3,26 GET siglabase ;
	SIZE 1,7 ;
	DEFAULT " " ;
	WHEN .f.
@ 3,48 GET m.tbgera ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN isediting ;
	VALID _2lx0waif5() ;
	MESSAGE "<TAB> = Zoom  ;  <ESC> = Sai " ;
	ERROR "Codigo de Tabela Nao Confere."
@ 3,52 GET m.sgera ;
	SIZE 1,1 ;
	DEFAULT " " ;
	WHEN isediting ;
	VALID _2lx0waif9()
@ 6,17 GET m.empgera ;
	SIZE 2,36 ;
	DEFAULT " " ;
	WHEN _2lx0waifc() ;
	VALID _2lx0waiff()
@ 10,12 GET LFpreco ;
	PICTURE "@*C Copiar Tabela de Precos           - PRECO" ;
	SIZE 1,45 ;
	DEFAULT 0 ;
	WHEN _2lx0waifg()
@ 11,12 GET LFcomissao ;
	PICTURE "@*C Copiar Percentuais de Comissoes   - COMISSOES" ;
	SIZE 1,49 ;
	DEFAULT 0 ;
	WHEN _2lx0waifh()
@ 12,12 GET LFdesconto ;
	PICTURE "@*C Copiar Percentuais de Desconto    - DESCONTO" ;
	SIZE 1,48 ;
	DEFAULT 0 ;
	WHEN _2lx0waifi()
@ 16,5 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	WHEN _2lx0waifj() ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 16,31 GET m.imp_btn ;
	PICTURE "@*HN \<Gerar" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _2lx0waifk() ;
	DISABLE
@ 16,58 GET exit_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _2lx0waifx()
@ 0,57 SAY "[stb0045]" ;
	SIZE 1,9, 0

IF NOT WVISIBLE("stb0045")
	ACTIVATE WINDOW stb0045
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨     MS-DOSREAD contains clauses from SCREEN stb0045     ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

READ CYCLE ;
	NOLOCK

RELEASE WINDOW stb0045

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨               STB0045/MS-DOS Cleanup Code               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
DO ULfecha 		&& FECHA ARQUIVOS ABERTOS
RETURN



*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨   STB0045/MS-DOS Supporting Procedures and Functions    ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
PROCEDURE ULfecha
	IF LFemp		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	IF LFcad  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("cadtab")
	ENDIF
	IF LFpre  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("preco")
	ENDIF
	IF LFcms  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("prod_cms")
	ENDIF
	IF LFgru		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("grupo")
	ENDIF

	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(wl_areant) AND USED(wl_areant)
		SELECT &wl_areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
	************************************
	POP KEY 			&& reabilita teclas de atalho def. anteriormente
RETURN

*************
*-------------------->>>>>>>>>

PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	LN_prxobj = _CUROBJ
	ON KEY LABEL ENTER
    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.imp_btn DISABLE
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn ENABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn DISABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN

PROCEDURE ULtabempresa && TRANSF. EMPRE. P/ TABELA INTERNA
	SELECT empresa
	LN_emp = 0
	COUNT TO LN_emp
	LN_emp = LN_emp + 1
	DIMENSION wv_empresa(LN_emp,1)
	GO TOP
	wv_empresa(1) = "Recomeca Selecao."
	DO WHILE !EOF()
	   wv_empresa(wi_empresa) = STRTRAN(STR(empresa,3),' ','0')+" - "+nome
	   wi_empresa = wi_empresa + 1
	   SKIP
	ENDDO
RETURN

************
PROCEDURE ULgertabela
PARAMETERS 	LNempbase,LNtbbase,LSsbase,;
			LNtbgera,LSsgera,LSempgera,;
			LFpreco,LFcomissao,LFdesconto

	SELE grupo
	SET ORDER TO TAG codigo

   	SELE prod_cms
	SET ORDER TO TAG tabela

   	SELE preco
	SET ORDER TO TAG tabela

*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SET STEP ON
	LNocorrenc = 1
	LNposic    = 0
	LNinicio   = 1
	LNempresa  = ""
	DO WHILE AT("/",LSempgera, LNocorrenc) <> 0
		LNposic = AT("/",LSempgera, LNocorrenc)
		LSempresa 	= SUBS(LSempgera,LNinicio,3)
        LNempresa 	= INT(VAL(LSempresa))  && ASSOCIA A EMPRESA
		IF LFpreco
		   	SELE preco       && LE A TABELA BASE DO CODIGO
			SET NEAR ON
			SEEK STR(LNempbase,3)+STR(LNtbbase,3)+LSsbase
			SET NEAR OFF
			DO WHILE !EOF() AND LNempbase = preco.empresa ;
							AND LNtbbase  = preco.tabpreco;
							AND LSsbase   = preco.serie
				SCATTER MEMVAR MEMO
				WAIT WINDOW m.codigo NOWAIT
				SELE grupo
				SEEK m.codigo
				IF 	!FOUND() OR !(LSempresa $ grupo.empresas)
					SELE preco
					SKIP
					LOOP
				ENDIF
				*** GRAVAR NO NOVO E VOLTAR AO ANTIGO P/ DAR SKIP ***
				SELE preco
				SKIP
				IF !EOF()
					LNrgtbbase = RECNO()
				ELSE				
					LNrgtbbase = 0
				ENDIF
				SKIP -1

		        m.empresa 	= LNempresa	  && ASSOCIA A EMPRESA
				m.tabpreco  = LNtbgera
				m.serie     = LSsgera
				SEEK STR(m.empresa,3)+STR(m.tabpreco,3)+m.serie+m.codigo
				IF !FOUND()		
					=edithand('SAVE')
				ELSE
					=REGLOCK(.T.)
					=edithand('REGRAVA')
				ENDIF
				IF LNrgtbbase = 0
					EXIT
				ENDIF
				GO LNrgtbbase
				*****************************************************
			ENDDO
		ENDIF		

		IF LFcomissao OR LFdesconto
		   	SELE prod_cms       && LE A TABELA BASE DO CODIGO
			SET ORDER TO TAG tabela
			SET NEAR ON
			SEEK STR(LNempbase,3)+STR(LNtbbase,3)+LSsbase
			SET NEAR OFF
			DO WHILE !EOF() ;
						AND LNempbase 	= prod_cms.empresa ;
						AND LNtbbase  	= prod_cms.tabpreco;
						AND LSsbase   	= prod_cms.serie
				SCATTER MEMVAR MEMO
				WAIT WINDOW m.codigo NOWAIT
				*** GRAVAR NO NOVO E VOLTAR AO ANTIGO P/ DAR SKIP ***
				SKIP
				IF !EOF()
					LNrgtbbase = RECNO()
				ELSE				
					LNrgtbbase = 0
				ENDIF
				SKIP -1
		        m.empresa 	= LNempresa	  && ASSOCIA A EMPRESA
				m.tabpreco  = LNtbgera
				m.serie     = LSsgera
				SEEK STR(m.empresa,3)+STR(m.tabpreco,3)+;
						m.serie+m.codigo+STR(m.nivel,2)
				IF !FOUND()		
					IF !LFcomissao
						STORE 0 TO  comissao,com_supera
					ENDIF
					IF !LFdesconto
						STORE 0 TO  desc_varej,desc_frota,;
									  desc_reven,desc_ppubl
					ENDIF
					=edithand('SAVE')
				ELSE
					IF !LFcomissao
						SCATTER MEMVAR FIELDS comissao,com_supera
					ENDIF
					IF !LFdesconto
						SCATTER MEMVAR FIELDS desc_varej,desc_frota,;
											  desc_reven,desc_ppubl
					ENDIF
					=REGLOCK(.T.)
					=edithand('REGRAVA')
				ENDIF
				IF LNrgtbbase = 0
					EXIT
				ENDIF
				GO LNrgtbbase
				*****************************************************
			ENDDO
		ENDIF
		LNinicio   = LNposic + 1
		LNocorrenc = LNocorrenc + 1
	ENDDO
*-----------------------------
    SET PRINTER TO SET('PRINTER',1)
	SET RELATION TO
	SET POINT TO
	SET SEPARATOR  TO

RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIEP           m.tbbase WHEN                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   44   ╨
*       ╨ Variable:            m.tbbase                           ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      1                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waiep     &&  m.tbbase WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIES           m.tbbase VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   44   ╨
*       ╨ Variable:            m.tbbase                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      2                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waies     &&  m.tbbase VALID
#REGION 1
IF m.tbbase = 0
	m.sbase = " "
	m.empbase = 0
	RETURN .T.
ENDIF
SELECT cadtab
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.,""
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   m.tbbase = cadtab.tabela
   m.sbase  = cadtab.serie
   SHOW GET  m.tbbase
   SHOW GET  m.sbase
ENDIF
RETURN .T.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIEW           m.sbase WHEN                       ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   45   ╨
*       ╨ Variable:            m.sbase                            ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      3                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waiew     &&  m.sbase WHEN
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting AND m.tbbase > 0)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIEY           m.sbase VALID                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   45   ╨
*       ╨ Variable:            m.sbase                            ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      4                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waiey     &&  m.sbase VALID
#REGION 1
IF SEEK(STR(m.tbbase,3)+m.sbase)
   SHOW GET  m.tbbase
   SHOW GET  m.sbase
   RETURN .T.
ENDIF
_CUROBJ = 4
RETURN .T.

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIF2           m.empbase VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   46   ╨
*       ╨ Variable:            m.empbase                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      5                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waif2     &&  m.empbase VALID
#REGION 1
IF m.empbase = 0 and m.tbbase = 0
   RETURN .T.
ENDIF
SELECT empresa

IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   m.empbase 	= 	empresa.empresa
   m.siglabase 	=	empresa.sigla
   SHOW GET  m.empbase
   SHOW GET  m.siglabase
ELSE
	SET ORDER TO TAG empresa
	IF SEEK(m.empbase)
   	   m.empbase = empresa.empresa
	   m.siglabase 	=	empresa.sigla
	   SHOW GET  m.empbase
	   SHOW GET  m.siglabase
	ELSE
	   RETURN .F.
	ENDIF
ENDIF
RETURN .T.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIF5           m.tbgera VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   48   ╨
*       ╨ Variable:            m.tbgera                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      6                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

FUNCTION _2lx0waif5     &&  m.tbgera VALID
#REGION 1
SELECT cadtab
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.,""
   m.tbgera = cadtab.tabela
   m.sgera  = cadtab.serie
   SHOW GET  m.tbgera
   SHOW GET  m.sgera
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
ENDIF
RETURN .T.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIF9           m.sgera VALID                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   49   ╨
*       ╨ Variable:            m.sgera                            ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      7                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waif9     &&  m.sgera VALID
#REGION 1
IF SEEK(STR(m.tbgera,3)+m.sgera)
   SHOW GET  m.tbgera
   SHOW GET  m.sgera
   RETURN .T.
ENDIF
_CUROBJ = 1
RETURN .T.

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIFC           m.empgera WHEN                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   50   ╨
*       ╨ Variable:            m.empgera                          ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      8                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waifc     &&  m.empgera WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIFF           m.empgera VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   50   ╨
*       ╨ Variable:            m.empgera                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      9                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waiff     &&  m.empgera VALID
#REGION 1
if lastkey() = 9
	SELECT empresa
	wp_string = m.empgera
	do obj_empr.spr
	if lastkey() != 27
	   m.empgera  = wp_string
	endif
endif
show get m.empgera


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIFG           LFpreco WHEN                       ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   51   ╨
*       ╨ Variable:            LFpreco                            ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      10                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waifg     &&  LFpreco WHEN
#REGION 1
IF isediting
	ON KEY LABEL ENTER KEYBOARD "{RIGHTARROW}"
ENDIF	
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIFH           LFcomissao WHEN                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   52   ╨
*       ╨ Variable:            LFcomissao                         ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      11                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waifh     &&  LFcomissao WHEN
#REGION 1
IF isediting
	ON KEY LABEL ENTER KEYBOARD "{RIGHTARROW}"
ENDIF	
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIFI           LFdesconto WHEN                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   53   ╨
*       ╨ Variable:            LFdesconto                         ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      12                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waifi     &&  LFdesconto WHEN
#REGION 1
IF isediting
	ON KEY LABEL ENTER KEYBOARD "{RIGHTARROW}"
ENDIF	
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIFJ           m.edit_btn WHEN                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   54   ╨
*       ╨ Variable:            m.edit_btn                         ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      13                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waifj     &&  m.edit_btn WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIFK           m.imp_btn VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   55   ╨
*       ╨ Variable:            m.imp_btn                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      14                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waifk     &&  m.imp_btn VALID
#REGION 1
DO ULgertabela WITH m.empbase,m.tbbase,m.sbase,;
					m.tbgera,m.sgera,m.empgera,;
					LFpreco,LFcomissao,LFdesconto
SHOW GET m.imp_btn DISABLE
RETURN



*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0WAIFX           exit_btn VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         STB0045,     Record Number:   56   ╨
*       ╨ Variable:            exit_btn                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      15                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0waifx     &&  exit_btn VALID
#REGION 1
CLEAR READ
CLEAR GETS
