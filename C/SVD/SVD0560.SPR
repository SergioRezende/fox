*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º 22/05/2006            SVD0560.SPR              11:54:51 º
*       º                                                         º
*       ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
*       º                                                         º
*       º Author's Name                                           º
*       º                                                         º
*       º Copyright (c) 2006 Company Name                         º
*       º Address                                                 º
*       º City,     Zip                                           º
*       º                                                         º
*       º Description:                                            º
*       º This program was automatically generated by GENSCRN.    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½

PARAMETERS lnemp,lnorca

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SVD0560/MS-DOS Setup Code - SECTION 1          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
	*------------------------------------------------------------*
	* CLASSIFICACAO:  [*****]
	*------------------------------------------------------------*
	* OBJETIVO....:
	*------------------------------------------------------------*
	* COMENTARIO..:
	*
	*------------------------------------------------------------*
	* OBS........ :
	*------------------------------------------------------------*
	*  TABELAS....:
	*------------------------------------------------------------*
	*  PARAMETROS..:
	*		LNemp..........: Empresa Operadora do Sistema
	*		LNorca.........: Orcamento Para Vinculo de Dados
	*
	*------------------------------------------------------------*
	*  RETORNO.....:
	*------------------------------------------------------------*
	* EXEMPLO :
	*
	*
	*------------------------------------------------------------*
	=W_DEFPROC("rotinas.spr")
	CLEAR TYPEAHEAD
	PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
	ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()

	ON KEY LABEL ENTER
	ON KEY LABEL END  DO ULpos_ok
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"



	PRIVATE LSalias
	PRIVATE LFclienc,LForcament,LFobs_orca
	PRIVATE isediting

	*------------------------------------------------------------*
	isediting   =   .t.

	LSalias = ALIAS()
	LSalias		= ALIAS()
	LFclienc	= NetArq("clienc")
	LForcament 	= NetArq("orcament")
	LFobs_orca 	= NetArq("obs_orca")
	IF (LFclienc+LForcament+LFobs_orca) > 100000
		DO ULfecha
		RETURN(.f.)
	ENDIF
	*-----------------------------------------------------------*
	*			>>>> INICIO CONTROLE ARQUIVOS<<<<<<<<
	*-----------------------------------------------------------*
	SELE orcament
	SET ORDER TO TAG GERAL
	SEEK STR(LNemp,3)+STR(LNorca,6)
	IF !FOUND()		
		DO OBJ_MENS.SPR WITH CHR(13)+" Nao Existe Orcamento Numero "+;
				STR(LNorca,6)
		DO ULfecha
		RETURN(.f.)
	ENDIF
	IF !REGLOCK()
		DO OBJ_MENS.SPR WITH CHR(13)+" Registro "+;
		  " Referente ao Orcamento Numero "+STR(LNorca,6)+;
		  " NÆo Esta Disponivel."
			DO ULfecha
			RETURN(.f.)
	ENDIF

	IF (LEFT(orcament.situacao,1) $ "OZYo")
		DO OBJ_MENS.SPR WITH CHR(13)+" Orcamento Nao Esta  "+;
		  " Disponivel para Esta Operacao."
			DO ULfecha
			RETURN(.f.)
	ENDIF
	SELE CLIENC
	SET ORDE TO EMPORCA
	SEEK STR(LNemp,3)+STR(LNorca,6)
	IF !FOUND()		
		DO OBJ_MENS.SPR WITH CHR(13)+" Registro Com Dados do Cliente"+;
		  " Referente ao Orcamento Numero "+STR(LNorca,6)+;
		  " NÆo Foi Localizado."
		DO ULfecha
		RETURN(.f.)
	ENDIF
	SELE clienc
	m.cliente = clienc.cliente
	m.cgccliente = STR(m.cliente,14)
	SHOW GET m.cgccliente


	SELE obs_orca
	SET ORDE TO Pobs_orca
	SEEK STR(LNemp,3)+STR(LNorca,6)
    IF FOUND()
	   m.OBS  =  obs_orca.obs
       m.ac   =  obs_orca.AC
       m.PRZENTREGA  = obs_orca.PRZENTREGA
	ELSE
	   m.OBS  =  ""
       m.ac   =  ""
       m.PRZENTREGA  = ""
    ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                MS-DOS Window definitions                º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

IF NOT WEXIST("svd0560") ;
	OR UPPER(WTITLE("SVD0560")) == "SVD0560.PJX" ;
	OR UPPER(WTITLE("SVD0560")) == "SVD0560.SCX" ;
	OR UPPER(WTITLE("SVD0560")) == "SVD0560.MNX" ;
	OR UPPER(WTITLE("SVD0560")) == "SVD0560.PRG" ;
	OR UPPER(WTITLE("SVD0560")) == "SVD0560.FRX" ;
	OR UPPER(WTITLE("SVD0560")) == "SVD0560.QPR"
	DEFINE WINDOW svd0560 ;
		FROM 1, 5 ;
		TO 11,74 ;
		FLOAT ;
		NOCLOSE ;
		MINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SVD0560/MS-DOS Screen Layout               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
IF WVISIBLE("svd0560")
	ACTIVATE WINDOW svd0560 SAME
ELSE
	ACTIVATE WINDOW svd0560 NOSHOW
ENDIF
@ 0,0 TO 10,69 ;
	COLOR SCHEME 23
@ 0,69 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,69 TO 9,69 ;
	COLOR SCHEME 24
@ 10,69 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 10,1 TO 10,68 ;
	COLOR SCHEME 24
@ 1,10 SAY "CGC/CPF" ;
	SIZE 1,7, 0
@ 1,1 SAY "OSI Nro" ;
	SIZE 1,7, 0
@ 2,31 SAY "-" ;
	SIZE 1,1, 0
@ 0,59 SAY "[SVD0560]" ;
	SIZE 1,9, 0
@ 0,26 SAY "[ Obsevacoes ]" ;
	SIZE 1,14, 0
@ 8,4 SAY "A/C:" ;
	SIZE 1,4, 0
@ 8,21 SAY "Prazo Entrega" ;
	SIZE 1,13, 0
@ 2,2 GET LNorca ;
	SIZE 1,7 ;
	DEFAULT " " ;
	PICTURE "@K 999,999" ;
	WHEN .F. ;
	ERROR WP_MSG
@ 2,10 GET m.cgc ;
	SIZE 1,21 ;
	DEFAULT " " ;
	PICTURE "@R 99.999.999/9999-99" ;
	WHEN _1t40pjbei()
@ 2,32 GET clienc.nome ;
	SIZE 1,27 ;
	DEFAULT " " ;
	PICTURE "@K" ;
	WHEN .f.
@ 4,5 EDIT m.obs ;
	SIZE 4,60,0 ;
	DEFAULT " " ;
	TAB ;
	SCROLL ;
	WHEN _1t40pjbej()
@ 8,9 GET m.ac ;
	SIZE 1,10 ;
	DEFAULT " " ;
	WHEN _1t40pjbek()
@ 8,35 GET obs_orca.przentrega ;
	SIZE 1,30 ;
	DEFAULT " " ;
	WHEN _1t40pjbel()
@ 10,17 GET m.ok_btn ;
	PICTURE "@*HN \<Ok" ;
	SIZE 1,6,5 ;
	DEFAULT 1 ;
	WHEN _1t40pjbem() ;
	VALID _1t40pjben()
@ 10,40 GET Canc_btn ;
	PICTURE "@*HN \<Cancela" ;
	SIZE 1,11,5 ;
	DEFAULT 1 ;
	WHEN _1t40pjbeo() ;
	VALID _1t40pjbep()

IF NOT WVISIBLE("svd0560")
	ACTIVATE WINDOW svd0560
ENDIF

READ CYCLE MODAL

RELEASE WINDOW svd0560

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º               SVD0560/MS-DOS Cleanup Code               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
	ON KEY LABEL END
	ON KEY LABEL TAB
	ON KEY LABEL ENTER

DO ULfecha
RETURN



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º   SVD0560/MS-DOS Supporting Procedures and Functions    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
PROCEDURE ULfecha
	SELE orcament
	UNLOCK

	=UP_fecha("clienc"  	,LFclienc)
	=UP_fecha("orcament"  	,LForcament)
	=UP_fecha("obs_orca" 	,LFobs_orca)
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
	************************************
	POP KEY 			&& reabilita teclas de atalho def. anteriormente
RETURN

PROCEDURE ULpos_ok
	clear read
	clear gets
	RETUR
RETURN(.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1T40PJBEI           m.cgc WHEN                         º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SVD0560,     Record Number:   15   º
*       º Variable:            m.cgc                              º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      1                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1t40pjbei     &&  m.cgc WHEN
#REGION 1
m.cgc = STR(clienc.cliente,14)
RETURN(.F.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1T40PJBEJ           m.obs WHEN                         º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SVD0560,     Record Number:   17   º
*       º Variable:            m.obs                              º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      2                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1t40pjbej     &&  m.obs WHEN
#REGION 1
	ON KEY LABEL END KEYBOARD "{CTRL-TAB}"
	ON KEY LABEL TAB KEYBOARD "{CTRL-TAB}"
RETURN(isediting)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1T40PJBEK           m.ac WHEN                          º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SVD0560,     Record Number:   18   º
*       º Variable:            m.ac                               º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      3                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1t40pjbek     &&  m.ac WHEN
#REGION 1
	ON KEY LABEL END  DO ULpos_ok
	ON KEY LABEL TAB
	ON KEY LABEL ENTER
RETURN(isediting)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1T40PJBEL           obs_orca.przentrega WHEN           º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SVD0560,     Record Number:   19   º
*       º Variable:            obs_orca.przentrega                º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      4                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1t40pjbel     &&  obs_orca.przentrega WHEN
#REGION 1
	ON KEY LABEL END  DO ULpos_ok
	ON KEY LABEL TAB
	ON KEY LABEL ENTER
RETURN(isediting)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1T40PJBEM           m.ok_btn WHEN                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SVD0560,     Record Number:   20   º
*       º Variable:            m.ok_btn                           º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      5                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1t40pjbem     &&  m.ok_btn WHEN
#REGION 1
ON KEY LABEL ENTER


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1T40PJBEN           m.ok_btn VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SVD0560,     Record Number:   20   º
*       º Variable:            m.ok_btn                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      6                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
	*----------------------------------------------------------*
FUNCTION _1t40pjben     &&  m.ok_btn VALID
#REGION 1
  	SELE obs_orca
	SET ORDE TO pobs_orca
	SEEK STR(LNemp,3)+STR(LNorca,6)

	m.empresa   = LNemp
    m.orcamento = LNorca
	IF !FOUND()		
		=edithand('SAVE')
	ELSE
		=REGLOCK(.T.)
		=edithand('REGRAVA')
	ENDIF
	clear read
	clear gets
RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1T40PJBEO           Canc_btn WHEN                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SVD0560,     Record Number:   21   º
*       º Variable:            Canc_btn                           º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      7                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1t40pjbeo     &&  Canc_btn WHEN
#REGION 1
ON KEY LABEL ENTER


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1T40PJBEP           Canc_btn VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SVD0560,     Record Number:   21   º
*       º Variable:            Canc_btn                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      8                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1t40pjbep     &&  Canc_btn VALID
#REGION 1
clear read
clear gets
RETUR