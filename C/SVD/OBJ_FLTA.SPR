*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 03/19/09            OBJ_FLTA.SPR               15:07:23 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 2009 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ

PARAMETERS lscod,lsclass,lsdescricao,lnvend

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         OBJ_FLTA/MS-DOS Setup Code - SECTION 1          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
*---------------------------------------------------------------------*
* ARQUIVOS UTILIZADOS :                                               *
*              - STQFALTA
* OBJETIVO : INFORMAR PRODUTO CONSULTADO E COM FALTA DE ESTOQUE
*---------------------------------------------------------------------*

PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()

*****>>>>>
PRIVATE wl_areant, LFfalt,wp_flgfecha,isediting,wzalias
PRIVATE classifica, codigo, data,hora,qtde,vendedor,nome,fone,motivo

******>>>> INICIO CONTROLE AMBIENTAL

ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"

wl_areant 	= ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

LFfalt		= .F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
wp_flgfecha = .F. 		&& defaut nao fechamento da secao
isediting	= .t.
m.wzalias=SELECT()

******>>>> FIM CONTROLE AMBIENTAL

******>>>> INICIO CONTROLE ARQUIVOS
IF !USED("stqfalta")
	LFfalt	= .T.
	IF ! NetUse("stqfalta")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

IF wp_flgfecha
	POP KEY
	RETURN
ENDIF

m.motivo = 1


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

IF NOT WEXIST("obj_flta") ;
	OR UPPER(WTITLE("OBJ_FLTA")) == "OBJ_FLTA.PJX" ;
	OR UPPER(WTITLE("OBJ_FLTA")) == "OBJ_FLTA.SCX" ;
	OR UPPER(WTITLE("OBJ_FLTA")) == "OBJ_FLTA.MNX" ;
	OR UPPER(WTITLE("OBJ_FLTA")) == "OBJ_FLTA.PRG" ;
	OR UPPER(WTITLE("OBJ_FLTA")) == "OBJ_FLTA.FRX" ;
	OR UPPER(WTITLE("OBJ_FLTA")) == "OBJ_FLTA.QPR"
	DEFINE WINDOW obj_flta ;
		FROM 2, 2 ;
		TO 13,72 ;
		TITLE "[ REGISTRO DE FALTA DE ESTOQUE]" ;
		FOOTER "[OBJ_FLTA]" ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         OBJ_FLTA/MS-DOS Setup Code - SECTION 2          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              OBJ_FLTA/MS-DOS Screen Layout              є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("obj_flta")
	ACTIVATE WINDOW obj_flta SAME
ELSE
	ACTIVATE WINDOW obj_flta NOSHOW
ENDIF
@ 0,0 TO 11,70 ;
	COLOR SCHEME 23
@ 11,1 TO 11,69 ;
	COLOR SCHEME 24
@ 1,70 TO 7,70 ;
	COLOR SCHEME 24
@ 11,70 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,70 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,3 TO 6,15 ;
	COLOR SCHEME 23
@ 6,4 TO 6,14 ;
	COLOR SCHEME 24
@ 4,4 SAY "[ Qtde ]" ;
	SIZE 1,8, 0
@ 6,15 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,15 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,15 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,19 TO 6,66 ;
	COLOR SCHEME 23
@ 6,66 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,66 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,66 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,20 TO 6,65 ;
	COLOR SCHEME 24
@ 1,8 TO 3,62 ;
	COLOR SCHEME 24
@ 3,9 TO 3,62 ;
	COLOR SCHEME 23
@ 2,62 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 3,62 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 1,62 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 2,26 SAY "-" ;
	SIZE 1,1, 0
@ 11,25 SAY "<ESC> - Retorna" ;
	SIZE 1,15, 0 ;
	COLOR SCHEME 24
@ 11,51 SAY "<ENTER> - Confirma" ;
	SIZE 1,18, 0 ;
	COLOR SCHEME 24
@ 11,2 SAY "<TAB> - Ver" ;
	SIZE 1,11, 0 ;
	COLOR SCHEME 24
@ 2,9 GET LScod ;
	SIZE 1,16 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN .f.
@ 2,28 GET LSdescricao ;
	SIZE 1,34 ;
	DEFAULT " " ;
	WHEN .f.
@ 5,7 GET m.qtde ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID _2lx0wewog()
@ 5,21 GET m.nome ;
	SIZE 1,25 ;
	DEFAULT " " ;
	WHEN isediting
@ 5,49 GET m.fone ;
	SIZE 1,15 ;
	DEFAULT " " ;
	WHEN isediting
@ 7,1 GET m.motivo ;
	PICTURE "@^ \<A-Estoque Insuficiente- Cliente Fone;\<B-Estoque Insuficiente- Cliente Loja;\<C-Outras Observacoes" ;
	SIZE 3,19 ;
	DEFAULT "A-Estoque Insuficiente- Cliente Fone" ;
	WHEN isediting ;
	COLOR SCHEME 1, 2
@ 7,21 EDIT m.obs ;
	SIZE 3,49,0 ;
	DEFAULT " " ;
	TAB ;
	SCROLL ;
	WHEN _2lx0wewoh() ;
	VALID _2lx0wewoi() ;
	COLOR SCHEME 1
@ 4,21 SAY "[ Nome Cliente ]" ;
	SIZE 1,16, 0
@ 4,49 SAY "[ Fone ]" ;
	SIZE 1,8, 0
@ 0,15 SAY "[ Registra Consultas e Perda de Vendas  ]" ;
	SIZE 1,41, 0

IF NOT WVISIBLE("obj_flta")
	ACTIVATE WINDOW obj_flta
ENDIF

READ CYCLE

RELEASE WINDOW obj_flta

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              OBJ_FLTA/MS-DOS Cleanup Code               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF LFfalt		&& .t. => TERMINAL DEVE SER FECHADA NA SAIDA
	=UP_fecha("STQFALTA")
ENDIF

SELE  &wl_areant
POP KEY 			   && reabilita teclas de controle

RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є  OBJ_FLTA/MS-DOS Supporting Procedures and Functions    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
PROCEDURE ULpos_ok
 	_CUROBJ = OBJNUM(ok_btn)
RETURN(.T.)

PROCEDURE ULpos_canc
 	_CUROBJ = OBJNUM(cft_btn)
RETURN(.T.)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WEWOG           m.qtde VALID                       є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_FLTA,     Record Number:   29  є
*       є Variable:            m.qtde                             є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0wewog     &&  m.qtde VALID
#REGION 1
IF LASTKEY() = 9 				&& TAB
	ON KEY LABEL ESCAPE
	ON KEY LABEL CTRL-Y KEYBOARD "{CTRL-T}"
	SELE stqfalta
	set order to
	GO BOTT
	BROWSE  FIELDS ;
		EMPRESA		:H="Emp";
			:R,;
		CODIGO		:H="COD";
			:P=masc_codi;
			:R,;
		QTDE		:H="QTDE";
			:P="@r 9999";
			:R,;
		DATA 	:H="DATA";
			:R,;
		HORA	:H="HORA" ;
			:R,;
		VENDEDOR :H="VEND";
			:R,;
		NOME :R,;
		FONE :R;
	TITLE "LISTA" COLOR SCHEME 10  NOAPPEND  NORMAL
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
	RETURN(.F.)
ENDIF
IF LASTKEY() = 15 				&& BACKTAB
	isediting = .f.
	CLEAR TYPEAHEAD
	CLEAR TYPEAHEAD
	ON KEY
ENDIF
RETURN(.T.)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WEWOH           m.obs WHEN                         є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_FLTA,     Record Number:   33  є
*       є Variable:            m.obs                              є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0wewoh     &&  m.obs WHEN
#REGION 1
ON KEY LABEL TAB KEYBOARD "{CTRL-TAB}"
ON KEY LABEL ENTER KEYBOARD "{CTRL-TAB}"

RETURN(isediting)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WEWOI           m.obs VALID                        є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_FLTA,     Record Number:   33  є
*       є Variable:            m.obs                              є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0wewoi     &&  m.obs VALID
#REGION 1
ON KEY LABEL TAB
ON KEY LABEL ENTER
IF LASTKEY() = 148  && CTRL-TAB
	isediting = .f.
	CLEAR TYPEAHEAD
	CLEAR TYPEAHEAD
	ON KEY
	m.empresa		=   wp_empresa
	m.classifica 	= 	LSclass
	m.codigo		=	LScod
	m.data			=	wp_dtoper
	m.vendedor 		=	LNvend
	m.hora			=	time()
	m.motivo		=	1		&& falta de estoque
	SELE stqfalta
	=EDITHAND("SAVE")
	SELE  &wl_areant
ENDIF
RETURN(.T.)
