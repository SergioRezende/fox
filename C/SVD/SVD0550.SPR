*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 15/04/2010            SVD0550.SPR              15:26:56 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 2010 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

IF NOT WEXIST("svd0550") ;
	OR UPPER(WTITLE("SVD0550")) == "SVD0550.PJX" ;
	OR UPPER(WTITLE("SVD0550")) == "SVD0550.SCX" ;
	OR UPPER(WTITLE("SVD0550")) == "SVD0550.MNX" ;
	OR UPPER(WTITLE("SVD0550")) == "SVD0550.PRG" ;
	OR UPPER(WTITLE("SVD0550")) == "SVD0550.FRX" ;
	OR UPPER(WTITLE("SVD0550")) == "SVD0550.QPR"
	DEFINE WINDOW svd0550 ;
		FROM INT((SROW()-8)/2),INT((SCOL()-78)/2) ;
		TO INT((SROW()-8)/2)+7,INT((SCOL()-78)/2)+77 ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є          SVD0550/MS-DOS Setup Code - SECTION 2          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
* 					[ INICIO CONTROLE AMBIENTAL ]				*
CLEAR TYPEAHEAD
PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
ON KEY LABEL END DO ULencerra
*---------------------------------------------------------------*

PRIVATE isediting
isediting = .t.
LFcheq_A	=	.f.
LFcheq_B	=	.f.
LFcheq_C	=	.f.

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              SVD0550/MS-DOS Screen Layout               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("svd0550")
	ACTIVATE WINDOW svd0550 SAME
ELSE
	ACTIVATE WINDOW svd0550 NOSHOW
ENDIF
@ 0,0 TO 7,77 ;
	COLOR SCHEME 23
@ 7,1 TO 7,76 ;
	COLOR SCHEME 24
@ 7,77 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,77 TO 6,77 ;
	COLOR SCHEME 24
@ 0,77 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 7,66 SAY "[SVD0550]" ;
	SIZE 1,9, 0
@ 0,6 SAY "[ Rela‡Жo Para Verifica‡Жo de Efetiva‡Жo de Fat. Televendas ]" ;
	SIZE 1,61, 0
@ 3,9 SAY "Informe Data do Faturamento:" ;
	SIZE 1,28, 0
@ 5,9 SAY "Relacionar Cota‡дes apartir de " ;
	SIZE 1,31, 0
@ 5,47 SAY "Dias Anteriores" ;
	SIZE 1,15, 0
@ 3,40 GET LMT_INFERIOR ;
	SIZE 1,12 ;
	DEFAULT {  /  /  } ;
	WHEN isediting
@ 5,41 GET LNdiasAnteriores ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN isediting
@ 7,21 GET a ;
	PICTURE "@*HN \<Imprimir" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	WHEN isediting ;
	VALID _2wv0x41sg()
@ 7,40 GET m.canc_btn ;
	PICTURE "@*HN \<Sair" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	WHEN isediting ;
	VALID _2wv0x41ug()

IF NOT WVISIBLE("svd0550")
	ACTIVATE WINDOW svd0550
ENDIF

READ CYCLE ;
	ACTIVATE READACT() ;
	DEACTIVATE READDEAC()

RELEASE WINDOW svd0550

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є               SVD0550/MS-DOS Cleanup Code               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
POP KEY 			&& reabilita teclas de atalho def. anteriormente
RETURN

*******************************************************************



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є   SVD0550/MS-DOS Supporting Procedures and Functions    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
PROCEDURE ULencerra
	CLEAR GETS
	CLEAR READ
	isediting = .f.
RETURN

PROCEDURE ULimprimir
PARAMETERS LSrelatorio

	=W_DEFPROC("rotinas.spr")
	PRIVATE LFinterrompe			&& Interrupcao de processos
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO

	GO TOP
	LNregistro 	= RECNO()
    COUNT TO LNimpressao
	LNimpressos = 0
	GO LNregistro
	*------------------------------------------------------------*
	*   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
	*------------------------------------------------------------*
	LFsegue  	= .T.
	wp_arqname 	= ""
    LSrel 		= LSrelatorio
	*------------------------------------------------------------*
	LSfiltro  = ""
	LSorienta = ""
	LSorienta 	= " For LFsegue "

	DO UPimpressao
	*------------------------------------------------------------*
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
	*------------------------------------------------------------*
    SET PRINTER TO SET('PRINTER',1)
	SET RELATION TO
	SET POINT TO
	SET SEPARATOR  TO
RETURN(0)



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2WV0X41SG           a VALID                            є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SVD0550,     Record Number:   14   є
*       є Variable:            a                                  є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2wv0x41sg     &&  a VALID
#REGION 1
PRIVATE LSalias
LSalias = ALIAS()
	SET DELE ON


	dbf_LJUSUARIO 	 = wp_dirloja+'USUARIO.DBF'

	dbf_LJORCAMENTO  = wp_dirloja+'ORCAMENT.DBF'
	dbf_LJCLIENC	 = wp_dirloja+'CLIENC.DBF'

	dbf_CTORCAMENTO  = wp_dircentral+'ORCAMENT.DBF'
	dbf_CTCLIENC	 = wp_dircentral+'CLIENC.DBF'



	******************************************************************
	SAVE SCREEN TO VLwin260
	set talk on
	SET ESCAPE ON


	*-----------------------------------------------------------------*
	* PRE-FILTRAGEM
	*------------------------------------------------------------------*

	SELECT  * ;
	FROM &dbf_LJORCAMENTO OR;
	WHERE ;
	             (OR.EMPRESA = 1 or OR.EMPRESA = 5 OR OR.EMPRESA = 9 ;
	             OR OR.EMPRESA = 7) ;
			AND OR.DATA >= LMT_INFERIOR - LNdiasAnteriores  ;
			AND OR.DATA <= LMT_INFERIOR ;
	        AND LEFT(OR.TIPO,1) = "V" ;
	INTO CURSOR ORC_LOJA


	SELECT  * ;
	FROM &dbf_CTORCAMENTO OR2;
  	WHERE      (OR2.EMPRESA = 1 or OR2.EMPRESA = 5 OR OR2.EMPRESA = 9 ;
	            OR OR2.EMPRESA = 7) ;
			AND OR2.DATA >= LMT_INFERIOR - LNdiasAnteriores  ;
			AND OR2.DATA <= LMT_INFERIOR ;
	        AND left(OR2.situacao,1) = "O";
    	    AND LEFT(OR2.TIPO,1) = "V" ;
	INTO CURSOR ORC_CENT





	SELECT  OR.DATA,OR.SITUACAO,OR.ORCAMENTO,OR.OPERADOR,OR.VALOR,;
		OR.EMPRESA,OR.VEICULO,CL.NOME ;
	FROM ORC_LOJA OR,;
	     &dbf_LJCLIENC    CL, ;
    	 &dbf_LJUSUARIO   US ;	
	WHERE ;
	  		    OR.EMPRESA = CL.EMPRESA ;
    		AND OR.OPERADOR = US.USUARIO ;
	    	AND US.nivel_aces >= 32 ;
    		AND US.nivel_aces <= 35 ;
  			AND OR.orcamento = CL.ORCAMENTO ;
	INTO CURSOR TESTE_1


*	UNION ;

	SELECT  OR2.DATA,OR2.SITUACAO,OR2.ORCAMENTO,OR2.OPERADOR,;
 			OR2.VALOR,OR2.EMPRESA,OR2.VEICULO,CL2.NOME ;
	FROM ORC_CENT OR2, &dbf_CTCLIENC CL2 ;
  	WHERE      OR2.EMPRESA = CL2.EMPRESA ;
  	    	AND OR2.orcamento = CL2.ORCAMENTO ;
	INTO CURSOR TESTE_2



	SELECT * FROM TESTE_1 ;
	UNION ;
	SELECT * FROM TESTE_2 ;
	INTO CURSOR TESTE

	SELE TESTE_1
	USE
	SELE TESTE_2
	USE
	SELE ORC_LOJA
	USE
	SELE ORC_CENT
	USE
	
	

**	WHERE     (OR2.EMPRESA = 1 OR OR2.EMPRESA = 5 OR OR2.EMPRESA = 9)


	SELECT DISTINCT * FROM TESTE ;
		ORDER BY NOME,EMPRESA INTO CURSOR  RELATORIO


	LFLdireciona  = .T. && Ativa PRTSETUP para direcionar impressao DEF(.T.)
	LFLagrega 	  = .F. && Agrega o ??.REL em ??.AGR			    DEF(.F.)
	LFLfimagrega  = .F. && Qdo. Estiver agregando => encerra        DEF(.F.)



	SET ESCAPE OFF
	set talk off
	SHOW WINDOWS svd0550 TOP
	RESTORE SCREEN FROM VLwin260

	DO  ULimprimir WITH "REL0550"
	SELE RELATORIO
	USE

	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
	SHOW WINDOWS svd0550 TOP

RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2WV0X41UG           m.canc_btn VALID                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SVD0550,     Record Number:   15   є
*       є Variable:            m.canc_btn                         є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2wv0x41ug     &&  m.canc_btn VALID
#REGION 1
DO ULencerra