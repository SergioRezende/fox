*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 03/19/09            OBJ_3FAT.SPR               15:06:48 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 2009 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ

PARAMETERS prmnronf,;
	 prmnronfservico,;
	 prmnroctrlcupom,;
	 prmnronfcop,;
	 prmnronfsrvcop,;
	 prmcupom,;
	 prmtp_process

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         OBJ_3FAT/MS-DOS Setup Code - SECTION 1          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1



*********************************************		

PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
*---------------------------------------------------------------*
* OBJETIVO:		coletar os numeros atribuido no processo normal
*			para repetir o processo de forma a recuperar a base
*			de dados em caso de perda
*---------------------------------------------------------------*
************************>>>
wl_areant = ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

IF NOT WEXIST("obj_3fat") ;
	OR UPPER(WTITLE("OBJ_3FAT")) == "OBJ_3FAT.PJX" ;
	OR UPPER(WTITLE("OBJ_3FAT")) == "OBJ_3FAT.SCX" ;
	OR UPPER(WTITLE("OBJ_3FAT")) == "OBJ_3FAT.MNX" ;
	OR UPPER(WTITLE("OBJ_3FAT")) == "OBJ_3FAT.PRG" ;
	OR UPPER(WTITLE("OBJ_3FAT")) == "OBJ_3FAT.FRX" ;
	OR UPPER(WTITLE("OBJ_3FAT")) == "OBJ_3FAT.QPR"
	DEFINE WINDOW obj_3fat ;
		FROM INT((SROW()-17)/2),INT((SCOL()-70)/2) ;
		TO INT((SROW()-17)/2)+16,INT((SCOL()-70)/2)+69 ;
		TITLE "[INFORMAR NRO DE NOTA E CUPOM P/ RECUPERACAO]" ;
		FOOTER "[ OBJ_3FAT ]" ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         OBJ_3FAT/MS-DOS Setup Code - SECTION 2          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              OBJ_3FAT/MS-DOS Screen Layout              є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("obj_3fat")
	ACTIVATE WINDOW obj_3fat SAME
ELSE
	ACTIVATE WINDOW obj_3fat NOSHOW
ENDIF
@ 13,18 TO 15,27 ;
	COLOR SCHEME 24
@ 15,19 TO 15,26 ;
	COLOR SCHEME 23
@ 14,27 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 15,27 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 13,27 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 0,0 TO 16,69 ;
	COLOR SCHEME 23
@ 16,1 TO 16,68 ;
	COLOR SCHEME 24
@ 16,69 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,69 TO 15,69 ;
	COLOR SCHEME 24
@ 0,69 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,64 SAY "]" ;
	SIZE 1,1, 0
@ 3,64 SAY "]" ;
	SIZE 1,1, 0
@ 5,64 SAY "]" ;
	SIZE 1,1, 0
@ 13,39 TO 15,48 ;
	COLOR SCHEME 24
@ 15,40 TO 15,47 ;
	COLOR SCHEME 23
@ 14,48 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 15,48 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 13,48 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 1,7 SAY "[ Nro do Cupom dado Pela ECF.................:" ;
	SIZE 1,46, 0
@ 3,7 SAY "[ Nro de Registro no Sistema do Cupom Acima..:" ;
	SIZE 1,46, 0
@ 5,7 SAY "[ Nro da Nota Fiscal a ser Recuperada........:" ;
	SIZE 1,46, 0
@ 0,20 SAY "[                            ]" ;
	SIZE 1,30, 0
@ 9,64 SAY "]" ;
	SIZE 1,1, 0
@ 11,64 SAY "]" ;
	SIZE 1,1, 0
@ 11,7 SAY "[ Nro da NF.Copia do Cupom em NF.Servico.....:" ;
	SIZE 1,46, 0
@ 9,7 SAY "[ Nro da NF.de Servico.......................:" ;
	SIZE 1,46, 0
@ 7,64 SAY "]" ;
	SIZE 1,1, 0
@ 7,7 SAY "[ Nro da Copia de Cupom em Nota Fiscal.......:" ;
	SIZE 1,46, 0
@ 0,21 SAY PrmTp_Process ;
	SIZE 1,28
@ 1,56 GET PrmCupom ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999999" ;
	WHEN _2lx0we5n4()
@ 3,55 GET PrmNroCtrlCupom ;
	SIZE 1,7 ;
	DEFAULT 0 ;
	PICTURE "9999999" ;
	WHEN _2lx0we5n8()
@ 5,55 GET PrmNroNF ;
	SIZE 1,7 ;
	DEFAULT 0 ;
	PICTURE "9999999" ;
	WHEN _2lx0we5nb()
@ 7,55 GET PrmNroNFCop ;
	SIZE 1,7 ;
	DEFAULT 0 ;
	PICTURE "9999999" ;
	WHEN _2lx0we5ne()
@ 9,55 GET PrmNroNfServico ;
	SIZE 1,7 ;
	DEFAULT 0 ;
	PICTURE "9999999" ;
	WHEN _2lx0we5nh()
@ 11,55 GET PrmNroNfSrvCop ;
	SIZE 1,7 ;
	DEFAULT 0 ;
	PICTURE "9999999" ;
	WHEN _2lx0we5nk()
@ 14,21 GET m.ok_btn ;
	PICTURE "@*HN \<Ok" ;
	SIZE 1,4,1 ;
	DEFAULT 1 ;
	WHEN _2lx0we5nn() ;
	VALID _2lx0we5nq()
@ 14,41 GET m.Canc_btn ;
	PICTURE "@*HN \<Canc" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	WHEN _2lx0we5ns() ;
	VALID _2lx0we5pe()

IF NOT WVISIBLE("obj_3fat")
	ACTIVATE WINDOW obj_3fat
ENDIF

READ CYCLE ;
	DEACTIVATE .t.

RELEASE WINDOW obj_3fat

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              OBJ_3FAT/MS-DOS Cleanup Code               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
POP KEY
******
IF !EMPTY(wl_areant)
	SELECT &wl_areant
ENDIF
ON KEY LABEL ESCAPE
RETURN

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WE5N4           PrmCupom WHEN                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_3FAT,     Record Number:   31  є
*       є Variable:            PrmCupom                           є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0we5n4     &&  PrmCupom WHEN
#REGION 1
ON KEY LABEL ESCAPE	
ON KEY LABEL ENTER
IF LASTKEY() = 15
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN("CUPOM" $ PrmTp_Process)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WE5N8           PrmNroCtrlCupom WHEN               є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_3FAT,     Record Number:   32  є
*       є Variable:            PrmNroCtrlCupom                    є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0we5n8     &&  PrmNroCtrlCupom WHEN
#REGION 1
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN("CUPOM" $ PrmTp_Process)



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WE5NB           PrmNroNF WHEN                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_3FAT,     Record Number:   33  є
*       є Variable:            PrmNroNF                           є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0we5nb     &&  PrmNroNF WHEN
#REGION 1
	ON KEY LABEL ENTER
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN("NOTA" $ PrmTp_Process AND !("COPIA" $ PrmTp_Process))


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WE5NE           PrmNroNFCop WHEN                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_3FAT,     Record Number:   34  є
*       є Variable:            PrmNroNFCop                        є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      4                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0we5ne     &&  PrmNroNFCop WHEN
#REGION 1
	ON KEY LABEL ENTER
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN("NOTA" $ PrmTp_Process AND ("COPIA" $ PrmTp_Process))


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WE5NH           PrmNroNfServico WHEN               є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_3FAT,     Record Number:   35  є
*       є Variable:            PrmNroNfServico                    є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      5                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0we5nh     &&  PrmNroNfServico WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN("NF SERVICO" $ PrmTp_Process AND !("COPIA" $ PrmTp_Process))


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WE5NK           PrmNroNfSrvCop WHEN                є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_3FAT,     Record Number:   36  є
*       є Variable:            PrmNroNfSrvCop                     є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      6                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0we5nk     &&  PrmNroNfSrvCop WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN("NF SERVICO" $ PrmTp_Process AND ("COPIA" $ PrmTp_Process))


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WE5NN           m.ok_btn WHEN                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_3FAT,     Record Number:   37  є
*       є Variable:            m.ok_btn                           є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      7                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0we5nn     &&  m.ok_btn WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(.T.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WE5NQ           m.ok_btn VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_3FAT,     Record Number:   37  є
*       є Variable:            m.ok_btn                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      8                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0we5nq     &&  m.ok_btn VALID
#REGION 1
	CLEAR GETS
	CLEAR READ
	isediting = .f.
RETURN .T.

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WE5NS           m.Canc_btn WHEN                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_3FAT,     Record Number:   38  є
*       є Variable:            m.Canc_btn                         є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      9                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0we5ns     &&  m.Canc_btn WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(.T.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0WE5PE           m.Canc_btn VALID                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_3FAT,     Record Number:   38  є
*       є Variable:            m.Canc_btn                         є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      10                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0we5pe     &&  m.Canc_btn VALID
#REGION 1
STORE 0	TO	PRcupom,PRregistro,PRnota,PRindica
CLEAR GETS
CLEAR READ
isediting = .f.
RETURN .T.