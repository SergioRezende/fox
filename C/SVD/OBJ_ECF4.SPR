*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 07/17/15            OBJ_ECF4.SPR               17:36:36 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 2015 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ

PARAMETERS lschamada

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         OBJ_ECF4/MS-DOS Setup Code - SECTION 1          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1

	PRIVATE LNecf
	PRIVATE LSstatus
	LSstatus = ""



	LNecf = 0	&& CONTROLADOR REFERENTE A ECF
	=W_DEFPROC("ECF.SPR")
	LSstatus = ECFconecta(wp_TIPOECF)
	IF SUBS(LSstatus,7,1) = "E"    && HOUVE ERRO
		return
	ENDIF

	=W_DEFPROC("ECF.SPR")
	=ECFprgpgt()

	=W_DEFPROC("DOCFISCA.SPR")
	=DFLimpaReg()


	=W_DEFPROC("DOCFISIT.SPR")
	=DILimpaReg()


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

IF NOT WEXIST("obj_ecf") ;
	OR UPPER(WTITLE("OBJ_ECF")) == "OBJ_ECF.PJX" ;
	OR UPPER(WTITLE("OBJ_ECF")) == "OBJ_ECF.SCX" ;
	OR UPPER(WTITLE("OBJ_ECF")) == "OBJ_ECF.MNX" ;
	OR UPPER(WTITLE("OBJ_ECF")) == "OBJ_ECF.PRG" ;
	OR UPPER(WTITLE("OBJ_ECF")) == "OBJ_ECF.FRX" ;
	OR UPPER(WTITLE("OBJ_ECF")) == "OBJ_ECF.QPR"
	DEFINE WINDOW obj_ecf ;
		FROM 1, 2 ;
		TO 23,77 ;
		TITLE "[ Informacoes Finais Para Faturamento ]" ;
		FOOTER "[OBJ_FATU]" ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         OBJ_ECF4/MS-DOS Setup Code - SECTION 2          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
	*---------------------------------------------------------------------*
	* ARQUIVOS UTILIZADOS :                                               *
	* OBJETIVO : GERENCIAR CUPOM FISCAL - ECF
	*---------------------------------------------------------------------*

	PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
	ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
	
	******>>>> INICIO CONTROLE AMBIENTAL

	ON KEY LABEL ESCAPE  WAIT WINDOW "Para sair selecione <Ok>."

	wl_areant = ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

	isediting	= .t.

	
	SELE ORCAMENT	
	
	SCATTER MEMVAR MEMO BLANK


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              OBJ_ECF4/MS-DOS Screen Layout              є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("obj_ecf")
	ACTIVATE WINDOW obj_ecf SAME
ELSE
	ACTIVATE WINDOW obj_ecf NOSHOW
ENDIF
@ 19,64 TO 21,74 ;
	COLOR SCHEME 24
@ 21,65 TO 21,73 ;
	COLOR SCHEME 23
@ 20,74 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 21,74 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 19,74 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 0,0 TO 22,75 ;
	COLOR SCHEME 23
@ 22,1 TO 22,74 ;
	COLOR SCHEME 24
@ 1,75 TO 20,75 ;
	COLOR SCHEME 24
@ 22,75 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,75 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 19,53 TO 21,63 ;
	COLOR SCHEME 24
@ 21,54 TO 21,62 ;
	COLOR SCHEME 23
@ 20,63 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 21,63 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 19,63 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 0,69 SAY "[ECF]" ;
	SIZE 1,5, 0
@ 14,2 SAY "-----------------------------------------------------------------------" ;
	SIZE 1,71, 0
@ 2,4 GET m.fatvend_swe ;
	PICTURE "@*HN \<2-Faturar" ;
	SIZE 1,11,1 ;
	DEFAULT 1 ;
	WHEN _4ef11qt70() ;
	VALID _4ef11qt8r()
@ 4,4 GET m.canc_swe ;
	PICTURE "@*HN \<3-Cancelar Documento Fiscal" ;
	SIZE 1,29,1 ;
	DEFAULT 1 ;
	WHEN _4ef11qt8z() ;
	VALID _4ef11qt95()
@ 6,4 GET m.visual_swe ;
	PICTURE "@*HN \<5-Visualizar Docs. Faturados" ;
	SIZE 1,30,1 ;
	DEFAULT 1 ;
	WHEN _4ef11qt96() ;
	VALID _4ef11qt97()
@ 16,4 GET m.ReenvNFe ;
	PICTURE "@*HN \<8-NFe Reenvia->NF->DOC->XML->NFe" ;
	SIZE 1,34,1 ;
	DEFAULT 1 ;
	WHEN _4ef11qt98() ;
	VALID _4ef11qt99()
@ 17,4 GET m.ReenvDFis ;
	PICTURE "@*HN \<9-DFis-Reenvia->NF/NFe/NFS/ECF ==> DFis" ;
	SIZE 1,41,1 ;
	DEFAULT 1 ;
	WHEN _4ef11qt9a() ;
	VALID _4ef11qta9()
@ 20,56 GET m.OK_btn ;
	PICTURE "@*HN \<Ok" ;
	SIZE 1,4,1 ;
	DEFAULT 1 ;
	WHEN _4ef11qtag() ;
	VALID _4ef11qtam() ;
	MESSAGE 'Abre Sistema Vendas'
@ 20,66 GET m.cft_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	WHEN _4ef11qtan() ;
	VALID _4ef11qtao() ;
	MESSAGE 'Abre Sistema Vendas'
@ 0,20 SAY "[ FATURAMENTO - OUTRAS OPERACOES ]" ;
	SIZE 1,34, 0

IF NOT WVISIBLE("obj_ecf")
	ACTIVATE WINDOW obj_ecf
ENDIF

READ CYCLE

RELEASE WINDOW obj_ecf

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              OBJ_ECF4/MS-DOS Cleanup Code               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
	SET DEVICE TO SCREEN

	=W_DEFPROC("ECF.SPR")
	=ECFClose()

	IF !EMPTY(wl_areant)
		SELECT &wl_areant
	ENDIF
	POP KEY 			   && reabilita teclas de controle

RETURN

*--------------  ROTINAS DE APOIO  - ECF ---------------*



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є  OBJ_ECF4/MS-DOS Supporting Procedures and Functions    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
PROCEDURE ULpos_ok
 	_CUROBJ = OBJNUM(ok_btn)
RETURN(.T.)

PROCEDURE ULpos_canc
 	_CUROBJ = OBJNUM(cft_btn)
RETURN(.T.)



****************************************************************************
* FUCTION ECFimpdpl : PROCESSA DADOS REFERENTES AS DUPLICATAS RETORNANDO
*			UMA STRING COM NUMERO E VENCIMENTO DAS DUPLICATAS
****************************************************************************

FUNCTION ECFShowStatus				&& VERIFICA STA

	=W_DEFPROC("ECF.SPR")
	=ECFstatus()			&& PROVOCA ATUALIZAЂЗO DOS STATUS

	*---------------------------------------------------------*
	=W_DEFPROC("ECF.SPR")
	LSseq 		= ECFGetPropVT("LSSEQ")
	=W_DEFPROC("ECF.SPR")
	LSstat 		= ECFGetPropVT("LSstat")
	=W_DEFPROC("ECF.SPR")
	LStransacao = ECFGetPropVT("LStransacao")
	=W_DEFPROC("ECF.SPR")
	LSescape 	= ECFGetPropVT("LSescape")
	=W_DEFPROC("ECF.SPR")
	LSreducao 	= ECFGetPropVT("LSreducao")
	=W_DEFPROC("ECF.SPR")
	LSliq	 	= ECFGetPropVT("LSliq")
	=W_DEFPROC("ECF.SPR")
	LSbruto 	= ECFGetPropVT("LSbruto")
	=W_DEFPROC("ECF.SPR")
	LSmenserro 	= ECFGetPropVT("LSmenserro")
	=W_DEFPROC("ECF.SPR")
	LSfazx	 	= ECFGetPropVT("LSfazx")
	=W_DEFPROC("ECF.SPR")
	LSpapel	 	= ECFGetPropVT("LSpapel")
	*---------------------------------------------------------*

	SHOW GET LSseq	
	SHOW GET LSstat
	SHOW GET LStransacao
	SHOW GET LSescape
	SHOW GET LSreducao
	SHOW GET LSliq
	SHOW GET LSbruto
	SHOW GET LSerro
	SHOW GET LSmenserro
	SHOW GET LSfazx
	SHOW GET LSpapel
RETURN





*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QT70           m.fatvend_swe WHEN                 є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   19  є
*       є Variable:            m.fatvend_swe                      є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qt70     &&  m.fatvend_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QT8R           m.fatvend_swe VALID                є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   19  є
*       є Variable:            m.fatvend_swe                      є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qt8r     &&  m.fatvend_swe VALID
#REGION 1
	UNLOCK ALL

	=W_DEFPROC("ORCAMENT.SPR")


    PRIVATE LSEmite_blto

	IF ORSleOrFinFat("OUTRAS")

		=W_DEFPROC("CLIENC.SPR")
        LSEmite_blto =  CNGetFieldValue(orcament.empresa,;
                            orcament.orcamento,;
                            "EMITE_BLTO")

       IF TYPE("LSEmite_blto") <> "N"  OR LSEmite_blto <> 2
			=W_DEFPROC("NOTA.SPR")
			=NFrot_fat(LSchamada,"EFETIVAR FATURAMENTO","EMITIR BOLETO")
	   ELSE
			*-----------------------------------*
            **  LSEmite_blto = 2 => nao emitir boleto
			*-----------------------------------*
			=W_DEFPROC("NOTA.SPR")
			=NFrot_fat(LSchamada,"EFETIVAR FATURAMENTO","SEM BOLETO")
       ENDIF


	ENDIF

	UNLOCK ALL

    CLEAR TYPEAHEAD
    CLEAR TYPEAHEAD

	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP

	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP

RETURN


*
*
*
*		=W_DEFPROC("NOTA.SPR")
*		wp_flgfecha = !NFrot_fat("IMPORTACAO","EFETIVAR FATURAMENTO")
*

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QT8Z           m.canc_swe WHEN                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   20  є
*       є Variable:            m.canc_swe                         є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qt8z     &&  m.canc_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QT95           m.canc_swe VALID                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   20  є
*       є Variable:            m.canc_swe                         є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      4                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qt95     &&  m.canc_swe VALID
#REGION 1
	UNLOCK ALL


  =ECF_REENVIA()    && DESVIA CHAMADO PARA
                    && \<8-NFe Reenvia->NF->DOC->XML->NFe


	UNLOCK ALL

RETURN



PROCEDURE OLD_PROCESSO

	=W_DEFPROC("NOTA.SPR")
	=NFpede_cancelamento("OUTRAS")


	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP

	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP

RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QT96           m.visual_swe WHEN                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   21  є
*       є Variable:            m.visual_swe                       є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      5                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qt96     &&  m.visual_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QT97           m.visual_swe VALID                 є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   21  є
*       є Variable:            m.visual_swe                       є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      6                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qt97     &&  m.visual_swe VALID
#REGION 1
	UNLOCK ALL

	=W_DEFPROC("NOTA.SPR")
	=NFView(" AND CH_OPERA <> '1' ")

	UNLOCK ALL


RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QT98           m.ReenvNFe WHEN                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   22  є
*       є Variable:            m.ReenvNFe                         є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      7                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qt98     &&  m.ReenvNFe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QT99           m.ReenvNFe VALID                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   22  є
*       є Variable:            m.ReenvNFe                         є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      8                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qt99     &&  m.ReenvNFe VALID
#REGION 1
	UNLOCK ALL


  =ECF_REENVIA()


	UNLOCK ALL


RETURN


FUNCTION ECF_REENVIA






	*-----------------------------------------------------------*
	PRIVATE LSemi_CFe
	PRIVATE LSscr_CFe

	*------------------------------------------------------------*


	=W_DEFPROC("EMPRESA.SPR")
	LSemi_CFE = EMGetFieldValue(wp_empresa,"EMITE_CFE")

	*------------------------------------------------------------*



	=W_DEFPROC("EMPRESA.SPR")
	LSscr_cfe = EMGetFieldValue(wp_empresa,"ESCRT_CFE")


	*------------------------------------------------------------*

	DO CASE

        CASE nota.nfe_status = "CANCELADA"
             =W_DEFPROC("nota.spr")
		     =NFCTRLcancFatura((nota.empresa),(nota.nota),"NORMAL")

		CASE LSemi_cfe = "S" OR LSscr_cfe = "S"
	
			=W_DEFPROC("NOTA.SPR")
			=NFReenvNFe("")

		OTHERWISE
		
			=W_DEFPROC("NOTA.SPR")
			=NFReenvNFe(" and (nota < 1000000 or nota > 3000000)")

	ENDCASE


	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP

RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QT9A           m.ReenvDFis WHEN                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   23  є
*       є Variable:            m.ReenvDFis                        є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      9                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qt9a     &&  m.ReenvDFis WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QTA9           m.ReenvDFis VALID                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   23  є
*       є Variable:            m.ReenvDFis                        є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      10                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qta9     &&  m.ReenvDFis VALID
#REGION 1
	UNLOCK ALL


	=W_DEFPROC("NOTA.SPR")
	=NFReenvNFe()


	UNLOCK ALL


	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP
RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QTAG           m.OK_btn WHEN                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   24  є
*       є Variable:            m.OK_btn                           є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      11                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qtag     &&  m.OK_btn WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QTAM           m.OK_btn VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   24  є
*       є Variable:            m.OK_btn                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      12                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qtam     &&  m.OK_btn VALID
#REGION 1
CLEAR GETS
CLEAR READ
isediting = .f.
RETURN .T.

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QTAN           m.cft_btn WHEN                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   25  є
*       є Variable:            m.cft_btn                          є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      13                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qtan     &&  m.cft_btn WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4EF11QTAO           m.cft_btn VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF4,     Record Number:   25  є
*       є Variable:            m.cft_btn                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      14                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4ef11qtao     &&  m.cft_btn VALID
#REGION 1
  CLEAR GETS
  CLEAR READ
  isediting = .f.
  CLEAR TYPEAHEAD
  CLEAR TYPEAHEAD
  ON KEY
  KEYBOARD CHR(27)
  LFretorno = .f.  && CASO SEJA CANCELADO VOLTA .F.
RETURN .T.