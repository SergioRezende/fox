*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 04/10/15            OBJ_ECF2.SPR               15:56:46 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 2015 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ

PARAMETERS lschamada

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         OBJ_ECF2/MS-DOS Setup Code - SECTION 1          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1

	PRIVATE LNecf
	PRIVATE LSstatus
	LSstatus = ""



	LNecf = 0	&& CONTROLADOR REFERENTE A ECF
	=W_DEFPROC("ECF.SPR")
	LSstatus = ECFconecta(wp_TIPOECF)
	IF SUBS(LSstatus,7,1) = "E"    && HOUVE ERRO
		return
	ENDIF

	=W_DEFPROC("ECF.SPR")
	=ECFprgpgt()

	=W_DEFPROC("DOCFISCA.SPR")
	=DFLimpaReg()


	=W_DEFPROC("DOCFISIT.SPR")
	=DILimpaReg()


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

IF NOT WEXIST("obj_ecf") ;
	OR UPPER(WTITLE("OBJ_ECF")) == "OBJ_ECF.PJX" ;
	OR UPPER(WTITLE("OBJ_ECF")) == "OBJ_ECF.SCX" ;
	OR UPPER(WTITLE("OBJ_ECF")) == "OBJ_ECF.MNX" ;
	OR UPPER(WTITLE("OBJ_ECF")) == "OBJ_ECF.PRG" ;
	OR UPPER(WTITLE("OBJ_ECF")) == "OBJ_ECF.FRX" ;
	OR UPPER(WTITLE("OBJ_ECF")) == "OBJ_ECF.QPR"
	DEFINE WINDOW obj_ecf ;
		FROM 1, 2 ;
		TO 23,77 ;
		TITLE "[ Informacoes Finais Para Faturamento ]" ;
		FOOTER "[OBJ_FATU]" ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         OBJ_ECF2/MS-DOS Setup Code - SECTION 2          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
	*---------------------------------------------------------------------*
	* ARQUIVOS UTILIZADOS :                                               *
	* OBJETIVO : GERENCIAR CUPOM FISCAL - ECF
	*---------------------------------------------------------------------*

	PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
	ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
	
	******>>>> INICIO CONTROLE AMBIENTAL

	ON KEY LABEL ESCAPE  WAIT WINDOW "Para sair selecione <Ok>."

	wl_areant = ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

	isediting	= .t.

	
	SELE ORCAMENT	
	
	SCATTER MEMVAR MEMO BLANK


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              OBJ_ECF2/MS-DOS Screen Layout              є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("obj_ecf")
	ACTIVATE WINDOW obj_ecf SAME
ELSE
	ACTIVATE WINDOW obj_ecf NOSHOW
ENDIF
@ 19,64 TO 21,74 ;
	COLOR SCHEME 24
@ 21,65 TO 21,73 ;
	COLOR SCHEME 23
@ 20,74 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 21,74 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 19,74 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 0,0 TO 22,75 ;
	COLOR SCHEME 23
@ 22,1 TO 22,74 ;
	COLOR SCHEME 24
@ 1,75 TO 20,75 ;
	COLOR SCHEME 24
@ 22,75 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,75 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 19,53 TO 21,63 ;
	COLOR SCHEME 24
@ 21,54 TO 21,62 ;
	COLOR SCHEME 23
@ 20,63 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 21,63 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 19,63 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 0,21 SAY "[ ECF - Emissao de Cupom Fiscal ]" ;
	SIZE 1,33, 0
@ 0,69 SAY "[ECF]" ;
	SIZE 1,5, 0
@ 16,1 SAY "Seq.Comando" ;
	SIZE 1,11, 0
@ 20,1 SAY "Liquido:" ;
	SIZE 1,8, 0
@ 20,26 SAY "Bruto:" ;
	SIZE 1,6, 0
@ 14,67 SAY "Erro:" ;
	SIZE 1,5, 0
@ 14,26 SAY "Menssagem:" ;
	SIZE 1,10, 0
@ 18,26 SAY "Leitura X:" ;
	SIZE 1,10, 0
@ 16,26 SAY "Stat:" ;
	SIZE 1,5, 0
@ 14,1 SAY "Papel :" ;
	SIZE 1,7, 0
@ 16,44 SAY "Ultimo Comando:" ;
	SIZE 1,15, 0
@ 16,14 SAY "Transa‡ao:" ;
	SIZE 1,10, 0
@ 18,1 SAY "Redu‡ao Z:" ;
	SIZE 1,10, 0
@ 1,1 GET m.LX_swe ;
	PICTURE "@*HN \<1-Leitura X" ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f2s() ;
	VALID _4bp0y6f2t() ;
	MESSAGE 'Abre Sistema Vendas'
@ 1,43 GET m.ADM ;
	PICTURE "@*HN \<A-ADM Cartao" ;
	SIZE 1,14,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f2u() ;
	VALID _4bp0y6f2v()
@ 2,4 GET m.fatvend_swe ;
	PICTURE "@*HN \<2-Fatura" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f2w() ;
	VALID _4bp0y6f3s()
@ 2,43 GET m.CNC_CARTAO ;
	PICTURE "@*HN \<C-CNC Cartao" ;
	SIZE 1,14,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f3z() ;
	VALID _4bp0y6f44()
@ 3,4 GET m.canc_swe ;
	PICTURE "@*HN \<3-Cancelar Cupom Anterior" ;
	SIZE 1,27,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f4a() ;
	VALID _4bp0y6f4b()
@ 3,43 GET m.nro_swe ;
	PICTURE "@*HN \<N-Numero do Cupom" ;
	SIZE 1,19,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f4c() ;
	VALID _4bp0y6f4d()
@ 4,4 GET m.eminfcp_swe ;
	PICTURE "@*HN \<4-Copia Cupom em NF" ;
	SIZE 1,22,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f4e() ;
	VALID _4bp0y6f4f()
@ 4,43 GET m.ST_swe ;
	PICTURE "@*HN \<T-Status" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f5b() ;
	VALID _4bp0y6f5h() ;
	MESSAGE 'Abre Sistema Vendas'
@ 5,4 GET m.visual_swe ;
	PICTURE "@*HN \<5-Visualizar Docs. Faturados" ;
	SIZE 1,30,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f5n() ;
	VALID _4bp0y6f5u()
@ 5,43 GET m.forma_swe ;
	PICTURE "@*HN \<P-Programa Forma Pgto" ;
	SIZE 1,23,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f5v() ;
	VALID _4bp0y6f5w() ;
	MESSAGE 'Abre Sistema Vendas'
@ 6,4 GET m.fchabrt_swe ;
	PICTURE "@*HN \<6-Fechar Cupom em Aberto" ;
	SIZE 1,26,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f5x() ;
	VALID _4bp0y6f5y()
@ 6,43 GET m.reset_swe ;
	PICTURE "@*HN RESET - Qdo.Impressora em ERRO" ;
	SIZE 1,32,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f6s() ;
	VALID _4bp0y6f6z() ;
	MESSAGE 'Abre Sistema Vendas'
@ 7,4 GET m.Emit_Bol ;
	PICTURE "@*HN \<7-Emite Boleto" ;
	SIZE 1,16,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f74() ;
	VALID _4bp0y6f7a()
@ 7,43 GET m.mapaI_swe ;
	PICTURE "@*HN \<M-Mapa Resumo ECF" ;
	SIZE 1,19,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f7g() ;
	VALID _4bp0y6f7h() ;
	MESSAGE 'Abre Sistema Vendas'
@ 8,4 GET m.ReenvNFe ;
	PICTURE "@*HN \<8-NFe Reenvia->NF->DOC->XML->NFe" ;
	SIZE 1,34,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f7i() ;
	VALID _4bp0y6f7j()
@ 8,43 GET m.lermemo ;
	PICTURE "@*HN \<L-Leitura Memoria Fiscal" ;
	SIZE 1,26,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f7k() ;
	VALID _4bp0y6f7l()
@ 9,43 GET m.recupfat_swe ;
	PICTURE "@*HN \<R-Recuperacao" ;
	SIZE 1,15,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f8g() ;
	VALID _4bp0y6f8m()
@ 10,4 GET m.RtrnNFe ;
	PICTURE "@*HN \<V-NFe Retorno" ;
	SIZE 1,15,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f8s() ;
	VALID _4bp0y6f8z()
@ 11,1 GET m.redZ_swe ;
	PICTURE "@*HN \<9-Reducao-Z" ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f90() ;
	VALID _4bp0y6f91()
@ 11,32 GET m.ReenvDFis ;
	PICTURE "@*HN \<0-DFis-Reenvia->NF/NFe/NFS/ECF ==> DFis" ;
	SIZE 1,41,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f92() ;
	VALID _4bp0y6f93()
@ 15,2 GET LSpapel ;
	SIZE 1,20 ;
	DEFAULT " " ;
	WHEN .f.
@ 15,27 GET LSmenserro ;
	SIZE 1,39 ;
	DEFAULT " " ;
	WHEN .f.
@ 15,68 GET LSerro ;
	SIZE 1,1 ;
	DEFAULT " " ;
	WHEN .f.
@ 17,2 GET LSseq ;
	SIZE 1,4 ;
	DEFAULT " " ;
	WHEN .f.
@ 17,15 GET LStransacao ;
	SIZE 1,8 ;
	DEFAULT " " ;
	WHEN .f.
@ 17,27 GET LSstat ;
	SIZE 1,15 ;
	DEFAULT " " ;
	WHEN .f.
@ 17,50 GET LSescape ;
	SIZE 1,2 ;
	DEFAULT " " ;
	WHEN .f.
@ 19,2 GET LSreducao ;
	SIZE 1,20 ;
	DEFAULT " " ;
	WHEN .f.
@ 19,27 GET LSfazx ;
	SIZE 1,17 ;
	DEFAULT " " ;
	WHEN .f.
@ 20,56 GET m.OK_btn ;
	PICTURE "@*HN \<Ok" ;
	SIZE 1,4,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6f9t() ;
	VALID _4bp0y6fa0() ;
	MESSAGE 'Abre Sistema Vendas'
@ 20,66 GET m.cft_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	WHEN _4bp0y6fa6() ;
	VALID _4bp0y6fac() ;
	MESSAGE 'Abre Sistema Vendas'
@ 21,2 GET LSliquido ;
	SIZE 1,12 ;
	DEFAULT " " ;
	WHEN .f.
@ 21,27 GET LSbruto ;
	SIZE 1,12 ;
	DEFAULT " " ;
	WHEN .f.

IF NOT WVISIBLE("obj_ecf")
	ACTIVATE WINDOW obj_ecf
ENDIF

READ CYCLE

RELEASE WINDOW obj_ecf

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              OBJ_ECF2/MS-DOS Cleanup Code               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
	SET DEVICE TO SCREEN

	=W_DEFPROC("ECF.SPR")
	=ECFClose()

	IF !EMPTY(wl_areant)
		SELECT &wl_areant
	ENDIF
	POP KEY 			   && reabilita teclas de controle

RETURN

*--------------  ROTINAS DE APOIO  - ECF ---------------*



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є  OBJ_ECF2/MS-DOS Supporting Procedures and Functions    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
PROCEDURE ULpos_ok
 	_CUROBJ = OBJNUM(ok_btn)
RETURN(.T.)

PROCEDURE ULpos_canc
 	_CUROBJ = OBJNUM(cft_btn)
RETURN(.T.)



****************************************************************************
* FUCTION ECFimpdpl : PROCESSA DADOS REFERENTES AS DUPLICATAS RETORNANDO
*			UMA STRING COM NUMERO E VENCIMENTO DAS DUPLICATAS
****************************************************************************

FUNCTION ECFShowStatus				&& VERIFICA STA

	=W_DEFPROC("ECF.SPR")
	=ECFstatus()			&& PROVOCA ATUALIZAЂЗO DOS STATUS

	*---------------------------------------------------------*
	=W_DEFPROC("ECF.SPR")
	LSseq 		= ECFGetPropVT("LSSEQ")
	=W_DEFPROC("ECF.SPR")
	LSstat 		= ECFGetPropVT("LSstat")
	=W_DEFPROC("ECF.SPR")
	LStransacao = ECFGetPropVT("LStransacao")
	=W_DEFPROC("ECF.SPR")
	LSescape 	= ECFGetPropVT("LSescape")
	=W_DEFPROC("ECF.SPR")
	LSreducao 	= ECFGetPropVT("LSreducao")
	=W_DEFPROC("ECF.SPR")
	LSliq	 	= ECFGetPropVT("LSliq")
	=W_DEFPROC("ECF.SPR")
	LSbruto 	= ECFGetPropVT("LSbruto")
	=W_DEFPROC("ECF.SPR")
	LSmenserro 	= ECFGetPropVT("LSmenserro")
	=W_DEFPROC("ECF.SPR")
	LSfazx	 	= ECFGetPropVT("LSfazx")
	=W_DEFPROC("ECF.SPR")
	LSpapel	 	= ECFGetPropVT("LSpapel")
	*---------------------------------------------------------*

	SHOW GET LSseq	
	SHOW GET LSstat
	SHOW GET LStransacao
	SHOW GET LSescape
	SHOW GET LSreducao
	SHOW GET LSliq
	SHOW GET LSbruto
	SHOW GET LSerro
	SHOW GET LSmenserro
	SHOW GET LSfazx
	SHOW GET LSpapel
RETURN





*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F2S           m.LX_swe WHEN                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   30  є
*       є Variable:            m.LX_swe                           є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f2s     &&  m.LX_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F2T           m.LX_swe VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   30  є
*       є Variable:            m.LX_swe                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f2t     &&  m.LX_swe VALID
#REGION 1
	=W_DEFPROC("ECF.SPR")
	=ECFpede_Xleitura()
RETURN


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F2U           m.ADM WHEN                         є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   31  є
*       є Variable:            m.ADM                              є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f2u     &&  m.ADM WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F2V           m.ADM VALID                        є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   31  є
*       є Variable:            m.ADM                              є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      4                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f2v     &&  m.ADM VALID
#REGION 1
	=W_DEFPROC("ECF.SPR")
	A=ECFAdm()
RETURN


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F2W           m.fatvend_swe WHEN                 є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   32  є
*       є Variable:            m.fatvend_swe                      є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      5                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f2w     &&  m.fatvend_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F3S           m.fatvend_swe VALID                є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   32  є
*       є Variable:            m.fatvend_swe                      є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      6                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f3s     &&  m.fatvend_swe VALID
#REGION 1
	=W_DEFPROC("ORCAMENT.SPR")
	IF ORSelParaFat()

		=W_DEFPROC("NOTA.SPR")
		=NFrot_fat(LSchamada,"EFETIVAR FATURAMENTO")

	ENDIF

	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP

	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP

RETURN


*
*
*
*		=W_DEFPROC("NOTA.SPR")
*		wp_flgfecha = !NFrot_fat("IMPORTACAO","EFETIVAR FATURAMENTO")
*

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F3Z           m.CNC_CARTAO WHEN                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   33  є
*       є Variable:            m.CNC_CARTAO                       є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      7                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f3z     &&  m.CNC_CARTAO WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F44           m.CNC_CARTAO VALID                 є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   33  є
*       є Variable:            m.CNC_CARTAO                       є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      8                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f44     &&  m.CNC_CARTAO VALID
#REGION 1
	=W_DEFPROC("ECF.SPR")
	A=ECFPedeCNC()
RETURN


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F4A           m.canc_swe WHEN                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   34  є
*       є Variable:            m.canc_swe                         є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      9                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f4a     &&  m.canc_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F4B           m.canc_swe VALID                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   34  є
*       є Variable:            m.canc_swe                         є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      10                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f4b     &&  m.canc_swe VALID
#REGION 1
	=W_DEFPROC("NOTA.SPR")
	=NFpede_cancelamento()

*	=W_DEFPROC("ECF.SPR")
*	=ECFpede_cancpmant()

	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP

	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP

RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F4C           m.nro_swe WHEN                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   35  є
*       є Variable:            m.nro_swe                          є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      11                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f4c     &&  m.nro_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F4D           m.nro_swe VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   35  є
*       є Variable:            m.nro_swe                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      12                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f4d     &&  m.nro_swe VALID
#REGION 1
	=W_DEFPROC("ECF.SPR")
	A=ECFnrocupom()

	A=STR(INT(A),6)
	WAIT WINDOW "Nro Cupom : "+A
RETURN


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F4E           m.eminfcp_swe WHEN                 є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   36  є
*       є Variable:            m.eminfcp_swe                      є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      13                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f4e     &&  m.eminfcp_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F4F           m.eminfcp_swe VALID                є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   36  є
*       є Variable:            m.eminfcp_swe                      є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      14                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
	*--------------------------------------------------------*
FUNCTION _4bp0y6f4f     &&  m.eminfcp_swe VALID
#REGION 1
	=W_DEFPROC("NOTA.SPR")
	if wp_dtoper <= {02.04.2006}
		do NF_01ImpCopia
	ELSE
		do NF_02ImpCopia with "CAIXA"
	ENDIF
	*--------------------------------------------------------*

	SELECT orcament
	UNLOCK ALL
	ACTIVATE WINDOW OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP
RETURN







*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F5B           m.ST_swe WHEN                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   37  є
*       є Variable:            m.ST_swe                           є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      15                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f5b     &&  m.ST_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F5H           m.ST_swe VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   37  є
*       є Variable:            m.ST_swe                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      16                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f5h     &&  m.ST_swe VALID
#REGION 1
	=ECFShowStatus()
	WAIT WINDOW " <ENTER> "
RETURN


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F5N           m.visual_swe WHEN                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   38  є
*       є Variable:            m.visual_swe                       є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      17                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f5n     &&  m.visual_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F5U           m.visual_swe VALID                 є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   38  є
*       є Variable:            m.visual_swe                       є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      18                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f5u     &&  m.visual_swe VALID
#REGION 1
	=W_DEFPROC("NOTA.SPR")
	=NFView()
RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F5V           m.forma_swe WHEN                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   39  є
*       є Variable:            m.forma_swe                        є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      19                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f5v     &&  m.forma_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F5W           m.forma_swe VALID                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   39  є
*       є Variable:            m.forma_swe                        є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      20                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f5w     &&  m.forma_swe VALID
#REGION 1
	=W_DEFPROC("ECF.SPR")
	=ECFprgpgt()
RETURN


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F5X           m.fchabrt_swe WHEN                 є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   40  є
*       є Variable:            m.fchabrt_swe                      є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      21                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f5x     &&  m.fchabrt_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F5Y           m.fchabrt_swe VALID                є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   40  є
*       є Variable:            m.fchabrt_swe                      є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      22                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f5y     &&  m.fchabrt_swe VALID
#REGION 1
	=W_DEFPROC("ECF.SPR")
	=ECFpede_fchcpm()
RETURN




*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F6S           m.reset_swe WHEN                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   41  є
*       є Variable:            m.reset_swe                        є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      23                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f6s     &&  m.reset_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F6Z           m.reset_swe VALID                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   41  є
*       є Variable:            m.reset_swe                        є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      24                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*


FUNCTION _4bp0y6f6z     &&  m.reset_swe VALID
#REGION 1
	=W_DEFPROC("ECF.SPR")
	=ECFreset()
RETURN


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F74           m.Emit_Bol WHEN                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   42  є
*       є Variable:            m.Emit_Bol                         є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      25                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f74     &&  m.Emit_Bol WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F7A           m.Emit_Bol VALID                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   42  є
*       є Variable:            m.Emit_Bol                         є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      26                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f7a     &&  m.Emit_Bol VALID
#REGION 1
	=W_DEFPROC("NOTA.SPR")
	LNregistro = NFView()
	IF LNregistro > 0
	   sele nota
	   go lnregistro
		*---------------------------------------------------------*
		=W_DEFPROC("DUPLICAT.SPR")
		=CRGeraBoleto(nota.empresa,nota.nota)
		*---------------------------------------------------------*
	ENDIF
	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP
RETURN


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F7G           m.mapaI_swe WHEN                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   43  є
*       є Variable:            m.mapaI_swe                        є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      27                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f7g     &&  m.mapaI_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F7H           m.mapaI_swe VALID                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   43  є
*       є Variable:            m.mapaI_swe                        є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      28                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

FUNCTION _4bp0y6f7h     &&  m.mapaI_swe VALID
#REGION 1
	=W_DEFPROC("ECF.SPR")
**	=ECFRelMapa()
	=ECFleDadSintegra(WP_DTOPER)

	SELE orcament
	SHOW WINDOW OBJ_ECF TOP
RETURN


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F7I           m.ReenvNFe WHEN                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   44  є
*       є Variable:            m.ReenvNFe                         є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      29                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f7i     &&  m.ReenvNFe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F7J           m.ReenvNFe VALID                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   44  є
*       є Variable:            m.ReenvNFe                         є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      30                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*






	*-----------------------------------------------------------*
FUNCTION _4bp0y6f7j     &&  m.ReenvNFe VALID
#REGION 1
	PRIVATE LSemi_CFe
	PRIVATE LSscr_CFe

	*------------------------------------------------------------*


	=W_DEFPROC("EMPRESA.SPR")
	LSemi_CFE = EMGetFieldValue(wp_empresa,"EMITE_CFE")

	*------------------------------------------------------------*



	=W_DEFPROC("EMPRESA.SPR")
	LSscr_cfe = EMGetFieldValue(wp_empresa,"ESCRT_CFE")


	*------------------------------------------------------------*

	DO CASE

        CASE nota.nfe_status = "CANCELADA"
             =W_DEFPROC("nota.spr")
		     =NFCTRLcancFatura((nota.empresa),(nota.nota),"NORMAL")

		CASE LSemi_cfe = "S" OR LSscr_cfe = "S"
	
			=W_DEFPROC("NOTA.SPR")
			=NFReenvNFe("")

		OTHERWISE
		
			=W_DEFPROC("NOTA.SPR")
			=NFReenvNFe(" and (nota < 1000000 or nota > 3000000)")

	ENDCASE


	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP

RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F7K           m.lermemo WHEN                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   45  є
*       є Variable:            m.lermemo                          є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      31                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f7k     &&  m.lermemo WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F7L           m.lermemo VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   45  є
*       є Variable:            m.lermemo                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      32                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f7l     &&  m.lermemo VALID
#REGION 1
	=W_DEFPROC("ECF.SPR")
	=ECFlermemo()

	SELE orcament
	SHOW WINDOW OBJ_ECF TOP
RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F8G           m.recupfat_swe WHEN                є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   46  є
*       є Variable:            m.recupfat_swe                     є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      33                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f8g     &&  m.recupfat_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F8M           m.recupfat_swe VALID               є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   46  є
*       є Variable:            m.recupfat_swe                     є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      34                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
	*---------------------------------------------------------*

FUNCTION _4bp0y6f8m     &&  m.recupfat_swe VALID
#REGION 1
	=W_DEFPROC("NOTA.SPR")
	=NFRecuperaFat("RECUPERACAO","EFETIVAR FATURAMENTO")

	*---------------------------------------------------------*
	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP
RETURN





*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F8S           m.RtrnNFe WHEN                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   47  є
*       є Variable:            m.RtrnNFe                          є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      35                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f8s     &&  m.RtrnNFe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F8Z           m.RtrnNFe VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   47  є
*       є Variable:            m.RtrnNFe                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      36                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f8z     &&  m.RtrnNFe VALID
#REGION 1
	=W_DEFPROC("NOTA.SPR")
	LNregistro = NFView(" and (nota < 1000000 or nota > 3000000)")
	IF LNregistro > 0
	   sele nota
	   go lnregistro
		*---------------------------------------------------------*
		=W_DEFPROC("NOTA.SPR")
		=NFRtrnoNfe_NOTA(nota.empresa,nota.nota,"NAO ESPERA")

		*---------------------------------------------------------*
	ENDIF
	=W_DEFPROC("rotinas.SPR")

	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP
RETURN


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F90           m.redZ_swe WHEN                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   48  є
*       є Variable:            m.redZ_swe                         є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      37                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f90     &&  m.redZ_swe WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F91           m.redZ_swe VALID                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   48  є
*       є Variable:            m.redZ_swe                         є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      38                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f91     &&  m.redZ_swe VALID
#REGION 1
	=W_DEFPROC("ECF.SPR")
	=ECFpede_zleitura()
RETURN




*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F92           m.ReenvDFis WHEN                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   49  є
*       є Variable:            m.ReenvDFis                        є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      39                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f92     &&  m.ReenvDFis WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F93           m.ReenvDFis VALID                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   49  є
*       є Variable:            m.ReenvDFis                        є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      40                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

FUNCTION _4bp0y6f93     &&  m.ReenvDFis VALID
#REGION 1
	=W_DEFPROC("NOTA.SPR")
	=NFReenvNFe()
	ACTIVATE WINDOWS OBJ_ECF TOP
	SHOW WINDOW OBJ_ECF TOP
RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6F9T           m.OK_btn WHEN                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   59  є
*       є Variable:            m.OK_btn                           є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      41                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6f9t     &&  m.OK_btn WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6FA0           m.OK_btn VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   59  є
*       є Variable:            m.OK_btn                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      42                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6fa0     &&  m.OK_btn VALID
#REGION 1
CLEAR GETS
CLEAR READ
isediting = .f.
RETURN .T.

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6FA6           m.cft_btn WHEN                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   60  є
*       є Variable:            m.cft_btn                          є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      43                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6fa6     &&  m.cft_btn WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _4BP0Y6FAC           m.cft_btn VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_ECF2,     Record Number:   60  є
*       є Variable:            m.cft_btn                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      44                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _4bp0y6fac     &&  m.cft_btn VALID
#REGION 1
CLEAR GETS
CLEAR READ
isediting = .f.
CLEAR TYPEAHEAD
CLEAR TYPEAHEAD
ON KEY
KEYBOARD CHR(27)
LFretorno = .f.  && CASO SEJA CANCELADO VOLTA .F.
RETURN .T.