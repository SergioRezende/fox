*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 03/19/09             SGC0411.SPR               14:50:39 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 2009 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є          SGC0411/MS-DOS Setup Code - SECTION 1          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1

    = W_DEFPROC("rotinas.spr")
	ON KEY LABEL ESCAPE


	PRIVATE LSalias
	PRIVATE wp_ref_local
	PRIVATE isediting
	wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
	wp_ref_local =  .f.     && NAO POSSUI CONTROLE DE REFRESH LOCAL
	m.isediting	 =	.t.
	*------------------------------------------*
	PRIVATE  ARQ_empresa , ALS_empresa
	PRIVATE  ARQ_grupo   , ALS_grupo
	PRIVATE  ARQ_itemmov , ALS_itemmov
	PRIVATE  ARQ_tab001  , ALS_tab001
	PRIVATE  ordinicio ,ordfim
	m.ordinicio = 0
	m.ordfim    = 0

	LSalias	 = ALIAS()


    ARQ_empresa  = NetArqAgain("EMPRESA")
    ALS_empresa  = Alias()

    ARQ_grupo  	  = NetArqAgain("GRUPO")
    ALS_grupo     = Alias()

    ARQ_tab001    = NetArqAgain("TAB001")
    ALS_tab001   = Alias()

    ARQ_itemmov   = NetArqAgain("ITEMMOV")
    ALS_itemmov   = Alias()

	IF (ARQ_empresa+ARQ_grupo+ARQ_itemmov) > 100000    && HOUVE FALHA ABERT
		DO ulfecha
    	RETURN(.F.)
    ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

IF NOT WEXIST("sgc0411") ;
	OR UPPER(WTITLE("SGC0411")) == "SGC0411.PJX" ;
	OR UPPER(WTITLE("SGC0411")) == "SGC0411.SCX" ;
	OR UPPER(WTITLE("SGC0411")) == "SGC0411.MNX" ;
	OR UPPER(WTITLE("SGC0411")) == "SGC0411.PRG" ;
	OR UPPER(WTITLE("SGC0411")) == "SGC0411.FRX" ;
	OR UPPER(WTITLE("SGC0411")) == "SGC0411.QPR"
	DEFINE WINDOW sgc0411 ;
		FROM INT((SROW()-13)/2),INT((SCOL()-77)/2) ;
		TO INT((SROW()-13)/2)+12,INT((SCOL()-77)/2)+76 ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є          SGC0411/MS-DOS Setup Code - SECTION 2          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
	SELECT GR.ORDEM,GR.CODIGO,GR.DESCRICAO, GR.CLASSIFICA ;
		FROM   &ALS_grupo GR;
		WHERE  GR.CDG_TIPO = 4;
		ORDER  BY ordem;
		INTO CURSOR TMP_GRUPO

*----------------------------------------------------------*
    ON KEY LABEL END DO ULsaida
		
		
		
		
		

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              SGC0411/MS-DOS Screen Layout               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("sgc0411")
	ACTIVATE WINDOW sgc0411 SAME
ELSE
	ACTIVATE WINDOW sgc0411 NOSHOW
ENDIF
@ 1,2 TO 11,72 ;
	COLOR SCHEME 23
@ 11,3 TO 11,71 ;
	COLOR SCHEME 24
@ 11,72 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,72 TO 10,72 ;
	COLOR SCHEME 24
@ 1,72 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,0 TO 12,75 ;
	COLOR SCHEME 23
@ 12,1 TO 12,74 ;
	COLOR SCHEME 24
@ 12,75 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,75 TO 11,75 ;
	COLOR SCHEME 24
@ 0,75 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 8,46 TO 10,57 ;
	COLOR SCHEME 24
@ 10,47 TO 10,56 ;
	COLOR SCHEME 23
@ 9,57 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,57 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,57 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,60 TO 10,68 ;
	COLOR SCHEME 24
@ 10,61 TO 10,67 ;
	COLOR SCHEME 23
@ 9,68 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,68 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,68 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 3,35 SAY "a" ;
	SIZE 1,1, 0
@ 2,23 TO 4,47 ;
	COLOR SCHEME 23
@ 4,24 TO 4,46 ;
	COLOR SCHEME 24
@ 4,47 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,47 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,47 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,25 SAY "[Periodo]" ;
	SIZE 1,9, 0
@ 2,4 TO 4,22 ;
	COLOR SCHEME 23
@ 4,5 TO 4,21 ;
	COLOR SCHEME 24
@ 4,22 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,22 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,22 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,6 SAY "[Filial]" ;
	SIZE 1,8, 0
@ 3,8 SAY "-" ;
	SIZE 1,1, 0
@ 0,6 SAY "[ Consulta Vendas Por Seguimento de Mercado ]" ;
	SIZE 1,45, 0
@ 0,61 SAY "[SGC411]" ;
	SIZE 1,8, 0
@ 5,23 TO 7,60 ;
	COLOR SCHEME 23
@ 7,24 TO 7,59 ;
	COLOR SCHEME 24
@ 5,60 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 7,60 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,25 SAY "[Intervalo Produtos]" ;
	SIZE 1,20, 0
@ 6,60 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,5 GET m.empresa ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN _2lx0vte0y() ;
	VALID _2lx0vte10()
@ 3,9 GET m.nome_emp ;
	SIZE 1,12 ;
	DEFAULT " " ;
	WHEN _2lx0vte14()
@ 3,24 GET m.dt_inicio ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _2lx0vte2r() ;
	VALID _2lx0vte2s()
@ 3,37 GET m.dt_fim ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN isediting ;
	MESSAGE "Data Final deve ser maior ou igual a Inicial"
@ 6,24 GET m.codinicio ;
	SIZE 1,16 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN _2lx0vte2t() ;
	VALID _2lx0vte2u() ;
	ERROR wp_msg
@ 6,44 GET m.codfim ;
	SIZE 1,16 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN _2lx0vte2v() ;
	VALID _2lx0vte3k() ;
	ERROR wp_msg
@ 9,47 GET m.imp_btn ;
	PICTURE "@*HN \<Consulta" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _2lx0vte3o()
@ 9,61 GET exit_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _2lx0vte3v()
@ 10,62 SAY "<END>" ;
	SIZE 1,5, 0 ;
	COLOR SCHEME 24

IF NOT WVISIBLE("sgc0411")
	ACTIVATE WINDOW sgc0411
ENDIF

READ CYCLE ;
	ACTIVATE READACT() ;
	DEACTIVATE READDEAC()

RELEASE WINDOW sgc0411

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є               SGC0411/MS-DOS Cleanup Code               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1

	DO ULfecha
RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є   SGC0411/MS-DOS Supporting Procedures and Functions    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
PROC ulfecha
	
    =UP_fecha(ALS_empresa)
    =UP_fecha(ALS_grupo)
    =UP_fecha(ALS_itemmov)
    =UP_fecha(ALS_tab001)

	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(LSalias)
		SELECT &LSalias
	ENDIF
	ON KEY LABEL ESCAPE
    ON KEY LABEL END
	SET FORMAT TO
RETURN




*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VTE0Y           m.empresa WHEN                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SGC0411,     Record Number:   44   є
*       є Variable:            m.empresa                          є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vte0y     &&  m.empresa WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VTE10           m.empresa VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SGC0411,     Record Number:   44   є
*       є Variable:            m.empresa                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vte10     &&  m.empresa VALID
#REGION 1
SELECT &ALS_empresa
SET ORDER TO TAG empresa
IF LASTKEY() = 15
	DO ULsaida
	RETURN
ENDIF


IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .F.
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT &ALS_empresa
		RETURN .F.
	ENDIF
ELSE
	IF !SEEK(m.empresa)
		SELECT &ALS_empresa
		RETURN .F.
	ENDIF
ENDIF
m.empresa   = &ALS_empresa .empresa
m.nome_emp  = &ALS_empresa .sigla
SHOW GET m.empresa
SHOW GET m.nome_emp
SELECT empresa
RETURN .T.


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VTE14           m.nome_emp WHEN                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SGC0411,     Record Number:   45   є
*       є Variable:            m.nome_emp                         є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vte14     &&  m.nome_emp WHEN
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(.f.)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VTE2R           m.dt_inicio WHEN                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SGC0411,     Record Number:   46   є
*       є Variable:            m.dt_inicio                        є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      4                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vte2r     &&  m.dt_inicio WHEN
#REGION 1
IF isediting
	ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ENDIF
RETURN(isediting)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VTE2S           m.dt_inicio VALID                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SGC0411,     Record Number:   46   є
*       є Variable:            m.dt_inicio                        є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      5                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vte2s     &&  m.dt_inicio VALID
#REGION 1
m.dt_fim = m.dt_inicio
SHOW GET m.dt_fim
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN (.T.)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VTE2T           m.codinicio WHEN                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SGC0411,     Record Number:   48   є
*       є Variable:            m.codinicio                        є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      6                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vte2t     &&  m.codinicio WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VTE2U           m.codinicio VALID                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SGC0411,     Record Number:   48   є
*       є Variable:            m.codinicio                        є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      7                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vte2u     &&  m.codinicio VALID
#REGION 1
PRIVATE LSforlocal, LSgrupo

	IF EMPTY(m.codinicio) AND LASTKEY() <> 9
		m.descinicio  =   "PRIMEIRO"
		m.ordinicio  = 1
		SHOW GET  m.descinicio
		RETURN(.T.)
	ENDIF
	*----------------------------------------------------------*
	LSforlocal  = ""
	*----------------------------------------------------------*
	IF LASTKEY() = 9
	    = W_DEFPROC("estoque.spr")
	    m.codinicio = ESPsq_Produtos(m.codinicio)
		IF LASTKEY() = 27
			RETURN .F.
		ENDIF
	ENDIF
	SELE TMP_GRUPO
	SET NEAR ON
	LOCATE FOR CODIGO = m.codinicio
	SET NEAR OFF
	m.codinicio  = TMP_GRUPO.codigo
	m.codfim     = TMP_GRUPO.codigo

	m.clasinicio = TMP_GRUPO.classifica
	m.descinicio = TMP_GRUPO.descricao

	m.ordinicio  = TMP_GRUPO.ordem
	m.ordfim     = TMP_GRUPO.ordem
	*******
	SHOW GET  m.codinicio
RETURN .t.


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VTE2V           m.codfim WHEN                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SGC0411,     Record Number:   49   є
*       є Variable:            m.codfim                           є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      8                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vte2v     &&  m.codfim WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VTE3K           m.codfim VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SGC0411,     Record Number:   49   є
*       є Variable:            m.codfim                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      9                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vte3k     &&  m.codfim VALID
#REGION 1
PRIVATE LSforlocal, LSgrupo

	IF EMPTY(m.codfim) AND LASTKEY() <> 9
		m.clasfim 	= 	REPL("9",15)
		m.descfim   =   "ULTIMO"
		m.ordfim  	 = 9999999
		SHOW GET  m.descfim
		RETURN(.T.)
	ENDIF

	*----------------------------------------------------------*
	LSforlocal  = ""
	*----------------------------------------------------------*
	IF LASTKEY() = 9
	    = W_DEFPROC("estoque.spr")
	    m.codfim = ESPsq_Produtos(m.codinicio)
		IF LASTKEY() = 27
			RETURN .F.
		ENDIF
	ENDIF
	SELE TMP_GRUPO
	SET NEAR ON
	LOCATE FOR CODIGO = m.codfim
	SET NEAR OFF


	m.codfim  = TMP_GRUPO.codigo
	m.clasfim = TMP_GRUPO.classifica
	m.descfim = TMP_GRUPO.descricao
	m.ordfim  = TMP_GRUPO.ordem
	*******
	SHOW GET  m.codfim
RETURN .t.


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VTE3O           m.imp_btn VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SGC0411,     Record Number:   50   є
*       є Variable:            m.imp_btn                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      10                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vte3o     &&  m.imp_btn VALID
#REGION 1
	do ULconsulta WITH m.empresa, m.dt_inicio, m.dt_fim, m.ordinicio,;
				         m.ordfim

RETURN

PROCEDURE ULconsulta
PARAMETERS LNempresa, LDdt_inicio, LDdt_Fim, LNordInicio, LNordFim



  CTR = 0

  SELECT  EMP.SIGLA,;
  		  LDdt_inicio as DTINICIO ,;
          LDdt_fim  AS DTFINAL,;
          GR.CODIGO,GR.DESCRICAO AS PRODUTO,;
          LEFT(tb.DESCRICAO,15) AS DESCRICAO,;
          SUM(mv.QTDE) AS QTDE ,;
          SUM(mv.VLRVENDA) AS VALOR;
      FROM  ;
   	        &ALS_empresa EMP, ;
   	        &ALS_tab001  TB, ;
      		TMP_GRUPO    GR,;
      		&ALS_itemmov MV;
	     WHERE ;
			      ULevolucao(gr.ordem, mv.codigo,mv.data);
	     	  AND emp.empresa  =   LNempresa;
	     	  AND gr.ordem    >=  LNordinicio;
	     	  AND gr.ordem    <=  LNordfim;
	     	  AND mv.data     >=  ldDT_inicio ;
		      AND mv.data     <=  LDdt_fim ;
           	  AND mv.empresa   =  LNempresa ;
           	  AND gr.codigo    = mv.codigo  ;
    		  AND (;
 			      	(left(mv.operacao,1) = "S" AND mv.ch_opera = "1")  ;
 			      );
 			  AND tb.tabela = "NTZ" ;
 			  AND CHRTRAN(STR(mv.NATU_CLI,1)," ","0") = TB.codigo;
		 ORDE  BY GR.CODIGO,tb.DESCRICAO ;
		 GROUP BY GR.CODIGO,tb.DESCRICAO ;
         INTO CURSOR TMP_1


  SELECT  ;
          CODIGO    AS  T_CODIGO,;
          SUM(QTDE) AS  T_QTDE ,;
          SUM(VALOR) AS T_VALOR;
      FROM  TMP_1 ;
		 ORDER  BY CODIGO ;
		 GROUP BY CODIGO ;
         INTO CURSOR TMP_2

  SELECT  SIGLA,;
  		  DTINICIO ,;
          DTFINAL,;
          CODIGO,;
          PRODUTO,;
          DESCRICAO,;
          QTDE ,;
		  (QTDE * 100 / T_QTDE) AS PRCT,;	
          VALOR;
      FROM  TMP_1, TMP_2 ;
	  WHERE CODIGO = T_CODIGO ;
		 ORDE  BY CODIGO,DESCRICAO ;
         INTO CURSOR TMP_ITEM


    SELECT TMP_ITEM
	IF EOF()
		USE
		WAIT WINDOW 'NAO EXISTEM DADOS  PARA PROCESSO.'
		SHOW GET m.imp_btn DISABLE
		RETURN
	ENDIF
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SELECT TMP_ITEM

	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()

    COUNT TO   LNimpressao

	LNimpressos = 0

	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	

**************************>>> REGISTRO DE SAIDAS
    LSrel = "REL0411"      && relatorio para classificacao de comissao
    LSorienta = "FOR  LFsegue "
***********
	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
***********
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
*-----------------------------
    =UP_fecha("TMP_ITEM")
    =UP_fecha("TMP_1")
    =UP_fecha("TMP_2")

    SELECT TMP_GRUPO
    SET PRINTER TO SET('PRINTER',1)
	SET RELATION TO
	SET POINT TO
	SET SEPARATOR  TO

	SHOW WINDOW SGC0411 TOP

RETURN

FUNCTION ULevolucao
    PARAMETERS LNordem,LScodigo, LDdata
	WAIT WINDOWS "Processando : "+;
	         STR(CTR,7)+" "+DTOS(LDdata)+" "+LScodigo NOWAIT
	CTR = CTR+1

RETURN(.T.)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VTE3V           exit_btn VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SGC0411,     Record Number:   51   є
*       є Variable:            exit_btn                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      11                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vte3v     &&  exit_btn VALID
#REGION 1
  DO ULsaida
RETURN


PROCEDURE ULsaida
*  IF fox_alert("Confirma Saida ?")
		CLEAR GETS
		CLEAR READ
		isediting = .f.
		RETURN .T.
*  ENDIF
RETURN .T.