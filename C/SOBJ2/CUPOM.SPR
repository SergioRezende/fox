*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        06/25/09              CUPOM.SPR                15:16:34 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 2009 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                  CUPOM/MS-DOS Setup Code - SECTION 2           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
return

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      CUPOM/MS-DOS Screen Layout                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
@ 1,0 SAY "====> Com Uso de pseudo OO" ;
	SIZE 1,26, 0
@ 5,5 GET CPVerifyInst ;
	PICTURE "@*HN CPVerifyInst - Verifica Instancia" ;
	SIZE 1,35,1 ;
	DEFAULT 1 ;
	VALID _2on0wqq8a()
@ 6,8 GET CPCreate ;
	PICTURE "@*HN CPCreate - Instancia" ;
	SIZE 1,22,1 ;
	DEFAULT 1 ;
	VALID _2on0wqq8e()
@ 14,8 GET CPDestroi ;
	PICTURE "@*HN CPDestroi - Desinstancia" ;
	SIZE 1,26,1 ;
	DEFAULT 1 ;
	VALID _2on0wqq8j()
@ 8,11 GET CPReadProp ;
	PICTURE "@*HN CPReadProp - Carga do Vetor com Base na Tabela" ;
	SIZE 1,48,1 ;
	DEFAULT 1 ;
	VALID _2on0wqq8o()
@ 11,14 GET CPSetDerivadas ;
	PICTURE "@*HN CPSetDerivadas - Carga de Propriedades Derivadas" ;
	SIZE 1,51,1 ;
	DEFAULT 1 ;
	VALID _2on0wqq8r()
@ 9,14 GET CPSetPropVT ;
	PICTURE "@*HN CPSetPropVT - Set o Valor de uma Propriedade do Vetor" ;
	SIZE 1,55,1 ;
	DEFAULT 1 ;
	VALID _2on0wqq8v()
@ 10,14 GET CPGetPropVT ;
	PICTURE "@*HN CPGetPropVT - Get o Valor de uma Propriedade do Vetor" ;
	SIZE 1,55,1 ;
	DEFAULT 1 ;
	VALID _2on0wqq8x()
@ 4,0 GET CPChk_Identidade ;
	PICTURE "@*HN CPChk_Identidade - Checagem de Identidade do Objeto" ;
	SIZE 1,53,1 ;
	DEFAULT 1 ;
	VALID _2on0wqq91()
@ 3,0 GET CPFind ;
	PICTURE "@*HN CPFind - Localiza Registro Com Base nas Propriedades" ;
	SIZE 1,54,1 ;
	DEFAULT 1 ;
	VALID _2on0wqqao()
@ 16,0 GET CPGetFieldValue ;
	PICTURE "@*HN CPGetFieldValue - Retorna o valor do Campo informado" ;
	SIZE 1,54,1 ;
	DEFAULT 1 ;
	VALID _2on0wqqas()
@ 15,0 GET CP_Refresh ;
	PICTURE "@*HN CP_Refresh - Forca Atualiza놹o Objeto" ;
	SIZE 1,39,1 ;
	DEFAULT 1 ;
	VALID _2on0wqqaw()
@ 12,11 GET CPWriteProp ;
	PICTURE "@*HN CPWriteProp - Grava do Vetor para Base na Tabela" ;
	SIZE 1,50,1 ;
	DEFAULT 1 ;
	VALID _2on0wqqb0()
@ 19,0 SAY "*-------------------------------------------------------------------*" ;
	SIZE 1,69, 0
@ 21,0 GET CPLerRegistro ;
	PICTURE "@*HN CPLerRegistro - Le Registro e Carrega OBJ" ;
	SIZE 1,43,1 ;
	DEFAULT 1 ;
	VALID _2on0wqqb2()
@ 22,0 GET CPSalvarRegistro ;
	PICTURE "@*HN CPSalvarRegistro - Salva Registro" ;
	SIZE 1,35,1 ;
	DEFAULT 1 ;
	VALID _2on0wqqb3()
@ 20,0 GET CPExiste ;
	PICTURE "@*HN CPExiste - Le Registro nao carrega o OBJ e Retorna se existe" ;
	SIZE 1,62,1 ;
	DEFAULT 1 ;
	VALID _2on0wqqb4()
@ 23,0 SAY "*-------------------------------------------------------------------*" ;
	SIZE 1,69, 0
@ 17,0 GET CPGetAlias ;
	PICTURE "@*HN CPGetAlias - Retorna Alias da area em que foi abertaa tabela" ;
	SIZE 1,62,1 ;
	DEFAULT 1 ;
	VALID _2on0wqqb5()



READ


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQ8A           CPVerifyInst VALID                 
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:    3     
*        Variable:            CPVerifyInst                       
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqq8a     &&  CPVerifyInst VALID
#REGION 1
return
*---------------------------------------------------------------*



FUNCTION CPVerifyInst
	
PRIVATE LSpath
	=W_DEFPROC("rotinas.spr")
	LSpath = UPobterPath("Nota")


	DO CASE

		CASE TYPE("PBCupomAlias") = "U" ;
		   		OR EMPTY(PBCupomAlias) ;
		   		OR !USED(PBCupomAlias)
			=CPCreate()					

		CASE !("NOTA.DBF" $ DBF(PBCupomAlias))
				* APOS UM CLOSE DATABASE UM OUTRO DBF FOI
				* ABERTO NA AREA ANTES OCUPADA PELO DBF AVALIADO AKI
				RELEASE PBCupomAlias
			=CPCreate()					


		CASE  !(LSPath $ DBF(PBCupomAlias))
			 	* HOUVE MUDANCA DE DIR BASE
			 	* ELIMINA INSTACIA DE OUTRA BASE
		     	* CRIA INSTANCIA NA NOVA BASE
			=CPDestroi()				
			=CPCreate()					
	ENDCASE

	
RETURN(.t.)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQ8E           CPCreate VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:    4     
*        Variable:            CPCreate                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqq8e     &&  CPCreate VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION CPCreate
	=W_DEFPROC("rotinas.spr")
	PRIVATE LSalias
	PRIVATE LSAlsTmp
    PRIVATE LMaxDim
	LSalias		= 	ALIAS()
	
	IF TYPE("PBCupomAlias") <> "U" ;
	   		AND !EMPTY(PBCupomAlias) ;
	   		AND USED(PBCupomAlias)
			RETURN(.T.)
	ENDIF


	PUBLIC PBCupomAlias

	IF USED("Nota")
	     =NetArqAgain("Nota")
	     PBCupomAlias     = Alias()
	ELSE
	     =NetArqAgain("Nota")
	     LSAlsTmp     = Alias()
	     =NetArqAgain("Nota")
	     PBCupomAlias     = Alias()
		 IF !EMPTY(LSAlsTmp) AND USED(LSAlsTmp)
			SELECT &LSAlsTmp
			USE
		 ENDIF
	ENDIF	

    SELE &PBCupomAlias
	LMaxDim = Fcount()
    PUBLIC DIMENSION VTCupom[LMaxDim]
    PUBLIC DIMENSION VDCupom[2,3]			&& VETOR PARA PROPRIEDADES
    PUBLIC DIMENSION VFCupom[1]      && VETOR CABECALHO DOS CAMPOS
	=AFIELDS(VFCupom)
	*-----------------------------------------------------------*
	=CPReadProperty()
	=CPSetDerivadas()
	*--------------------------------------------------------------*
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
RETURN



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQ8J           CPDestroi VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:    5     
*        Variable:            CPDestroi                          
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqq8j     &&  CPDestroi VALID
#REGION 1
return
*---------------------------------------------------------------*


FUNCTION CPDestroi

	=W_DEFPROC("rotinas.spr")

	IF TYPE("PBCupomAlias") = "U"
		RETURN
	ENDIF

    *--------------------------------------------------------------------*
	*-> QUANDO O SISTEMA APLICA UM CLOSE DATABASE :
	*   EX: EM UPAltDir (Geral.spr)
	*  1- Fecha inclusive a referencia do PBCupomAlias
	*  2- Novas tabelas abertas podem ocupar a area referenciada
	*     por PBCupomAlias
	*  3- Se aplicar um FECHAMENTO a PBCupomAlias estara fechando
	*     outra tabela
	*  4- Entao Verifica-se a coerencia do dbf esperado em PBCupomAlias
	*-------------------------------------------------------------------*
	IF !(USED(PBCupomAlias)) OR ;
	   !("NOTA.DBF" $ DBF(PBCupomAlias))

		RELEASE PBCupomAlias
    	RELEASE VTCupom
	    RELEASE VDCupom
	    RELEASE VFCupom
		return(.T.)			
	ENDIF
	PRIVATE LSalias
	LSalias  = Alias()
	IF !EMPTY(PBCupomAlias) AND USED(PBCupomAlias)
		SELECT &PBCupomAlias
		USE
	ENDIF	
	RELEASE PBCupomAlias
    RELEASE VTCupom
    RELEASE VDCupom
    RELEASE VFCupom

	*-----------------------------------------------------------*
	*--------------------------------------------------------------*
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
RETURN(.T.)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQ8O           CPReadProp VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:    6     
*        Variable:            CPReadProp                         
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqq8o     &&  CPReadProp VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION CPReadProp
	PRIVATE LSalias
	LSalias		= 	ALIAS()


	SELE &PBCupomAlias
	SCATTER TO VTCupom
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
RETURN(.T.)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQ8R           CPSetDerivadas VALID               
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:    7     
*        Variable:            CPSetDerivadas                     
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqq8r     &&  CPSetDerivadas VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION CPSetDerivadas
	PRIVATE LSalias
	PRIVATE LEmpresa
	LSalias		= 	ALIAS()

	*--------------------------------------------------------------*
    VDCupom(1,1) = "NAOINFORMADO"
   	VDCupom(1,2) = 0
   	VDCupom(1,3) = .F.
	*--------------------------------------------------------------*
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
RETURN(.T.)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQ8V           CPSetPropVT VALID                  
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:    8     
*        Variable:            CPSetPropVT                        
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqq8v     &&  CPSetPropVT VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION CPSetPropVT
PARAMETER  PrmField, PrmValue
	PRIVATE Lvalue

	=W_DEFPROC("ROTINAS.SPR")
	Lvalue = RTsetValueObj(PrmField,PrmValue,;
						    PBCupomAlias,VTCupom,VDCupom,VFCupom)

RETURN(Lvalue)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQ8X           CPGetPropVT VALID                  
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:    9     
*        Variable:            CPGetPropVT                        
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      7                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqq8x     &&  CPGetPropVT VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION CPGetPropVT
PARAMETER  PrmField

	PRIVATE Lvalue

	=W_DEFPROC("ROTINAS.SPR")
	Lvalue = RTgetValueObj(PrmField,;
					PBCupomAlias,;
					VTCupom,;
					VDCupom,;
					VFCupom)

RETURN(Lvalue)





*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQ91           CPChk_Identidade VALID             
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:   10     
*        Variable:            CPChk_Identidade                   
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      8                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqq91     &&  CPChk_Identidade VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*

FUNCTION CPChk_Identidade
PARAMETERS  ;
			PrmEmp,;
			PrmNota


	PRIVATE LFretorno
	LFretorno = .t.



	=CPVerifyInst()
    =CPSetPropVT("EMPRESA",PrmEmp)
    =CPSetPropVT("NOTA",PrmNota)


	LFretorno=CPFind()
RETURN(LFretorno)




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQAO           CPFind VALID                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:   11     
*        Variable:            CPFind                             
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      9                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqqao     &&  CPFind VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION CPFind

	PRIVATE LEmpresa,;
			LNota
			
	
	


	PRIVATE LFreturn

	PRIVATE LSalias
	LSalias		= 	ALIAS()

	=CPVerifyInst()


	LEmpresa    = CPGetPropVT("Empresa")
	LNota       = CPGetPropVT("Nota")


	SELE &PBCupomAlias
	SET ORDER TO TAG NOTA
	SEEK STR(Lempresa,3)+STR(LNota,7)
	
	IF FOUND()
		=CPReadProperty()
		=CPSetDerivadas()
	    LFreturn = .T.
	ELSE
	    LFreturn = .f.
	ENDIF
	*--------------------------------------------------------------*
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
RETURN(LFreturn)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQAS           CPGetFieldValue VALID              
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:   12     
*        Variable:            CPGetFieldValue                    
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      10                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqqas     &&  CPGetFieldValue VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION CPGetFieldValue
PARAMETERS  PrmEmp,;
			PrmNota,;
			PrmField			

	=CPChk_Identidade(PrmEmp,;
					  PrmNota)

RETURN(CPGetPropVT(PrmField))


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQAW           CP_Refresh VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:   13     
*        Variable:            CP_Refresh                         
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      11                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqqaw     &&  CP_Refresh VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*

FUNCTION CP_Refresh
PARAMETERS  PrmEmpresa,;
			PrmNota
			
	
	


	PRIVATE LFreturn

	=CPVerifyInst()


	= CPSetPropVT("Empresa" ,PrmEmpresa)
	= CPSetPropVT("Nota"    ,PrmNota)

	*----------------------------------------------------------------*


	=CPFind()
	
RETURN(.t.)




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQB0           CPWriteProp VALID                  
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:   14     
*        Variable:            CPWriteProp                        
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      12                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqqb0     &&  CPWriteProp VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION CPWriteProp
	PRIVATE LSalias
	LSalias		= 	ALIAS()


	SELE &PBCupomAlias
	GATHER FROM  VTCupom
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
RETURN(.T.)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQB2           CPLerRegistro VALID                
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:   16     
*        Variable:            CPLerRegistro                      
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      13                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqqb2     &&  CPLerRegistro VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*

FUNCTION CPLerRegistro
PARAMETERS  PrmEmp,;
			PrmNota

	PRIVATE LFretorno
	LFretorno = .t.

	LFretorno = CPChk_Identidade(PrmEmp,;
			PrmNota)
RETURN(LFretorno)




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQB3           CPSalvarRegistro VALID             
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:   17     
*        Variable:            CPSalvarRegistro                   
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      14                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqqb3     &&  CPSalvarRegistro VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*

FUNCTION CPSalvarRegistro

	=CPVerifyInst()

	PRIVATE LFretorno
	LFretorno = .t.

	IF !CPExiste()
		SELE &PBCupomAlias
		APPEND BLANK
		LFretorno=CPWriteProp()
	ELSE
		SELE &PBCupomAlias
		LFretorno=CPWriteProp()
	ENDIF

RETURN(LFretorno)




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQB4           CPExiste VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:   18     
*        Variable:            CPExiste                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      15                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqqb4     &&  CPExiste VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION CPExiste

	PRIVATE LEmpresa,;
			LNota
			

	PRIVATE LFreturn

	PRIVATE LSalias
	LSalias		= 	ALIAS()

	=CPVerifyInst()

	LEmpresa    = CPGetPropVT("Empresa")
	LNota	    = CPGetPropVT("NOTA")


	SELE &PBNotaAlias
	SET ORDER TO TAG NOTA
	SEEK STR(Lempresa,3)+STR(LNota,7)
	
	IF FOUND()
	    LFreturn = .T.
	ELSE
	    LFreturn = .f.
	ENDIF
	*--------------------------------------------------------------*
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
RETURN(LFreturn)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2ON0WQQB5           CPGetAlias VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         CUPOM,     Record Number:   20     
*        Variable:            CPGetAlias                         
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      16                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2on0wqqb5     &&  CPGetAlias VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION CPGetAlias

	=CPVerifyInst()

RETURN(PBCupomAlias)
