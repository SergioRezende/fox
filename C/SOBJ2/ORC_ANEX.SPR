*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        05/01/2010           ORC_ANEX.SPR              16:37:36 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 2010 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     ORC_ANEX/MS-DOS Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
@ 7,5 GET OAVerifyInst ;
	PICTURE "@*HN OAVerifyInst - Verifica Instancia" ;
	SIZE 1,35,1 ;
	DEFAULT 1 ;
	VALID _2u30zmw9a()
@ 8,8 GET OACreate ;
	PICTURE "@*HN OACreate - Instancia" ;
	SIZE 1,22,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwb5()
@ 17,8 GET OADestroi ;
	PICTURE "@*HN OADestroi - Desinstancia" ;
	SIZE 1,26,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwbj()
@ 9,10 GET OAReadProp ;
	PICTURE "@*HN OAReadProp - Carga do Vetor com Base na Tabela" ;
	SIZE 1,48,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwbu()
@ 10,10 GET OASetDerivadas ;
	PICTURE "@*HN OASetDerivadas - Carga de Propriedades Derivadas" ;
	SIZE 1,51,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwbv()
@ 13,10 GET OASetPropVT ;
	PICTURE "@*HN OASetPropVT - Set o Valor de uma Propriedade do Vetor" ;
	SIZE 1,55,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwch()
@ 14,10 GET OAGetPropVT ;
	PICTURE "@*HN OAGetPropVT - Get o Valor de uma Propriedade do Vetor" ;
	SIZE 1,55,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwcr()
@ 4,2 GET OAChk_Identidade ;
	PICTURE "@*HN OAChk_Identidade - Checagem de Identidade do Objeto" ;
	SIZE 1,53,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwd2()
@ 3,2 GET OAFind ;
	PICTURE "@*HN OAFind - Localiza Registro Com Base nas Propriedades" ;
	SIZE 1,54,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwdd()
@ 20,2 GET OAGetFieldValue ;
	PICTURE "@*HN OAGetFieldValue - Retorna o valor do Campo informado" ;
	SIZE 1,54,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwde()
@ 19,2 GET OA_Refresh ;
	PICTURE "@*HN OA_Refresh - Forca Atualiza놹o Objeto" ;
	SIZE 1,39,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwe1()
@ 24,2 SAY "*-------------------------------------------------------------------*" ;
	SIZE 1,69, 0
@ 26,2 GET OALerRegistro ;
	PICTURE "@*HN OALerRegistro - Le Registro e Carrega OBJ" ;
	SIZE 1,43,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwec()
@ 16,10 GET OAWriteProp ;
	PICTURE "@*HN OAWriteProp - Grava do Vetor para Base na Tabela" ;
	SIZE 1,50,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwem()
@ 27,2 GET OASalvarRegistro ;
	PICTURE "@*HN OASalvarRegistro - Salva Registro" ;
	SIZE 1,35,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwex()
@ 25,2 GET OAExiste ;
	PICTURE "@*HN OAExiste - Le Registro nao carrega o OBJ e Retorna se existe" ;
	SIZE 1,62,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwey()
@ 32,2 SAY "*-------------------------------------------------------------------*" ;
	SIZE 1,69, 0
@ 21,2 GET OAGetAlias ;
	PICTURE "@*HN OAGetAlias - Retorna Alias da area em que foi abertaa tabela" ;
	SIZE 1,62,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwfk()
@ 11,10 GET OASetConfig ;
	PICTURE "@*HN OASetConfig - Carga Propriedades de Configuracao/Parametros" ;
	SIZE 1,61,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwft()
@ 28,2 GET OABtnVal ;
	PICTURE "@*HN OABtnVal - Trata Comandos de navegacao" ;
	SIZE 1,40,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwg4()
@ 5,5 GET OATrtChave ;
	PICTURE "@*HN OATrtChave - Trata Acesso por Chave " ;
	SIZE 1,38,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwg5()
@ 29,2 GET OAView ;
	PICTURE "@*HN OAView - Visualisa BROWSE" ;
	SIZE 1,28,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwg6()
@ 30,5 GET OALOCATE ;
	PICTURE "@*HN OALOCATE - Apoio a CLView - Visualisa BROWSE" ;
	SIZE 1,46,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwh4()
@ 18,2 SAY "*-------------------------------------------------------------------*" ;
	SIZE 1,69, 0
@ 34,2 SAY "*-------------------------------------------------------------------*" ;
	SIZE 1,69, 0
@ 22,2 GET OAScatter ;
	PICTURE "@*HN OAScatter - Carrega Var de Memoria" ;
	SIZE 1,36,1 ;
	DEFAULT 1 ;
	VALID _2u30zmwhf()
@ 1,2 SAY "CLAS:V-1.0 => IMPLEMENTA NAVEGACAO E MANUTENCAO COMPLETA (BASE=CLIENTES)" ;
	SIZE 1,72, 0
@ 2,2 SAY "*---------------------------------------------------------------------*" ;
	SIZE 1,71, 0



READ


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMW9A           OAVerifyInst VALID                 
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:    2  
*        Variable:            OAVerifyInst                       
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmw9a     &&  OAVerifyInst VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION OAVerifyInst
	
PRIVATE LSpath
	=W_DEFPROC("rotinas.spr")
	LSpath = UPobterPath("ORC_ANEX")


	DO CASE

		CASE TYPE("PBOrc_AnexAlias") = "U" ;
		   		OR EMPTY(PBOrc_AnexAlias) ;
		   		OR !USED(PBOrc_AnexAlias)
			=OACreate()					

		CASE !("ORC_ANEX.DBF" $ DBF(PBOrc_AnexAlias))
				* APOS UM CLOSE DATABASE UM OUTRO DBF FOI
				* ABERTO NA AREA ANTES OCUPADA PELO DBF AVALIADO AKI
				RELEASE PBOrc_AnexAlias
			=OACreate()					


		CASE  !(LSPath $ DBF(PBOrc_AnexAlias))
			 	* HOUVE MUDANCA DE DIR BASE
			 	* ELIMINA INSTACIA DE OUTRA BASE
		     	* CRIA INSTANCIA NA NOVA BASE
			=OADestroi()				
			=OACreate()					
	ENDCASE

	
RETURN(.t.)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWB5           OACreate VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:    3  
*        Variable:            OACreate                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwb5     &&  OACreate VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION OACreate
	=W_DEFPROC("rotinas.spr")
	PRIVATE LSalias
	PRIVATE LSAlsTmp
    PRIVATE LMaxDim
	LSalias		= 	ALIAS()
	
	IF TYPE("PBOrc_AnexAlias") <> "U" ;
	   		AND !EMPTY(PBOrc_AnexAlias) ;
	   		AND USED(PBOrc_AnexAlias)
			RETURN(.T.)
	ENDIF


	PUBLIC PBOrc_AnexAlias

	IF USED("Orc_Anex")
	     =NetArqAgain("Orc_Anex")
	     PBOrc_AnexAlias     = Alias()
	ELSE
	     =NetArqAgain("Orc_Anex")
	     LSAlsTmp     = Alias()
	     =NetArqAgain("Orc_Anex")
	     PBOrc_AnexAlias     = Alias()
		 IF !EMPTY(LSAlsTmp) AND USED(LSAlsTmp)
			SELECT &LSAlsTmp
			USE
		 ENDIF
	ENDIF	

    SELE &PBOrc_AnexAlias
	LMaxDim = Fcount()
    PUBLIC DIMENSION VTOrc_Anex[LMaxDim]&& VETOR PARA CAMPOS DA TABELA
    PUBLIC DIMENSION VDOrc_Anex[2,3]	&& VETOR PARA CAMPOS DERIVADAS
    PUBLIC DIMENSION VFOrc_Anex[1]      && VETOR CABECALHO DOS CAMPOS
    PUBLIC DIMENSION VCOrc_Anex[8,3]	&& VETOR PARA CONFIGURACOES


	=AFIELDS(VFOrc_Anex)



	*-----------------------------------------------------------*
	=OAReadProperty()
	=OASetDerivadas()
	=OASetConfig()
	*--------------------------------------------------------------*
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
RETURN



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWBJ           OADestroi VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:    4  
*        Variable:            OADestroi                          
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwbj     &&  OADestroi VALID
#REGION 1
return
*---------------------------------------------------------------*


FUNCTION OADestroi

	=W_DEFPROC("rotinas.spr")

	IF TYPE("PBOrc_AnexAlias") = "U"
		RETURN
	ENDIF

    *--------------------------------------------------------------------*
	*-> QUANDO O SISTEMA APLICA UM CLOSE DATABASE :
	*   EX: EM UPAltDir (Geral.spr)
	*  1- Fecha inclusive a referencia do PBOrc_AnexAlias
	*  2- Novas tabelas abertas podem ocupar a area referenciada
	*     por PBOrc_AnexAlias
	*  3- Se aplicar um FECHAMENTO a PBOrc_AnexAlias estara fechando
	*     outra tabela
	*  4- Entao Verifica-se a coerencia do dbf esperado em PBOrc_AnexAlias
	*-------------------------------------------------------------------*
	IF !(USED(PBOrc_AnexAlias)) OR ;
	   !("ORC_ANEX.DBF" $ DBF(PBOrc_AnexAlias))

		RELEASE PBOrc_AnexAlias
    	RELEASE VTOrc_Anex
	    RELEASE VDOrc_Anex
		RELEASE VFOrc_Anex
		RELEASE VCOrc_Anex
		return(.T.)			
	ENDIF
	PRIVATE LSalias
	LSalias  = Alias()
	IF !EMPTY(PBOrc_AnexAlias) AND USED(PBOrc_AnexAlias)
		SELECT &PBOrc_AnexAlias
		USE
	ENDIF	
	RELEASE PBOrc_AnexAlias
    RELEASE VTOrc_Anex
    RELEASE VDOrc_Anex
	RELEASE VFOrc_Anex
	RELEASE VCOrc_Anex

	*-----------------------------------------------------------*
	*--------------------------------------------------------------*
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
RETURN(.T.)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWBU           OAReadProp VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:    5  
*        Variable:            OAReadProp                         
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwbu     &&  OAReadProp VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION OAReadProp
	PRIVATE LSalias
	LSalias		= 	ALIAS()


	SELE &PBOrc_AnexAlias
	SCATTER TO VTOrc_Anex
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
RETURN(.T.)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWBV           OASetDerivadas VALID               
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:    6  
*        Variable:            OASetDerivadas                     
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwbv     &&  OASetDerivadas VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION OASetDerivadas
	PRIVATE LSalias
	PRIVATE LEmpresa
	LSalias		= 	ALIAS()

	*--------------------------------------------------------------*
    VDOrc_Anex(1,1) = "NAOINFORMADO"	&& TITULO	
   	VDOrc_Anex(1,2) = 0					&& VALOR
   	VDOrc_Anex(1,3) = .F.				&& FLAG .T. => FOI CARREGADO
	*--------------------------------------------------------------*
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
RETURN(.T.)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWCH           OASetPropVT VALID                  
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:    7  
*        Variable:            OASetPropVT                        
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwch     &&  OASetPropVT VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION OASetPropVT
PARAMETER  PrmField, PrmValue
	PRIVATE Lvalue

	=W_DEFPROC("ROTINAS.SPR")
	Lvalue = RTsetValueObj(PrmField,;
							PrmValue,;
						    PBOrc_AnexAlias,;
						    VTOrc_Anex,;
						    VDOrc_Anex,;
						    VFOrc_Anex,;
						    VCOrc_Anex)

RETURN(Lvalue)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWCR           OAGetPropVT VALID                  
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:    8  
*        Variable:            OAGetPropVT                        
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      7                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwcr     &&  OAGetPropVT VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION OAGetPropVT
PARAMETER  PrmField

	PRIVATE Lvalue

	=W_DEFPROC("ROTINAS.SPR")
	Lvalue = RTgetValueObj(PrmField,;
	            PBOrc_AnexAlias,;
	            VTOrc_Anex,;
	            VDOrc_Anex,;
			    VFOrc_Anex,;
			    VCOrc_Anex)

RETURN(Lvalue)





*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWD2           OAChk_Identidade VALID             
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:    9  
*        Variable:            OAChk_Identidade                   
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      8                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwd2     &&  OAChk_Identidade VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*


FUNCTION OAChk_Identidade
PARAMETERS PrmEmpresa,PrmOrcamento
	PRIVATE LFretorno
	LFretorno = .t.

	=OAVerifyInst()

    =OASetPropVT("EMPRESA",PrmEmpresa)
    =OASetPropVT("ORCAMENTO",PrmOrcamento)

	LFretorno=OAFind()
RETURN(LFretorno)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWDD           OAFind VALID                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   10  
*        Variable:            OAFind                             
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      9                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwdd     &&  OAFind VALID
#REGION 1
return

*---------------------------------------------------------------*

FUNCTION OAFind


	PRIVATE LEmpresa,LOrcamento
	PRIVATE LFreturn

	PRIVATE LSalias
	LSalias		= 	ALIAS()

	=OAVerifyInst()


	SELE &PBOrc_AnexAlias

	LSchaveAcesso  =OAGetPropVT("CHAVE DE LEITURA")


	DO CASE
		CASE UPPER(LSchaveAcesso) = "ORCAMENTO"
			LEmpresa = OAgetPropVT("EMPRESA")
			LOrcamento = OAgetPropVT("ORCAMENTO")
			SET ORDER TO TAG ORCAMENTO
			SEEK STR(LEmpresa,3)+STR(LOrcamento,6)
		OTHERWISE
			LEmpresa = OAgetPropVT("EMPRESA")
			LOrcamento = OAgetPropVT("ORCAMENTO")
			SET ORDER TO TAG ORCAMENTO
			SEEK STR(LEmpresa,3)+STR(LOrcamento,6)
	ENDCASE


	IF FOUND()
		=OAReadProperty()
		=OASetDerivadas()
	    LFreturn = .T.
	ELSE
	    LFreturn = .f.
	ENDIF
	*--------------------------------------------------------------*
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF

RETURN(LFreturn)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWDE           OAGetFieldValue VALID              
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   11  
*        Variable:            OAGetFieldValue                    
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      10                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwde     &&  OAGetFieldValue VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION MNGetFieldValue
PARAMETERS PrmEmpresa,PrmOrcamento,PrmField

	=OAChk_Identidade(PrmEmpresa,PrmOrcamento)

RETURN(OAGetPropVT(PrmField))


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWE1           OA_Refresh VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   12  
*        Variable:            OA_Refresh                         
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      11                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwe1     &&  OA_Refresh VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*

FUNCTION OA_Refresh
PARAMETERS PrmEmpresa,PrmOrcamento
	PRIVATE LFretorno
	LFretorno = .t.

	=OAVerifyInst()

    =OASetPropVT("EMPRESA",PrmEmpresa)
    =OASetPropVT("ORCAMENTO",PrmOrcamento)

	LFretorno=OAFind()
RETURN(LFretorno)






*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWEC           OALerRegistro VALID                
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   14  
*        Variable:            OALerRegistro                      
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      12                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwec     &&  OALerRegistro VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*

FUNCTION OALerRegistro
PARAMETERS PrmEmpresa,PrmOrcamento

	PRIVATE LFretorno
	LFretorno = .t.

	LFretorno =OAChk_Identidade(PrmEmpresa,PrmOrcamento)

RETURN(LFretorno)




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWEM           OAWriteProp VALID                  
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   15  
*        Variable:            OAWriteProp                        
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      13                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwem     &&  OAWriteProp VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION OAWriteProp
	PRIVATE LSalias
	LSalias		= 	ALIAS()


	SELE &PBOrc_AnexAlias
	=RLOCK()
	GATHER FROM  VTOrc_Anex
	UNLOCK

	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF

RETURN(.T.)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWEX           OASalvarRegistro VALID             
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   16  
*        Variable:            OASalvarRegistro                   
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      14                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwex     &&  OASalvarRegistro VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*

FUNCTION OASalvarRegistro

	=OAVerifyInst()

	PRIVATE LFretorno
	LFretorno = .t.

	IF !OAExiste()
		SELE &PBOrc_AnexAlias
		APPEND BLANK
		LFretorno=OAWriteProp()
	ELSE
		SELE &PBOrc_AnexAlias
		LFretorno=OAWriteProp()
	ENDIF

RETURN(LFretorno)




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWEY           OAExiste VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   17  
*        Variable:            OAExiste                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      15                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwey     &&  OAExiste VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION OAExiste


	PRIVATE LEmpresa,LOrcamento
	PRIVATE LFreturn

	PRIVATE LSalias
	LSalias		= 	ALIAS()

	=OAVerifyInst()


	SELE &PBOrc_AnexAlias

	LSchaveAcesso  =OAGetPropVT("CHAVE DE LEITURA")


	DO CASE
		CASE UPPER(LSchaveAcesso) = "ORCAMENTO"
			LEmpresa = OAgetPropVT("EMPRESA")
			LOrcamento = OAgetPropVT("ORCAMENTO")
			SET ORDER TO TAG ORCAMENTO
			SEEK STR(LEmpresa,3)+STR(LOrcamento,6)
		OTHERWISE
			LEmpresa = OAgetPropVT("EMPRESA")
			LOrcamento = OAgetPropVT("ORCAMENTO")
			SET ORDER TO TAG ORCAMENTO
			SEEK STR(LEmpresa,3)+STR(LOrcamento,6)
	ENDCASE



	IF FOUND()
	    LFreturn = .T.
	ELSE
	    LFreturn = .f.
	ENDIF
	*--------------------------------------------------------------*
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF

RETURN(LFreturn)




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWFK           OAGetAlias VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   19  
*        Variable:            OAGetAlias                         
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      16                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwfk     &&  OAGetAlias VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION OAGetAlias

	=OAVerifyInst()

RETURN(PBOrc_AnexAlias)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWFT           OASetConfig VALID                  
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   20  
*        Variable:            OASetConfig                        
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      17                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwft     &&  OASetConfig VALID
#REGION 1
return
*---------------------------------------------------------------*

FUNCTION OASetConfig

	*--------------------------------------------------------------*
    VCOrc_Anex(1,1) = "REG_STATE" && INSERT/EDICAO/BROWSER/
   	VCOrc_Anex(1,2) = ""
   	VCOrc_Anex(1,3) = .T.
	*--------------------------------------------------------------*
    VCOrc_Anex(2,1) = "CHV_LER" && p/ leitura do ultimo reg + 1
   	VCOrc_Anex(2,2) = ""
   	VCOrc_Anex(2,3) = .T.
	*--------------------------------------------------------------*
    VCOrc_Anex(3,1) = "CHV_COMPARA" && p/ leitura do ultimo reg + 1
   	VCOrc_Anex(3,2) = ""
   	VCOrc_Anex(3,3) = .T.
	*--------------------------------------------------------------*
    VCOrc_Anex(4,1) = "CHV_BROW" && p/ leitura do ultimo reg + 1
   	VCOrc_Anex(4,2) = ""
   	VCOrc_Anex(4,3) = .T.
	*--------------------------------------------------------------*
    VCOrc_Anex(5,1) = "ISEDITING" && p/ leitura do ultimo reg + 1
   	VCOrc_Anex(5,2) = .F.
   	VCOrc_Anex(5,3) = .T.
	*--------------------------------------------------------------*
    VCOrc_Anex(6,1) = "ISADDING" && p/ leitura do ultimo reg + 1
   	VCOrc_Anex(6,2) = .F.
   	VCOrc_Anex(6,3) = .T.
	*--------------------------------------------------------------*
    VCOrc_Anex(7,1) = "ISREADING" && p/ leitura do ultimo reg + 1
   	VCOrc_Anex(7,2) = .F.
   	VCOrc_Anex(7,3) = .T.
	*--------------------------------------------------------------*
    VCOrc_Anex(8,1) = "CHAVE DE LEITURA" && TAG DO CHAVE USADA EM FIND
   	VCOrc_Anex(8,2) = "ORCAMENTO"
   	VCOrc_Anex(8,3) = .T.
	*--------------------------------------------------------------*
	
RETURN(.T.)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWG4           OABtnVal VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   21  
*        Variable:            OABtnVal                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      18                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwg4     &&  OABtnVal VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*

FUNCTION OABtnVal
PARAMETERS PrmTecla

	PRIVATE Lchv_Ler
	PRIVATE Lchv_Compara
	PRIVATE Lchv_Brow

	PRIVATE LEmpresa,LOrcamento


	=OAVerifyInst()

	Lchv_ler     = OAGetPropVT("CHV_LER")
	Lchv_compara = OAGetPropVT("CHV_COMPARA")
	Lchv_brow    = OAGetPropVT("CHV_BROW")

	
	SELE &PBOrc_AnexAlias
	DO CASE
	
		CASE PrmTecla = "LOCATE"
			LEmpresa    = OAGetPropVT("EMPRESA")
			LOrcamento  = OAgetPropVT("ORCAMENTO")

			=OAView(LEmpresa,LOrcamento)
			SELE &PBOrc_AnexAlias
			SCATTER MEMVAR MEMO

			
		OTHERWISE

		    DO btn_val with PrmTecla,;
	   			       Lchv_ler,;
	   			       Lchv_compara,;
	   			       Lchv_brow,;
	   			       .T.,;
	   			       .T.
	   			
	ENDCASE
	   			
	=OASetPropVT("ISEDITING",ISEDITING)
	=OASetPropVT("ISADDING",ISADDING)
	=OASetPropVT("ISREADING",ISREADING)
	   			
RETURN(.t.)




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWG5           OATrtChave VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   22  
*        Variable:            OATrtChave                         
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      19                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwg5     &&  OATrtChave VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*

FUNCTION OATrtChave
PARAMETERS PrmEmpresa,PrmOrcamento

	PRIVATE LFretorno
	LFretorno = .t.

	=OAVerifyInst()


    =OASetPropVT("EMPREASA",PrmEmpresa)
    =OASetPropVT("ORCAMENTO",PrmOrcamento)
	*--------------------------------------------------------------*

	LFretorno=OAFind()

	SELE &PBOrc_AnexAlias

RETURN(UPtratachv())





*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWG6           OAView VALID                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   23  
*        Variable:            OAView                             
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      20                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwg6     &&  OAView VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*

FUNCTION OAView


	&& CONSULTAR CLASSES DE MUNICIPIO QUANDO FOR DESENVOLVER

RETURN(.T.)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWH4           OALOCATE VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   24  
*        Variable:            OALOCATE                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      21                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwh4     &&  OALOCATE VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*


FUNCTION OALOCATE


	&& CONSULTAR CLASSES DE MUNICIPIO QUANDO FOR DESENVOLVER

RETURN(.T.)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _2U30ZMWHF           OAScatter VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ORC_ANEX,     Record Number:   27  
*        Variable:            OAScatter                          
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      22                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION _2u30zmwhf     &&  OAScatter VALID
#REGION 1
return
*---------------------------------------------------------------*
*------------------------ < ROT. APOIO >------------------------*
*---------------------------------------------------------------*

FUNCTION OAScatter

	PRIVATE LFretorno
	LFretorno = .t.

	=OAVerifyInst()
	SELE &PBOrc_AnexAlias
	SCATTER MEMVAR MEMO
RETURN(.T.)




