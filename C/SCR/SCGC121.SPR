*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 19/03/2009            SCGC121.SPR              11:42:56 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 2009 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є          SCGC121/MS-DOS Setup Code - SECTION 1          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
*~ WIZARDSCREEN

*---------------------------------------------------------------------*
* ARQUIVOS UTILIZADOS :                                               *
*              - FABRICA
* OBJETIVOS : CADASTRO DE  FABRICANTES
*	
*---------------------------------------------------------------------*
******>>>> INICIO CONTROLE AMBIENTAL

ON KEY LABEL ESCAPE

PRIVATE isediting,isadding,isreading
PRIVATE wp_record
PRIVATE isreadonly,is2table,wzalias
PRIVATE LS121areant
LS121areant	= ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

PRIVATE cidade,estado,regiao

m.wzalias	=	SELECT()
m.isediting	=	.F.
m.isadding	=	.F.
m.isreading	=	.F.

m.is2table 	= 	.F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
wp_ref_local =  .t.     && NAO POSSUI CONTROLE DE REFRESH LOCAL

LFcid121	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFban121	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFcli121	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFreg121	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA

******>>>> INICIO CONTROLE ARQUIVOS

*>> parametros repassados a btn_val

VLleitura = ""   && repassa chave de leitura p/ btn_val
VLlerfim  = ""   && p/ leitura do ultimo reg + 1
VLcompara = ""   && repassa chave de comparacao p/ btn_val
VLchvlimi = ""   && otimiza browse

IF !USED("clientes")
	LFcli121	= .T.
	IF ! NetUse("clientes")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("regiao")
	LFreg121	= .T.
	IF ! NetUse("regiao")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("cidbanc")
	LFcid121	= .T.
	IF ! NetUse("cidbanc")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("banco")
	LFban121	= .T.
	IF ! NetUse("banco")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

IF wp_flgfecha
	DO ULfecha
	RETURN
ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

IF NOT WEXIST("scgc121") ;
	OR UPPER(WTITLE("SCGC121")) == "SCGC121.PJX" ;
	OR UPPER(WTITLE("SCGC121")) == "SCGC121.SCX" ;
	OR UPPER(WTITLE("SCGC121")) == "SCGC121.MNX" ;
	OR UPPER(WTITLE("SCGC121")) == "SCGC121.PRG" ;
	OR UPPER(WTITLE("SCGC121")) == "SCGC121.FRX" ;
	OR UPPER(WTITLE("SCGC121")) == "SCGC121.QPR"
	DEFINE WINDOW scgc121 ;
		FROM 4, 8 ;
		TO 17,72 ;
		TITLE "[ CIDADES E BANCOS ]" ;
		FOOTER "[121]" ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("navega") ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.PJX" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.SCX" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.MNX" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.PRG" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.FRX" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.QPR"
	DEFINE WINDOW navega ;
		FROM 22, 0 ;
		TO 24,79 ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є          SCGC121/MS-DOS Setup Code - SECTION 2          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1

******>>>> INICIO CONTROLE LOCAL

DO CASE
	CASE !wp_flgfecha
		SELECT cidbanc
		SET ORDER TO TAG cidade
		SCATTER MEMVAR MEMO
		*-------------------------> criado pelo wizard
		m.wzalias=SELECT()
		m.isreadonly=IIF(ISREAD(),.T.,.F.)
		IF m.isreadonly
			WAIT WINDOW C_READONLY TIMEOUT 1
		ENDIF
		KEYBOARD "I"
ENDCASE







*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              SCGC121/MS-DOS Screen Layout               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("scgc121")
	ACTIVATE WINDOW scgc121 SAME
ELSE
	ACTIVATE WINDOW scgc121 NOSHOW
ENDIF
@ 7,17 TO 9,55 ;
	COLOR SCHEME 23
@ 7,42 SAY "[ Correcao ]" ;
	SIZE 1,12, 0
@ 0,0 TO 13,64 ;
	COLOR SCHEME 23
@ 7,17 TO 9,55 ;
	COLOR SCHEME 23
@ 9,18 TO 9,54 ;
	COLOR SCHEME 24
@ 9,55 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 8,55 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 7,55 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 8,47 SAY "-" ;
	SIZE 1,1, 0
@ 4,6 TO 6,44 ;
	COLOR SCHEME 23
@ 4,31 SAY "[ Correcao ]" ;
	SIZE 1,12, 0
@ 4,6 TO 6,44 ;
	COLOR SCHEME 23
@ 6,7 TO 6,43 ;
	COLOR SCHEME 24
@ 6,44 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,44 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,44 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,8 SAY "Bancos" ;
	SIZE 1,6, 0
@ 2,36 SAY "-" ;
	SIZE 1,1, 0
@ 7,19 SAY "Cidade/UF (correcao)" ;
	SIZE 1,20, 0
@ 1,2 TO 3,40 ;
	COLOR SCHEME 23
@ 1,2 TO 3,40 ;
	COLOR SCHEME 23
@ 3,3 TO 3,39 ;
	COLOR SCHEME 24
@ 3,40 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,40 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,40 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,4 SAY "Cidade/UF" ;
	SIZE 1,9, 0
@ 10,1 TO 12,33 ;
	COLOR SCHEME 24
@ 12,2 TO 12,32 ;
	COLOR SCHEME 23
@ 11,33 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,33 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,33 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,35 TO 12,63 ;
	COLOR SCHEME 24
@ 12,36 TO 12,62 ;
	COLOR SCHEME 23
@ 11,63 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,63 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,63 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 13,1 TO 13,63 ;
	COLOR SCHEME 24
@ 1,64 TO 12,64 ;
	COLOR SCHEME 24
@ 13,64 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,64 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,17 SAY "[ Cadastro de Cidades e Bancos]" ;
	SIZE 1,31, 0
@ 0,58 SAY "[121]" ;
	SIZE 1,5, 0
@ 4,50 TO 6,59 ;
	COLOR SCHEME 23
@ 4,51 SAY "Regiao" ;
	SIZE 1,6, 0
@ 5,59 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,59 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,59 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,51 TO 6,58 ;
	COLOR SCHEME 24
@ 2,4 GET m.cidade ;
	SIZE 1,32 ;
	DEFAULT " " ;
	WHEN _2lx0p3zl2() ;
	ERROR "Codigo ja cadastrado."
@ 2,37 GET m.estado ;
	SIZE 1,2 ;
	DEFAULT " " ;
	WHEN _2lx0p3zl6() ;
	VALID _2lx0p3zl8() ;
	ERROR "Codigo ja cadastrado."
@ 5,11 GET m.banco1 ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	WHEN isediting ;
	VALID _2lx0p3zlc()
@ 5,18 GET m.banco2 ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	WHEN isediting ;
	VALID _2lx0p3zlg()
@ 5,25 GET m.banco3 ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	WHEN isediting ;
	VALID _2lx0p3zlk()
@ 5,32 GET m.banco4 ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	WHEN isediting ;
	VALID _2lx0p3zlo()
@ 5,39 GET m.banco5 ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	WHEN isediting ;
	VALID _2lx0p3zlr()
@ 5,53 GET m.regiao ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN isediting ;
	VALID _2lx0p3zlv()
@ 8,20 GET m.cor_cidade ;
	SIZE 1,26 ;
	DEFAULT " " ;
	WHEN _2lx0p3zlw() ;
	ERROR "Codigo ja cadastrado."
@ 8,49 GET m.cor_estado ;
	SIZE 1,2 ;
	DEFAULT " " ;
	WHEN _2lx0p3zlx() ;
	VALID _2lx0p3zly() ;
	ERROR "Codigo ja cadastrado."
@ 11,2 GET m.gr_btn ;
	PICTURE "@*HN \<Gerar nova relacao de Cidades" ;
	SIZE 1,31,1 ;
	DEFAULT 1 ;
	VALID _2lx0p3zlz()
@ 11,40 GET m.cc_btn ;
	PICTURE "@*HN \<Correcao no Cadastro" ;
	SIZE 1,22,1 ;
	DEFAULT 1 ;
	VALID _2lx0p3zmc()




*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              OBJ_WNAV/MS-DOS Screen Layout              є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 2
IF WVISIBLE("navega")
	ACTIVATE WINDOW navega SAME
ELSE
	ACTIVATE WINDOW navega NOSHOW
ENDIF
@ 1,8 GET m.top_btn ;
	PICTURE "@*HN \<Inicio" ;
	SIZE 1,8,1 ;
	DEFAULT 1 ;
	VALID BTN_VAL1('TOP', VLleitura, Vlcompara) ;
	MESSAGE 'Primeiro registro'
@ 1,16 GET m.prev_btn ;
	PICTURE "@*HN \<Ant" ;
	SIZE 1,5,1 ;
	DEFAULT 1 ;
	VALID btn_val1('PREV', VLleitura, Vlcompara) ;
	MESSAGE 'Posiciona no registro anterior.' 	
@ 1,21 GET m.next_btn ;
	PICTURE "@*HN \<Proximo" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID btn_val1('NEXT', VLleitura, Vlcompara) ;
	MESSAGE 'Avanca para proximo registro'
@ 1,30 GET m.end_btn ;
	PICTURE "@*HN \<Fim" ;
	SIZE 1,5,1 ;
	DEFAULT 1 ;
	VALID btn_val1('END', VLlerfim, Vlcompara) ;
	MESSAGE 'Ultimo registro do arquivo' 																																													
@ 1,35 GET m.loc_btn ;
	PICTURE "@*HN \<Zoom" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID btn_val1('LOCATE', VLleitura, Vlcompara,VLchvlimi)		 ;
	MESSAGE 'Permite consulta visual ampliada a varios registros na tela'
@ 1,41 GET m.add_btn ;
	PICTURE "@*HN \<Lanca" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID btn_val1('ADD') ;
	MESSAGE 'Abre novo registro para lancamento de dados' 
@ 1,55 GET m.edit_btn ;
	PICTURE "@*HN \<Edit" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 1,61 GET m.del_btn ;
	PICTURE "@*HN \<Del" ;
	SIZE 1,5,1 ;
	DEFAULT 1 ;
	VALID btn_val1('DELETE', VLleitura, Vlcompara) ;
	MESSAGE 'Delete current record.'
@ 1,73 GET m.exit_btn ;
	PICTURE "@*HN \<Sair" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EXIT') ;
	MESSAGE 'Close screen.'
@ 1,48 GET m.cop_btn ;
	PICTURE "@*HN \<Copia" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID btn_val1('COPY') ;
	MESSAGE 'Abre novo registro sel limpar os dados do reg corrente' 
@ 1,1 GET m.busca_btn ;
	PICTURE "@*HN \<Busca" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID BTN_VAL1('BUSCA') ;
	MESSAGE 'Busca dirata pela chave do documento.'
@ 1,66 GET m.imp_btn ;
	PICTURE "@*HN i\<Mpr" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID btn_val1('PRINT') ;
	MESSAGE 'Close screen.'
@ 0,0 TO 2,79 DOUBLE ;
	COLOR SCHEME 24
@ 2,1 TO 2,78 DOUBLE ;
	COLOR SCHEME 23
@ 1,79 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 0,79 SAY "»" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 2,79 SAY "ј" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 1,79 SAY "є" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23

IF NOT WVISIBLE("navega")
	ACTIVATE WINDOW navega
ENDIF
IF NOT WVISIBLE("scgc121")
	ACTIVATE WINDOW scgc121
ENDIF



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є     MS-DOSREAD contains clauses from SCREEN scgc121     є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

READ CYCLE ;
	ACTIVATE READACT() ;
	DEACTIVATE READDEAC() ;
	NOLOCK

RELEASE WINDOW navega
RELEASE WINDOW scgc121

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є               SCGC121/MS-DOS Cleanup Code               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
RELEASE WINDOW SCGC121
IF !WEXIST('SCGC200')
   RELEASE WINDOW NAVEGA
ENDIF
DO ULfecha
************************************
POP KEY 			&& reabilita teclas de atalho def. anteriormente

RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є   SCGC121/MS-DOS Supporting Procedures and Functions    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
PROCEDURE ULfecha
	IF LFcid121		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("cidbanc")
	ENDIF
	IF LFreg121		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("regiao")
	ENDIF
	IF LFcli121		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("clientes")
	ENDIF
	IF LFban121		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("banco")
	ENDIF
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(LS121areant)
		SELECT &LS121areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
RETURN
***

PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	SELE cidbanc
	IF tecla = 'PRINT'
		wp_rel = "REL121"
	ENDIF
    DO btn_val with tecla, m.chv_ler, m.chv_compara, m.chv_brow
	SELE cidbanc

RETURN

PROCEDURE local_refresh
PARAMETERS wl_branco

   IF isediting OR wl_branco
      SHOW GET m.gr_btn   DISABLE
      SHOW GET m.cc_btn   DISABLE
  ENDIF
RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZL2           m.cidade WHEN                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   50   є
*       є Variable:            m.cidade                           є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zl2     &&  m.cidade WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting or isreading)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isadding or isreading)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZL6           m.estado WHEN                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   51   є
*       є Variable:            m.estado                           є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zl6     &&  m.estado WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting or isreading)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isadding or isreading)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZL8           m.estado VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   51   є
*       є Variable:            m.estado                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zl8     &&  m.estado VALID
#REGION 1
SELECT cidbanc
SET ORDER TO TAG cidade
IF LASTKEY() = 9
    ON KEY LABEL ESCAPE
	DO loc_dlog WITH .T.
    ON KEY LABEL ESCAPE DO BTN_VAL WITH 'DELETE'
	IF LASTKEY() <> 27
		m.estado = cidbanc.estado
		m.cidade = cidbanc.cidade
	ENDIF	
ENDIF	

SEEK m.estado+m.cidade

RETURN(UPtratachv())



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZLC           m.banco1 VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   52   є
*       є Variable:            m.banco1                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      4                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zlc     &&  m.banco1 VALID
#REGION 1
SELECT banco
SET ORDER TO TAG banco
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT cidbanc
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF m.banco1 = 0
	   SELECT cidbanc
		RETURN .t.
   ENDIF
   IF !SEEK(m.banco1)
	   SELECT cidbanc
		RETURN .F.
   ENDIF
ENDIF
SELECT cidbanc
m.banco1 	 = banco.banco
SHOW GET m.banco1
RETURN .T.


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZLG           m.banco2 VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   53   є
*       є Variable:            m.banco2                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      5                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zlg     &&  m.banco2 VALID
#REGION 1
SELECT banco
SET ORDER TO TAG banco
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT cidbanc
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF m.banco2 = 0
	   SELECT cidbanc
		RETURN .t.
   ENDIF
   IF !SEEK(m.banco2)
	   SELECT cidbanc
		RETURN .F.
   ENDIF
ENDIF
SELECT cidbanc
m.banco2 	 = banco.banco
SHOW GET m.banco2
RETURN .T.


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZLK           m.banco3 VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   54   є
*       є Variable:            m.banco3                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      6                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zlk     &&  m.banco3 VALID
#REGION 1
SELECT banco
SET ORDER TO TAG banco
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT cidbanc
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF m.banco3 = 0
	   SELECT cidbanc
		RETURN .t.
   ENDIF
   IF !SEEK(m.banco3)
	   SELECT cidbanc
		RETURN .F.
   ENDIF
ENDIF
SELECT cidbanc
m.banco3 	 = banco.banco
SHOW GET m.banco3
RETURN .T.


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZLO           m.banco4 VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   55   є
*       є Variable:            m.banco4                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      7                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zlo     &&  m.banco4 VALID
#REGION 1
SELECT banco
SET ORDER TO TAG banco
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT cidbanc
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF m.banco4 = 0
	   SELECT cidbanc
		RETURN .t.
   ENDIF
   IF !SEEK(m.banco4)
	   SELECT cidbanc
		RETURN .F.
   ENDIF
ENDIF
SELECT cidbanc
m.banco4 	 = banco.banco
SHOW GET m.banco4
RETURN .T.


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZLR           m.banco5 VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   56   є
*       є Variable:            m.banco5                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      8                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zlr     &&  m.banco5 VALID
#REGION 1
SELECT banco
SET ORDER TO TAG banco
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT cidbanc
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF m.banco5 = 0
	   SELECT cidbanc
		RETURN .t.
   ENDIF
   IF !SEEK(m.banco5)
	   SELECT cidbanc
		RETURN .F.
   ENDIF
ENDIF
SELECT cidbanc
m.banco5 	 = banco.banco
SHOW GET m.banco5
RETURN .T.


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZLV           m.regiao VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   57   є
*       є Variable:            m.regiao                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      9                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zlv     &&  m.regiao VALID
#REGION 1
SELECT regiao
SET ORDER TO TAG regiao
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT cidbanc
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF !SEEK(m.regiao)
	   SELECT cidbanc
		RETURN .F.
   ENDIF
ENDIF
SELECT cidbanc
m.regiao 	 = regiao.regiao
RETURN .T.


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZLW           m.cor_cidade WHEN                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   58   є
*       є Variable:            m.cor_cidade                       є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      10                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zlw     &&  m.cor_cidade WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting or isreading)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting or isreading)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZLX           m.cor_estado WHEN                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   59   є
*       є Variable:            m.cor_estado                       є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      11                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zlx     &&  m.cor_estado WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting or isreading)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting or isreading)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZLY           m.cor_estado VALID                 є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   59   є
*       є Variable:            m.cor_estado                       є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      12                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zly     &&  m.cor_estado VALID
#REGION 1
SELECT cidbanc
SET ORDER TO TAG cidade
IF LASTKEY() = 9
    ON KEY LABEL ESCAPE
	DO loc_dlog WITH .T.
    ON KEY LABEL ESCAPE DO BTN_VAL WITH 'DELETE'
	IF LASTKEY() <> 27
		m.estado = cidbanc.estado
		m.cidade = cidbanc.cidade
	ENDIF	
ENDIF	

SEEK m.estado+m.cidade

RETURN(UPtratachv())



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZLZ           m.gr_btn VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   60   є
*       є Variable:            m.gr_btn                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      13                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zlz     &&  m.gr_btn VALID
#REGION 1
SELE cidbanc
SET ORDER TO TAG cidade
SELE clientes
SET ORDER TO TAG cidade
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
*******************	
DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO

LFsegue = .t.
LNregistro = RECNO()
LNimpressao = RECCOUNT()
LNimpressos = 0
GO LNregistro
wp_msg = "Inserindo novas cidades na Relacao."
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
GO TOP
DO WHILE !EOF() AND LFsegue
	=UPtermo()
*** REGISTRO DA CIDADE DE LOCALIZACAO
	m.cidade = clientes.cidade
	m.estado = clientes.estado
	SELE cidbanc
	SEEK m.estado+m.cidade
	IF !FOUND()
		=edithand('SAVE')
	ENDIF

*** REGISTRO DA CIDADE DE COBRANCA
	m.cidade = clientes.cbcidade
	m.estado = clientes.cbestado
	SELE cidbanc
	SEEK m.estado+m.cidade
	IF !FOUND()
		=edithand('SAVE')
	ENDIF
	SELE clientes
	SKIP
ENDDO
***********
DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
wp_msg = ""
SELE cidbanc


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0P3ZMC           m.cc_btn VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC121,     Record Number:   61   є
*       є Variable:            m.cc_btn                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      14                                 є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0p3zmc     &&  m.cc_btn VALID
#REGION 1
SELE cidbanc
SET ORDER TO TAG cidade
SELE clientes
SET ORDER TO TAG nome
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
*******************	
DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO

LFsegue = .t.
LNregistro = RECNO()
LNimpressao = RECCOUNT()
LNimpressos = 0
GO LNregistro
wp_msg = "Processando Correcao de Cidades em Clientes."
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
GO TOP
DO WHILE !EOF() AND LFsegue
	=UPtermo()
****** CORRECAO DA CIDADE DE LOCALIZACAO
	m.cidade = clientes.cidade
	m.estado = clientes.estado
	SELE cidbanc
	SEEK m.estado+m.cidade
	IF FOUND()
		IF !EMPTY(cidbanc.cor_cidade)
			SELE clientes
			=REGLOCK()
			replace cidade with cidbanc.cor_cidade
			replace estado with cidbanc.cor_estado
		ENDIF
	ENDIF
****** CORRECAO DA CIDADE DE COBRANCA
	m.cidade = clientes.cbcidade
	m.estado = clientes.cbestado
	SELE cidbanc
	SEEK m.estado+m.cidade
	IF FOUND()
		IF !EMPTY(cidbanc.cor_cidade)
			SELE clientes
			=REGLOCK()
			replace cbcidade with cidbanc.cor_cidade
			replace cbestado with cidbanc.cor_estado
		ENDIF
	ENDIF
	SELE clientes
	SKIP
ENDDO
***********
DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
SELE cidbanc

DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
LFsegue = .t.
LNregistro = RECNO()
LNimpressao = RECCOUNT()
LNimpressos = 0
GO LNregistro
wp_msg = "Eliminando Nomes errados da Relacao de Cid."
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
GO TOP
DO WHILE !EOF() AND LFsegue
	=UPtermo()
	IF !EMPTY(cidbanc.cor_cidade)
		=REGLOCK()
		DELETE
	ENDIF
	SKIP
ENDDO
DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
wp_msg = ""
GO TOP
