*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º 19/03/2009            OCR0001.SPR              11:42:19 º
*       º                                                         º
*       ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
*       º                                                         º
*       º Author's Name                                           º
*       º                                                         º
*       º Copyright (c) 2009 Company Name                         º
*       º Address                                                 º
*       º City,     Zip                                           º
*       º                                                         º
*       º Description:                                            º
*       º This program was automatically generated by GENSCRN.    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½

PARAMETERS lsdup,lscodcli,lsnome,ldvenc,ldpgto,lnvlrdup,lnmulta,lnjuros,;
	lndiasatr,lnvlrmulta,lnvlrjuros,lnvlrdesp,lnvlrreceb,lnvlrliq,;
	lnvlrprot,lnvlroutd1,lnvlrabat,lnvlrdesc,lnvlrpgpar,;
	lnprincipal

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          OCR0001/MS-DOS Setup Code - SECTION 1          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
	*------------------------------------------------------------*
	* CLASSIFICACAO:  [*****]
	*------------------------------------------------------------*
	* OBJETIVO....: Informar o valor de
    *
	*               1 - dias de atraso
	*               2 - valor da multa
	*               3 - valor do juros
	*               4 - valor das despesas
	*               5 - valor de recebimento
	*               6 - valor liquido
    *
	*------------------------------------------------------------*
	* COMENTARIO..: A funcao permite calcular o valor do recebimento
	*               e das despesas de uma duplicata
	*------------------------------------------------------------*
	* OBS........ :
	*------------------------------------------------------------*
	*  TABELAS....:
	*------------------------------------------------------------*
	*  PARAMETROS..:
    *                LSDup      => numero da duplicata
    *                LSCodcli   => codigo do cliente
    *                LSNome     => nome do cliente
    *                LDVenc     => data de vencimento
    *                LDPgto     => data de pagamento
    *                LNVlrdup   => valor da duplicata
	*                LNVlrProt  => valor do protesto
    *                LNDiasatr  => dias de atraso      ( retorno )
    *                LNVlrmulta => valor da ulta       ( retorno )
    *                LNVlrjuros => valor do juros      ( retorno )
    *                LNVlrDesp  => valor das depesas   ( retorno )
    *                LNVlrReceb => valor do recebimento( retorno )
    *                LNVlrLiq   => valor liquido       ( retorno )
    *
	*------------------------------------------------------------*
	*  RETORNO.....:
	*  LNDiasatr,LNVlrmulta,LNVlrjuros,LNVlrDesp,LNVlrReceb,LNVlrLiq
	*------------------------------------------------------------*
	* EXEMPLO : DO ocr0001.spr WITH "000001-1","01001","cliente teste",;
	*           ctod("01/01/2000"),ctod("01/02/2000"),236.05,;
	*           0,0,0,0,0,0
	*------------------------------------------------------------*

*PRIVATE LNVlrDev  ,LNVlrabat ,LNVlrdev,LNVlrdesc,LNVlrpgpar

ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
ON KEY LABEL END DO OCRENCERRA

IF EMPT(LSDup)
   LSDup    = "XX"
ENDI
IF EMPT(LSCodcli)
   LSCodcli = "XX"
ENDI
IF EMPT(LSNome)
   LSNome   = "XX"
ENDI
IF EMPT(LDVenc)
   LDVenc   = CTOD("01/01/1980")
ENDI
IF EMPT(LDPgto)
   LDPgto   = CTOD("00/00/00")
ENDI
IF EMPT(LNVlrdup)
   LNVlrdup = 0
ENDI
IF EMPT(LNMULTA)
   LNMULTA = 0
ENDI
IF EMPT(LNJUROS)
   LNJUROS = 0
ENDI
set point to "."

LNDiasatr  = 0
LNDiasatr2 = 0
LNVlrDev   = 0
LNVlrdesc  = 0
LNVlrjuros = 0
LNVlrP     = 0

=w_defproc("EMPRESA.SPR")
LNmulta = EMGet_Mora(wp_empresa)*30


=CALCULO2()


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                MS-DOS Window definitions                º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

IF NOT WEXIST("ocr0001") ;
	OR UPPER(WTITLE("OCR0001")) == "OCR0001.PJX" ;
	OR UPPER(WTITLE("OCR0001")) == "OCR0001.SCX" ;
	OR UPPER(WTITLE("OCR0001")) == "OCR0001.MNX" ;
	OR UPPER(WTITLE("OCR0001")) == "OCR0001.PRG" ;
	OR UPPER(WTITLE("OCR0001")) == "OCR0001.FRX" ;
	OR UPPER(WTITLE("OCR0001")) == "OCR0001.QPR"
	DEFINE WINDOW ocr0001 ;
		FROM INT((SROW()-21)/2),INT((SCOL()-80)/2) ;
		TO INT((SROW()-21)/2)+20,INT((SCOL()-80)/2)+79 ;
		TITLE "[ COMPOSI€ÇO DO CREDITO ]" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		COLOR SCHEME 1
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              OCR0001/MS-DOS Screen Layout               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
IF WVISIBLE("ocr0001")
	ACTIVATE WINDOW ocr0001 SAME
ELSE
	ACTIVATE WINDOW ocr0001 NOSHOW
ENDIF
@ 2,41 SAY "-" ;
	SIZE 1,1, 0
@ 8,45 SAY "=" ;
	SIZE 1,1, 0
@ 10,45 SAY "=" ;
	SIZE 1,1, 0
@ 8,37 SAY "%" ;
	SIZE 1,1, 0
@ 10,37 SAY "*" ;
	SIZE 1,1, 0
@ 11,1 SAY "(+) Prot. e outras Desp.:" ;
	SIZE 1,25, 0
@ 13,1 SAY "(-) Devolucao...........:" ;
	SIZE 1,25, 0
@ 14,1 SAY "(-) Abatimento..........:" ;
	SIZE 1,25, 0
@ 15,1 SAY "(-) Desconto............:" ;
	SIZE 1,25, 0
@ 10,1 SAY "(+) Juros por dia atr...:" ;
	SIZE 1,25, 0
@ 8,5 SAY "Taxa Mˆs............:" ;
	SIZE 1,21, 0
@ 5,1 SAY "    Valor da Duplicata..:" ;
	SIZE 1,25, 0
@ 4,5 SAY "Dt. Pagamento.......:" ;
	SIZE 1,21, 0
@ 3,5 SAY "Dt. Vencimento......:" ;
	SIZE 1,21, 0
@ 2,5 SAY "Cliente.............:" ;
	SIZE 1,21, 0
@ 1,5 SAY "Duplicata...........:" ;
	SIZE 1,21, 0
@ 6,1 SAY "(-) Pagamento Parcial...:" ;
	SIZE 1,25, 0
@ 6,45 SAY "=" ;
	SIZE 1,1, 0
@ 4,48 SAY "Dias" ;
	SIZE 1,4, 0
@ 4,39 SAY "=>" ;
	SIZE 1,2, 0
@ 16,0 TO 18,77 ;
	COLOR SCHEME 24
@ 17,1 SAY "Pagando:" ;
	SIZE 1,8, 0
@ 12,40 SAY "(=) Valor Bruto a Receber:" ;
	SIZE 1,26, 0
@ 13,40 SAY "(+) Juros-Outras Despesas:" ;
	SIZE 1,26, 0
@ 15,40 SAY "(=) Liquido a Receber....:" ;
	SIZE 1,26, 0
@ 7,64 TO 9,76 ;
	COLOR SCHEME 24
@ 7,65 TO 7,75 ;
	COLOR SCHEME 23
@ 18,77 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 16,77 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,77 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 1,27 SAY LSDup ;
	SIZE 1,9
@ 2,27 SAY LSCodcli ;
	SIZE 1,14
@ 2,42 SAY LSNome ;
	SIZE 1,36
@ 3,27 GET LDVenc ;
	SIZE 1,11 ;
	DEFAULT 0 ;
	VALID _2lx0p36y2()
@ 4,27 GET LDPgto ;
	SIZE 1,11 ;
	DEFAULT 0 ;
	VALID _2lx0p36y6()
@ 4,42 SAY LNDiasAtr ;
	SIZE 1,5
@ 5,29 GET LNVlrDup ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	PICTURE "999,999.99" ;
	VALID _2lx0p36y9()
@ 6,29 GET LNVlrpgPar ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	PICTURE "999,999.99" ;
	WHEN .F. ;
	VALID _2lx0p36yc()
@ 6,47 GET LNVlrP ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	PICTURE "999,999.99" ;
	WHEN .F.
@ 8,33 GET LNMulta ;
	SIZE 1,5 ;
	DEFAULT 0 ;
	PICTURE "99.99" ;
	VALID _2lx0p36yu()
@ 8,47 GET LNVLRMULTA ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	PICTURE "999,999.99" ;
	WHEN .F.
@ 10,29 GET LNJuros ;
	SIZE 1,9 ;
	DEFAULT 0 ;
	PICTURE "99,999.99" ;
	VALID _2lx0p36yw()
@ 10,39 GET LNDiasAtr2 ;
	SIZE 1,5 ;
	DEFAULT 0 ;
	WHEN .F.
@ 10,47 GET LNVlrJuros ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	PICTURE "999,999.99" ;
	WHEN .F.
@ 11,29 GET LNVlroutD1 ;
	SIZE 1,9 ;
	DEFAULT 0 ;
	PICTURE "99,999.99" ;
	VALID _2lx0p36z0()
@ 12,67 GET LNVlrReceb ;
	SIZE 1,9 ;
	DEFAULT 0 ;
	PICTURE "99,999.99" ;
	DISABLE
@ 13,29 GET LNVlrDev ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	PICTURE "999,999.99" ;
	VALID _2lx0p36z2()
@ 13,67 GET LNVlrDesp ;
	SIZE 1,9 ;
	DEFAULT 0 ;
	PICTURE "99,999.99" ;
	DISABLE
@ 14,29 GET LNVlrAbat ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	PICTURE "999,999.99" ;
	VALID _2lx0p36z6()
@ 15,29 GET LNVlrDesc ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	PICTURE "999,999.99" ;
	VALID _2lx0p36z8()
@ 15,67 GET LNVlrLiq ;
	SIZE 1,9 ;
	DEFAULT 0 ;
	PICTURE "99,999.99" ;
	DISABLE
@ 17,9 GET LNPagando ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	PICTURE "999,999.99" ;
	VALID _2lx0p36zb()
@ 17,40 GET LNPrincipal ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	PICTURE "999,999.99" ;
	WHEN .F.
@ 4,72 GET m.mov_btn ;
	PICTURE "@*HN \<Mvt" ;
	SIZE 1,5,1 ;
	DEFAULT 1 ;
	VALID _2lx0p36ze() ;
	DISABLE ;
	MESSAGE 'Busca dirata pela chave do documento.'
@ 0,55 SAY "Tecle <END> para Sair." ;
	SIZE 1,22, 0
@ 18,1 SAY "* Pagando deve ser a soma do Pg.Parcial + o Vlr quitado no momento" ;
	SIZE 1,66, 0 ;
	COLOR SCHEME 24
@ 17,20 SAY "->valor principal =" ;
	SIZE 1,19, 0
@ 17,62 GET LNJurosParc ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	PICTURE "999,999.99" ;
	WHEN .F.
@ 17,51 SAY "-->Juros =" ;
	SIZE 1,10, 0

IF NOT WVISIBLE("ocr0001")
	ACTIVATE WINDOW ocr0001
ENDIF

READ CYCLE ;
	SHOW _2lx0p36zj()

RELEASE WINDOW ocr0001

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º               OCR0001/MS-DOS Cleanup Code               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1

RETURN



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º   OCR0001/MS-DOS Supporting Procedures and Functions    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
PROCEDURE OCRENCERRA
	ON KEY LABEL END
	ON KEY LABEL ESCAPE
	KEYBOARD "{ESCAPE}"
RETURN


PROC CALCULO2
	IF EMPT(LDPGTO) OR EMPT(LDVENC)
	   LNDiasatr  = 0
  	ELSE
	   LNDiasatr  = LDPGTO - LDVENC
	ENDI

	LNVlrmulta = ((LNVlrdup - LNVlrpgpar) * LNMulta)/100
	LNjuros    = (LNVlrmulta/30)
	LNVlrjuros = LNjuros * LNDiasatr

	LNVlrDesp  = LNVlrjuros + LNVlroutD1


	LNVlrDesp  = LNVlrjuros + LNVlroutD1
	LNVlrReceb = LNVlrdup   -             LNVlrdev - LNVlrabat  - ;
			 LNVlrDesc - LNVlrpgpar
	LNVlrLiq   = LNVlrdup   + LNVlrdesp - LNVlrdev - LNVlrabat  - ;
             LNVlrDesc  - LNVlrpgpar

	LNDiasatr2 = LNDiasatr
	LNVlrP	   = LNVlrdup - LNVlrpgpar

	show get LNVlrdup
	show get LNVlrP
	show get LNMulta
	show get LNjuros
	show get LNDiasatr
	show get LNDiasatr2
	show get LNVlrmulta
	show get LNVlrjuros

	show get LNVlrProt
	show get LNVlroutD1

	show get LNVlrDesp
	show get LNVlrReceb
	show get LNVlrLiq

RETURN

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36Y2           LDVenc VALID                       º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001,     Record Number:   35   º
*       º Variable:            LDVenc                             º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      1                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0p36y2     &&  LDVenc VALID
#REGION 1
=CALCULO2()

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36Y6           LDPgto VALID                       º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001,     Record Number:   36   º
*       º Variable:            LDPgto                             º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      2                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0p36y6     &&  LDPgto VALID
#REGION 1
=CALCULO2()

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36Y9           LNVlrDup VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001,     Record Number:   38   º
*       º Variable:            LNVlrDup                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      3                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0p36y9     &&  LNVlrDup VALID
#REGION 1
=CALCULO2()

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36YC           LNVlrpgPar VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001,     Record Number:   39   º
*       º Variable:            LNVlrpgPar                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      4                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0p36yc     &&  LNVlrpgPar VALID
#REGION 1
=CALCULO2()

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36YU           LNMulta VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001,     Record Number:   41   º
*       º Variable:            LNMulta                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      5                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0p36yu     &&  LNMulta VALID
#REGION 1
=CALCULO2()

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36YW           LNJuros VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001,     Record Number:   43   º
*       º Variable:            LNJuros                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      6                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0p36yw     &&  LNJuros VALID
#REGION 1
=CALCULO2()

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36Z0           LNVlroutD1 VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001,     Record Number:   46   º
*       º Variable:            LNVlroutD1                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      7                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0p36z0     &&  LNVlroutD1 VALID
#REGION 1
=CALCULO2()

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36Z2           LNVlrDev VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001,     Record Number:   48   º
*       º Variable:            LNVlrDev                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      8                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0p36z2     &&  LNVlrDev VALID
#REGION 1
=CALCULO2()

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36Z6           LNVlrAbat VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001,     Record Number:   50   º
*       º Variable:            LNVlrAbat                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      9                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0p36z6     &&  LNVlrAbat VALID
#REGION 1
=CALCULO2()

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36Z8           LNVlrDesc VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001,     Record Number:   51   º
*       º Variable:            LNVlrDesc                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      10                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0p36z8     &&  LNVlrDesc VALID
#REGION 1
=CALCULO2()

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36ZB           LNPagando VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001,     Record Number:   53   º
*       º Variable:            LNPagando                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      11                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _2lx0p36zb     &&  LNPagando VALID
#REGION 1
	=W_DEFPROC("duplicat.spr")

	LNPrincipal = CRNv_VlrDup(LNVlrDup, LNpagando,LDPgto,LDVenc,;
							LNMulta,LNVlroutD1,LNVlrDesc,;
							LNVlrAbat,LNVlrDev,LNVlrpgPar)

	show get LNPrincipal
	


	private LNDiasatr, LNVlrmulta, LNjuros
	IF EMPT(LDPgto) OR EMPT(LDVenc)
	   LNDiasatr  = 0
	  ELSE
	   LNDiasatr  = LDPgto - LDVenc
	ENDI

	LNVlrmulta= LNPrincipal * LNMulta  / 100
	LNjuros   = (LNVlrmulta/30)
	LNJurosParc   = LNjuros * LNDiasatr
	show get LNJurosParc

	
return(.t.)		


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36ZE           m.mov_btn VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001,     Record Number:   55   º
*       º Variable:            m.mov_btn                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      12                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0p36ze     &&  m.mov_btn VALID
#REGION 1
PRIVATE VLtela, LNregant

LNregant = RECNO()
**
ACTIVATE WINDOW OCR0001
SAVE SCREEN TO VLtela
**
DEACTIVATE WINDOW OCR0001
HIDE WINDOW ALL
do obj_finc.spr WITH m.duplicata

**
ACTIVATE WINDOW OCR0001
RESTORE SCREEN FROM VLtela
SHOW WINDOW OCR0001

=BTN_VAL1('ATUALIZA', VLleitura, Vlcompara)
RETURN

			


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0P36ZJ           Read Level Show                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OCR0001                            º
*       º Called By:           READ Statement                     º
*       º Snippet Number:      13                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0p36zj     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: OCR0001
*
#REGION 1
IF SYS(2016) = "OCR0001" OR SYS(2016) = "*"
	ACTIVATE WINDOW ocr0001 SAME
	@ 4,42 SAY LNDiasAtr ;
		SIZE 1,5, 0
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF