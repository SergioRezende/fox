*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º 12/01/09             SCGC518.SPR               11:18:30 º
*       º                                                         º
*       ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
*       º                                                         º
*       º Author's Name                                           º
*       º                                                         º
*       º Copyright (c) 2009 Company Name                         º
*       º Address                                                 º
*       º City,     Zip                                           º
*       º                                                         º
*       º Description:                                            º
*       º This program was automatically generated by GENSCRN.    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC518/MS-DOS Setup Code - SECTION 1          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
*---------------------------------------------------------------*
* OPERA ARQUIVOS :
*			DUPLICAT
*           BANCO
* OBJETIVO:	IMPRIMIR  VENCIDOS E A VENCER POR PORTADOR
*	
*---------------------------------------------------------------*

******>>>> INICIO CONTROLE AMBIENTAL

ON KEY LABEL ESCAPE

PRIVATE isediting,isadding,isreading
PRIVATE wp_record
PRIVATE isreadonly,is2table,wzalias
PRIVATE LS518areant
LS518areant = ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.wzalias	=	SELECT()
m.isediting	=	.F.
m.isadding	=	.F.
m.isreading=	.F.
m.is2table 	= 	.F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
wp_ref_local =  .f.     && NAO POSSUI CONTROLE DE REFRESH LOCAL

wl_arqtmp = ""
m.dt_inicio= wp_dtoper
m.titulo = " POSICAO DE CARTEIRA "+DTOC(m.dt_inicio)
LS_filtro = " "
m.vcdos_de = 0
m.vcdos_a  = 9999
m.vcer_de  = 0
m.vcer_a   = 9999
m.nome_reg = " "

m.dt_emiini = {}
m.dt_emifim = {12.12.9999}

m.dt_vcini = {}
m.dt_vcfim = {12.12.9999}


LFrescfo	= .f.       && AUTORIZA OU NAO EMI. RESUMO POR CFO
LFresuf		= .f.       && AUTORIZA OU NAO EMI. RESUMO POR UF

LFtab518	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFtb2518	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFban518	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFdup518	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFreg518	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFcli518	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFemp518	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFret518	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA

******>>>> INICIO CONTROLE ARQUIVOS


IF !USED("regiao")
	LFreg518	= .T.
	IF ! NetUse("regiao")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("clientes")
	LFcli518	= .T.
	IF ! NetUse("clientes")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("tab002")
	LFtb2518	= .T.
	IF ! NetUse("tab002")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("tab001")
	LFtab518	= .T.
	IF ! NetUse("tab001")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("banco")
	LFban518	= .T.
	IF ! NetUse("banco")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("empresa")
	LFemp518	= .T.
	IF ! NetUse("empresa")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("retornmv")
	LFret518	= .T.
	IF ! NetUse("retornmv")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("duplicat")
	LFdup518	= .T.
	IF ! NetUse("duplicat")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
***************
wl_arqtmp = ""
LNtmp     = 65		&& TABELA ASCII A = 65
IF !UPabretmp("dpl")
	wp_flgfecha = .t.
ENDIF
***********

IF wp_flgfecha
	DO ULfecha
	RETURN
ENDIF

SET SAFET OFF
LStmp = "&wp_dirtmp"+"&wl_arqtmp"
SELE duplicat
COPY STRU TO &LStmp
SELE 0
USE "&wp_dirtmp"+"&wl_arqtmp" exclu
SELE duplicat

LStmpant = LStmp  && mantem o nome do arquivo temporario p/ outra geracao


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                MS-DOS Window definitions                º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

IF NOT WEXIST("scgc518") ;
	OR UPPER(WTITLE("SCGC518")) == "SCGC518.PJX" ;
	OR UPPER(WTITLE("SCGC518")) == "SCGC518.SCX" ;
	OR UPPER(WTITLE("SCGC518")) == "SCGC518.MNX" ;
	OR UPPER(WTITLE("SCGC518")) == "SCGC518.PRG" ;
	OR UPPER(WTITLE("SCGC518")) == "SCGC518.FRX" ;
	OR UPPER(WTITLE("SCGC518")) == "SCGC518.QPR"
	DEFINE WINDOW scgc518 ;
		FROM INT((SROW()-24)/2),INT((SCOL()-78)/2) ;
		TO INT((SROW()-24)/2)+23,INT((SCOL()-78)/2)+77 ;
		TITLE "[ Posicao de Carteira ]" ;
		FOOTER "[ 518 ]" ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC518/MS-DOS Setup Code - SECTION 2          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1

******>>>> INICIO CONTROLE LOCAL
SELE banco
SET ORDER TO TAG banco
SELE regiao
SET ORDER TO TAG regiao


SELECT duplicat
SCATTER MEMVAR MEMO
*-------------------------> criado pelo wizard
m.wzalias=SELECT()
m.isreadonly=IIF(ISREAD(),.T.,.F.)
SELECT empresa
SET ORDER TO TAG empresa
SEEK wp_empresa
m.empresa   = empresa.empresa
m.nome_emp  = empresa.nome
m.inscricao = empresa.inscricao
SHOW GET m.empresa
SHOW GET m.nome_emp
SELECT duplicat



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC518/MS-DOS Screen Layout               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
IF WVISIBLE("scgc518")
	ACTIVATE WINDOW scgc518 SAME
ELSE
	ACTIVATE WINDOW scgc518 NOSHOW
ENDIF
@ 4,9 SAY "-" ;
	SIZE 1,1, 0
@ 15,0 TO 15,77
@ 6,45 SAY "-" ;
	SIZE 1,1, 0
@ 6,62 SAY "-" ;
	SIZE 1,1, 0
@ 6,29 SAY "-" ;
	SIZE 1,1, 0
@ 11,26 SAY "Vencidas a mais" ;
	SIZE 1,15, 0
@ 5,41 SAY "Portador:" ;
	SIZE 1,9, 0
@ 5,25 SAY "Regiao:" ;
	SIZE 1,7, 0
@ 12,67 SAY "dias" ;
	SIZE 1,4, 0
@ 11,41 SAY " de" ;
	SIZE 1,3, 0
@ 12,1 SAY "igual a" ;
	SIZE 1,7, 0
@ 4,0 TO 4,75
@ 13,0 TO 13,77
@ 1,1 TO 3,44 ;
	COLOR SCHEME 23
@ 3,2 TO 3,43 ;
	COLOR SCHEME 24
@ 3,44 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,44 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,44 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,3 SAY "[Filial]" ;
	SIZE 1,8, 0
@ 2,6 SAY "-" ;
	SIZE 1,1, 0
@ 0,0 TO 23,77 ;
	COLOR SCHEME 23
@ 23,1 TO 23,76 ;
	COLOR SCHEME 24
@ 23,77 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,77 TO 22,77 ;
	COLOR SCHEME 24
@ 0,77 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,48 TO 3,73 ;
	COLOR SCHEME 23
@ 3,49 TO 3,72 ;
	COLOR SCHEME 24
@ 3,73 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,73 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,73 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,50 SAY "[Cobranca na data de] " ;
	SIZE 1,22, 0
@ 11,1 SAY "Debito maior ou" ;
	SIZE 1,15, 0
@ 11,59 SAY "A vencer ate" ;
	SIZE 1,12, 0
@ 12,42 SAY "dias" ;
	SIZE 1,4, 0
@ 0,71 SAY "[518]" ;
	SIZE 1,5, 0
@ 0,27 SAY "[ Posicao de Carteira ]" ;
	SIZE 1,23, 0
@ 4,17 SAY "[  Filtrar Duplicatas que Apresentem ...  ]" ;
	SIZE 1,43, 0
@ 6,12 SAY "e" ;
	SIZE 1,1, 0
@ 5,1 SAY "Emitidas  entre" ;
	SIZE 1,15, 0
@ 5,60 SAY "Natureza.:" ;
	SIZE 1,10, 0
@ 7,26 SAY "999=todas Reg." ;
	SIZE 1,14, 0 ;
	COLOR SCHEME 24
@ 9,12 SAY "e" ;
	SIZE 1,1, 0
@ 8,1 SAY "Com Vencimento Entre" ;
	SIZE 1,20, 0
@ 2,3 GET m.empresa ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN _2t20o8jwr() ;
	VALID _2t20o8jws()
@ 2,7 GET m.nome_emp ;
	SIZE 1,37 ;
	DEFAULT " " ;
	WHEN _2t20o8jxg()
@ 2,57 GET m.dt_inicio ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _2t20o8jxp() ;
	VALID _2t20o8jxy()
@ 6,1 GET m.dt_emiini ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _2t20o8jy7() ;
	VALID _2t20o8jyf()
@ 6,14 GET m.dt_emifim ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _2t20o8jyg() ;
	VALID _2t20o8jyy()
@ 6,26 GET m.regiao ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN isediting ;
	VALID _2t20o8jz7()
@ 6,30 GET m.filnom_reg ;
	SIZE 1,10 ;
	DEFAULT " " ;
	WHEN .f.
@ 6,42 GET m.portador ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN isediting ;
	VALID _2t20o8jz8()
@ 6,46 GET m.filnom_port ;
	SIZE 1,12 ;
	DEFAULT " " ;
	WHEN .f.
@ 6,61 GET m.natu ;
	SIZE 1,1 ;
	DEFAULT 0 ;
	PICTURE "9" ;
	WHEN isediting ;
	VALID _2t20o8jz9()
@ 6,63 GET m.filnom_natu ;
	SIZE 1,13 ;
	DEFAULT " " ;
	WHEN .f.
@ 9,1 GET m.dt_vcini ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _2t20o8jza() ;
	VALID _2t20o8jzj()
@ 9,14 GET m.dt_vcfim ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _2t20o8k1b() ;
	VALID _2t20o8k1c()
@ 12,9 GET m.vlr_doc ;
	SIZE 1,12 ;
	DEFAULT 0 ;
	PICTURE "9,999,999.99" ;
	WHEN isediting
@ 12,37 GET m.vcdos_de ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting
@ 12,62 GET m.vcer_de ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting
@ 14,20 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 14,45 GET m.canc_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _2t20o8k1d()
@ 16,1 GET m.impA_btn ;
	PICTURE "@*HN \<A-Resumo Geral" ;
	SIZE 1,16,1 ;
	DEFAULT 1 ;
	VALID _2t20o8k1e()
@ 17,5 GET m.impB_btn ;
	PICTURE "@*HN \<B-Por Regiao, Port. e Nat." ;
	SIZE 1,28,1 ;
	DEFAULT 1 ;
	VALID _2t20o8k1f()
@ 17,41 GET m.impH_btn ;
	PICTURE "@*HN \<H-Rel.de Dupl. Por Regiao ao Mes" ;
	SIZE 1,34,1 ;
	DEFAULT 1 ;
	VALID _2t20o8k2n()
@ 18,5 GET m.impC_btn ;
	PICTURE "@*HN \<C-Por Portador e Nat." ;
	SIZE 1,23,1 ;
	DEFAULT 1 ;
	VALID _2t20o8k2x()
@ 18,41 GET m.impI_btn ;
	PICTURE "@*HN \<I-Analitico" ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	VALID _2t20o8k2y()
@ 19,5 GET m.impD_btn ;
	PICTURE "@*HN \<D-Por Natureza" ;
	SIZE 1,16,1 ;
	DEFAULT 1 ;
	VALID _2t20o8k2z()
@ 19,41 GET m.impJ_btn ;
	PICTURE "@*HN \<J-Res./Portador" ;
	SIZE 1,17,1 ;
	DEFAULT 1 ;
	VALID _2t20o8k30()
@ 20,1 GET m.impE_btn ;
	PICTURE "@*HN \<E-Resumo" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _2t20o8k31()
@ 20,41 GET m.impK_btn ;
	PICTURE "@*HN \<K-PROTOCOLO DE CAIXA" ;
	SIZE 1,22,1 ;
	DEFAULT 1 ;
	VALID _2t20o8k4e()
@ 21,1 GET m.impF_btn ;
	PICTURE "@*HN \<F-Rel.Clientes e Debito - Analitico" ;
	SIZE 1,37,1 ;
	DEFAULT 1 ;
	VALID _2t20o8k4f()
@ 22,1 GET m.impG_btn ;
	PICTURE "@*HN \<G-Rel.Clientes e Debito - Sintetico" ;
	SIZE 1,37,1 ;
	DEFAULT 1 ;
	VALID _2t20o8k4g()
@ 7,43 SAY "999=todos" ;
	SIZE 1,9, 0 ;
	COLOR SCHEME 24
@ 7,61 SAY "9=todas" ;
	SIZE 1,7, 0 ;
	COLOR SCHEME 24

IF NOT WVISIBLE("scgc518")
	ACTIVATE WINDOW scgc518
ENDIF

READ CYCLE ;
	ACTIVATE READACT() ;
	DEACTIVATE READDEAC()

RELEASE WINDOW scgc518

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º               SCGC518/MS-DOS Cleanup Code               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
SELECT &wl_arqtmp
USE

do ULfecha
RETURN



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º   SCGC518/MS-DOS Supporting Procedures and Functions    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
PROCEDURE ULfecha
	IF LFreg518  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("regiao")
	ENDIF
	IF LFcli518  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("clientes")
	ENDIF
	IF LFtab518  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("tab001")
	ENDIF
	IF LFtb2518  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("tab002")
	ENDIF
	IF LFdup518  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("duplicat")
	ENDIF
	IF LFban518  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("banco")
	ENDIF
	IF LFemp518  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	IF LFret518  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("retornmv")
	ENDIF
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(LS518areant)
		SELECT &LS518areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
RETURN


PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow

	LN_prxobj = _CUROBJ
	SHOW GET m.empresa
	SHOW GET nome_emp
    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.impA_btn DISABLE
			SHOW GET m.impB_btn DISABLE
			SHOW GET m.impC_btn DISABLE
			SHOW GET m.impD_btn DISABLE
			SHOW GET m.impE_btn DISABLE
			SHOW GET m.impF_btn DISABLE
			SHOW GET m.impG_btn DISABLE
			SHOW GET m.impH_btn DISABLE
			SHOW GET m.impI_btn DISABLE
			SHOW GET m.impJ_btn DISABLE
			SHOW GET m.impK_btn DISABLE
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.impA_btn ENABLE
			SHOW GET m.impB_btn ENABLE
			SHOW GET m.impC_btn ENABLE
			SHOW GET m.impD_btn ENABLE
			SHOW GET m.impE_btn ENABLE
			SHOW GET m.impF_btn ENABLE
			SHOW GET m.impG_btn ENABLE
			SHOW GET m.impH_btn ENABLE
			SHOW GET m.impI_btn ENABLE
			SHOW GET m.impJ_btn ENABLE
			SHOW GET m.impK_btn ENABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
**** SELECAO
			LS_filtro = " AND "
			IF m.regiao <> 999
				LS_filtro = LS_filtro +" m.regiao = duplicat.regiao AND "
			ENDIF
			
			IF m.portador <> 999
				LS_filtro = LS_filtro+" m.portador = duplicat.portador AND "
			ENDIF
			IF m.natu <> 9
				LS_filtro = LS_filtro +" m.natu = duplicat.natu AND "
			ENDIF
*********
			LS_filtro = LS_filtro +" duplicat.dt_emi >= m.dt_emiini AND "
			LS_filtro = LS_filtro +" duplicat.dt_emi <= m.dt_emifim  AND "
**********
			LS_filtro = LS_filtro +" duplicat.dt_venc >= m.dt_vcini AND "
			LS_filtro = LS_filtro +" duplicat.dt_venc <= m.dt_vcfim  AND "
**********
			IF m.vlr_doc > 0 && p/ SELECIONAR DBITOS SUPERIORES A ????
							 && NAO CONSIDERAR CLIENTES DE CARTÇO
							 && CLIENTE = 0
				LS_filtro = LS_filtro +" duplicat.cliente > 0  AND "
			ENDIF
*********
			IF ((m.vcdos_de + m.vcer_de) <> 0) OR m.vcdos_a <> 9999 or ;
				m.vcer_a <> 9999
				LS_filtro = LS_filtro + ;			
	    	   "(	((dt_venc - m.dt_inicio) <= (m.vcdos_de * -1)) AND ;
					 ((dt_venc - m.dt_inicio) >= (m.vcdos_a  * -1) )    ;
					OR ;
					((dt_venc - m.dt_inicio) >= (m.vcer_de)) AND ;
					 ((dt_venc - m.dt_inicio) <= (m.vcer_a ) )    ;
	            )  AND "
			ENDIF
***********
			LS_filtro = SUBS(LS_filtro,1,LEN(LS_filtro) - 4)
***********
			DO ULgertmp
		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.impA_btn ENABLE
			SHOW GET m.impB_btn ENABLE
			SHOW GET m.impC_btn ENABLE
			SHOW GET m.impD_btn ENABLE
			SHOW GET m.impE_btn ENABLE
			SHOW GET m.impF_btn ENABLE
			SHOW GET m.impG_btn ENABLE
			SHOW GET m.impH_btn ENABLE
			SHOW GET m.impI_btn ENABLE
			SHOW GET m.impJ_btn ENABLE
			SHOW GET m.impK_btn ENABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN

PROCEDURE ULgertmp
	m.titulo = "SINTETICO GERAL.  COM BASE EM "+DTOC(m.dt_inicio)

	LStmp = LStmpant && restaura o nome do arquivo temp. p/ outra geracao

	SHOW GET m.titulo
	SELECT duplicat
	SET ORDER TO TAG r_dtbaixa
*----------------------------------------------------------------------|
*<<<<<<<    O INDICE CONDICIONAL  ORGANIZA O ARQUIVO EM   >>>>>>>>>>   |
***********************************************************************
*                                                                      |
*STR(EMPRESA,3)+IIF(EMPTY(DT_BAIXA),DTOS(CTOD("31.12.2999")),DTOS(DT_BAIXA))
*                                                                      |
*                     |------------------------------------------------|
*                     |      VENCIDAS OU A VENCER NA DATA DE REF       |
*                     |                   =                            |
*                     |      DUPLICATAS EM ABERTO NA DATA DE REF       |
*                     |                                                |
*  |------------------|--------------*****|----------------------------|
*     BAIXADAS ANTES /|\ BAIXADAS DEPOIS  |     NAO BAIXADAS           |
*       (DT_BAIXA)    |   (DT_BAIXA)      |     (31.12.2999)           |
*                     |                   V                            |
*                     |            (faixa de nao baixadas emitidas     |
*                  (SEEK)             depois da data de referencia)    |
***********************************************************************

	SET NEAR ON
	SEEK STR(m.empresa,3)+DTOS(m.dt_inicio+1)
	SET NEAR OFF
	IF EOF() OR m.empresa <> duplicat.empresa
		APPEND BLANK
	ENDIF
	IF EOF() OR m.empresa <> duplicat.empresa
			SHOW GET m.impA_btn DISABLE
			SHOW GET m.impB_btn DISABLE
			SHOW GET m.impC_btn DISABLE
			SHOW GET m.impD_btn DISABLE
			SHOW GET m.impE_btn DISABLE
			SHOW GET m.impF_btn DISABLE
			SHOW GET m.impG_btn DISABLE
			SHOW GET m.impH_btn DISABLE
			SHOW GET m.impI_btn DISABLE
			SHOW GET m.impJ_btn DISABLE
			SHOW GET m.impK_btn DISABLE
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
 		SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		
************************>
	SELE duplicat
	WAIT WINDOW "AGUARDE. Gerando Arq. Temporario." NOWAIT
	SELECT &wl_arqtmp
	USE
	SELE duplicat

	COPY TO &LStmp ;
   	     FOR  (m.dt_inicio <= duplicat.dt_baixa  OR ;
   	     		 EMPTY(duplicat.dt_baixa))      AND ;
   	     		 duplicat.dt_emi <= m.dt_inicio &LS_filtro ;
	        	 WHILE duplicat.empresa   = m.empresa


	SELE 0
	USE "&wp_dirtmp"+"&wl_arqtmp" exclu
    INDEX ON STR(CLIENTE,14) TAG portador ;
   			 ADDITIVE
   	SET ORDER TO TAG portador

****** ELIMINAR REGISTRO DE DEBITO INFERIORES A M.VLR_DOC
*	IF m.vlr_doc > 0
*		GO TOP
*		*-----------------------------------------------------*
*
*		LNctr = 0
*		DO WHILE !EOF()
*			LNctr = LNctr + 1
*			WAIT WINDOW STR(LNctr,6) NOWAIT
*			LNrant = RECNO()			
*			LNcliant = cliente
*			LNsoma  = 0
*			DO WHILE !EOF() AND LNcliant = cliente
*			   IF dt_baixa >= m.dt_inicio
*			   		LNsoma = LNsoma + vlr_doc
*			   ELSE		
*			   		LNsoma = LNsoma + vlr_doc -  abatimento - ;
*			   						  desconto - vlr_pgto
*			   ENDIF			
*			   SKIP
*			ENDDO
*			IF LNsoma < m.vlr_doc
*				GO LNrant
*				DO WHILE !EOF() AND LNcliant = cliente
*					DELETE
*					SKIP
*				ENDDO
*			ENDIF
*		ENDDO
*		WAIT WINDOW " OK ! " NOWAIT
*	ENDIF
	SELECT &wl_arqtmp

	KEYBOARD CHR(4)
RETURN


FUNCTION UL_LREG && leitura da regiao de referencia da dup
	parameter LSreg
	LSareant = ALIAS()
	SELECT regiao
	LSregant = RECNO()
	SET ORDER TO TAG regiao
	SEEK LSreg
	m.nome_reg = descricao
	GO LSregant
	SELE &LSareant
RETURN(LSreg)

*--------------------------------------------------------------------*
*            ROTINA QUE APURA O SALDO NA DATA ESPECIFICADA
*--------------------------------------------------------------------*

FUNCTION ULantsld_dup
	PRIVATE LNvlr
	=W_DEFPROC("DUPLICAT.SPR")
	LNvlr = CRsld_dup(&wl_arqtmp .DUPLICATA,m.dt_inicio,;
			 &wl_arqtmp .dt_emi,&wl_arqtmp .DT_BAIXA, &wl_arqtmp .vlr_doc )
RETURN(LNvlr)

FUNCTION EXULsld_dup

PARAMETERS PrmDUPLICATA, Prmdt_inicio,;
		   Prmdt_emi, PrmDT_BAIXA, Prmvlr_doc
	PRIVATE LNvlr
*	=W_DEFPROC("DUPLICAT.SPR")
	LNvlr =	 CRsld_dup(PrmDUPLICATA, Prmdt_inicio,;
					   Prmdt_emi, PrmDT_BAIXA, Prmvlr_doc)

RETURN(LNvlr)

FUNCTION ULsld_dup

PARAMETERS  LNdup, LDt_Refer, LDt_emidp ,LDt_BXdup, LNvlrdup
	PRIVATE LSalias
	PRIVATE LNsaldo
	PRIVATE LFretornmv

	LSalias			= ALIAS()
	=W_DEFPROC("rotinas.spr")

	IF LDt_emidp > LDt_Refer && DUP. EMIT APOS A DATA DE CONSULTA
		RETURN(0)
	ENDIF

	IF !EMPTY(LDt_BXdup) ;
		AND LDt_BXdup <= LDt_Refer && DUP. BAIXADA ANTES DA DATA DE CONSULTA
			RETURN(0)
	ENDIF


	LFretornmv		= NetArq("retornmv")
	IF (LFretornmv) > 100000 && HOUVE FALHA DE ABERTURA
		=UP_fecha("retornmv" ,LFretornmv)
		IF !EMPTY(LSalias) AND USED(LSalias)
			SELECT &LSalias
		ENDIF
		RETURN(0)
	ENDIF
	*-------------------------------------------------------------*
	LNsaldo  	=   LNvlrdup
	*-------------------------------------------------------------*
	* BAIXAR VALORES DE PGTO => (EFEITO = 2,3,4,5)
	*						2-PGTO TOTAL
	*						3-PGTO PARCIAL
	*						4-DEVOLUCAO
	*						5-INCOBRAVEL
	*-------------------------------------------------------------*
	SELE retornmv
	SET ORDER TO TAG doc_ocor
	SET NEAR ON
	SEEK STR(LNdup,9) 	
	SET NEAR OFF
	DO WHILE !EOF() AND LNdup = retornmv.duplicata
		IF  retornmv.efeito < 2 OR retornmv.status <> "PR"
			SKIP
			LOOP
		ENDIF
		************** JUROS EM PGTO PARCIAL ***************
		* NO CASO DE PGTO PARCIAL COM PARTE TRANSFORMADA EM
		* JUROS, ESTE JUROS NAO PODE SER ABATIDO DO SALDO DA
		* DUPLICATA => COMO JA HOUVE A SUBTRACAO DO JUROS
		* QUANDO  SUBTRAIU O PAGO PARCIAL QUE ESTA INCLUINDO
		* O JUROS E FEITA A COMPENSSACAO AGORA AO SOMAR O
		* JUROS
		***************************************************
		IF retornmv.dtprocesso <= LDt_Refer
			 LNsaldo = LNsaldo - retornmv.vlr_pgto+;
			 				retornmv.JUROS + retornmv.MORA			
		ENDIF
		SKIP
	ENDDO
	=UP_fecha("retornmv" ,LFretornmv)
	IF !EMPTY(LSalias) AND USED(LSalias)
		SELECT &LSalias
	ENDIF
RETURN(LNsaldo)

********************************************************************

PROCEDURE ULrel518C

    SELECT &wl_arqtmp
    INDEX ON STR(EMPRESA,3) + STR(REGIAO,3) + STR(PORTADOR,3) ;
    		+ STR(NATU,2)	+ DTOS(DT_BAIXA) TAG portador ;
   			 ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF() AND BOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
 		SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		


*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SELE tab001
	SET ORDER TO TAG codigo
	SELE banco
	SET ORDER TO TAG banco
	SELECT &wl_arqtmp
	SET RELATION TO &wl_arqtmp .portador INTO banco ADDITIVE
	SET RELATION TO 'NTZ'+;
			CHRTRAN(STR(&wl_arqtmp .natu,1)," ","0") ;
						INTO tab001 ADDITIVE
	LF_fim  = .f.
    LSrel = "REL518C"      && relatorio padrao
    LSorienta = " FOR LFsegue "
	DO UPimpressao WITH 	LFLdireciona, LFLagrega, LFLfimagrega
	LFcontinua = LFsegue
************
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
RETURN

*************************************************************

PROCEDURE ULrel518B
    SELECT &wl_arqtmp
    INDEX ON STR(EMPRESA,3)+STR(PORTADOR,3)+STR(NATU,2);
			+DTOS(DT_BAIXA) TAG portador ;
   			 ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF() AND BOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
 		SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SELE tab001
	SET ORDER TO TAG codigo
	SELE banco
	SET ORDER TO TAG banco
	SELECT &wl_arqtmp
	SET RELATION TO &wl_arqtmp .portador INTO banco ADDITIVE
	SET RELATION TO 'NTZ'+;
			CHRTRAN(STR(&wl_arqtmp .natu,1)," ","0") ;
						INTO tab001 ADDITIVE
	LF_fim  = .f.
    LSrel = "REL518B"      && relatorio padrao
    LSorienta = " FOR LFsegue "
	DO UPimpressao WITH 	LFLdireciona, LFLagrega, LFLfimagrega
	LFcontinua = LFsegue
************
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
RETURN

PROCEDURE ULrel518A
    SELECT &wl_arqtmp
    INDEX ON STR(EMPRESA,3)+STR(NATU,2);
			+DTOS(DT_BAIXA) TAG portador ;
   			 ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF() AND BOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
 		SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SELE tab001
	SET ORDER TO TAG codigo
	SELE banco
	SET ORDER TO TAG banco
	SELECT &wl_arqtmp
	SET RELATION TO &wl_arqtmp .portador INTO banco
	SET RELATION TO 'NTZ'+;
			CHRTRAN(STR(&wl_arqtmp .natu,1)," ","0") ;
						INTO tab001 ADDITIVE
	LF_fim  = .f.
    LSrel = "REL518A"      && relatorio padrao
    LSorienta = " FOR LFsegue "
	DO UPimpressao WITH 	LFLdireciona, LFLagrega, LFLfimagrega
	LFcontinua = LFsegue
************
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
RETURN


PROCEDURE ULrel518K
    PRIVATE LSL1,LSL2,LSL3,LSL4,LSVAR
    SELECT &wl_arqtmp
    INDEX ON STR(EMPRESA,3)+STR(NATU,2);
			+DTOS(DT_BAIXA) TAG portador ;
   			 ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF() AND BOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
 		SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		
    LSL1  = " SELECT "+wl_arqtmp+".EMPRESA,"+wl_arqtmp+".duplicata,"+;
                       wl_arqtmp+".dt_venc,"+wl_arqtmp+".vlr_doc,"+;
                       wl_arqtmp+".cliente,"+wl_arqtmp+".nome "
    LSL2  = " FROM   "+wl_arqtmp
    LSL3  = " WHERE  "
    LSL4  = " INTO CURSOR C_REL518K"
    LSVAR = LSL1+LSL2+LSL4
    &LSVAR

*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue     = .t.
	LNregistro  = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	LF_fim  = .f.
    LSrel = "REL518K"      && relatorio padrao
    LSorienta = " FOR LFsegue "
	DO UPimpressao WITH 	LFLdireciona, LFLagrega, LFLfimagrega
	LFcontinua = LFsegue
************
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JWR           m.empresa WHEN                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   45   º
*       º Variable:            m.empresa                          º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      1                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jwr     &&  m.empresa WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JWS           m.empresa VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   45   º
*       º Variable:            m.empresa                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      2                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jws     &&  m.empresa VALID
#REGION 1
SELECT empresa
SET ORDER TO TAG empresa
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .F.
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT empresa
		RETURN .F.
	ENDIF
ELSE
	IF !SEEK(m.empresa)
		SELECT empresa
		RETURN .F.
	ENDIF
ENDIF
m.empresa   = empresa
m.nome_emp  = empresa.nome
m.inscricao = empresa.inscricao
SHOW GET m.empresa
SHOW GET m.nome_emp
SELECT empresa
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JXG           m.nome_emp WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   46   º
*       º Variable:            m.nome_emp                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      3                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jxg     &&  m.nome_emp WHEN
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(.f.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JXP           m.dt_inicio WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   47   º
*       º Variable:            m.dt_inicio                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      4                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jxp     &&  m.dt_inicio WHEN
#REGION 1
IF isediting
	ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ENDIF
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JXY           m.dt_inicio VALID                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   47   º
*       º Variable:            m.dt_inicio                        º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      5                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jxy     &&  m.dt_inicio VALID
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN (.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JY7           m.dt_emiini WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   48   º
*       º Variable:            m.dt_emiini                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      6                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jy7     &&  m.dt_emiini WHEN
#REGION 1
IF isediting
	ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ENDIF
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JYF           m.dt_emiini VALID                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   48   º
*       º Variable:            m.dt_emiini                        º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      7                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jyf     &&  m.dt_emiini VALID
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN (.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JYG           m.dt_emifim WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   49   º
*       º Variable:            m.dt_emifim                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      8                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jyg     &&  m.dt_emifim WHEN
#REGION 1
IF isediting
	ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ENDIF
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JYY           m.dt_emifim VALID                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   49   º
*       º Variable:            m.dt_emifim                        º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      9                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jyy     &&  m.dt_emifim VALID
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN (.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JZ7           m.regiao VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   50   º
*       º Variable:            m.regiao                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      10                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jz7     &&  m.regiao VALID
#REGION 1
SELECT regiao
SET ORDER TO TAG regiao
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT duplicat
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF m.regiao = 999
		m.filnom_reg = "Todas"
		SHOW GET m.regiao
		SHOW GET m.filnom_reg
		RETURN .T.
   ENDIF
   IF m.regiao = 0
		m.filnom_reg = "Sem Regiao"
		SHOW GET m.regiao
		SHOW GET m.filnom_reg
		RETURN .T.
   ENDIF
   IF !SEEK(m.regiao)
   		SELECT duplicat
		RETURN .F.
   ENDIF
ENDIF
SELECT duplicat
m.regiao 	 = regiao.regiao
m.filnom_reg   = regiao.descricao
SHOW GET m.regiao
SHOW GET m.filnom_reg

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JZ8           m.portador VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   52   º
*       º Variable:            m.portador                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      11                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jz8     &&  m.portador VALID
#REGION 1
SELECT banco
SET ORDER TO TAG banco
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT duplicat
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF m.portador = 999
		m.filnom_port = "Todos"
		SHOW GET m.portador
		SHOW GET m.filnom_port
		RETURN .T.
   ENDIF
   IF !SEEK(m.portador)
   		SELECT duplicat
		RETURN .F.
   ENDIF
ENDIF
SELECT duplicat
m.portador 	 = banco.banco
m.filnom_port  = banco.nome
SHOW GET m.portador
SHOW GET m.filnom_port
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JZ9           m.natu VALID                       º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   54   º
*       º Variable:            m.natu                             º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      12                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jz9     &&  m.natu VALID
#REGION 1
SELECT tab001
SET ORDER TO TAG codigo
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .t.,.F.,"'NTZ'"
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT duplicat
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF m.natu = 9
		m.filnom_natu = "Todas"
		SHOW GET m.natu
		SHOW GET m.filnom_natu
		RETURN .T.
   ENDIF
   IF !SEEK('NTZ'+CHRTRAN(STR(m.natu,1)," ","0"))
   		SELECT duplicat
		RETURN .F.
   ENDIF
ENDIF
SELECT duplicat
m.natu = INT(VAL(tab001.codigo))
m.filnom_natu = tab001.descricao
SHOW GET m.natu
SHOW GET m.filnom_natu
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JZA           m.dt_vcini WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   56   º
*       º Variable:            m.dt_vcini                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      13                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jza     &&  m.dt_vcini WHEN
#REGION 1
IF isediting
	ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ENDIF
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8JZJ           m.dt_vcini VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   56   º
*       º Variable:            m.dt_vcini                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      14                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8jzj     &&  m.dt_vcini VALID
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN (.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K1B           m.dt_vcfim WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   57   º
*       º Variable:            m.dt_vcfim                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      15                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8k1b     &&  m.dt_vcfim WHEN
#REGION 1
IF isediting
	ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ENDIF
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K1C           m.dt_vcfim VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   57   º
*       º Variable:            m.dt_vcfim                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      16                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8k1c     &&  m.dt_vcfim VALID
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN (.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K1D           m.canc_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   62   º
*       º Variable:            m.canc_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      17                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8k1d     &&  m.canc_btn VALID
#REGION 1
CLEAR GETS
CLEAR READ
isediting = .f.
RETURN .T.

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K1E           m.impA_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   63   º
*       º Variable:            m.impA_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      18                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
***************************
FUNCTION _2t20o8k1e     &&  m.impA_btn VALID
#REGION 1
	LFLdireciona  = .F. && Ativa PRTSETUP para direcionar impressao DEF(.T.)
	LFLagrega 	  = .T. && Agrega o ??.REL em ??.AGR			    DEF(.F.)
	LFLfimagrega  = .F. && Qdo. Estiver agregando => encerra        DEF(.F.)
**********************************************************************
	LFcontinua = .t.  			&& CAPTURA O VALOR DE LFsegue



	LNpagina = 1

	DO ULrel518C

	LFLdireciona  = .T. && Nao Ativa PRTSETUP para direcionar imp.DEF(.F.)

	IF LFcontinua = .t.  			&& CAPTURA O VALOR DE LFsegue
		LNpagina = LNpagina + _PAGENO - 1    && DAR SEQU.AO N. PAGINA
		DO ULrel518B
	ENDIF

	LFLdireciona  = .T. && Nao Ativa PRTSETUP para direcionar imp.DEF(.F.)
	LFLfimagrega  = .T. && Qdo. Estiver agregando => encerra        DEF(.F.)

	IF LFcontinua = .t.  			&& CAPTURA O VALOR DE LFsegue
		LNpagina = LNpagina + _PAGENO - 1    && DAR SEQU.AO N. PAGINA
		DO ULrel518A
	ENDIF
*-----------------------------
	SHOW WINDOW SCGC518 TOP
    SELE DUPLICAT


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K1F           m.impB_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   64   º
*       º Variable:            m.impB_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      19                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
***************************
FUNCTION _2t20o8k1f     &&  m.impB_btn VALID
#REGION 1
LFLdireciona  = .F. && Ativa PRTSETUP para direcionar impressao DEF(.T.)
LFLagrega 	  = .T. && Agrega o ??.REL em ??.AGR			    DEF(.F.)
LFLfimagrega  = .F. && Qdo. Estiver agregando => encerra        DEF(.F.)
**********************************************************************

LFLfimagrega  = .T. && Qdo. Estiver agregando => encerra        DEF(.F.)

LFcontinua = .t.  			&& CAPTURA O VALOR DE LFsegue

LNpagina = 1
DO ULrel518C
*-----------------------------
SHOW WINDOW SCGC518 TOP
SELE DUPLICAT


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K2N           m.impH_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   65   º
*       º Variable:            m.impH_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      20                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8k2n     &&  m.impH_btn VALID
#REGION 1
    SELECT &wl_arqtmp
    INDEX ON STR(YEAR(DT_VENC),4) + STR(MONTH(DT_VENC),2)+STR(regiao,3)+ ;
    			STR(DAY(DT_VENC),2)	 TAG portador  ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF() AND BOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
 		SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
***************************
	SELE banco
	SET ORDER TO TAG banco
	SELE clientes
	SET ORDER TO TAG cliente
	SELECT &wl_arqtmp
	SET RELATION TO cliente INTO clientes
	SET RELATION TO &wl_arqtmp .portador INTO banco ADDITIVE

*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	

	LF_fim  = .f.
    LSrel = "REL518D"      && relatorio padrao
    LSorienta = " FOR LFsegue "

	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
	SET RELATION TO
*-----------------------------
	SHOW WINDOW SCGC518 TOP
    SELE DUPLICAT


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K2X           m.impC_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   66   º
*       º Variable:            m.impC_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      21                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
***************************
FUNCTION _2t20o8k2x     &&  m.impC_btn VALID
#REGION 1
LFLdireciona  = .F. && Ativa PRTSETUP para direcionar impressao DEF(.T.)
LFLagrega 	  = .T. && Agrega o ??.REL em ??.AGR			    DEF(.F.)
LFLfimagrega  = .F. && Qdo. Estiver agregando => encerra        DEF(.F.)
**********************************************************************

LFLfimagrega  = .T. && Qdo. Estiver agregando => encerra        DEF(.F.)

LFcontinua = .t.  			&& CAPTURA O VALOR DE LFsegue
LNpagina = 1
DO ULrel518B
*-----------------------------
SHOW WINDOW SCGC518 TOP
SELE DUPLICAT


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K2Y           m.impI_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   67   º
*       º Variable:            m.impI_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      22                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8k2y     &&  m.impI_btn VALID
#REGION 1
	SET ORDER TO TAG portador
    SELECT &wl_arqtmp
    INDEX ON STR(EMPRESA,3)+STR(PORTADOR,3)+DTOS(DT_VENC) TAG portador ;
   			 ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF() AND BOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
 		SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
***************************
	SELE tab001
	SET ORDER TO TAG codigo
	SELE banco
	SET ORDER TO TAG banco
	SELE clientes
	SET ORDER TO TAG cliente
	SELECT &wl_arqtmp

	SET RELATION TO cliente INTO clientes
	SET RELATION TO &wl_arqtmp .portador INTO banco ADDITIVE
	SET RELATION TO 'NTZ'+;
			CHRTRAN(STR(&wl_arqtmp .natu,1)," ","0") ;
						INTO tab001 ADDITIVE
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	

	LF_fim  = .f.
    LSrel = "REL518"      && relatorio padrao
    LSorienta = " FOR LFsegue "

	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
	SET RELATION TO
*-----------------------------
	SHOW WINDOW SCGC518 TOP
    SELE DUPLICAT


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K2Z           m.impD_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   68   º
*       º Variable:            m.impD_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      23                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
***************************
FUNCTION _2t20o8k2z     &&  m.impD_btn VALID
#REGION 1
LFLdireciona  = .F. && Ativa PRTSETUP para direcionar impressao DEF(.T.)
LFLagrega 	  = .T. && Agrega o ??.REL em ??.AGR			    DEF(.F.)
LFLfimagrega  = .F. && Qdo. Estiver agregando => encerra        DEF(.F.)
**********************************************************************

LFLfimagrega  = .T. && Qdo. Estiver agregando => encerra        DEF(.F.)


LFcontinua = .t.  			&& CAPTURA O VALOR DE LFsegue
LNpagina = 1
DO ULrel518A
*-----------------------------
SHOW WINDOW SCGC518 TOP
SELE DUPLICAT


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K30           m.impJ_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   69   º
*       º Variable:            m.impJ_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      24                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8k30     &&  m.impJ_btn VALID
#REGION 1
    SELECT &wl_arqtmp
    INDEX ON STR(EMPRESA,3)+STR(PORTADOR,3)+DTOS(DT_VENC) TAG portador ;
   			 ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF() AND BOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
 		SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
***************************
***************************
	SELE tab001
	SET ORDER TO TAG codigo
	SELE banco
	SET ORDER TO TAG banco
	SELE clientes
	SET ORDER TO TAG cliente
	SELECT &wl_arqtmp

	SET RELATION TO cliente INTO clientes
	SET RELATION TO &wl_arqtmp .portador INTO banco ADDITIVE
	SET RELATION TO 'NTZ'+;
			CHRTRAN(STR(&wl_arqtmp .natu,1)," ","0") ;
						INTO tab001 ADDITIVE
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	

	LF_fim  = .f.
    LSrel = "REL517"      && relatorio padrao
    LSorienta = " FOR LFsegue "

	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
	SET RELATION TO
*-----------------------------
	SHOW WINDOW SCGC518 TOP
    SELE DUPLICAT


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K31           m.impE_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   70   º
*       º Variable:            m.impE_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      25                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2t20o8k31     &&  m.impE_btn VALID
#REGION 1
    SELECT &wl_arqtmp
    INDEX ON STR(EMPRESA,3)+STR(PORTADOR,3)+DTOS(DT_BAIXA) TAG portador ;
   			 ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF() AND BOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
	    SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
	LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
***************************
	SELECT &wl_arqtmp
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	

	LF_fim  = .f.
    LSrel = "REL518E"      && relatorio padrao
    LSorienta = " FOR LFsegue "

	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
	SHOW WINDOW SCGC518 TOP
    SELE DUPLICAT


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K4E           m.impK_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   71   º
*       º Variable:            m.impK_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      26                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
***************************
FUNCTION _2t20o8k4e     &&  m.impK_btn VALID
#REGION 1
LFLdireciona  = .F. && Ativa PRTSETUP para direcionar impressao DEF(.T.)
LFLagrega 	  = .T. && Agrega o ??.REL em ??.AGR			    DEF(.F.)
LFLfimagrega  = .F. && Qdo. Estiver agregando => encerra        DEF(.F.)
**********************************************************************

LFLfimagrega  = .T. && Qdo. Estiver agregando => encerra        DEF(.F.)

LFcontinua = .t.  			&& CAPTURA O VALOR DE LFsegue

LNpagina = 1
DO ULrel518K
*-----------------------------
SHOW WINDOW SCGC518 TOP
SELE DUPLICAT


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K4F           m.impF_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   72   º
*       º Variable:            m.impF_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      27                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
*-----------------------------
FUNCTION _2t20o8k4f     &&  m.impF_btn VALID
#REGION 1
	DO CRclAnalitico
	SHOW WINDOW SCGC518 TOP
    SELE DUPLICAT
RETURN	

PROCEDURE CRclAnalitico


	SELECT &wl_arqtmp
	
	* Seleciona Clieantes com Debito total acima do solicitado

	SELECT CLIENTE,  sum(ULsld_dup(DUPLICATA,m.dt_inicio,;
			         dt_emi,DT_BAIXA, vlr_doc )) AS SALDO_CL ;
	FROM &wl_arqtmp ;
	GROUP BY cliente ;
	HAVING SALDO_CL > m.vlr_doc;
	ORDER BY SALDO_CL ;
	INTO CURSOR CRSTMP1


	* Seleciona Duplicatas dos Clieantes com Debito total acima do
	* solicitado

	SELECT CLIENTE, NOME,DUPLICATA,CODPARCELA,dt_emi,dt_venc, ;
	       (dt_venc - m.dt_inicio) AS DIAS, ;
	       portador,;
	       vlr_doc, ;
		   ULsld_dup(DUPLICATA,m.dt_inicio,;
			         dt_emi,DT_BAIXA, vlr_doc ) AS SALDO_DP ;
	FROM &wl_arqtmp ;
	WHERE cliente in (SELECT CLIENTE FROM CRSTMP1) ;
	INTO CURSOR CRSTMP2

	IF fox_alert("Imprimir em Ordem Alfabetica ? "+chr(13)+chr(13)+;
		"(Sim) = Imprimir em Ordem Alfabetica  "+chr(13)+;
		"(Nao) = Imprimir em Ordem de Debito ")
		SELECT CRSTMP2.*, CRSTMP1.SALDO_CL ;
		FROM CRSTMP1, CRSTMP2 ;
		WHERE CRSTMP1.CLIENTE =  CRSTMP2.CLIENTE ;
		ORDER BY NOME;
		INTO CURSOR CRSTMP3
	ELSE
		SELECT CRSTMP2.*, CRSTMP1.SALDO_CL ;
		FROM CRSTMP1, CRSTMP2 ;
		WHERE CRSTMP1.CLIENTE =  CRSTMP2.CLIENTE ;
		ORDER BY SALDO_CL DESC ;
		INTO CURSOR CRSTMP3
	ENDIF


	GO TOP
	IF EOF() AND BOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		=UP_fecha("CRSTMP1")
		=UP_fecha("CRSTMP2")
		=UP_fecha("CRSTMP3")
 		SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
***************************
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	

	LF_fim  = .f.
    LSrel = "REL518F1"      && relatorio padrao
    LSorienta = " FOR LFsegue "

	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
	SET RELATION TO
	=UP_fecha("CRSTMP1")
	=UP_fecha("CRSTMP2")
	=UP_fecha("CRSTMP3")

RETURN


PROCEDURE ANT5CRclAnalitico

	SELECT &wl_arqtmp

	
	SELE clientes
	SET ORDER TO TAG cliente

	SELECT &wl_arqtmp
	SET RELATION TO cliente INTO clientes

*   INDEX ON STR(EMPRESA,3)+clientes.NOME+STR(clientes.cliente,14)+;
			 STR(DUPLICATA,9)  TAG portador ADDITIVE

   INDEX ON STR(EMPRESA,3)+NOME+STR(cliente,14)+;
			 STR(DUPLICATA,9)  TAG portador ADDITIVE

	SET ORDER TO TAG portador
	GO TOP
	IF EOF() AND BOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
 		SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
***************************
    SELECT &wl_arqtmp
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	

	LF_fim  = .f.
    LSrel = "REL518F"      && relatorio padrao
    LSorienta = " FOR LFsegue "

	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
	SET RELATION TO
RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2T20O8K4G           m.impG_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC518,     Record Number:   73   º
*       º Variable:            m.impG_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      28                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
***	INTO CURSOR SALDO_DP


FUNCTION _2t20o8k4g     &&  m.impG_btn VALID
#REGION 1
	SELECT &wl_arqtmp

	
	IF fox_alert("Imprimir em Ordem Alfabetica ? "+chr(13)+chr(13)+;
		"(Sim) = Imprimir em Ordem Alfabetica  "+chr(13)+;
		"(Nao) = Imprimir em Ordem de Debito ")
		SELECT CLIENTE, NOME, ;
		   sum(ULsld_dup(DUPLICATA,m.dt_inicio,;
			         dt_emi,DT_BAIXA, vlr_doc )) AS SALDO_DP ;
		FROM &wl_arqtmp ;
		GROUP BY cliente ;
		HAVING SALDO_DP > m.vlr_doc;
		ORDER BY NOME ;
		INTO TABLE SALDO_DP
	ELSE
		SELECT CLIENTE, NOME, ;
		   sum(ULsld_dup(DUPLICATA,m.dt_inicio,;
			         dt_emi,DT_BAIXA, vlr_doc )) AS SALDO_DP ;
		FROM &wl_arqtmp ;
		GROUP BY cliente ;
		HAVING SALDO_DP > m.vlr_doc;
		ORDER BY SALDO_DP  DESC ;
		INTO TABLE SALDO_DP
	ENDIF
		
	GO TOP
	IF EOF() AND BOF()
		APPEND BLANK
	ENDIF
	IF EOF() AND BOF()
		=UP_fecha("SALDO_DP")

 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
 		SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
***************************
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	

	LF_fim  = .f.
    LSrel = "REL518G1"      && relatorio padrao
    LSorienta = " FOR LFsegue "

	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
	SET RELATION TO
*-----------------------------
	=UP_fecha("SALDO_DP")

	SHOW WINDOW SCGC518 TOP

    SELE DUPLICAT



RETURN

*----------------------------------------------------*

PROCEDURE RTANT
	SELE clientes
	SET ORDER TO TAG cliente

	SELECT &wl_arqtmp
	SET RELATION TO cliente INTO clientes

    INDEX ON STR(EMPRESA,3)+clientes.NOME+STR(CLIENTE,14)+STR(DUPLICATA,9)  TAG portador ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF() AND BOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
 		SELE DUPLICAT
		UNLOCK
 		RETURN
 	ENDIF		
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
***************************
    SELECT &wl_arqtmp
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	

	LF_fim  = .f.
    LSrel = "REL518G"      && relatorio padrao
    LSorienta = " FOR LFsegue "

	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
	SET RELATION TO
*-----------------------------
	SHOW WINDOW SCGC518 TOP
    SELE DUPLICAT

RETURN
