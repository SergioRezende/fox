*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º 08/17/12             SCGC521.SPR               15:57:32 º
*       º                                                         º
*       ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
*       º                                                         º
*       º Author's Name                                           º
*       º                                                         º
*       º Copyright (c) 2012 Company Name                         º
*       º Address                                                 º
*       º City,     Zip                                           º
*       º                                                         º
*       º Description:                                            º
*       º This program was automatically generated by GENSCRN.    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC521/MS-DOS Setup Code - SECTION 1          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
*---------------------------------------------------------------*
* OPERA ARQUIVOS :
*			DUPLICAT
*           RETORNMV
*           clientes
* OBJETIVO:	IMPRIMIR  DIARIO AUXILIAR
*	
*---------------------------------------------------------------*

******>>>> INICIO CONTROLE AMBIENTAL

ON KEY LABEL ESCAPE

PRIVATE isediting,isadding,isreading
PRIVATE wp_record
PRIVATE isreadonly,is2table,wzalias
PRIVATE LS521areant
LS521areant = ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.wzalias	=	SELECT()
m.isediting	=	.F.
m.isadding	=	.F.
m.isreading=	.F.
m.is2table 	= 	.F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
wp_ref_local =  .f.     && NAO POSSUI CONTROLE DE REFRESH LOCAL

LFrescfo	= .f.       && AUTORIZA OU NAO EMI. RESUMO POR CFO
LFresuf		= .f.       && AUTORIZA OU NAO EMI. RESUMO POR UF

LFtab521	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFban521	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFdup521	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFret521	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFcli521	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFemp521	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA

******>>>> INICIO CONTROLE ARQUIVOS
IF !USED("tab001")
	LFtab521	= .T.
	IF ! NetUse("tab001")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("banco")
	LFban521	= .T.
	IF ! NetUse("banco")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("duplicat")
	LFdup521	= .T.
	IF ! NetUse("duplicat")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("empresa")
	LFemp521	= .T.
	IF ! NetUse("empresa")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("clientes")
	LFcli521	= .T.
	IF ! NetUse("clientes")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("retornmv")
	LFret521	= .T.
	IF ! NetUse("retornmv")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF wp_flgfecha
	DO ULfecha
	RETURN
ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                MS-DOS Window definitions                º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

IF NOT WEXIST("scgc521") ;
	OR UPPER(WTITLE("SCGC521")) == "SCGC521.PJX" ;
	OR UPPER(WTITLE("SCGC521")) == "SCGC521.SCX" ;
	OR UPPER(WTITLE("SCGC521")) == "SCGC521.MNX" ;
	OR UPPER(WTITLE("SCGC521")) == "SCGC521.PRG" ;
	OR UPPER(WTITLE("SCGC521")) == "SCGC521.FRX" ;
	OR UPPER(WTITLE("SCGC521")) == "SCGC521.QPR"
	DEFINE WINDOW scgc521 ;
		FROM INT((SROW()-12)/2),INT((SCOL()-72)/2) ;
		TO INT((SROW()-12)/2)+11,INT((SCOL()-72)/2)+71 ;
		TITLE "[ Diario Auxiliar ]" ;
		FOOTER "[ 521 ]" ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC521/MS-DOS Setup Code - SECTION 2          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1

******>>>> INICIO CONTROLE LOCAL

SELECT empresa
SET ORDER TO TAG empresa
SEEK wp_empresa

m.empresa   = empresa.empresa
m.nome_emp  = empresa.nome
m.inscricao = empresa.inscricao
SHOW GET m.empresa
SHOW GET m.nome_emp


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC521/MS-DOS Screen Layout               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
IF WVISIBLE("scgc521")
	ACTIVATE WINDOW scgc521 SAME
ELSE
	ACTIVATE WINDOW scgc521 NOSHOW
ENDIF
@ 0,0 TO 11,71 ;
	COLOR SCHEME 23
@ 11,1 TO 11,70 ;
	COLOR SCHEME 24
@ 11,71 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,71 TO 10,71 ;
	COLOR SCHEME 24
@ 0,71 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,65 SAY "[521]" ;
	SIZE 1,5, 0
@ 0,21 SAY "[ Emissao de Diario Auxiliar ]" ;
	SIZE 1,30, 0
@ 8,1 TO 10,11 ;
	COLOR SCHEME 24
@ 10,2 TO 10,10 ;
	COLOR SCHEME 23
@ 9,11 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,11 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,11 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,12 TO 10,23 ;
	COLOR SCHEME 24
@ 10,13 TO 10,22 ;
	COLOR SCHEME 23
@ 9,23 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,23 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,23 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,60 TO 10,70 ;
	COLOR SCHEME 24
@ 10,61 TO 10,69 ;
	COLOR SCHEME 23
@ 9,70 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,70 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,70 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 4,3 TO 6,17 ;
	COLOR SCHEME 23
@ 6,4 TO 6,16 ;
	COLOR SCHEME 24
@ 6,17 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,17 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,17 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,3 TO 3,54 ;
	COLOR SCHEME 23
@ 3,4 TO 3,53 ;
	COLOR SCHEME 24
@ 3,54 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,54 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,54 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,5 SAY "[Filial]" ;
	SIZE 1,8, 0
@ 4,5 SAY "[Dt.Inicio]" ;
	SIZE 1,11, 0
@ 4,19 TO 6,33 ;
	COLOR SCHEME 23
@ 6,20 TO 6,32 ;
	COLOR SCHEME 24
@ 6,33 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,33 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,33 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,21 SAY "[Dt.Final]" ;
	SIZE 1,10, 0
@ 2,7 SAY "-" ;
	SIZE 1,1, 0
@ 4,44 TO 6,58 ;
	COLOR SCHEME 23
@ 6,45 TO 6,57 ;
	COLOR SCHEME 24
@ 6,58 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,58 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,58 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,45 SAY "[Pg.Inicial]" ;
	SIZE 1,12, 0
@ 8,24 TO 10,34 ;
	COLOR SCHEME 24
@ 10,25 TO 10,33 ;
	COLOR SCHEME 23
@ 9,34 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,34 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,34 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,35 TO 10,47 ;
	COLOR SCHEME 24
@ 10,36 TO 10,46 ;
	COLOR SCHEME 23
@ 9,47 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,47 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,47 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 2,4 GET m.empresa ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN _3kq0y7f25() ;
	VALID _3kq0y7f26()
@ 2,8 GET m.nome_emp ;
	SIZE 1,45 ;
	DEFAULT " " ;
	WHEN _3kq0y7f27()
@ 5,5 GET m.dt_inicio ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _3kq0y7f28() ;
	VALID _3kq0y7f29()
@ 5,22 GET m.dt_fim ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN isediting ;
	VALID _3kq0y7f36() ;
	MESSAGE "Data Final deve ser maior ou igual a Inicial" ;
	ERROR wp_msg
@ 5,49 GET LNpagina ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN _3kq0y7f39() ;
	VALID LNpagina > 0 ;
	ERROR "Numero deve ser > 0 "
@ 9,3 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 9,14 GET m.Padrao_btn ;
	PICTURE "@*HN \<Padrao" ;
	SIZE 1,8,1 ;
	DEFAULT 1 ;
	VALID _3kq0y7f3e()
@ 9,26 GET m.cx_btn ;
	PICTURE "@*HN \<Caixa" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _3kq0y7f3n()
@ 9,37 GET m.ExtrCx_btn ;
	PICTURE "@*HN E\<xtr.Cx" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _3kq0y7f3o()
@ 9,62 GET m.canc_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _3kq0y7f3p()
@ 8,48 TO 10,59 ;
	COLOR SCHEME 24
@ 10,49 TO 10,58 ;
	COLOR SCHEME 23
@ 9,59 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,59 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,59 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 9,50 GET m.Vendor_btn ;
	PICTURE "@*HN \<Vendor" ;
	SIZE 1,8,1 ;
	DEFAULT 1 ;
	VALID _3kq0y7f3q()
@ 2,61 GET m.APadrao_btn ;
	PICTURE "@*HN \<APadrao" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _3kq0y7f3r() ;
	DISABLE
@ 3,61 GET m.acx_btn ;
	PICTURE "@*HN \<Caixa" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _3kq0y7f4h() ;
	DISABLE
@ 4,61 GET m.aExtrCx_btn ;
	PICTURE "@*HN E\<xtr.Cx" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _3kq0y7f4m() ;
	DISABLE

IF NOT WVISIBLE("scgc521")
	ACTIVATE WINDOW scgc521
ENDIF

READ CYCLE ;
	ACTIVATE READACT() ;
	DEACTIVATE READDEAC()

RELEASE WINDOW scgc521

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º               SCGC521/MS-DOS Cleanup Code               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
do ULfecha
RETURN



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º   SCGC521/MS-DOS Supporting Procedures and Functions    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
PROCEDURE ULfecha
	IF LFtab521  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("tab001")
	ENDIF
	IF LFdup521  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("duplicat")
	ENDIF
	IF LFban521  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("banco")
	ENDIF
	IF LFcli521  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("clientes")
	ENDIF
	IF LFret521  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("retornmv")
	ENDIF
	IF LFemp521  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(LS521areant)
		SELECT &LS521areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
RETURN


PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	LN_prxobj = _CUROBJ
	SHOW GET m.empresa
	SHOW GET m.nome_emp
    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.padrao_btn DISABLE
			SHOW GET m.cx_btn DISABLE
			SHOW GET m.extrcx_btn DISABLE
			SHOW GET m.vendor_btn DISABLE
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.padrao_btn ENABLE
			SHOW GET m.cx_btn ENABLE
			SHOW GET m.extrcx_btn ENABLE
			SHOW GET m.vendor_btn ENABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END

			*--------------------------------------------*
			DO ULgerDupTmp
			*--------------------------------------------*

		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.padrao_btn DISABLE
			SHOW GET m.cx_btn DISABLE
			SHOW GET m.extrcx_btn DISABLE
			SHOW GET m.vendor_btn DISABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN

*******************
FUNCTION ULlenatu		&& chamada por rel521
PARAMETERS LNnatu

SELECT tab001
SET ORDER TO TAG codigo

SEEK 'NTZ'+CHRTRAN(STR(LNnatu,1)," ","0")
SELECT duplicat

RETURN(TAB001.descricao)




PROCEDURE  ULgerDupTmp


RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F25           m.empresa WHEN                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   59   º
*       º Variable:            m.empresa                          º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      1                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _3kq0y7f25     &&  m.empresa WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F26           m.empresa VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   59   º
*       º Variable:            m.empresa                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      2                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _3kq0y7f26     &&  m.empresa VALID
#REGION 1
SELECT empresa
SET ORDER TO TAG empresa
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .F.
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT empresa
		RETURN .F.
	ENDIF
ELSE
	IF !SEEK(m.empresa)
		SELECT empresa
		RETURN .F.
	ENDIF
ENDIF
m.empresa   = empresa
m.nome_emp  = empresa.nome
m.inscricao = empresa.inscricao
SHOW GET m.empresa
SHOW GET m.nome_emp
SELECT empresa
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F27           m.nome_emp WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   60   º
*       º Variable:            m.nome_emp                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      3                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _3kq0y7f27     &&  m.nome_emp WHEN
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(.f.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F28           m.dt_inicio WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   61   º
*       º Variable:            m.dt_inicio                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      4                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _3kq0y7f28     &&  m.dt_inicio WHEN
#REGION 1
IF isediting
	ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ENDIF
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F29           m.dt_inicio VALID                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   61   º
*       º Variable:            m.dt_inicio                        º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      5                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _3kq0y7f29     &&  m.dt_inicio VALID
#REGION 1
m.dt_fim = m.dt_inicio
SHOW GET m.dt_fim
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN (.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F36           m.dt_fim VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   62   º
*       º Variable:            m.dt_fim                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      6                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _3kq0y7f36     &&  m.dt_fim VALID
#REGION 1
IF m.dt_fim < m.dt_inicio
	wp_msg  = "Data Final Deve ser Maior ou Igual a Data Inicial."
	RETURN(.F.)
ENDIF
IF MONTH(m.dt_inicio) <> MONTH(m.dt_fim) OR ;
   YEAR(m.dt_inicio) <> YEAR(m.dt_fim)
	wp_msg  = "Data Inicial e Data Final Devem Pertencer ao Mesmo Mes."
	RETURN(.F.)
ENDIF
RETURN(.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F39           LNpagina WHEN                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   63   º
*       º Variable:            LNpagina                           º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      7                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _3kq0y7f39     &&  LNpagina WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F3E           m.Padrao_btn VALID                 º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   65   º
*       º Variable:            m.Padrao_btn                       º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      8                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _3kq0y7f3e     &&  m.Padrao_btn VALID
#REGION 1
	SELE clientes
	SET ORDER TO TAG cliente

	SELECT duplicat
	SET ORDER TO TAG doc
	SELECT retornmv
	SET ORDER TO TAG dtprocesso
	SET NEAR ON
	SEEK STR(m.empresa,3)+DTOS(m.dt_inicio)
	SET NEAR OFF
*	IF retornmv.empresa <> m.empresa or retornmv.dtprocesso > m.dt_fim
* 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
*		UNLOCK
* 		RETURN
* 	ENDIF		
************************>

	*--------------------------------------------------------------*
	*  INICIO - MONTAGEM DADOS
	*--------------------------------------------------------------*
	SELE banco
	SET ORDER TO TAG banco

	SELE DUPLICAT
	WAIT WINDOW "AGUARDE. Gerando Arq. Temporario." NOWAIT

	LStp_LANCAME = "PADRAO"


    *------------------------------------------------------*
    * nao considerar os registros de vendas a vista
    * 	      	AND dup.tp_parcela <> 1
    *------------------------------------------------------*


	SELECT  dup.regiao,;
	        dup.natu as natureza,;
		 	dup.nome,;
		 	dup.dt_venc,;
			dup.duplicata,;
			dup.CODPARCELA,;
			dup.vlr_doc , ;
			dup.banco,;
			dup.dt_emi AS dtaviso,;
			dup.dt_emi AS dtocorrenc, ;
			dup.dt_emi AS dtprocesso,;
	        1          AS efeito,;
		 	(dup.vlr_pgto*0) as vlr_pgto,;
		 	(dup.juros*0)    as juros,;
		 	(dup.mora*0)     as mora,;
		 	(dup.DESCONTO*0) as desconto, ;
		 	(dup.OUT_CREDT*0) as out_credt, ;
			02               as ocorrencia  ;
	 FROM  duplicat dup ;
	 WHERE 	;
	      	    dup.empresa = m.empresa  ;
	      	AND dup.dt_emi >= m.dt_inicio;
	      	AND dup.dt_emi <= m.dt_fim;
	      	AND dup.tp_parcela <> 1 ;
     INTO CURSOR dp_emi


**	(rt.vlr_pgto+000000000) AS VLR_PGTO, ;

	SELECT  dup.regiao,;
	        dup.natu as natureza,;
		 	dup.nome,;
		 	dup.dt_venc,;
			dup.duplicata,;
			dup.CODPARCELA,;
			dup.vlr_doc , ;
			dup.banco,;
			rt.dtaviso,;
			rt.dtocorrenc, ;
			rt.dtprocesso,;
	        rt.efeito,;
			(IIF(dup.tp_cobranc <> 6,rt.vlr_pgto,dup.vlr_doc)++000000000) ;
				AS VLR_PGTO, ;			
		 	(rt.juros+0000000)    AS JUROS,;
		 	(rt.mora+0000000)     AS MORA,;
		 	(rt.DESCONTO+0000000) AS DESCONTO, ;
		 	(rt.OUT_CREDT+0000000) as out_credt, ;
			rt.ocorrencia  ;
	 FROM retornmv rt, duplicat dup ;
	 WHERE 	;
			    rt.empresa = dup.empresa ;
	      	AND dup.tp_parcela <> 1 ;
			AND rt.banco <> 990;
			AND rt.duplicata = dup.duplicata ;
	  		AND	rt.efeito > 0 ;
	        AND rt.status = "PR" ;
	      	AND rt.empresa = m.empresa  ;
	      	AND rt.dtprocesso >= m.dt_inicio;
	      	AND rt.dtprocesso <= m.dt_fim;
     INTO CURSOR mv_rtrn



     SELECT * FROM  dp_emi ;
     UNION ;
     SELECT * FROM  mv_rtrn ;
     INTO CURSOR mv_tmp1

	 SELECT * FROM mv_tmp1 ;
	 INTO CURSOR mv_tmp ;
	 ORDER BY dtprocesso,REGIAO,natureza,EFEITO,NOME

	 SELECT mv_tmp
	 GO TOP


	IF EOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
		SHOW WINDOW SCGC521 TOP

		SELECT dp_emi
    	USE

		SELECT mv_rtrn
		USE

		SELECT mv_TMP1
		USE

		SELECT mv_tmp
		USE

	    SELE DUPLICAT
 		RETURN
 	ENDIF		

	*--------------------------------------------------------------*
	*  FIM - MONTAGEM DADOS
	*--------------------------------------------------------------*
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SELECT mv_tmp

	LF_fim  = .f.

	IF m.dt_fim - m.dt_inicio > 0
	    LSrel = "REL521A"      && TOTALIZA O MES
	ELSE
	    LSrel = "REL521"      && relatorio padrao
	ENDIF
    LSorienta = " FOR LFsegue "
	GO TOP
	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
	SET RELATION TO
	SHOW WINDOW SCGC521 TOP

	SELECT dp_emi
    USE

	SELECT mv_rtrn
	USE

	SELECT mv_TMP1
	USE

	SELECT mv_tmp
	USE

    SELE DUPLICAT
RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F3N           m.cx_btn VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   66   º
*       º Variable:            m.cx_btn                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      9                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*


FUNCTION _3kq0y7f3n     &&  m.cx_btn VALID
#REGION 1
	SELE clientes
	SET ORDER TO TAG cliente

	SELECT duplicat
	SET ORDER TO TAG doc
	SELECT retornmv
	SET ORDER TO TAG dtprocesso
	SET NEAR ON
	SEEK STR(m.empresa,3)+DTOS(m.dt_inicio)
	SET NEAR OFF
*	IF retornmv.empresa <> m.empresa or retornmv.dtprocesso > m.dt_fim
*		WAIT WINDOW "Nao Foram encotrados dados para impessao."
*		UNLOCK
* 		RETURN
* 	ENDIF		
************************>
	SET SAFET OFF

	SELE banco
	SET ORDER TO TAG banco

	SELE DUPLICAT
	SET RELATION TO cliente INTO clientes
	
	SELECT retornmv

	WAIT WINDOW "AGUARDE. Gerando Arq. Temporario." NOWAIT

	*--------------------------------------------------------------*
	*  INICIO - MONTAGEM DADOS
	*--------------------------------------------------------------*
	SELE banco
	SET ORDER TO TAG banco

	SELE DUPLICAT
	WAIT WINDOW "AGUARDE. Gerando Arq. Temporario." NOWAIT


	LStp_LANCAME = "CAIXA"


    *------------------------------------------------------*
    * nao considerar os registros de vendas a vista
    * 	      	AND dup.tp_parcela <> 1
    *------------------------------------------------------*
	SELECT  dup.regiao,;
	        dup.natu as natureza,;
		 	dup.nome,;
		 	dup.dt_venc,;
			dup.duplicata,;
			dup.CODPARCELA,;
			dup.vlr_doc , ;
			dup.banco,;
			rt.dtaviso,;
			rt.dtocorrenc, ;
			rt.dtprocesso,;
	        rt.efeito,;
		 	(rt.vlr_pgto+000000000) AS VLR_PGTO, ;
		 	(rt.juros+0000000)    AS JUROS,;
		 	(rt.mora+0000000)     AS MORA,;
		 	(rt.DESCONTO+0000000) AS DESCONTO, ;
		 	(dup.OUT_CREDT*0) as out_credt, ;
			rt.ocorrencia  ;
	 FROM banco bco, retornmv rt, duplicat dup ;
	 WHERE 	;
			    rt.empresa = dup.empresa ;
         	AND dup.tp_parcela <> 1 ;
			AND rt.banco <> 990;
			AND rt.duplicata = dup.duplicata ;
			AND bco.banco      = rt.banco ;
			AND bco.tp_lancame = "CAIXA" ;
			AND rt.efeito > 1;
	        AND rt.status = "PR" ;
	      	AND rt.empresa = m.empresa  ;
	      	AND rt.dtprocesso >= m.dt_inicio;
	      	AND rt.dtprocesso <= m.dt_fim;
     INTO CURSOR mv_rtrn


     SELECT * FROM  mv_rtrn ;
     INTO CURSOR mv_tmp1

	 SELECT * FROM mv_tmp1 ;
	 INTO CURSOR mv_tmp ;
	 ORDER BY dtprocesso,REGIAO,natureza,EFEITO,NOME

	 SELECT mv_tmp
	 GO TOP


	IF EOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
		SHOW WINDOW SCGC521 TOP


		SELECT mv_rtrn
		USE

		SELECT mv_TMP1
		USE

		SELECT mv_tmp
		USE

	    SELE DUPLICAT
 		RETURN
 	ENDIF		

	*--------------------------------------------------------------*
	*  FIM - MONTAGEM DADOS
	*--------------------------------------------------------------*



*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
    SELECT mv_tmp

	LF_fim  = .f.

	IF m.dt_fim - m.dt_inicio > 0
	    LSrel = "REL521A"      && TOTALIZA O MES
	ELSE
	    LSrel = "REL521"      && relatorio padrao
	ENDIF
    LSorienta = " FOR LFsegue "
	GO TOP
	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
	SET RELATION TO
	SHOW WINDOW SCGC521 TOP

	SELECT mv_rtrn
	USE

	SELECT mv_TMP1
	USE

	SELECT mv_tmp
	USE

    SELE DUPLICAT
RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F3O           m.ExtrCx_btn VALID                 º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   67   º
*       º Variable:            m.ExtrCx_btn                       º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      10                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _3kq0y7f3o     &&  m.ExtrCx_btn VALID
#REGION 1
	SELE clientes
	SET ORDER TO TAG cliente

	SELECT duplicat
	SET ORDER TO TAG doc
	SELECT retornmv
	SET ORDER TO TAG dtprocesso
	SET NEAR ON
	SEEK STR(m.empresa,3)+DTOS(m.dt_inicio)
	SET NEAR OFF
*	IF retornmv.empresa <> m.empresa or retornmv.dtprocesso > m.dt_fim
* 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
*		UNLOCK
* 		RETURN
* 	ENDIF		
************************>
	SET SAFET OFF

	SELE banco
	SET ORDER TO TAG banco

	SELE DUPLICAT
	SET RELATION TO cliente INTO clientes
	

	SELECT retornmv

	*--------------------------------------------------------------*
	*  INICIO - MONTAGEM DADOS
	*--------------------------------------------------------------*
	SELE banco
	SET ORDER TO TAG banco

	SELE DUPLICAT
	WAIT WINDOW "AGUARDE. Gerando Arq. Temporario." NOWAIT


	LStp_LANCAME = "EXTRA CAIXA"

	
    *------------------------------------------------------*
    * nao considerar os registros de vendas a vista
    * 	      	AND dup.tp_parcela <> 1
    *------------------------------------------------------*
	SELECT  dup.regiao,;
	        dup.natu as natureza,;
		 	dup.nome,;
		 	dup.dt_venc,;
			dup.duplicata,;
			dup.CODPARCELA,;
			dup.vlr_doc , ;
			dup.banco,;
			dup.dt_emi AS dtaviso,;
			dup.dt_emi AS dtocorrenc, ;
			dup.dt_emi AS dtprocesso,;
	        1          AS efeito,;
		 	(dup.vlr_pgto*0) as vlr_pgto,;
		 	(dup.juros*0)    as juros,;
		 	(dup.mora*0)     as mora,;
		 	(dup.DESCONTO*0) as desconto, ;
		 	(dup.OUT_CREDT*0) as out_credt, ;
			02               as ocorrencia  ;
	 FROM  duplicat dup ;
	 WHERE 	;
	      	    dup.empresa = m.empresa  ;
         	AND dup.tp_parcela <> 1 ;
	      	AND dup.dt_emi >= m.dt_inicio;
	      	AND dup.dt_emi <= m.dt_fim;
     INTO CURSOR dp_emi





	SELECT  dup.regiao,;
	        dup.natu as natureza,;
		 	dup.nome,;
		 	dup.dt_venc,;
			dup.duplicata,;
			dup.CODPARCELA,;
			dup.vlr_doc , ;
			dup.banco,;
			rt.dtaviso,;
			rt.dtocorrenc, ;
			rt.dtprocesso,;
	        rt.efeito,;
		 	(dup.vlr_pgto+000000000) AS VLR_PGTO, ;
		 	(rt.juros+0000000)    AS JUROS,;
		 	(rt.mora+0000000)     AS MORA,;
		 	(rt.DESCONTO+0000000) AS DESCONTO, ;
		 	(rt.OUT_CREDT+0000000) AS OUT_CREDT, ;
			rt.ocorrencia  ;
	 FROM banco bco, retornmv rt, duplicat dup ;
	 WHERE 	;
			    bco.banco      = rt.banco;
         	AND dup.tp_parcela <> 1 ;
			AND bco.tp_lancame = "EXTRA CAIXA" ;
			AND rt.efeito > 1;
			AND rt.empresa = dup.empresa ;
			AND rt.banco <> 990;
			AND rt.duplicata = dup.duplicata ;
	        AND rt.status = "PR" ;
	      	AND rt.empresa = m.empresa  ;
	      	AND rt.dtprocesso >= m.dt_inicio;
	      	AND rt.dtprocesso <= m.dt_fim;
     INTO CURSOR mv_rtrn


     SELECT * FROM  dp_emi ;
     UNION ;
     SELECT * FROM  mv_rtrn ;
     INTO CURSOR mv_tmp1

	 SELECT * FROM mv_tmp1 ;
	 INTO CURSOR mv_tmp ;
	 ORDER BY dtprocesso,REGIAO,natureza,EFEITO,NOME

	 SELECT mv_tmp
	 GO TOP

	IF EOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
		SHOW WINDOW SCGC521 TOP

		SELECT dp_emi
    	USE

		SELECT mv_rtrn
		USE

		SELECT mv_TMP1
		USE

		SELECT mv_tmp
		USE

	    SELE DUPLICAT
 		RETURN
 	ENDIF		

	*--------------------------------------------------------------*
	*  FIM - MONTAGEM DADOS
	*--------------------------------------------------------------*


*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SELECT mv_tmp

	LF_fim  = .f.

	IF m.dt_fim - m.dt_inicio > 0
	    LSrel = "REL521A"      && TOTALIZA O MES
	ELSE
	    LSrel = "REL521"      && relatorio padrao
	ENDIF
    LSorienta = " FOR LFsegue "
	GO TOP
	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
	SET RELATION TO
	SHOW WINDOW SCGC521 TOP

	SELECT dp_emi
   	USE

	SELECT mv_rtrn
	USE

	SELECT mv_TMP1
	USE

	SELECT mv_tmp
	USE

    SELE DUPLICAT
RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F3P           m.canc_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   68   º
*       º Variable:            m.canc_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      11                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _3kq0y7f3p     &&  m.canc_btn VALID
#REGION 1
CLEAR GETS
CLEAR READ
isediting = .f.
RETURN .T.

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F3Q           m.Vendor_btn VALID                 º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   74   º
*       º Variable:            m.Vendor_btn                       º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      12                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _3kq0y7f3q     &&  m.Vendor_btn VALID
#REGION 1
	SELE clientes
	SET ORDER TO TAG cliente

	SELECT duplicat
	SET ORDER TO TAG doc
	SELECT retornmv
	SET ORDER TO TAG dtprocesso
	SET NEAR ON
	SEEK STR(m.empresa,3)+DTOS(m.dt_inicio)
	SET NEAR OFF
	IF retornmv.empresa <> m.empresa or retornmv.dtprocesso > m.dt_fim
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
 		RETURN
 	ENDIF		
************************>
	wl_arqtmp = ""
	LNtmp     = 65		&& TABELA ASCII A = 65
	IF !UPabretmp("dpl")
		wp_flgfecha = .t.
	ENDIF
	IF wp_flgfecha
		RETURN
	ENDIF
	SET SAFET OFF
	LStmp = "&wp_dirtmp"+"&wl_arqtmp"

	SELE banco
	SET ORDER TO TAG banco

	SELE DUPLICAT
	SET RELATION TO cliente INTO clientes
	

	SELECT retornmv

	SET RELATION TO STR(EMPRESA,3)+STR(DUPLICATA,9) INTO duplicat
	SET SKIP TO duplicat
	SET RELATION TO banco      INTO banco additive


	WAIT WINDOW "AGUARDE. Gerando Arq. Temporario." NOWAIT

	LStp_LANCAME = "VENDOR"

	COPY TO &LStmp ;
		 FIELDS duplicat.regiao, clientes.natureza, retornmv.efeito,  ;
		 		duplicat.nome  , duplicat.dt_venc, retornmv.vlr_pgto, ;
		 		retornmv.juros,retornmv.mora,retornmv.DESCONTO, ;
				duplicat.duplicata, duplicat.vlr_doc , ;
				retornmv.banco,;
				retornmv.dtaviso, retornmv.dtocorrenc, ;
				retornmv.OUT_CREDT,;
				retornmv.dtprocesso,retornmv.ocorrencia  ;
  	    FOR	 retornmv.efeito > 0 AND retornmv.status = "PR" ;
            AND duplicat.tp_parcela = 6 ;
		    AND ((banco.tp_lancame = "EXTRA CAIXA") ;
		    	OR  ;
			    (banco.tp_lancame = "CAIXA" and retornmv.efeito = 1)) ;
      	 WHILE   retornmv.empresa     = m.empresa  AND ;
			        	 retornmv.dtprocesso <= m.dt_fim
    SELE 0
    USE "&wp_dirtmp"+"&wl_arqtmp" exclu
    INDEX ON DTOS(dtprocesso)+STR(REGIAO,3)+STR(natureza,2);
    				+STR(EFEITO,1)+NOME ;
			     TAG portador 	 ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
		SHOW WINDOW SCGC521 TOP
		SELECT &wl_arqtmp
    	USE
	    SELE DUPLICAT
 		RETURN
 	ENDIF		

*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SELECT &wl_arqtmp

	LF_fim  = .f.

	IF m.dt_fim - m.dt_inicio > 0
	    LSrel = "REL521A"      && TOTALIZA O MES
	ELSE
	    LSrel = "REL521"      && relatorio padrao
	ENDIF
    LSorienta = " FOR LFsegue "
	GO TOP
	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
	SET RELATION TO
	SHOW WINDOW SCGC521 TOP
	SELECT &wl_arqtmp
    USE
    SELE DUPLICAT
RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F3R           m.APadrao_btn VALID                º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   75   º
*       º Variable:            m.APadrao_btn                      º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      13                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _3kq0y7f3r     &&  m.APadrao_btn VALID
#REGION 1
	SELE clientes
	SET ORDER TO TAG cliente

	SELECT duplicat
	SET ORDER TO TAG doc
	SELECT retornmv
	SET ORDER TO TAG dtprocesso
	SET NEAR ON
	SEEK STR(m.empresa,3)+DTOS(m.dt_inicio)
	SET NEAR OFF
	IF retornmv.empresa <> m.empresa or retornmv.dtprocesso > m.dt_fim
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
 		RETURN
 	ENDIF		
************************>
	wl_arqtmp = ""
	LNtmp     = 65		&& TABELA ASCII A = 65
	IF !UPabretmp("dpl")
		wp_flgfecha = .t.
	ENDIF
	IF wp_flgfecha
		RETURN
	ENDIF
	SET SAFET OFF
	LStmp = "&wp_dirtmp"+"&wl_arqtmp"

	SELE banco
	SET ORDER TO TAG banco

	SELE DUPLICAT
	SET RELATION TO cliente INTO clientes
	SET RELATION TO banco   INTO banco
	

	SELECT retornmv
	SET RELATION TO STR(EMPRESA,3)+STR(DUPLICATA,9) INTO duplicat
	SET SKIP TO duplicat
	WAIT WINDOW "AGUARDE. Gerando Arq. Temporario." NOWAIT

	LStp_LANCAME = "PADRAO"

	COPY TO &LStmp ;
		 FIELDS duplicat.regiao, clientes.natureza,    retornmv.efeito,  ;
		 		duplicat.nome  , duplicat.dt_venc, retornmv.vlr_pgto, ;
		 		retornmv.juros,retornmv.mora,retornmv.DESCONTO, ;
				duplicat.duplicata, duplicat.vlr_doc , ;
				duplicat.banco,;
				retornmv.dtaviso, retornmv.dtocorrenc, ;
				retornmv.dtprocesso,retornmv.ocorrencia  ;
				 FOR  	 retornmv.efeito > 0 AND retornmv.status = "PR" ;
	        	 WHILE   retornmv.empresa     = m.empresa  AND ;
			        	 retornmv.dtprocesso <= m.dt_fim
    SELE 0
    USE "&wp_dirtmp"+"&wl_arqtmp" exclu
    INDEX ON DTOS(dtprocesso)+STR(REGIAO,3)+STR(natureza,2);
    				+STR(EFEITO,1)+NOME ;
			     TAG portador 	 ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
		SHOW WINDOW SCGC521 TOP
		SELECT &wl_arqtmp
    	USE
	    SELE DUPLICAT
 		RETURN
 	ENDIF		

*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SELECT &wl_arqtmp

	LF_fim  = .f.

	IF m.dt_fim - m.dt_inicio > 0
	    LSrel = "REL521A"      && TOTALIZA O MES
	ELSE
	    LSrel = "REL521"      && relatorio padrao
	ENDIF
    LSorienta = " FOR LFsegue "
	GO TOP
	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
	SET RELATION TO
	SHOW WINDOW SCGC521 TOP
	SELECT &wl_arqtmp
    USE
    SELE DUPLICAT
RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F4H           m.acx_btn VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   76   º
*       º Variable:            m.acx_btn                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      14                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*


FUNCTION _3kq0y7f4h     &&  m.acx_btn VALID
#REGION 1
	SELE clientes
	SET ORDER TO TAG cliente

	SELECT duplicat
	SET ORDER TO TAG doc
	SELECT retornmv
	SET ORDER TO TAG dtprocesso
	SET NEAR ON
	SEEK STR(m.empresa,3)+DTOS(m.dt_inicio)
	SET NEAR OFF
	IF retornmv.empresa <> m.empresa or retornmv.dtprocesso > m.dt_fim
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
 		RETURN
 	ENDIF		
************************>
	wl_arqtmp = ""
	LNtmp     = 65		&& TABELA ASCII A = 65
	IF !UPabretmp("dpl")
		wp_flgfecha = .t.
	ENDIF
	IF wp_flgfecha
		RETURN
	ENDIF
	SET SAFET OFF
	LStmp = "&wp_dirtmp"+"&wl_arqtmp"

	SELE banco
	SET ORDER TO TAG banco

	SELE DUPLICAT
	SET RELATION TO cliente INTO clientes
	

	SELECT retornmv

	SET RELATION TO STR(EMPRESA,3)+STR(DUPLICATA,9) INTO duplicat
	SET SKIP TO duplicat
	SET RELATION TO banco      INTO banco additive


	WAIT WINDOW "AGUARDE. Gerando Arq. Temporario." NOWAIT


	LStp_LANCAME = "CAIXA"

	COPY TO &LStmp ;
		 FIELDS duplicat.regiao, clientes.natureza,    retornmv.efeito,  ;
		 		duplicat.nome  , duplicat.dt_venc, retornmv.vlr_pgto, ;
		 		retornmv.juros,retornmv.mora,retornmv.DESCONTO, ;
				duplicat.duplicata, duplicat.vlr_doc , ;
				retornmv.banco,;
				retornmv.dtaviso, retornmv.dtocorrenc, ;
				retornmv.dtprocesso,retornmv.ocorrencia  ;
  	    FOR	 retornmv.efeito > 0 AND retornmv.status = "PR" ;
			AND (banco.tp_lancame = "CAIXA" and retornmv.efeito > 1) ;
	    WHILE   retornmv.empresa     = m.empresa  AND ;
			        	 retornmv.dtprocesso <= m.dt_fim
    SELE 0
    USE "&wp_dirtmp"+"&wl_arqtmp" exclu
    INDEX ON DTOS(dtprocesso)+STR(REGIAO,3)+STR(natureza,2);
    				+STR(EFEITO,1)+NOME ;
			     TAG portador 	 ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
		SHOW WINDOW SCGC521 TOP
		SELECT &wl_arqtmp
    	USE
	    SELE DUPLICAT
 		RETURN
 	ENDIF		

*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SELECT &wl_arqtmp

	LF_fim  = .f.

	IF m.dt_fim - m.dt_inicio > 0
	    LSrel = "REL521A"      && TOTALIZA O MES
	ELSE
	    LSrel = "REL521"      && relatorio padrao
	ENDIF
    LSorienta = " FOR LFsegue "
	GO TOP
	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
	SET RELATION TO
	SHOW WINDOW SCGC521 TOP
	SELECT &wl_arqtmp
    USE
    SELE DUPLICAT
RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _3KQ0Y7F4M           m.aExtrCx_btn VALID                º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC521,     Record Number:   77   º
*       º Variable:            m.aExtrCx_btn                      º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      15                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _3kq0y7f4m     &&  m.aExtrCx_btn VALID
#REGION 1
	SELE clientes
	SET ORDER TO TAG cliente

	SELECT duplicat
	SET ORDER TO TAG doc
	SELECT retornmv
	SET ORDER TO TAG dtprocesso
	SET NEAR ON
	SEEK STR(m.empresa,3)+DTOS(m.dt_inicio)
	SET NEAR OFF
	IF retornmv.empresa <> m.empresa or retornmv.dtprocesso > m.dt_fim
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
 		RETURN
 	ENDIF		
************************>
	wl_arqtmp = ""
	LNtmp     = 65		&& TABELA ASCII A = 65
	IF !UPabretmp("dpl")
		wp_flgfecha = .t.
	ENDIF
	IF wp_flgfecha
		RETURN
	ENDIF
	SET SAFET OFF
	LStmp = "&wp_dirtmp"+"&wl_arqtmp"

	SELE banco
	SET ORDER TO TAG banco

	SELE DUPLICAT
	SET RELATION TO cliente INTO clientes
	

	SELECT retornmv

	SET RELATION TO STR(EMPRESA,3)+STR(DUPLICATA,9) INTO duplicat
	SET SKIP TO duplicat
	SET RELATION TO banco      INTO banco additive


	WAIT WINDOW "AGUARDE. Gerando Arq. Temporario." NOWAIT

	LStp_LANCAME = "EXTRA CAIXA"

	COPY TO &LStmp ;
		 FIELDS duplicat.regiao, clientes.natureza, retornmv.efeito,  ;
		 		duplicat.nome  , duplicat.dt_venc, retornmv.vlr_pgto, ;
		 		retornmv.juros,retornmv.mora,retornmv.DESCONTO, ;
				duplicat.duplicata, duplicat.vlr_doc , ;
				retornmv.banco,;
				retornmv.dtaviso, retornmv.dtocorrenc, ;
				retornmv.dtprocesso,retornmv.ocorrencia  ;
  	    FOR	 retornmv.efeito > 0 AND retornmv.status = "PR" ;
		    AND ((banco.tp_lancame = "EXTRA CAIXA") ;
		    	OR  ;
			    (banco.tp_lancame = "CAIXA" and retornmv.efeito = 1)) ;
      	 WHILE   retornmv.empresa     = m.empresa  AND ;
			        	 retornmv.dtprocesso <= m.dt_fim
    SELE 0
    USE "&wp_dirtmp"+"&wl_arqtmp" exclu
    INDEX ON DTOS(dtprocesso)+STR(REGIAO,3)+STR(natureza,2);
    				+STR(EFEITO,1)+NOME ;
			     TAG portador 	 ADDITIVE
	SET ORDER TO TAG portador
	GO TOP
	IF EOF()
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
		SHOW WINDOW SCGC521 TOP
		SELECT &wl_arqtmp
    	USE
	    SELE DUPLICAT
 		RETURN
 	ENDIF		

*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SELECT &wl_arqtmp

	LF_fim  = .f.

	IF m.dt_fim - m.dt_inicio > 0
	    LSrel = "REL521A"      && TOTALIZA O MES
	ELSE
	    LSrel = "REL521"      && relatorio padrao
	ENDIF
    LSorienta = " FOR LFsegue "
	GO TOP
	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
	SET RELATION TO
	SHOW WINDOW SCGC521 TOP
	SELECT &wl_arqtmp
    USE
    SELE DUPLICAT
RETURN
