*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º 03/19/09            OBJ_SLDT.SPR               14:53:30 º
*       º                                                         º
*       ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
*       º                                                         º
*       º Author's Name                                           º
*       º                                                         º
*       º Copyright (c) 2009 Company Name                         º
*       º Address                                                 º
*       º City,     Zip                                           º
*       º                                                         º
*       º Description:                                            º
*       º This program was automatically generated by GENSCRN.    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½

PARAMETERS ldmesini,lnmais,lsselecao

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º         OBJ_SLDT/MS-DOS Setup Code - SECTION 1          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1

IF EMPTY(LDmesini)
	LDmesini = DATE() - LNmais
ENDIF

*---------------------------------------------------------------*
* OPERA ARQUIVOS :
*
* OBJETIVO:		Selecionar meses
*---------------------------------------------------------------*

******>>>> INICIO CONTROLE AMBIENTAL
PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
ON KEY LABEL ESCAPE


PRIVATE wl_areant ,LFempfecha,wp_flgfecha ,isediting,wzalias
PRIVATE wi_opcoes ,wv_opcoes, LDdtfinal
PRIVATE LSmes,LSano,LSescolha,LNocorrenc


wl_areant 	= ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA
LFempfecha	= .F.		&& .F. => EMPRESA DEVE SER FECHADA NA SAIDA
wp_flgfecha = .F. 		&& defaut nao fechamento da secao
isediting	= .t.
m.wzalias	=SELECT()

*******

DIMENSION wv_opcoes(LNmais+3,1)

wi_opcoes = 3

wv_opcoes(1) = "Anula Selecoes."
wv_opcoes(2) = "Seleciona Todas."

LDdtfinal = GOMONTH(LDmesini,LNmais)

DO WHILE LDmesini <= LDdtfinal
   LSmes  = CHRTRAN(STR(MONTH(LDmesini),2)," ","0")
   LSano  = STR(YEAR(LDmesini),4)
	
   LSescolha = ALLTRIM(LSmes+"/"+LSano)

   IF LSescolha $ LSselecao
      wl_marca = chr(10)
   ELSE
      wl_marca = " "
   ENDIF
   wv_opcoes(wi_opcoes) = LSescolha+" "+ wl_marca+;
   									 " "+wp_meses(MONTH(LDmesini))
   wi_opcoes = wi_opcoes + 1
   LDmesini  = GOMONTH(LDmesini,1)
ENDDO
LNocorrenc= wi_opcoes - 1

wp_retorno(1) = LSselecao		&& devolver resultado



#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                MS-DOS Window definitions                º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

IF NOT WEXIST("selemeses") ;
	OR UPPER(WTITLE("SELEMESES")) == "SELEMESES.PJX" ;
	OR UPPER(WTITLE("SELEMESES")) == "SELEMESES.SCX" ;
	OR UPPER(WTITLE("SELEMESES")) == "SELEMESES.MNX" ;
	OR UPPER(WTITLE("SELEMESES")) == "SELEMESES.PRG" ;
	OR UPPER(WTITLE("SELEMESES")) == "SELEMESES.FRX" ;
	OR UPPER(WTITLE("SELEMESES")) == "SELEMESES.QPR"
	DEFINE WINDOW selemeses ;
		FROM INT((SROW()-15)/2),INT((SCOL()-50)/2) ;
		TO INT((SROW()-15)/2)+14,INT((SCOL()-50)/2)+49 ;
		TITLE "[ Seleciona Meses ]" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              OBJ_SLDT/MS-DOS Screen Layout              º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
IF WVISIBLE("selemeses")
	ACTIVATE WINDOW selemeses SAME
ELSE
	ACTIVATE WINDOW selemeses NOSHOW
ENDIF
@ 1,3 GET wi_opcoes ;
 	PICTURE "@&N" ;
	FROM wv_opcoes ;
	SIZE 12,43 ;
	DEFAULT 1 ;
	WHEN _2lx0vx20b() ;
	VALID _2lx0vx20f() ;
	MESSAGE "<ENTER> - Seleciona    -   <F2> - Sai " ;
	COLOR SCHEME 2
@ 0,0 TO 14,49 ;
	COLOR SCHEME 23
@ 13,22 GET m.OK_btn ;
	PICTURE "@*HN \<Ok" ;
	SIZE 1,4,1 ;
	DEFAULT 1 ;
	WHEN _2lx0vx20l() ;
	VALID _2lx0vx20m() ;
	MESSAGE 'Abre Sistema Vendas'
@ 0,49 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,49 TO 13,49 ;
	COLOR SCHEME 24
@ 14,49 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 14,1 TO 14,48 ;
	COLOR SCHEME 24
@ 0,1 SAY "[ Seleciona Meses ]" ;
	SIZE 1,19, 0

IF NOT WVISIBLE("selemeses")
	ACTIVATE WINDOW selemeses
ENDIF

READ CYCLE

RELEASE WINDOW selemeses

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              OBJ_SLDT/MS-DOS Cleanup Code               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1

wp_flgfecha = .F. 		&& defaut nao fechamento da secao

IF !EMPTY(wl_areant)
	SELECT &wl_areant
ENDIF

ON KEY LABEL ESCAPE
ON KEY LABEL O

POP KEY 			&& reabilita teclas de atalho def. anteriormente

RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0VX20B           wi_opcoes WHEN                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OBJ_SLDT,     Record Number:    2  º
*       º Variable:            wi_opcoes                          º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         List                               º
*       º Snippet Number:      1                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0vx20b     &&  wi_opcoes WHEN
#REGION 1
ON KEY LABEL O KEYBOARD "{CTRL-W}"
RETURN(.T.)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0VX20F           wi_opcoes VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OBJ_SLDT,     Record Number:    2  º
*       º Variable:            wi_opcoes                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         List                               º
*       º Snippet Number:      2                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0vx20f     &&  wi_opcoes VALID
#REGION 1
PRIVATE LNctr

IF LASTKEY() = -1
   SHOW GET	wi_opcoes DISABLE
   CLEAR READ
   CLEAR GET
   isediting = .f.
   RETURN .T.
endif
wl_marca = ""
wl_max = wi_opcoes
wl_marca = SUBS(wv_opcoes(wi_opcoes),9,1)

DO CASE
   CASE wi_opcoes = 1
        wl_comando = "ZERA"
        wi_opcoes = 3
        wl_max     = LNocorrenc
        wl_marca   = " "
   CASE wi_opcoes = 2
        wl_comando = "TODAS"
        wi_opcoes = 3
        wl_max     = LNocorrenc
        wl_marca = chr(10)
   OTHERWISE
        if wl_marca = " "
           wl_marca = chr(10)
           wl_comando = "MARCA"
        else
           wl_marca = " "
           wl_comando = "ZERA"
        endif
ENDCASE

*--->   MARCA ou DESMARCA

DO WHILE ! (wi_opcoes > wl_max)  && ATUALIZA VETOR
   wv_opcoes(wi_opcoes)= SUBS(wv_opcoes(wi_opcoes),1,8)+ ;
                        wl_marca+ ;
                        SUBS(wv_opcoes(wi_opcoes),10)
   wi_opcoes = wi_opcoes + 1
ENDDO

LNctr = 3
wp_retorno(1) = ""

DO WHILE ! (LNctr > LNocorrenc)  && ATUALIZA RETORNO MANTENDO ORDEM
	IF 	SUBS(wv_opcoes(LNctr),9,1) <> " "
	   wp_retorno(1) = wp_retorno(1)+left(wv_opcoes(LNctr),7)+"-"
	ENDIF
    LNctr = LNctr + 1
ENDDO



_CUROBJ = OBJNUM(wi_opcoes)
SHOW GET wi_opcoes
RETURN .f.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0VX20L           m.OK_btn WHEN                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OBJ_SLDT,     Record Number:    4  º
*       º Variable:            m.OK_btn                           º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      3                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0vx20l     &&  m.OK_btn WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.t.)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0VX20M           m.OK_btn VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         OBJ_SLDT,     Record Number:    4  º
*       º Variable:            m.OK_btn                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      4                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0vx20m     &&  m.OK_btn VALID
#REGION 1
CLEAR GETS
CLEAR READ
isediting = .f.
RETURN .T.