*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 03/19/09            OBJ_PRMT.SPR               14:53:17 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 2009 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ

PARAMETERS lsmsg, lscond

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         OBJ_PRMT/MS-DOS Setup Code - SECTION 1          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

IF NOT WEXIST("senha") ;
	OR UPPER(WTITLE("SENHA")) == "SENHA.PJX" ;
	OR UPPER(WTITLE("SENHA")) == "SENHA.SCX" ;
	OR UPPER(WTITLE("SENHA")) == "SENHA.MNX" ;
	OR UPPER(WTITLE("SENHA")) == "SENHA.PRG" ;
	OR UPPER(WTITLE("SENHA")) == "SENHA.FRX" ;
	OR UPPER(WTITLE("SENHA")) == "SENHA.QPR"
	DEFINE WINDOW senha ;
		FROM INT((SROW()-9)/2),INT((SCOL()-50)/2) ;
		TO INT((SROW()-9)/2)+8,INT((SCOL()-50)/2)+49 ;
		TITLE "INFORME CODIGO E SENHA " ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         OBJ_PRMT/MS-DOS Setup Code - SECTION 2          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1

*---------------------------------------------------------------*
* OPERA ARQUIVOS :
*			USUARIOS
*           ACESSOS
* OBJETIVO:		PERMITE IDENTIFICACAO DO USUARIO PARA O SISTEMA
*	
*---------------------------------------------------------------*
******>>>> INICIO CONTROLE AMBIENTAL
PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
ON KEY LABEL ESCAPE

PRIVATE LSalias
LSalias = ALIAS() && PARA RETORNAR A AREA ANTERIOR

LNusr_ret = 0
wp_msg = " "
IF !USED("USUARIO")
	IF !EMPTY(LSalias)
		SELE &LSalias
	ENDIF
	cSenha = " "
	POP KEY 			   && reabilita teclas de controle
	RETURN
ENDIF



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              OBJ_PRMT/MS-DOS Screen Layout              є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("senha")
	ACTIVATE WINDOW senha SAME
ELSE
	ACTIVATE WINDOW senha NOSHOW
ENDIF
@ 6,13 SAY "Senha...:" ;
	SIZE 1,9, 0
@ 0,0 TO 8,49 ;
	COLOR SCHEME 23
@ 8,1 TO 8,48 ;
	COLOR SCHEME 24
@ 1,49 TO 8,49 ;
	COLOR SCHEME 24
@ 8,49 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,49 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,7 TO 4,40 ;
	COLOR SCHEME 23
@ 4,8 TO 4,39 ;
	COLOR SCHEME 24
@ 4,40 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,40 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,40 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,11 TO 7,35 ;
	COLOR SCHEME 23
@ 7,12 TO 7,34 ;
	COLOR SCHEME 24
@ 7,35 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,35 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,35 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,12 SAY "-" ;
	SIZE 1,1, 0
@ 0,42 SAY "[PRMT]" ;
	SIZE 1,6, 0
@ 1,1 SAY LSmsg ;
	SIZE 1,47
@ 3,8 GET m.usr_libera ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	VALID _2lx0vwsio() ;
	ERROR wp_msg
@ 3,13 GET usuario.nome ;
	SIZE 1,25 ;
	DEFAULT " " ;
	WHEN .f.
@ 6,23 GET cSenha ;
	SIZE 1,10 ;
	DEFAULT " " ;
	PICTURE "@K" ;
	WHEN _2lx0vwska() ;
	VALID _2lx0vwskb() ;
	MESSAGE "Digite sua senha   /   <ESC>  -> Retorna " 	COLOR "R/R,R/R,R/R,R/R,R/R,R/R,R/R,R/R" ;
	ERROR "Senha nгo confere"

IF NOT WVISIBLE("senha")
	ACTIVATE WINDOW senha
ENDIF

READ CYCLE

RELEASE WINDOW senha

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              OBJ_PRMT/MS-DOS Cleanup Code               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
	IF !EMPTY(LSalias)
		SELE &LSalias
	ENDIF
	cSenha = " "
	POP KEY 			   && reabilita teclas de controle
RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VWSIO           m.usr_libera VALID                 є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_PRMT,     Record Number:   21  є
*       є Variable:            m.usr_libera                       є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vwsio     &&  m.usr_libera VALID
#REGION 1
	SELE USUARIO
	SET ORDER TO TAG usuario
	IF !SEEK(m.usr_libera)
	 	wp_msg = 'Usuario nao cadastrado.'
	    return .f.
	endif
	SHOW GET usuario.nome
*
	IF &LScond OR usuario.master
		RETURN .T.
	ENDIF
	wp_msg = 'Usuario nao atende condicao.'
RETURN .F.


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VWSKA           cSenha WHEN                        є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_PRMT,     Record Number:   23  є
*       є Variable:            cSenha                             є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vwska     &&  cSenha WHEN
#REGION 1
@ 6,33 say "<=" color W+/B*
SET COLOR TO B/B,B/B,B/B,B/B,B/B,B/B


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0VWSKB           cSenha VALID                       є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         OBJ_PRMT,     Record Number:   23  є
*       є Variable:            cSenha                             є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _2lx0vwskb     &&  cSenha VALID
#REGION 1
	@ 6,33 say "  "
	IF LASTKEY() <> 13 AND LASTKEY() <> 27
		RETURN -1
	ENDIF	
	if senha()
		LNusr_ret = usuario.usuario
		KEYBOARD CHR(27)
    	return .t.
	endif
	LNusr_ret = 0
return .f.
