*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 19/03/2009           SCGC800A.SPR              11:38:30 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 2009 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         SCGC800A/MS-DOS Setup Code - SECTION 1          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
CLEAR TYPEAHEAD
*---------------------------------------------------------------*
* OPERA ARQUIVOS :
*
* OBJETIVO:  PROGRAMA PRINCIPAL PARA EDICAO DE ITENS DA PROVISAO STQ
*
*---------------------------------------------------------------*

PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
*********************************************************************

PRIVATE isediting
PRIVATE wl_areant,wp_flgfecha, LFjanela,LNobjeto,tp_cons
PRIVATE wl_arqtmp,LNtmp,LStmp,LSsvtela	
PRIVATE GIRO_1,GIRO_2,GIRO_3
PRIVATE LFtpconsulta
PRIVATE LNvlrant1				&& P/ CALCULAR VALOR DA COMPRA (ULinfcamp)
******>>>> INICIO CONTROLE AMBIENTAL

ON KEY LABEL ESCAPE	KEYBOARD "{SHIFT-TAB}"

wl_areant 	= ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA
wp_flgfecha = .F. 		&& defaut nao fechamento da secao

LFjanela    = 3 		&& FLAG PARA CONTROLAR AS JANELAS
LNobjeto    = 1			&& permite voltar em scgc800Aa no mesmo obj ant
m.tp_cons   = 1
LNvlrant1	= 0
SAVE SCREEN TO LSsvtela	&& SO P/ INICIALISAR

*********************>>>> FIM CONTROLE AMBIENTAL <<<<<******************
************************************************************************

******>>>> INICIO CONTROLE ARQUIVOS
SELE prvitstq
wl_arqtmp = ""
LNtmp     = 65		&& TABELA ASCII A = 65
IF !UPabretmp("pre")
	wp_flgfecha = .t.
ENDIF
IF wp_flgfecha
	DO ULfecha
	POP KEY 			&& reabilita teclas de atalho def. anteriormente
	RETURN
ENDIF
******>>>> INICIO CONTROLE LOCAL


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

IF NOT WEXIST("scgc800a") ;
	OR UPPER(WTITLE("SCGC800A")) == "SCGC800A.PJX" ;
	OR UPPER(WTITLE("SCGC800A")) == "SCGC800A.SCX" ;
	OR UPPER(WTITLE("SCGC800A")) == "SCGC800A.MNX" ;
	OR UPPER(WTITLE("SCGC800A")) == "SCGC800A.PRG" ;
	OR UPPER(WTITLE("SCGC800A")) == "SCGC800A.FRX" ;
	OR UPPER(WTITLE("SCGC800A")) == "SCGC800A.QPR"
	DEFINE WINDOW scgc800a ;
		FROM 1, 2 ;
		TO 11,79 ;
		TITLE "[ ]" ;
		FOOTER "[800A]" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("itemprv1") ;
	OR UPPER(WTITLE("ITEMPRV1")) == "ITEMPRV1.PJX" ;
	OR UPPER(WTITLE("ITEMPRV1")) == "ITEMPRV1.SCX" ;
	OR UPPER(WTITLE("ITEMPRV1")) == "ITEMPRV1.MNX" ;
	OR UPPER(WTITLE("ITEMPRV1")) == "ITEMPRV1.PRG" ;
	OR UPPER(WTITLE("ITEMPRV1")) == "ITEMPRV1.FRX" ;
	OR UPPER(WTITLE("ITEMPRV1")) == "ITEMPRV1.QPR"
	DEFINE WINDOW itemprv1 ;
		FROM 12, 0 ;
		TO 24,79 ;
		TITLE " " ;
		FOOTER "ITEMPRV1" ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("scgc800c") ;
	OR UPPER(WTITLE("SCGC800C")) == "SCGC800C.PJX" ;
	OR UPPER(WTITLE("SCGC800C")) == "SCGC800C.SCX" ;
	OR UPPER(WTITLE("SCGC800C")) == "SCGC800C.MNX" ;
	OR UPPER(WTITLE("SCGC800C")) == "SCGC800C.PRG" ;
	OR UPPER(WTITLE("SCGC800C")) == "SCGC800C.FRX" ;
	OR UPPER(WTITLE("SCGC800C")) == "SCGC800C.QPR"
	DEFINE WINDOW scgc800c ;
		FROM 1, 2 ;
		TO 11,76 ;
		TITLE "[ ]" ;
		FOOTER "[800C]" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         SCGC800A/MS-DOS Setup Code - SECTION 2          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1

		SELECT  prvitstq
		SET ORDER TO TAG ordena
		SET NEAR ON
		SEEK STR(wp_empresa,3)+STR(m.numero,6)
		SET NEAR OFF
		***
		SET SAFET OFF
		LStmp = "\TMP\"+"&wl_arqtmp"
		COPY TO &LStmp WHILE !eof() ;
						AND wp_empresa 		= empresa ;
						AND m.numero	 	= numero    WITH CDX
	    SELE 0
	    USE "\TMP\"+"&wl_arqtmp"  EXCLUSIVE
		SET ORDER TO TAG ordena
		GO TOP
 	    DO brappend
		SCATTER MEMVAR
   ************************* 	
GO TOP
m.vlrcompra = 0
DO WHILE !EOF()
	m.vlrcompra = m.vlrcompra + ;
				(&wl_arqtmp .preco_vendor * &wl_arqtmp .pedir)
	SKIP
ENDDO
SELE prvcbstq
=RLOCK()
REPLACE prvcbstq.vlrcompra WITH m.vlrcompra
SELE &wl_arqtmp
GO TOP
****
isediting = .T.   && PERMITIR A EDICAO DOS CAMPOS OBJ_PRSO
******
LFtpconsulta = "SIMPLES"

LFjanela = 3
CLEAR TYPEAHEAD
**********************************************
SET SYSMENU ON
PUSH MENU _MSYSMENU
SET SYSMENU TO _MWINDOW, _MWI_ZOOM,_MWI_MOVE, _MEDIT, _MED_FIND, ;
						_MED_FINDA
HIDE MENU _MSYSMENU
*---
ON KEY LABEL F10    KEYBOARD "{CTRL-F10}"

KEYBOARD CHR(13)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              SCGC800A/MS-DOS Screen Layout              є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("scgc800a")
	ACTIVATE WINDOW scgc800a SAME
ELSE
	ACTIVATE WINDOW scgc800a NOSHOW
ENDIF
@ 0,0 TO 10,77 ;
	COLOR SCHEME 23
@ 10,1 TO 10,76 ;
	COLOR SCHEME 24
@ 10,77 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,77 TO 9,77 ;
	COLOR SCHEME 24
@ 0,77 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,70 SAY "[800A]" ;
	SIZE 1,6, 0
@ 2,41 SAY "=" ;
	SIZE 1,1, 0
@ 3,41 SAY "=" ;
	SIZE 1,1, 0
@ 4,41 SAY "=" ;
	SIZE 1,1, 0
@ 2,37 GET vendas_a ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 2,3 GET qtd_dias_A ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN .f.
@ 2,42 GET giro_a ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999.99" ;
	WHEN .f.
@ 3,37 GET vendas_b ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 3,3 GET qtd_dias_B ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN .f.
@ 3,42 GET giro_b ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999.99" ;
	WHEN .f.
@ 4,37 GET vendas_c ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 4,3 GET qtd_dias_c ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN .f.
@ 4,42 GET giro_c ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999.99" ;
	WHEN .f.
@ 2,9 GET semstq_a ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN .f.
@ 3,9 GET semstq_b ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN .f.
@ 4,9 GET semstq_c ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN .f.
@ 0,27 GET media_perm ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "99999.99" ;
	WHEN .f.
@ 1,8 SAY "Stq=0" ;
	SIZE 1,5, 0
@ 2,18 GET qtdatend_A ;
	SIZE 1,4 ;
	DEFAULT " " ;
	PICTURE "9999" ;
	WHEN .f.
@ 3,18 GET qtdatend_b ;
	SIZE 1,4 ;
	DEFAULT " " ;
	PICTURE "9999" ;
	WHEN .f.
@ 4,18 GET qtdatend_c ;
	SIZE 1,4 ;
	DEFAULT " " ;
	PICTURE "9999" ;
	WHEN .f.
@ 6,49 GET giromedio ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999.99" ;
	WHEN .f.
@ 0,33 SAY "   ]" ;
	SIZE 1,4, 0
@ 1,1 SAY "DiasUt" ;
	SIZE 1,6, 0
@ 2,24 GET entradas_a ;
	SIZE 1,5 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 3,24 GET entradas_b ;
	SIZE 1,5 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 4,24 GET entradas_c ;
	SIZE 1,5 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 7,51 GET prvvenda_a ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 7,13 GET saldo ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 8,13 GET pedidotran ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 9,13 GET pedidopfat ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 9,71 GET verifica ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 0,7 SAY "[ Saldo Medio/Dia : " ;
	SIZE 1,20, 0
@ 5,41 SAY "=" ;
	SIZE 1,1, 0
@ 5,37 GET vendas_d ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 5,3 GET qtd_dias_d ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN .f.
@ 5,42 GET giro_d ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999.99" ;
	WHEN .f.
@ 5,9 GET semstq_d ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN .f.
@ 5,18 GET qtdatend_d ;
	SIZE 1,4 ;
	DEFAULT " " ;
	PICTURE "9999" ;
	WHEN .f.
@ 5,24 GET entradas_d ;
	SIZE 1,5 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 6,41 SAY "=" ;
	SIZE 1,1, 0
@ 6,37 GET vendas_e ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 6,3 GET qtd_dias_e ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN .f.
@ 6,42 GET giro_e ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999.99" ;
	WHEN .f.
@ 6,9 GET semstq_e ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN .f.
@ 6,18 GET qtdatend_e ;
	SIZE 1,4 ;
	DEFAULT " " ;
	PICTURE "9999" ;
	WHEN .f.
@ 6,24 GET entradas_e ;
	SIZE 1,5 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 1,17 SAY "Atend." ;
	SIZE 1,6, 0
@ 1,23 SAY "StqAcm" ;
	SIZE 1,6, 0
@ 1,37 SAY "Vend" ;
	SIZE 1,4, 0
@ 2,61 SAY "=" ;
	SIZE 1,1, 0
@ 3,61 SAY "=" ;
	SIZE 1,1, 0
@ 4,61 SAY "=" ;
	SIZE 1,1, 0
@ 2,57 GET rvvendas_a ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 2,63 GET M.rvgiro_a ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999.99" ;
	WHEN .f.
@ 3,57 GET rvvendas_b ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 3,63 GET M.rvgiro_b ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999.99" ;
	WHEN .f.
@ 4,57 GET rvvendas_c ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 4,63 GET M.rvgiro_c ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999.99" ;
	WHEN .f.
@ 6,70 GET rvgiromedi ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999.99" ;
	WHEN .f.
@ 5,61 SAY "=" ;
	SIZE 1,1, 0
@ 5,57 GET rvvendas_d ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 5,63 GET M.rvgiro_d ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999.99" ;
	WHEN .f.
@ 6,61 SAY "=" ;
	SIZE 1,1, 0
@ 6,57 GET rvvendas_e ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 6,63 GET M.rvgiro_e ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999.99" ;
	WHEN .f.
@ 7,71 GET prvvenda_b ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 8,51 GET gatilho ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 2,31 GET vdcasada_a ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 3,31 GET vdcasada_b ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 4,31 GET vdcasada_c ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 5,31 GET vdcasada_d ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 6,31 GET vdcasada_e ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 10,28 SAY "[  " ;
	SIZE 1,3, 0
@ 10,46 SAY "  ]" ;
	SIZE 1,3, 0
@ 10,31 GET codigo ;
	SIZE 1,15 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN .f.
@ 9,2 SAY "PENDENTE:" ;
	SIZE 1,9, 0
@ 7,2 SAY "SALDO....:" ;
	SIZE 1,10, 0
@ 8,2 SAY "TRANSITO.:" ;
	SIZE 1,10, 0
@ 1,63 SAY "Giro ATC" ;
	SIZE 1,8, 0
@ 1,54 SAY "Vend.ATC" ;
	SIZE 1,8, 0
@ 1,30 SAY "Casada" ;
	SIZE 1,6, 0
@ 1,42 SAY "Gro Vrj" ;
	SIZE 1,7, 0
@ 6,69 SAY "<" ;
	SIZE 1,1, 0
@ 6,76 SAY ">" ;
	SIZE 1,1, 0
@ 6,48 SAY "<" ;
	SIZE 1,1, 0
@ 6,55 SAY ">" ;
	SIZE 1,1, 0
@ 7,23 SAY "VENDA PREVISTA P/: [ VRJ" ;
	SIZE 1,24, 0
@ 7,76 SAY "]" ;
	SIZE 1,1, 0
@ 8,23 SAY "PEDIDO PELO GATILHO......:" ;
	SIZE 1,26, 0
@ 7,55 SAY "]  [ VRJ+ATC..:" ;
	SIZE 1,15, 0
@ 9,56 SAY "[ VENDA REAL :" ;
	SIZE 1,14, 0
@ 9,76 SAY "]" ;
	SIZE 1,1, 0




*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              SCGC800B/MS-DOS Screen Layout              є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 2
IF WVISIBLE("itemprv1")
	ACTIVATE WINDOW itemprv1 SAME
ELSE
	ACTIVATE WINDOW itemprv1 NOSHOW
ENDIF
@ 1,2 GET GET_1ITEM ;
	SIZE 1,1 ;
	DEFAULT " " ;
	WHEN _2lx0oyabs()




*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              SCGC800C/MS-DOS Screen Layout              є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 3
IF WVISIBLE("scgc800c")
	ACTIVATE WINDOW scgc800c SAME
ELSE
	ACTIVATE WINDOW scgc800c NOSHOW
ENDIF
@ 0,0 TO 10,74 ;
	COLOR SCHEME 23
@ 10,1 TO 10,73 ;
	COLOR SCHEME 24
@ 10,74 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,74 TO 9,74 ;
	COLOR SCHEME 24
@ 0,74 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 10,35 GET m.data ;
	SIZE 1,8 ;
	DEFAULT {  /  /  } ;
	WHEN .F.
@ 10,52 GET m.prover_ate ;
	SIZE 1,8 ;
	DEFAULT {  /  /  } ;
	WHEN .f.
@ 10,61 GET m.em_dias ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN .f.
@ 0,51 GET Smedia_perm ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "99999.99" ;
	WHEN .f.
@ 0,66 SAY "[800C]" ;
	SIZE 1,6, 0
@ 0,1 SAY "[ Vlr Compras :          ]" ;
	SIZE 1,26, 0
@ 0,16 GET SVLRCOMPRA ;
	SIZE 1,10 ;
	DEFAULT " " ;
	PICTURE "@K 999,999.99" ;
	WHEN .F.
@ 0,31 SAY "[ Saldo Medio/Dia : " ;
	SIZE 1,20, 0
@ 0,57 SAY "   ]" ;
	SIZE 1,4, 0
@ 8,41 SAY "Pd.Trans:" ;
	SIZE 1,9, 0
@ 8,56 SAY "Pd.p/Fat:" ;
	SIZE 1,9, 0
@ 8,10 GET SLNvdprev ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 8,35 GET Ssaldo ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 8,50 GET Spedidotran ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 8,65 GET Spedidopfat ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 8,20 GET Sverifica ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .F.
@ 8,1 SAY "Vend.Prv:" ;
	SIZE 1,9, 0
@ 8,15 SAY "Real:" ;
	SIZE 1,5, 0
@ 8,30 SAY "Sld :" ;
	SIZE 1,5, 0
@ 10,45 SAY "[ Ate :" ;
	SIZE 1,7, 0
@ 10,60 SAY "=" ;
	SIZE 1,1, 0
@ 10,64 SAY " dias ]" ;
	SIZE 1,7, 0
@ 10,8 GET Scodigo ;
	SIZE 1,15 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN .f.
@ 10,23 SAY "   ]" ;
	SIZE 1,4, 0
@ 10,5 SAY "[  " ;
	SIZE 1,3, 0

IF NOT WVISIBLE("scgc800c")
	ACTIVATE WINDOW scgc800c
ENDIF
IF NOT WVISIBLE("itemprv1")
	ACTIVATE WINDOW itemprv1
ENDIF
IF NOT WVISIBLE("scgc800a")
	ACTIVATE WINDOW scgc800a
ENDIF


READ CYCLE ;
	WHEN LFjanela = 3 ;
	DEACTIVATE !isediting ;
	SHOW LFjanela = 3

RELEASE WINDOW itemprv1
RELEASE WINDOW scgc800a
RELEASE WINDOW scgc800c

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              SCGC800A/MS-DOS Cleanup Code               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
POP MENU _MSYSMENU
SET SYSMENU OFF
isediting = .F.   && INIBIE A EDICAO DOS CAMPOS SCGC240A
IF LEFT(m.situacao,1) = "A"
	SET POINT TO ","
	SET SEPARATOR  TO "."
ENDIF
RELEASE WINDOW ITEMPRV1
SET FORMAT TO
#DEFINE C_ABORTA      'Deseja Gravar as Alteracoes ?.'

DO ULfecha
POP KEY 			&& reabilita teclas de atalho def. anteriormente

RETURN

*<<<<<<<<<<<<<<<<<<<<<<<<<<---------->>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*
*----- ROTINAS DE APOIO A EXECUCAO DO PROGRAMA                      ---*
*<<<<<<<<<<<<<<<<<<<<<<<<<<---------->>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є  SCGC800A/MS-DOS Supporting Procedures and Functions    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
PROCEDURE ULfecha
	=UP_fecha("&wl_arqtmp")
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(wl_areant)
		SELECT &wl_areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
RETURN


*<<<<<<<<<<<<<<<<<<<<<<<<<<---------->>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*
*----- ROTINAS DE APOIO A EXECUCAO DO PROGRAMA                      ---*
*<<<<<<<<<<<<<<<<<<<<<<<<<<---------->>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*
*
*  CENTRAL DE CONTROLE DO BROWSE / EDIЂЗO
*----------------------------------------------------------------------*

FUNCTION ULinfcamp	&& mantem variavel com nome do campo em edicao
	PARAMETERS Lcmp,Loper
		LSposcampo = Lcmp

		SAVE SCREEN TO LSsvtela	&& SO P/ INICIALISAR

		AKEY= LASTKEY()


		*===<<< ============================================== >>>===*
		*===<<<  TESTAR SAIDA			              		   >>>===*
		*===<<< ============================================== >>>===*
		IF  Lcmp = "SAIR"		&& CTRL-END
			CLEAR TYPEAHEAD
			IF !ULversaida()
				Lcmp = "ATVJAN-3"
			ENDIF
		ENDIF						
		************************************************************

		IF !ISEDITING
			RETURN(.T.)
		ENDIF

		*===<<< ROTINAS TRATADAS NA ENTRADA OU SAIDA DE CAMPOS >>>===*

		*===<<< ============================================== >>>===*
		*===<<<  EXIBIR JANELAS 		O              		   >>>===*
		*===<<< ============================================== >>>===*

		IF  Lcmp = "ATVJAN-1"
			DO ULtpcons
		ENDIF

		IF  Lcmp = "ATVJAN-3"
		    LFjanela = 3
			CLEAR TYPEAHEAD
			DEACTIVATE WINDOWS ITEMPRV2
		    SHOW WINDOW ITEMPRV1 TOP
			ACTIVATE WINDOWS ITEMPRV2 TOP
		    SHOW WINDOW ITEMPRV2 REFRESH TOP
			SHOW GETS
		ENDIF

		*===<<< ============================================== >>>===*
		*===<<<  L - LOCALIZACAO DE CODIGO             		   >>>===*
		*===<<< ============================================== >>>===*

		IF  Lcmp = "ATVJAN-4"
		    LFjanela = 4
			CLEAR TYPEAHEAD
			DO SCGC800D.SPR WITH &wl_arqtmp .empresa, &wl_arqtmp .numero
		    LFjanela = 3
			CLEAR TYPEAHEAD
		    SHOW WINDOW ITEMPRV2 REFRESH TOP
			SHOW GETS
			RETURN(.T.)
		ENDIF

		*===<<< ============================================== >>>===*
		*===<<< "ATIBUIR SUGESTAO" - ACATAR SUGESTAO   		   >>>===*
		*===<<< ============================================== >>>===*
		IF  Lcmp = "ATIBUIR SUGESTAO"
			IF &wl_arqtmp .TIPO_REG <> "T" OR ;
			   &wl_arqtmp .SUGESTAO_B < 1
				RETURN
			ENDIF
			REPLACE pedir      WITH &wl_arqtmp .SUGESTAO_B
			DO ULgrava
			CLEAR TYPEAHEAD
		    SHOW WINDOW ITEMPRV2 REFRESH TOP
			SHOW GETS
			RETURN
		ENDIF
		*===<<< ============================================== >>>===*
		*===<<<  F3 - INFORMACOES ADICIONAIS DO PRODUTO  	   >>>===*
		*===<<< ============================================== >>>===*

		IF  Lcmp = "ATVJAN-5" &&TAB =>VER INF. ADIC DO PRODUTO
		    LFjanela = 5
			=ULinfostq()
		    LFjanela = 3
			CLEAR TYPEAHEAD
		    SHOW WINDOW ITEMPRV2 REFRESH TOP
			SHOW GETS
			RETURN(.T.)
		ENDIF

		*===<<< ============================================== >>>===*
		*===<<<  P="IMPRIMIR PREVIA"  						   >>>===*
		*===<<< ============================================== >>>===*
		IF  Lcmp = "IMPRIMIR PREVIA"
			=ULimpprevia()
		    LFjanela = 3
			CLEAR TYPEAHEAD
		    SHOW WINDOW ITEMPRV2 REFRESH TOP
			SHOW GETS
			RETURN
		ENDIF

		*===<<< ============================================== >>>===*
		*===<<<  F4 - NEGOCIA CONDICOES                 	   >>>===*
		*===<<< ============================================== >>>===*

		IF  Lcmp = "ATVJAN-6"
		    LFjanela = 6
			DO ULcombina
			DO ULgrava
		    LFjanela = 3
			CLEAR TYPEAHEAD
		    SHOW WINDOW ITEMPRV2 REFRESH TOP
			SHOW GETS

			RETURN(.T.)
		ENDIF


		IF  LFjanela <>  3
			RETURN
		ENDIF

		*===<<< ============================================== >>>===*
		*===<<<  RETORNO DE REGISTRO PELA TECLA ESC			   >>>===*
		*===<<< ============================================== >>>===*

		IF  Loper = "W" AND (AKEY = 27 OR AKEY = 15) AND LCmp $ "SUGESTAO"
			CLEAR TYPEAHEAD
			KEYBOARD "{UPARROW}"
			DEACTIVATE WINDOWS ITEMPRV
		    SHOW WINDOW ITEMPRV1 TOP
			ACTIVATE WINDOWS ITEMPRV2 TOP
		    SHOW WINDOW ITEMPRV2 REFRESH TOP
			RETURN(.T.)
		ENDIF
	
		*===<<< ============================================== >>>===*
		*===<<<  AVANCO DE LINHA PELA TECLA ENTER  			   >>>===*
		*===<<< ============================================== >>>===*

		IF  Loper = "W" AND AKEY = 13 AND LCmp = "PEDIR"
	    	CLEAR TYPEAHEAD
			KEYBOARD "{DNARROW}"
			DEACTIVATE WINDOWS ITEMPRV
		    SHOW WINDOW ITEMPRV1 TOP
			ACTIVATE WINDOWS ITEMPRV2 TOP
		    SHOW WINDOW ITEMPRV2 REFRESH TOP
			RETURN(.T.)
		ENDIF

		*===<<< ============================================== >>>===*
		*===<<<  ATIVA POSSIBILIDADE NEGOCIACAO F4         	   >>>===*
		*===<<< ============================================== >>>===*

		IF  Loper = "W" AND LCmp = "PRECO"
			ON KEY LABEL F4 DO ULinfcamp WITH "ATVJAN-6" , "X"
		ENDIF

		IF  Loper = "V" AND LCmp = "PRECO"
			ON KEY LABEL F4	
		ENDIF
***
		IF Loper = "W"
			LNvlrant1 = &wl_arqtmp .preco_vendor * ;
							&wl_arqtmp .pedir
		ENDIF
		IF !(LCmp $ "PEDIR/PRECO")
			RETURN(.F.)
		ENDIF
***
		*------  W => QUANDO => ENTRADA NO CAMPO
		*------  V => VALID  => SAIDA   NO CAMPO
		DO CASE
		   CASE Loper = "W"
				IF &wl_arqtmp .TIPO_REG <> "T"
					RETURN(.F.)
				ENDIF
		   CASE Loper = "V" AND LCmp $ "PEDIR/PRECO"
				DO ULgrava
		ENDCASE

	    SELECT &wl_arqtmp
RETURN(.T.)

PROCEDURE ULgrava
				m.vlrcompra = m.vlrcompra - LNvlrant1
				m.vlrcompra = m.vlrcompra + ;
							(&wl_arqtmp .preco_vendor * &wl_arqtmp .pedir)

				LNvlrant1 = &wl_arqtmp .preco_vendor * ;
							&wl_arqtmp .pedir

				SELE prvitstq
				SET ORDER TO TAG ordena
				SEEK STR(&wl_arqtmp .empresa,3)+;
					 STR(&wl_arqtmp .numero,6)+;
					 STR(&wl_arqtmp .ordem,5)+;
					 STR(&wl_arqtmp .regional,2)+;
					 STR(&wl_arqtmp .filial,3)
				IF !FOUND()
					WAIT WINDOW "Um erro nao Permitiu gravar este registro."
					RETURN(.F.)
				ELSE
					IF prvitstq.pedir 		<> &wl_arqtmp .pedir OR ;
					   prvitstq.preco_vendor  <> &wl_arqtmp .preco_vendor
						=REGLOCK(.T.)
						REPLACE pedir      WITH &wl_arqtmp .pedir
						REPLACE preco_tab  WITH &wl_arqtmp .preco_tab
						REPLACE preco_vendor WITH &wl_arqtmp .preco_vendor

						REPLACE desc_1 WITH &wl_arqtmp .desc_1
						REPLACE desc_2 WITH &wl_arqtmp .desc_2
						REPLACE desc_3 WITH &wl_arqtmp .desc_3
						REPLACE desc_4 WITH &wl_arqtmp .desc_4
						REPLACE desc_5 WITH &wl_arqtmp .desc_5
						REPLACE desc_6 WITH &wl_arqtmp .desc_6
						REPLACE desc_7 WITH &wl_arqtmp .desc_7
						REPLACE desc_8 WITH &wl_arqtmp .desc_8
						REPLACE desc_9 WITH &wl_arqtmp .desc_9

						REPLACE avindice WITH &wl_arqtmp .avindice
						REPLACE apindice WITH &wl_arqtmp .apindice

						REPLACE prvcbstq.vlrcompra WITH m.vlrcompra

					ENDIF
				ENDIF
RETURN
************************************************************
****-------------->>>>>
************************************************************
FUNCTION ULversaida     && VERIFICA O INTERESSE DE SAIDA
	   CLEAR TYPEAHEAD
	   LCtmp = foxalert2('Confirma Sair da Edicao  ?')
	   IF LCtmp = "S"
		  	  isediting = .F.   && INIBIE A EDICAO DOS CAMPOS SCGC240A
		  	  ON KEY LABEL ESCAPE
		      KEYBOARD '{CTRL-W}'
			  RETURN(.T.)
   	   ELSE	
   		   IF LCtmp = "N"   && abandonar
			  ON KEY LABEL ESCAPE
			  KEYBOARD CHR(27)
			  isediting = .F.   && INIBIE A EDICAO DOS CAMPO OBJ_PRSO
			  RETURN(.T.)
		   ENDIF
	   ENDIF					
RETURN(.F.)


*********************************************************************
* ROTINAS DE APOIO AO OPERADOR
**********************************************************************
FUNCTION ULinfostq
	PRIVATE VLtela, LNregant
	ON KEY LABEL ENTER
	SELE &wl_arqtmp
	LNreg800A = RECNO()
	**
	IF LFtpconsulta = "SIMPLES"
		ACTIVATE WINDOW SCGC800C
		SHOW WINDOW SCGC800C
	ELSE
		ACTIVATE WINDOW SCGC800A
		SHOW WINDOW SCGC800A
	ENDIF
	SAVE SCREEN TO VLtela
	**
*	DEACTIVATE WINDOW SCGC800A
*	HIDE WINDOW ALL
	do obj_ROL1.spr WITH ;
			&wl_arqtmp .codigo, &wl_arqtmp .filial, ;
			prvcbstq.DATA - 45,prvcbstq.DATA - 45,;
			prvcbstq.data, prvcbstq.prover_ate
	**
	IF LFtpconsulta = "SIMPLES"
		ACTIVATE WINDOW SCGC800C
		SHOW WINDOW SCGC800C
	ELSE
		ACTIVATE WINDOW SCGC800A
		SHOW WINDOW SCGC800A
	ENDIF
	RESTORE SCREEN FROM VLtela

	SELE &wl_arqtmp
	GO LNreg800A
	SELE grupo
	SET ORDER TO TAG codigo
	SELE EMPRESA
	SET ORDER TO TAG EMPRESA
	SELE &wl_arqtmp
	SET RELATION TO filial INTO empresa
	SET RELATION TO codigo INTO grupo ADDITIVE

	LFjanela = 3
	ON KEY LABEL ESCAPE	KEYBOARD "{BACKTAB}"
	LNobjeto = _CUROBJ
	ACTIVATE WINDOW ITEMPRV1  TOP
	ACTIVATE WINDOW ITEMPRV2  TOP
	SHOW WINDOW ITEMPRV1 REFRESH TOP
	SHOW WINDOW ITEMPRV2 REFRESH TOP
RETURN

FUNCTION ULimpprevia
	PRIVATE VLtela, LNregant
	PRIVATE WL_antarqtmp
	ON KEY LABEL ENTER


	WL_antarqtmp	= wl_arqtmp

	SELE &wl_arqtmp
	LNreg800A = RECNO()
	**
	IF LFtpconsulta = "SIMPLES"
		ACTIVATE WINDOW SCGC800C
		SHOW WINDOW SCGC800C
	ELSE
		ACTIVATE WINDOW SCGC800A
		SHOW WINDOW SCGC800A
	ENDIF
	SAVE SCREEN TO VLtela
	**
	DO ULimp WITH 4,&wl_arqtmp .empresa,&wl_arqtmp .numero
	**

	wl_arqtmp	= WL_antarqtmp	

	IF LFtpconsulta = "SIMPLES"
		ACTIVATE WINDOW SCGC800C
		SHOW WINDOW SCGC800C
	ELSE
		ACTIVATE WINDOW SCGC800A
		SHOW WINDOW SCGC800A
	ENDIF
	RESTORE SCREEN FROM VLtela


	SELE &wl_arqtmp
	SET ORDER TO TAG ordena
	GO LNreg800A
	=FLOCK()
	SELE grupo
	SET ORDER TO TAG codigo
	SELE EMPRESA
	SET ORDER TO TAG EMPRESA
	SELE &wl_arqtmp
	SET RELATION TO filial INTO empresa
	SET RELATION TO codigo INTO grupo ADDITIVE

	LFjanela = 3
	ON KEY LABEL ESCAPE	KEYBOARD "{BACKTAB}"
	LNobjeto = _CUROBJ
	ACTIVATE WINDOW ITEMPRV1  TOP
	ACTIVATE WINDOW ITEMPRV2  TOP
	SHOW WINDOW ITEMPRV1 REFRESH TOP
	SHOW WINDOW ITEMPRV2 REFRESH TOP
RETURN


FUNCTION ULcombina
 		
 		LNpreco		=   &wl_arqtmp  .preco_tab
		LNdesc_1	=	&wl_arqtmp  .desc_1
		LNdesc_2	=	&wl_arqtmp  .desc_2
		LNdesc_3	=	&wl_arqtmp  .desc_3
		LNdesc_4	=	&wl_arqtmp  .desc_4
		LNdesc_5	=	&wl_arqtmp  .desc_5
		LNdesc_6	=	&wl_arqtmp  .desc_6
		LNdesc_7	=	&wl_arqtmp  .desc_7
		LNdesc_8	=	&wl_arqtmp  .desc_8
		LNdesc_9	=	&wl_arqtmp  .desc_9
		LNdesc_t	=	&wl_arqtmp  .desc_t
		LNavindice	=	&wl_arqtmp  .avindice
		LNapindice	=	&wl_arqtmp  .apindice

		LNpreco_vendor =	&wl_arqtmp  .preco_vendor

		*------------------------------------------------------------*
		* OBJ_800A.SPR 	= AInformar descontos especificos,alterar
		*				  preco de tabela de um produto
		*------------------------------------------------------------*
		wp_retorno(1) = 0
		DO  OBJ_800A.SPR WITH ;
					codforn, codigo, ;
				    grupo.descricao,LNpreco,;
					LNdesc_1,LNdesc_2,LNdesc_3,LNdesc_4,LNdesc_5,LNdesc_6,;
					LNdesc_7,LNdesc_8,LNdesc_9,;
					LNdesc_t,LNavindice,LNapindice
		*------------------------------------------------------------*
		IF wp_retorno(1) > 0	&& FOI ALTERADO E CONFIRMADO COM <OK>
			LNregvolta = RECNO()
			LNordem    = &wl_arqtmp .ordem
			LNemp	   = &wl_arqtmp .empresa
			LNnro	   = &wl_arqtmp .numero
			SET NEAR ON
			SET ORDER TO TAG ordena
			SEEK STR(LNemp,3)+STR(LNnro,6)+STR(LNordem,5)
			SET NEAR OFF
			DO WHILE !EOF() AND ;
				LNordem    = &wl_arqtmp .ordem    AND;
				LNemp	   = &wl_arqtmp .empresa  AND;
				LNnro	   = &wl_arqtmp .numero
					LNvlrant1 = &wl_arqtmp .preco_vendor * ;
							&wl_arqtmp .pedir
					REPLACE &wl_arqtmp .preco_tab WITH LNpreco
					REPLACE &wl_arqtmp .desc_1 WITH LNdesc_1
					REPLACE &wl_arqtmp .desc_2 WITH LNdesc_2
					REPLACE &wl_arqtmp .desc_3 WITH LNdesc_3
					REPLACE &wl_arqtmp .desc_4 WITH LNdesc_4
					REPLACE &wl_arqtmp .desc_5 WITH LNdesc_5
					REPLACE &wl_arqtmp .desc_6 WITH LNdesc_6
					REPLACE &wl_arqtmp .desc_7 WITH LNdesc_7
					REPLACE &wl_arqtmp .desc_8 WITH LNdesc_8
					REPLACE &wl_arqtmp .desc_9 WITH LNdesc_9
					REPLACE &wl_arqtmp .desc_t WITH LNdesc_t
					REPLACE &wl_arqtmp .avindice WITH LNavindice
					REPLACE &wl_arqtmp .apindice WITH LNapindice
					m.preco_tab  = LNpreco
					m.aliq_ipi	 = &wl_arqtmp .aliq_ipi
					m.desc_t	 = LNdesc_t
					m.avindice	 = LNavindice
					m.apindice	 = LNapindice
					*------------- Calculo do Preco Final --------------*
					STORE 0 TO m.preco_compra
					LNvendor =  m.avindice
					DO UPcalcusto WITH ;
						 1,m.preco_tab,m.desc_t,m.aliq_ipi,0,0,;
							0,0,LNvendor,0,0,;
					    	0,0,0,;
						    0,0,0,;
						    0,0,0,;
						    m.preco_compra,0
					m.preco_normal= m.preco_compra
					*--------------------------------------------------*
					LNvendor =  m.apindice
					DO UPcalcusto WITH ;
						 1,m.preco_tab,m.desc_t,m.aliq_ipi,0,0,;
							0,0,LNvendor,0,0,;
				    		0,0,0,;
					    	0,0,0,;
						    0,0,0,;
						    m.preco_compra,0
					m.preco_vendor= m.preco_compra
					*--------------------------------------------------*
					REPLACE &wl_arqtmp .preco_normal WITH m.preco_normal
					REPLACE &wl_arqtmp .preco_vendor WITH m.preco_vendor
					DO ULgrava
				  	SELE &wl_arqtmp
					SKIP
			ENDDO
			GO LNregvolta
			LNvlrant1 = &wl_arqtmp .preco_vendor * ;
							&wl_arqtmp .pedir
		ENDIF
    	CLEAR TYPEAHEAD
	   	CLEAR TYPEAHEAD
	  	SELE &wl_arqtmp
RETURN

FUNCTION ULtpcons
	IF LFtpconsulta = "SIMPLES"
		LFtpconsulta = "COMPLETA"
		SHOW WINDOW SCGC800A REFRESH SAME
		HIDE WINDOW SCGC800C SAME
	ELSE
		LFtpconsulta = "SIMPLES"
		SHOW WINDOW SCGC800C REFRESH SAME
		HIDE WINDOW SCGC800A SAME
	ENDIF
RETURN


FUNCTION  ULsai

	IF TYPE("MARCADOR") <> "U"
		REPLACE marcador WITH " "
	ENDIF
RETURN(.T.)

FUNCTION ULatualiza
	REPLACE &wl_arqtmp .marcador WITH ""

	SHOW GET m.vlrcompra
**	SHOW GET grupo.descricao
	SHOW GET codigo
	SHOW GET giro_A
	SHOW GET giro_B
	SHOW GET giro_C
	SHOW GET giro_D
	SHOW GET giro_E
	SHOW GET giromedio

	SHOW GET vendas_A
	SHOW GET vendas_B
	SHOW GET vendas_C
	SHOW GET vendas_D
	SHOW GET vendas_E

	SHOW GET vdcasada_A
	SHOW GET vdcasada_B
	SHOW GET vdcasada_C
	SHOW GET vdcasada_D
	SHOW GET vdcasada_E

	SHOW GET rvgiro_A
	SHOW GET rvgiro_B
	SHOW GET rvgiro_C
	SHOW GET rvgiro_D
	SHOW GET rvgiro_E

	m.rvgiro_A = giro_A + rvgiro_A
	m.rvgiro_B = giro_B + rvgiro_B
	m.rvgiro_C = giro_C + rvgiro_C
	m.rvgiro_D = giro_D + rvgiro_D
	m.rvgiro_E = giro_E + rvgiro_E

	SHOW GET M.rvgiro_A
	SHOW GET M.rvgiro_B
	SHOW GET M.rvgiro_C
	SHOW GET M.rvgiro_D
	SHOW GET M.rvgiro_E


	SHOW GET rvgiromedio
	SHOW GET rvgiromedi
	SHOW GET rvvendas_A
	SHOW GET rvvendas_B
	SHOW GET rvvendas_C
	SHOW GET rvvendas_D
	SHOW GET rvvendas_E

	SHOW GET entradas_A
	SHOW GET entradas_B
	SHOW GET entradas_C
	SHOW GET entradas_D
	SHOW GET entradas_E
	
	SHOW GET qtd_dias_a
	SHOW GET qtd_dias_b
	SHOW GET qtd_dias_C
	SHOW GET qtd_dias_D
	SHOW GET qtd_dias_E

	SHOW GET semstq_a
	SHOW GET semstq_b
	SHOW GET semstq_c
	SHOW GET semstq_D
	SHOW GET semstq_E
	SHOW GET media_perm
	SHOW GET qtdatend_A
	SHOW GET qtdatend_B
	SHOW GET qtdatend_C
	SHOW GET qtdatend_D
	SHOW GET qtdatend_E
	SHOW GET indice_saz
	SHOW GET gatilho

*	LNvdprev   = int(giromedio*prvcbstq.em_dias)
*	LNvdrvprev = int(rvgiromedi*prvcbstq.em_dias)
*	LNvdszprev = LNvdrvprev + (LNvdrvprev * indice_saz) / 100
*
*	LNvdszprev = (LNvdprev + LNvdrvprev) / 2


	SHOW GET prvvenda_a
	SHOW GET prvvenda_b

	SHOW GET saldo
	SHOW GET pedidotran
	SHOW GET verifica
	SHOW GET pedidopfat
	
	
	Svlrcompra 	= 	m.vlrcompra
	Sdescricao 	= 	grupo.descricao
	Scodigo		=   codigo

	Smedia_perm = 	media_perm

	SLNvdprev 	=   prvvenda_b
	Ssaldo 		=   saldo
	Spedidotran = 	pedidotran
	Sverifica	=	verifica
	Spedidopfat	=	pedidopfat

	**** TELA SIMPLES
		SHOW GET Svlrcompra
		SHOW GET Sdescricao
		SHOW GET Scodigo
		SHOW GET Sgiro_A
		SHOW GET Sgiro_B
		SHOW GET Sgiro_C
		SHOW GET Sgiro_D
		SHOW GET Sgiro_E
		SHOW GET Sgiromedio
		SHOW GET Smedia_perm
		SHOW GET SLNvdprev
		SHOW GET Ssaldo
		SHOW GET Spedidotran
		SHOW GET Sverifica
		SHOW GET Spedidopfat

	IF EMPTY(&wl_arqtmp .codigo)
		DO ULreg_par  && grava os valores parametro de calculo
	ENDIF
	=ULcalcvlr()
RETURN(.T.)

******************************************************
* ROTINAS NAO USADAS
******************************************************

*---->
PROCEDURE ULatrcampo
    SELECT &wl_arqtmp
RETURN

PROCEDURE  brtotal
  PARAMETERS wl_ms
RETURN

PROCEDURE brdeleta
RETURN

PROCEDURE brappend
RETURN
**---->

FUNCTION ULcalcvlr
RETURN


PROCEDURE ULreg_par
    SELECT &wl_arqtmp
RETURN
	
*******************************************************************

*******************************************************************


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _2LX0OYABS           GET_1ITEM WHEN                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC800B,     Record Number:    2  є
*       є Variable:            GET_1ITEM                          є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

FUNCTION _2lx0oyabs     &&  GET_1ITEM WHEN
#REGION 2
SELE empresa
SET ORDER TO TAG empresa

SELE grupo
SET ORDER TO TAG codigo

SELE &wl_arqtmp
SET RELATION TO filial INTO empresa
SET RELATION TO codigo INTO grupo ADDITIVE

ON KEY LABEL ENTER
ON KEY LABEL F5       DO ULinfcamp WITH "ATVJAN-1" , "X" && DADOS CONSULTA
ON KEY LABEL L        DO ULinfcamp WITH "ATVJAN-4" , "X" && LOCALIZA PROD
ON KEY LABEL F3		  DO ULinfcamp WITH "ATVJAN-5" , "X" && INF.PRODUTO
ON KEY LABEL F4       DO ULinfcamp WITH "ATVJAN-6" , "X" && NEGOCIACAO
ON KEY LABEL END      DO ULinfcamp WITH "SAIR"     , "X" && SAIDA
ON KEY LABEL SPACEBAR DO ULinfcamp WITH "ATIBUIR SUGESTAO","X"
ON KEY LABEL P		  DO ULinfcamp WITH "IMPRIMIR PREVIA","X"

ON KEY LABEL CTRL-T DO brtotal WITH .T.
ON KEY LABEL ESCAPE	KEYBOARD "{BACKTAB}"

SET POINT TO "."
SET SEPARATOR  TO ","
LNregbrow   = RECNO()
CLEAR TYPEAHEAD
IF LFjanela = 3
		BROWSE  FIELDS ;
				ord=STR(recno(),4)  :H="Nr" :P="9999" ;
					:W=ULinfcamp("ORD","W") AND .F. ;
					:R,;
				MARCADOR :H=" " ;
					:W=ULinfcamp("MARCADOR","W") AND .F. ;
					:R,;
				CDGO=;
				IIF(tipo_reg="T",grupo.descricao,"        ");
					:H="Produto                  ";
					:P="XXXXXXXXXXXXXXXXXXXXXXXXX"  ;
					:W=ULinfcamp("CODIGO","W") AND .F. ;
					:R,;
				SIGLA=IIF(filial<> 999,LEFT(empresa.SIGLA,3),"==>");
					:H="";
					:P="XXX";
					:W=ULinfcamp("FILIAL","W") AND .F. ;
					:R,;
				PREVVD=prvvenda_b;
			 		:H="VdPrv";
					:P="@r 9999";
					:W=ULinfcamp("Vend.Prev","W") AND .F. ;
					:R,;
				SALDO	:H="Sald";
					:P="@r 9999";
					:W=ULinfcamp("SALDO","W") AND .F. ;
					:R,;
				SUGESTAO_B	:H="Sugs";
					:P="@r 9999";
					:W=ULinfcamp("SUGESTAO","W") AND .F. ;
					:R,;
				ESPACO="     " :H=" " ;
					:W=ULinfcamp("ESPACO","W") AND .F. ;
					:R,;
				PEDIR	:H="Pede";
					:P="@Z 9999";
					:W=ULinfcamp("PEDIR","W");
					:V=ULinfcamp("PEDIR","V");
					:F,;
				PRECO_VEND	:H="$Unit";
					:P="@r 99,999.99";
					:W=ULinfcamp("PRECO","W") AND .F.;
					:V=ULinfcamp("PRECO","V");
					:F,;
				CODFORN	:H="Forn";
					:P="99999";
					:W=ULinfcamp("CODFORN","W");
				TITLE "ITEMPRV2";
				  VALID :F ULsai() ;
				  WHEN ULatualiza() AND LFjanela = 3;
				COLOR SCHEME 10 ;
				  NODELETE NOAPPEND  NOCLEAR NORMAL ;
				  WINDOW ITEMPRV1
ENDIF
SET RELATION TO

RETURN(.F.)

*
*				CDGO=;
*				IIF(tipo_reg="T",CODIGO,"        ");
*					:H="Codigo";
*					:P=masc_codi;
*					:W=ULinfcamp("CODIGO","W") AND .F. ;
*					:R,;
*
*
*				IIF(tipo_reg="1",CODIGO,;
*				    IIF(tipo_reg="T","Geral...","........"));
*
*
*				PREVVD=int((RVgiromedi*prvcbstq.em_dias) + ;
*						  (RVgiromedi*prvcbstq.em_dias)* indice_saz / 100) ;
*