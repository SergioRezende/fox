*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º 29/11/2004           SCGC200B.SPR              09:41:30 º
*       º                                                         º
*       ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
*       º                                                         º
*       º Author's Name                                           º
*       º                                                         º
*       º Copyright (c) 2004 Company Name                         º
*       º Address                                                 º
*       º City,     Zip                                           º
*       º                                                         º
*       º Description:                                            º
*       º This program was automatically generated by GENSCRN.    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC200/MS-DOS Setup Code - SECTION 1          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 2
*~ WIZARDSCREEN
*---------------------------------------------------------------------*
* ARQUIVOS UTILIZADOS :                                               *
*              - CLIENTES
* OBJETIVOS : CADASTRO DE CLIENTES
*	
*---------------------------------------------------------------------*
#DEFINE C_DELREC		'Apagar Registro Selecionado ?'
******>>>> INICIO CONTROLE AMBIENTAL
CLEAR TYPEAHEAD
PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
******************************************************************
PRIVATE wl_areant, isediting,isadding,isreading,wp_record,wp_flgfecha
m.isediting   	= .F.
m.isadding    	= .F.
m.isreading   	= .F.
m.is2table    	= .F.


PRIVATE LFjanela, wp_ref_local, LNcr_ant
PRIVATE VLleitura, VLlerfim, VLcompara, VLchvlimi
PRIVATE LFcli,LFclx, LFreg, LFtb1, LFusr, LFdup, LFcid,LFemp
*****************************************************************
PRIVATE EMPRESA,TP_PESSOA,CLIENTE,NOME,TP_INSCR,INSCRICAO,REVENDEDOR
PRIVATE FANTASIA,ENDERECO,BAIRRO,CIDADE,ESTADO,CEP,FONE,CBNOME
PRIVATE CBENDERECO,CBBAIRRO,CBCIDADE,CBESTADO,CBCEP,CBFONE
PRIVATE CREDITO,DTCAD, ULTSERVICO,OBS,ULT_ATEND,REGIAO, STATUS
PRIVATE NATUREZA, VENDEDOR, SEXO, DT_NASC, DT_ALTER
PRIVATE Lt200,Lt200B,Lt200E

******************************************************************

ON KEY LABEL ESCAPE
wl_areant = ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.isreadonly  	= IIF(ISREAD(),.T.,.F.)
m.isediting	=	.F.
m.isadding	=	.F.
m.isreading =   .F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
LNcr_ant	= 0

LFjanela    = "200"
LFcli 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFclx 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFreg 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFtb1 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFtb2 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFusr 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFdup 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFcid 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFemp 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
wp_ref_local =  .T.     && NAO POSSUI CONTROLE DE REFRESH LOCAL
******>>>> INICIO CONTROLE ARQUIVOS
*>> parametros repassados a btn_val
VLleitura = ""   && repassa chave de leitura p/ btn_val
VLlerfim  = ""   && p/ leitura do ultimo reg + 1
VLcompara = ""   && repassa chave de comparacao p/ btn_val
VLchvlimi = ""   && otimiza browse
**************************************************************

IF !USED("cidbanc")
	LFcid 	= .T.
	IF ! NetUse("cidbanc")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("usuario")
	LFusr 	= .T.
	IF ! NetUse("usuario")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("empresa")
	LFemp 	= .T.
	IF ! NetUse("empresa")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("tab001")
	LFtb1 	= .T.
	IF ! NetUse("tab001")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("tab002")
	LFtb2 	= .T.
	IF ! NetUse("tab002")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("regiao")
	LFreg 	= .T.
	IF ! NetUse("regiao")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("duplicat")
	LFdup 	= .T.
	IF ! NetUse("duplicat")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("clianx_a")
	LFclx 	= .T.
	IF ! NetUse("clianx_a")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("clientes")
	LFcli 	= .T.
	IF ! NetUse("clientes")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

IF wp_flgfecha
	do ULfecha
	RETURN
ENDIF

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                MS-DOS Window definitions                º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

IF NOT WEXIST("scgc200b") ;
	OR UPPER(WTITLE("SCGC200B")) == "SCGC200B.PJX" ;
	OR UPPER(WTITLE("SCGC200B")) == "SCGC200B.SCX" ;
	OR UPPER(WTITLE("SCGC200B")) == "SCGC200B.MNX" ;
	OR UPPER(WTITLE("SCGC200B")) == "SCGC200B.PRG" ;
	OR UPPER(WTITLE("SCGC200B")) == "SCGC200B.FRX" ;
	OR UPPER(WTITLE("SCGC200B")) == "SCGC200B.QPR"
	DEFINE WINDOW scgc200b ;
		FROM 10, 3 ;
		TO 19,77 ;
		TITLE "[ Cadastro de Clientes ]" ;
		FOOTER "[200b]" ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("scgc200") ;
	OR UPPER(WTITLE("SCGC200")) == "SCGC200.PJX" ;
	OR UPPER(WTITLE("SCGC200")) == "SCGC200.SCX" ;
	OR UPPER(WTITLE("SCGC200")) == "SCGC200.MNX" ;
	OR UPPER(WTITLE("SCGC200")) == "SCGC200.PRG" ;
	OR UPPER(WTITLE("SCGC200")) == "SCGC200.FRX" ;
	OR UPPER(WTITLE("SCGC200")) == "SCGC200.QPR"
	DEFINE WINDOW scgc200 ;
		FROM 4, 3 ;
		TO 20,77 ;
		TITLE "[ Cadastro de Clientes ]" ;
		FOOTER "[200]" ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("scgc200e") ;
	OR UPPER(WTITLE("SCGC200E")) == "SCGC200E.PJX" ;
	OR UPPER(WTITLE("SCGC200E")) == "SCGC200E.SCX" ;
	OR UPPER(WTITLE("SCGC200E")) == "SCGC200E.MNX" ;
	OR UPPER(WTITLE("SCGC200E")) == "SCGC200E.PRG" ;
	OR UPPER(WTITLE("SCGC200E")) == "SCGC200E.FRX" ;
	OR UPPER(WTITLE("SCGC200E")) == "SCGC200E.QPR"
	DEFINE WINDOW scgc200e ;
		FROM 10, 3 ;
		TO 19,77 ;
		TITLE "[ Anexo de Clientes ]" ;
		FOOTER "[200e]" ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("scgc200c") ;
	OR UPPER(WTITLE("SCGC200C")) == "SCGC200C.PJX" ;
	OR UPPER(WTITLE("SCGC200C")) == "SCGC200C.SCX" ;
	OR UPPER(WTITLE("SCGC200C")) == "SCGC200C.MNX" ;
	OR UPPER(WTITLE("SCGC200C")) == "SCGC200C.PRG" ;
	OR UPPER(WTITLE("SCGC200C")) == "SCGC200C.FRX" ;
	OR UPPER(WTITLE("SCGC200C")) == "SCGC200C.QPR"
	DEFINE WINDOW scgc200c ;
		FROM 0, 3 ;
		TO 2,77 ;
		TITLE "[ Cadastro de Clientes ]" ;
		FOOTER "[200C]" ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("navega") ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.PJX" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.SCX" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.MNX" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.PRG" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.FRX" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.QPR"
	DEFINE WINDOW navega ;
		FROM 22, 0 ;
		TO 24,79 ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC200/MS-DOS Setup Code - SECTION 2          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 2
******>>>> INICIO CONTROLE LOCAL
**************************************
SELE clianx_a
SET ORDER TO TAG cliente
IF EOF() AND BOF()
	m.cliente = clientes.cliente
	=edithand('SAVE')
ENDIF
**************************************
SELECT clientes
SET ORDER TO TAG cliente
IF TYPE("LNcliente") = "N"
	SEEK LNcliente
	IF FOUND()
		KEYBOARD "1"
	ELSE
		KEYBOARD "I"
	ENDIF
ELSE
	KEYBOARD "I"
ENDIF			
SET ORDER TO TAG nome

ON KEY LABEL CTRL-ENTER ;
  do RTacesso WITH PROGRAM(),"Cadastro de Clientes",VARREAD()




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC200B/MS-DOS Screen Layout              º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
IF WVISIBLE("scgc200b")
	ACTIVATE WINDOW scgc200b SAME
ELSE
	ACTIVATE WINDOW scgc200b NOSHOW
ENDIF
@ 3,1 SAY "Obs.:" ;
	SIZE 1,5, 0
@ 0,0 TO 9,74 ;
	COLOR SCHEME 24
@ 9,1 TO 9,73 ;
	COLOR SCHEME 23
@ 1,74 TO 9,74 ;
	COLOR SCHEME 23
@ 0,74 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 9,74 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 5,26 SAY "Limite CR." ;
	SIZE 1,10, 0
@ 1,30 SAY "Vendedor 1:" ;
	SIZE 1,11, 0
@ 2,34 SAY "-" ;
	SIZE 1,1, 0
@ 8,54 SAY "-" ;
	SIZE 1,1, 0
@ 7,26 SAY "Cadastro" ;
	SIZE 1,8, 0
@ 7,64 SAY "Ult.Atend." ;
	SIZE 1,10, 0
@ 7,39 SAY "Alteracao" ;
	SIZE 1,9, 0
@ 1,21 SAY "Natureza" ;
	SIZE 1,8, 0
@ 6,60 SAY "-" ;
	SIZE 1,1, 0
@ 5,45 SAY "Alteracao" ;
	SIZE 1,9, 0
@ 5,56 SAY "Usr" ;
	SIZE 1,3, 0
@ 7,50 SAY "Usr" ;
	SIZE 1,3, 0
@ 2,22 SAY "-" ;
	SIZE 1,1, 0
@ 3,54 SAY "Filial Origem Cad." ;
	SIZE 1,18, 0
@ 4,59 SAY "-" ;
	SIZE 1,1, 0
@ 1,60 SAY IIF(m.tp_pessoa < 2,"Nascimento:","Fundacao..:") ;
	SIZE 1,11 ;
	COLOR W+/W    
@ 2,19 GET m.lmt_PARCELA ;
	SIZE 1,1 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN (LFjanela  = "200B" AND isediting) ;
	VALID _1e20kru4x()
@ 2,21 GET m.natureza ;
	SIZE 1,1 ;
	DEFAULT 0 ;
	PICTURE "9" ;
	WHEN (LFjanela  = "200B" AND isediting) ;
	VALID _1e20kru50()
@ 2,23 GET m.nome_natu ;
	SIZE 1,6 ;
	DEFAULT " " ;
	WHEN .f.
@ 2,30 GET m.vendedor ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN _1e20kru56() ;
	VALID _1e20kru5a()
@ 2,35 GET m.nome_vd1 ;
	SIZE 1,7 ;
	DEFAULT " " ;
	WHEN .f.
@ 2,56 GET m.regiao ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN (LFjanela  = "200B" AND isediting) ;
	VALID _1e20kru5i()
@ 2,60 GET m.dt_nasc ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN (LFjanela  = "200B" AND isediting)
@ 2,73 GET m.status ;
	SIZE 1,1 ;
	DEFAULT 0 ;
	PICTURE "9" ;
	WHEN (LFjanela  = "200B" AND isediting)
@ 3,26 SAY IIF(m.tp_pessoa < 2,"","Fantasia.:") ;
	SIZE 1,12 ;
	COLOR W+/W    
@ 4,1 EDIT m.obs ;
	SIZE 5,23,0 ;
	DEFAULT " " ;
	TAB ;
	SCROLL ;
	WHEN _1e20kru5n()
@ 4,27 GET m.fantasia ;
	SIZE 1,25 ;
	DEFAULT " " ;
	PICTURE "@!K" ;
	WHEN _1e20kru5s()
@ 4,56 GET m.empresa ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN (LFjanela  = "200B" AND isediting) ;
	VALID _1e20kru5v()
@ 4,60 GET m.nome_emp ;
	SIZE 1,9 ;
	DEFAULT " " ;
	WHEN .f.
@ 6,27 GET m.credito ;
	SIZE 1,12 ;
	DEFAULT 0 ;
	PICTURE "9,999,999.99" ;
	WHEN _1e20kru5z() ;
	VALID _1e20kru62()
@ 6,45 GET m.dt_altcr ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN .f.
@ 6,56 GET m.usr_altcr ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .f.
@ 6,61 GET m.nm_usrCR ;
	SIZE 1,8 ;
	DEFAULT " " ;
	WHEN .f.
@ 8,27 GET m.dtcad ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN .f.
@ 8,39 GET m.dt_alter ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN .f.
@ 8,50 GET m.usr_regis ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .f.
@ 8,55 GET m.nome_usr ;
	SIZE 1,8 ;
	DEFAULT " " ;
	WHEN .f.
@ 8,64 GET m.ult_atend ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN .f.
@ 1,1 SAY "Limitar Tipo de " ;
	SIZE 1,16, 0
@ 2,1 SAY "Parcelamento S/N ?" ;
	SIZE 1,18, 0
@ 2,42 SAY "(" ;
	SIZE 1,1, 0
@ 2,47 SAY "-" ;
	SIZE 1,1, 0
@ 1,43 SAY "Usr" ;
	SIZE 1,3, 0
@ 2,43 GET m.usrvincvnd ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .f.
@ 2,48 GET m.nmusrvincvnd ;
	SIZE 1,6 ;
	DEFAULT " " ;
	WHEN .f.
@ 1,56 SAY "Reg" ;
	SIZE 1,3, 0
@ 2,54 SAY ")" ;
	SIZE 1,1, 0
@ 1,71 SAY "Stt" ;
	SIZE 1,3, 0




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC200/MS-DOS Screen Layout               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 2
IF WVISIBLE("scgc200")
	ACTIVATE WINDOW scgc200 SAME
ELSE
	ACTIVATE WINDOW scgc200 NOSHOW
ENDIF
@ 11,1 TO 11,73
@ 1,26 SAY "Pessoa.:" ;
	SIZE 1,8, 0
@ 1,40 SAY "Inscricao..:" ;
	SIZE 1,12, 0
@ 11,29 SAY "***  COBRANCA ***" ;
	SIZE 1,17, 0
@ 12,13 SAY "-" ;
	SIZE 1,1, 0
@ 10,1 SAY "Cidade" ;
	SIZE 1,6, 0
@ 10,35 SAY "UF" ;
	SIZE 1,2, 0
@ 12,65 SAY "{* IDEM }" ;
	SIZE 1,9, 0
@ 15,1 SAY "Cidade" ;
	SIZE 1,6, 0
@ 15,35 SAY "UF" ;
	SIZE 1,2, 0
@ 5,13 SAY "-" ;
	SIZE 1,1, 0
@ 0,0 TO 16,74 ;
	COLOR SCHEME 23
@ 16,1 TO 16,73 ;
	COLOR SCHEME 24
@ 16,74 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,74 TO 15,74 ;
	COLOR SCHEME 24
@ 0,74 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,60 SAY "Tp.Inscricao" ;
	SIZE 1,12, 0
@ 1,1 SAY "C.G.C. / C.P.F." ;
	SIZE 1,15, 0
@ 7,3 SAY "e-mail:" ;
	SIZE 1,7, 0
@ 10,55 SAY "Fone" ;
	SIZE 1,4, 0
@ 10,41 SAY "CEP" ;
	SIZE 1,3, 0
@ 9,1 SAY "End" ;
	SIZE 1,3, 0
@ 9,48 SAY "St" ;
	SIZE 1,2, 0
@ 14,48 SAY "St" ;
	SIZE 1,2, 0
@ 14,1 SAY "End" ;
	SIZE 1,3, 0
@ 15,55 SAY "Fone" ;
	SIZE 1,4, 0
@ 15,41 SAY "CEP" ;
	SIZE 1,3, 0
@ 0,25 SAY "[ Liberado em " ;
	SIZE 1,14, 0
@ 0,72 SAY " ]" ;
	SIZE 1,2, 0
@ 0,49 SAY "  Por:" ;
	SIZE 1,6, 0
@ 4,1 SAY "Insc.Subs.ISSQN:" ;
	SIZE 1,16, 0
@ 0,39 GET DTLIBERACD ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN .f.
@ 0,55 GET M.usliberacd ;
	SIZE 1,4 ;
	DEFAULT " " ;
	WHEN .F.
@ 0,60 GET m.nm_usrLIBCD ;
	SIZE 1,13 ;
	DEFAULT " " ;
	WHEN .F.
@ 2,2 GET m.strcliente ;
	SIZE 1,20 ;
	DEFAULT " " ;
	PICTURE "@R 99.999.999/9999-99" ;
	WHEN _1e20kru6n()
@ 2,2 GET m.cliente ;
	SIZE 1,20 ;
	DEFAULT 0 ;
	PICTURE "99999999999999" ;
	WHEN _1e20kru6s() ;
	VALID _1e20kru6v() ;
	ERROR _1e20kru73()
@ 2,25 GET m.tp_pessoa ;
	PICTURE "@*RVN Fisica;Juridica  " ;
	SIZE 1,14,0 ;
	DEFAULT 1 ;
	WHEN _1e20kru79() ;
	VALID _1e20kru7b()
@ 2,40 GET m.inscricao ;
	SIZE 1,18 ;
	DEFAULT " " ;
	WHEN _1e20kru7e()
@ 2,61 GET m.tp_inscr ;
	PICTURE "@*RVN Estadual ;Isento" ;
	SIZE 1,13,0 ;
	DEFAULT 1 ;
	WHEN _1e20kru7h() ;
	VALID _1e20kru7k()
@ 4,17 GET m.INSSUBSISS ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999999" ;
	WHEN _1e20kru7n()
@ 5,1 SAY IIF(m.tp_pessoa < 2,"Nome.....:","Rz.Social:") ;
	SIZE 1,12 ;
	COLOR W+/W    
@ 5,14 GET m.nome ;
	SIZE 1,48 ;
	DEFAULT " " ;
	PICTURE "@!K" ;
	WHEN _1e20kru7r() ;
	VALID _1e20kru7t()
@ 7,11 GET m.e_mail ;
	SIZE 1,63 ;
	DEFAULT " " ;
	WHEN (LFjanela  = "200" AND isediting)
@ 9,4 GET m.endereco ;
	SIZE 1,43 ;
	DEFAULT " " ;
	PICTURE "@S45" ;
	WHEN (LFjanela  = "200" AND isediting)
@ 9,50 GET m.bairro ;
	SIZE 1,24 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN (LFjanela  = "200" AND isediting)
@ 10,7 GET m.cidade ;
	SIZE 1,26 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN (LFjanela  = "200" AND isediting) ;
	VALID _1e20kru7z()
@ 10,37 GET m.estado ;
	SIZE 1,2 ;
	DEFAULT " " ;
	WHEN (LFjanela  = "200" AND isediting) ;
	VALID _1e20kru84() ;
	ERROR wp_msg
@ 10,44 GET m.cep ;
	SIZE 1,10 ;
	DEFAULT " " ;
	PICTURE "@R 99999-999" ;
	WHEN (LFjanela  = "200" AND isediting)
@ 10,59 GET m.fone ;
	SIZE 1,15 ;
	DEFAULT " " ;
	WHEN (LFjanela  = "200" AND isediting)
@ 12,1 SAY IIF(m.tp_pessoa < 2,"Nome.....:","Rz.Social:") ;
	SIZE 1,12 ;
	COLOR W+/W    
@ 12,14 GET m.cbnome ;
	SIZE 1,48 ;
	DEFAULT " " ;
	PICTURE "@!K" ;
	WHEN (LFjanela  = "200" AND isediting) ;
	VALID _1e20kru8f()
@ 14,4 GET m.CBendereco ;
	SIZE 1,44 ;
	DEFAULT " " ;
	WHEN (LFjanela  = "200" AND isediting)
@ 14,50 GET m.cbbairro ;
	SIZE 1,24 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN (LFjanela  = "200" AND isediting)
@ 15,7 GET m.cbcidade ;
	SIZE 1,26 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN (LFjanela  = "200" AND isediting) ;
	VALID _1e20kru8l()
@ 15,37 GET m.cbestado ;
	SIZE 1,2 ;
	DEFAULT " " ;
	WHEN (LFjanela  = "200" AND isediting) ;
	VALID _1e20kru8q() ;
	ERROR wp_msg
@ 15,44 GET m.cbcep ;
	SIZE 1,10 ;
	DEFAULT " " ;
	PICTURE "@R 99999-999" ;
	WHEN (LFjanela  = "200" AND isediting)
@ 15,59 GET m.cbfone ;
	SIZE 1,15 ;
	DEFAULT " " ;
	WHEN (LFjanela  = "200" AND isediting) ;
	VALID _1e20kru90()




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC200E/MS-DOS Screen Layout              º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 3
IF WVISIBLE("scgc200e")
	ACTIVATE WINDOW scgc200e SAME
ELSE
	ACTIVATE WINDOW scgc200e NOSHOW
ENDIF
@ 0,0 TO 9,74 ;
	COLOR SCHEME 24
@ 9,1 TO 9,73 ;
	COLOR SCHEME 23
@ 1,74 TO 9,74 ;
	COLOR SCHEME 23
@ 0,74 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 9,74 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 2,9 SAY "-" ;
	SIZE 1,1, 0
@ 2,5 GET m.carteira ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN (LFjanela  = "200E" AND isediting) ;
	VALID _1e20kru96()
@ 2,10 GET m.nome_ct1 ;
	SIZE 1,9 ;
	DEFAULT " " ;
	WHEN .f.
@ 2,33 GET m.potencial ;
	SIZE 1,9 ;
	DEFAULT 0 ;
	PICTURE "99,999.99" ;
	WHEN _1e20kru9c()
@ 1,2 SAY "Carteira Vinculada" ;
	SIZE 1,18, 0
@ 1,26 SAY "Potencial de Compra Mes" ;
	SIZE 1,23, 0




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC200C/MS-DOS Screen Layout              º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 4
IF WVISIBLE("scgc200c")
	ACTIVATE WINDOW scgc200c SAME
ELSE
	ACTIVATE WINDOW scgc200c NOSHOW
ENDIF
@ 0,0 TO 2,74 ;
	COLOR SCHEME 24
@ 2,2 TO 2,73 ;
	COLOR SCHEME 23
@ 2,74 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 0,74 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 1,74 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 1,1 GET inf_btn ;
	PICTURE "@*HN \<1-Inf.Adic." ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	VALID BTN_VAL1('JANELA')
@ 1,14 GET nfs_btn ;
	PICTURE "@*HN \<2-Notas" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _1e20kru9k() ;
	MESSAGE 'Busca dirata pela chave do documento.'
@ 1,23 GET dup_btn ;
	PICTURE "@*HN \<3-Duplicat" ;
	SIZE 1,12,1 ;
	DEFAULT 1 ;
	VALID _1e20kru9o() ;
	MESSAGE 'Busca dirata pela chave do documento.'
@ 1,35 GET ext_btn ;
	PICTURE "@*HN \<4-Extr.Imp." ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	VALID _1e20kru9t() ;
	MESSAGE 'Busca dirata pela chave do documento.'
@ 1,48 GET res_btn ;
	PICTURE "@*HN \<5-Resumo Cr" ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	VALID _1e20krua4()
@ 2,61 GET CART_BTN ;
	PICTURE "@*HN \<7-Carteira" ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	VALID BTN_VAL1('ANEXO')

RETURN
@ 1,61 GET atlz_btn ;
	PICTURE "@*HN \<6-Atualiza" ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	VALID _1e20kruaa()




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              OBJ_WNAV/MS-DOS Screen Layout              º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 5
IF WVISIBLE("navega")
	ACTIVATE WINDOW navega SAME
ELSE
	ACTIVATE WINDOW navega NOSHOW
ENDIF
@ 1,8 GET m.top_btn ;
	PICTURE "@*HN \<Inicio" ;
	SIZE 1,8,1 ;
	DEFAULT 1 ;
	VALID BTN_VAL1('TOP', VLleitura, Vlcompara) ;
	MESSAGE 'Primeiro registro'
@ 1,16 GET m.prev_btn ;
	PICTURE "@*HN \<Ant" ;
	SIZE 1,5,1 ;
	DEFAULT 1 ;
	VALID btn_val1('PREV', VLleitura, Vlcompara) ;
	MESSAGE 'Posiciona no registro anterior.' 	
@ 1,21 GET m.next_btn ;
	PICTURE "@*HN \<Proximo" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID btn_val1('NEXT', VLleitura, Vlcompara) ;
	MESSAGE 'Avanca para proximo registro'
@ 1,30 GET m.end_btn ;
	PICTURE "@*HN \<Fim" ;
	SIZE 1,5,1 ;
	DEFAULT 1 ;
	VALID btn_val1('END', VLlerfim, Vlcompara) ;
	MESSAGE 'Ultimo registro do arquivo' 																																													
@ 1,35 GET m.loc_btn ;
	PICTURE "@*HN \<Zoom" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID btn_val1('LOCATE', VLleitura, Vlcompara,VLchvlimi)		 ;
	MESSAGE 'Permite consulta visual ampliada a varios registros na tela'
@ 1,41 GET m.add_btn ;
	PICTURE "@*HN \<Lanca" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID btn_val1('ADD') ;
	MESSAGE 'Abre novo registro para lancamento de dados' 
@ 1,55 GET m.edit_btn ;
	PICTURE "@*HN \<Edit" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 1,61 GET m.del_btn ;
	PICTURE "@*HN \<Del" ;
	SIZE 1,5,1 ;
	DEFAULT 1 ;
	VALID btn_val1('DELETE', VLleitura, Vlcompara) ;
	MESSAGE 'Delete current record.'
@ 1,73 GET m.exit_btn ;
	PICTURE "@*HN \<Sair" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EXIT') ;
	MESSAGE 'Close screen.'
@ 1,48 GET m.cop_btn ;
	PICTURE "@*HN \<Copia" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID btn_val1('COPY') ;
	MESSAGE 'Abre novo registro sel limpar os dados do reg corrente' 
@ 1,1 GET m.busca_btn ;
	PICTURE "@*HN \<Busca" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID BTN_VAL1('BUSCA') ;
	MESSAGE 'Busca dirata pela chave do documento.'
@ 1,66 GET m.imp_btn ;
	PICTURE "@*HN i\<Mpr" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID btn_val1('PRINT') ;
	MESSAGE 'Close screen.'
@ 0,0 TO 2,79 DOUBLE ;
	COLOR SCHEME 24
@ 2,1 TO 2,78 DOUBLE ;
	COLOR SCHEME 23
@ 1,79 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 0,79 SAY "»" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 2,79 SAY "¼" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 1,79 SAY "º" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23

IF NOT WVISIBLE("navega")
	ACTIVATE WINDOW navega
ENDIF
IF NOT WVISIBLE("scgc200c")
	ACTIVATE WINDOW scgc200c
ENDIF
IF NOT WVISIBLE("scgc200e")
	ACTIVATE WINDOW scgc200e
ENDIF
IF NOT WVISIBLE("scgc200")
	ACTIVATE WINDOW scgc200
ENDIF
IF NOT WVISIBLE("scgc200b")
	ACTIVATE WINDOW scgc200b
ENDIF



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º     MS-DOSREAD contains clauses from SCREEN scgc200     º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

READ CYCLE MODAL ;
	ACTIVATE READACT() ;
	DEACTIVATE READDEAC() ;
	SHOW _1e20kru94() ;
	NOLOCK


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º               SCGC200/MS-DOS Cleanup Code               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 2
	ON KEY LABEL CTRL-ENTER

	RELEASE WINDOW SCGC200
	RELEASE WINDOW SCGC200C
	RELEASE WINDOW SCGC200B
	RELEASE WINDOW SCGC200E
	*HIDE    WINDOW NAVEGA
	IF !WEXIST('SCGC201') AND !WEXIST('SCGC201A') AND !WEXIST('SVD0500')
	   RELEASE WINDOW NAVEGA
	ENDIF
	DO ULfecha
************************************
POP KEY 			&& reabilita teclas de atalho def. anteriormente

RETURN




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º   SCGC200/MS-DOS Supporting Procedures and Functions    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 2
PROCEDURE ULfecha
	IF LFcid   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("cidbanc")
	ENDIF
	IF LFdup   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("duplicat")
	ENDIF
	IF LFtb1   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("tab001")
	ENDIF
	IF LFtb2   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("tab002")
	ENDIF
	IF LFreg   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("regiao")
	ENDIF
	IF LFusr   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("usuario")
	ENDIF
	IF LFemp   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	IF LFcli   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("clientes")
	ENDIF
	IF LFclx   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("clianx_a")
	ENDIF

	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(wl_areant)
		SELECT &wl_areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
	************************************
	POP KEY 			&& reabilita teclas de atalho def. anteriormente


RETURN

*************

PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	ON KEY LABEL ENTER
	ON KEY LABEL TAB
	SELE clientes
	SET ORDER TO TAG nome
	=W_DEFPROC("CLIENTES.SPR")

    m.e_mail = 	LOWER(m.e_mail)
	IF TYPE("M.USLIBERACD") = "U"
			M.USLIBERACD = clientes.usliberacd
	ENDIF

	IF isediting AND tecla = 'EDIT' && COMANDO PARA GRAVAR
		IF !CLInscricao((m.ESTADO),(m.INSCRICAO),1,0,0,'')
			WAIT WINDOWS "Nro. Inscricao Invalido..<ENTER>"
			_CUROBJ = OBJNUM(m.inscricao)
	  	   SHOW WINDOW SCGC200 TOP
			LFjanela  = "200"
			RETURN(.F.)
		ENDIF
	ENDIF

******************************************************************
    IF tecla $ 'ADD/COPY/BUSCA'
		   LFjanela  = "200"		
	ENDIF
	=ULshow()
******************************************************************
    IF tecla $ 'JANELA/ANEXO'
		DO CASE
			CASE tecla = 'ANEXO'
		  	   HIDE WINDOW SCGC200B
		  	   SHOW WINDOW SCGC200E TOP
			   LFjanela  = "200E"		
			CASE tecla = 'JANELA' AND LFjanela  <> "200B"
		  	   HIDE WINDOW SCGC200E
		  	   ACTIVATE WINDOW SCGC200B
		  	   SHOW WINDOW SCGC200B TOP
			   LFjanela  = "200B"		
			CASE tecla = 'JANELA' AND LFjanela  <> "200"
		  	   HIDE WINDOW SCGC200E
		  	   ACTIVATE WINDOW SCGC200B
		  	   SHOW WINDOW SCGC200B TOP
		  	   SHOW WINDOW SCGC200 TOP
			   LFjanela  = "200"		
		ENDCASE
	ENDIF
*****************************************************************
*	TRATAMENTO ESPECIFICO PARA 200E
*****************************************************************
	LFposanx = .t.		&& DEVE SE FEITO O POSICIONAMENTO DO ANEXO
						&& CONFORME O CLIENTE POIS QUEM ESTA EM OPERACAO
						&& E O CLIENTE
						&& QUANDO A OPERACAO FOR NO ANEXO NAO DEVE
						&& HAVER POSICIONAMENTO
******************************************************************
	if LFjanela  = "200E"
		DO CASE
				CASE  tecla='EDIT'  AND !isediting  &&edit record
					   LFposanx = .F.
					   SELE clianx_a
					   IF !FOUND() OR clianx_a.cliente <> m.cliente
							tecla='ADD' && FORCA A CRIACAO DO REG				
					   ENDIF
				CASE  tecla='EDIT'  AND isediting  &&save record
					   LFposanx = .F.
					   SELE clianx_a
					   IF !FOUND() OR clianx_a.cliente <> m.cliente
							isadding = .t. && FORCA A CRIACAO DO REG				
					   ENDIF
		ENDCASE
	ENDIF
***************************************************
	KEYBOARD "{CTRL-F10}"
	IF tecla = 'DELETE'  AND !isediting 	&& DELETANDO
			IF EOF() OR BOF()
				WAIT WINDOW C_ENDFILE NOWAIT
			ELSE
				IF !REGLOCK()
					WAIT WINDOW C_NOLOCK NOWAIT
				ELSE
					IF fox_alert(C_DELREC)
						=edithand('APAGA')
					    SELE clianx_a
						IF FOUND() AND clianx_a.cliente = m.cliente
							=REGLOCK(.T.)
							=edithand('APAGA')
						ENDIF
						SELE clientes
						IF !EOF() AND DELETED()
							SKIP 1
						ENDIF
						IF EOF()
							WAIT WINDOW C_ENDFILE NOWAIT
							GO BOTTOM
						ENDIF
					ENDIF
					_curobj=1
			    ENDIF
			ENDIF
	   m.tecla = "ATUALILIZA"
	   DO btn_val with tecla, m.chv_ler, m.chv_compara, m.chv_brow, .T., .T.
	ELSE
	   IF UPPER(ALIAS()) = "CLIANX_A"
	   	  LNcliant = m.cliente
	   ENDIF
	   DO btn_val with tecla, m.chv_ler, m.chv_compara, m.chv_brow, .T., .T.
	   IF UPPER(ALIAS()) = "CLIANX_A"
	   	  m.cliente = LNcliant
	   ENDIF
	ENDIF
***************************************************
	LNcr_ant = m.credito
    IF tecla $ 'ADD/EDIT'
	    IF tecla $ 'ADD'
			m.empresa  = wp_empresa
			m.nome_emp = wp_sigla_emp
			m.dtcad	   = wp_dtoper
		ENDIF
		m.usr_regis  = nUsr
		m.dt_alter   = wp_dtsys
		SHOW GET m.dt_alter
    ENDIF
	m.strcliente = str(m.cliente,14)
	SHOW GET m.strcliente

*
	SELE TAB001
	SET ORDER TO TAG CODIGO
    SEEK 'NTZ'+CHRTRAN(STR(m.natureza,1)," ","0")
	m.nome_natu = tab001.descricao
	SHOW GET m.nome_natu
*
	select usuario
	SEEK m.vendedor
	m.nome_vd1	 = usuario.nome

	SEEK m.usr_regis
	m.nome_usr	 = usuario.nome

	SEEK m.usr_altcr
	m.nm_usrCR = usuario.nome

	SEEK m.usliberacd
	m.nm_usrLIBCD = usuario.nome

	SEEK m.usrvincvnd
	m.nmusrvincvnd = usuario.nome

	SHOW GET m.nome_vd1
	SHOW GET m.nome_usr
	SHOW GET m.nm_usrcr
	SHOW GET m.nmusrvincvnd
	
*
	IF LFposanx 		&& POSICIONAR ANEXO
		SELE clianx_a
		SET ORDER TO TAG cliente
		SEEK m.cliente
		IF FOUND()
			SCATTER MEMVAR FIELDS potencial,carteira
		ELSE
			STORE 0 TO potencial,carteira
		ENDIF
		SELE usuario
		SET ORDER TO TAG usuario
		IF SEEK(m.carteira)
			m.nome_ct1	 = usuario.nome
		ELSE
			m.nome_ct1	 = ""
		ENDIF		
		SHOW GET m.carteira
		SHOW GET m.nome_ct1
		SHOW GET m.potencial
	ENDIF
*
	SELE empresa
	SET ORDER TO TAG empresa
	SEEK m.empresa
	m.nome_emp	 = empresa.sigla
	SHOW GET m.nome_emp
*
	sele clientes
RETURN

PROCEDURE local_refresh
PARAMETERS wl_branco, LSaces
*****>>>>>>>>>>>  abilita os acessos permitidos
	LNindice = 0
	LSaces = "   "
	IF !lMaster
		LNindice = ASCAN(vAcessos,WPprgativo)
		IF LNindice > 0
				LNindice = ASUBSCRIPT(VACESSOS,LNindice,1)
				LSaces = vAcessos(LNindice,2)
		ENDIF
	ENDIF

   IF isediting or wl_branco or isreading
	        SHOW GETS OFF
			SHOW OBJECT 5		  ENABLE
			SHOW OBJECT 7		  ENABLE
			SHOW OBJECT 9		  ENABLE
			SHOW GET m.inf_btn    DISABLE
			SHOW GET m.nfs_btn    DISABLE
			SHOW GET m.dup_btn    DISABLE
			SHOW GET m.ext_btn    DISABLE
			SHOW GET m.res_btn    DISABLE
			SHOW GET anx_btn   	  DISABLE
			SHOW GET atlz_btn  	  DISABLE
			SHOW GET cart_btn  	  DISABLE
			RETURN

	ENDIF
	*****************
	IF "1" $ LSaces
		SHOW GET inf_btn   DISABLE
	ENDIF
	IF "2" $ LSaces	
		SHOW GET nfs_btn   DISABLE
	ENDIF
	IF "3" $ LSaces	
		SHOW GET dup_btn   DISABLE
	ENDIF
	IF "4" $ LSaces	
		SHOW GET ext_btn   DISABLE
	ENDIF
	IF "5" $ LSaces	
		SHOW GET res_btn   DISABLE
	ENDIF

	SHOW GET atlz_btn   DISABLE

	IF "7" $ LSaces	
		SHOW GET cart_btn   DISABLE
	ENDIF

	=W_DEFPROC("ACESSO.SPR")
	IF !ACGetAutorizacao(nUsr,"SCGC200", "ATLZ_BTN")
		SHOW GET ATLZ_btn   DISABLE
	ENDIF



	*****************
    IF m.tp_pessoa = 1
    	SHOW GET m.fantasia   DISABLE
	ELSE
    	SHOW GET m.fantasia   ENABLE
	ENDIF
RETURN

PROCEDURE ULrefcgc
	    IF m.tp_pessoa = 1
	    	SHOW GET m.fantasia   DISABLE
	        SHOW GETS OFF
		ELSE
	    	SHOW GET m.fantasia   ENABLE
            SHOW GETS OFF
		ENDIF
RETURN


FUNCTION ULshow
	DO CASE
		CASE LFjanela  = "200"
	  	   HIDE WINDOW SCGC200B
	   		SHOW WINDOW SCGC200 TOP
		CASE LFjanela  = "200B"
	   		SHOW WINDOW SCGC200B TOP
		CASE LFjanela  = "200E"
	   		SHOW WINDOW SCGC200E TOP
	ENDCASE
RETURN(.T.)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU4X           m.lmt_PARCELA VALID                º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   24  º
*       º Variable:            m.lmt_PARCELA                      º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      1                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _1e20kru4x     &&  m.lmt_PARCELA VALID
#REGION 1
IF !(m.lmt_parcela $ "SN")
	RETURN(.F.)
ENDIF
RETURN(.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU50           m.natureza VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   25  º
*       º Variable:            m.natureza                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      2                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru50     &&  m.natureza VALID
#REGION 1
IF LASTKEY() = 27
	RETURN .T.
ENDIF	

SELECT tab001
SET ORDER TO TAG codigo

IF LASTKEY() = 9
   SEEK 'NTZ'+CHRTRAN(STR(m.natureza,1)," ","0")
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .t.,.F.,"'NTZ'"
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT clientes
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF !SEEK('NTZ'+CHRTRAN(STR(m.natureza,1)," ","0"))
   		SELECT clientes
		RETURN .F.
   ENDIF
ENDIF
SELECT clientes
m.natureza = INT(VAL(tab001.codigo))
m.nome_natu = tab001.descricao
SHOW GET m.natureza
SHOW GET m.nome_natu

IF m.natureza =  1
	m.revendedor = "S"
ELSE
	m.revendedor = "N"
ENDIF	

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU56           m.vendedor WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   27  º
*       º Variable:            m.vendedor                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      3                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru56     &&  m.vendedor WHEN
#REGION 1
	=W_DEFPROC("ACESSO.SPR")
	IF !ACGetAutorizacao(nUsr,"SCGC200", VARREAD())
		return(.f.)
	ENDIF

RETURN(LFjanela  = "200B" AND isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU5A           m.vendedor VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   27  º
*       º Variable:            m.vendedor                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      4                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru5a     &&  m.vendedor VALID
#REGION 1
SELECT usuario
SET ORDER TO TAG usuario
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT clientes
		RETURN .F.
   ENDIF
ELSE
	SET ORDER TO TAG usuario
	IF m.vendedor = 0 and m.vendedor = clientes.vendedor
		m.nome_vd1	 = " "
		SHOW GET m.vendedor
		SHOW GET m.nome_vd1
		SELECT clientes
		RETURN .T.
	ENDIF
	IF m.vendedor <> 0
		IF !SEEK(m.vendedor)
			SELECT clientes
			RETURN .F.
		ENDIF
	endif
ENDIF
IF m.vendedor = 0
	m.nome_vd1	 = ""
ELSE
	m.vendedor	 = usuario.usuario
	m.nome_vd1	 = usuario.nome
ENDIF

SELECT clientes
SHOW GET m.vendedor
SHOW GET m.nome_vd1

IF m.vendedor <> clientes.vendedor
	select usuario
	SEEK nUsr
	wp_msg = 'Confirme .'
	BTMP   =  'nUsr = usuario.usuario'
	LNusr_ret = 0
	DO obj_prmt.SPR WITH   wp_msg , Btmp
	IF LNusr_ret =  0
	    m.vendedor = clientes.vendedor
		IF SEEK(m.vendedor)
			m.nome_vd1	 = usuario.nome
			SELECT clientes
		else
			m.nome_vd1	 = ""
		ENDIF
		SHOW GET m.vendedor
		return(.T.)
	ENDIF
	SELECT usuario
	m.usrvincvnd = nUsr
	SET ORDER TO TAG usuario
	SEEK m.usrvincvnd
	m.nmusrvincvnd = usuario.nome
	SHOW GET m.usrvincvnd
	SHOW GET m.nmusrvincvnd
endif
SELECT clientes


RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU5I           m.regiao VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   29  º
*       º Variable:            m.regiao                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      5                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru5i     &&  m.regiao VALID
#REGION 1
SELECT regiao
SET ORDER TO TAG regiao
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT clientes
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
   m.regiao 	 = regiao.regiao
ENDIF
IF !SEEK(m.regiao)
  		SELECT clientes
		RETURN .F.
ENDIF
SELECT clientes
m.regiao 	 = regiao.regiao
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU5N           m.obs WHEN                         º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   33  º
*       º Variable:            m.obs                              º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      6                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru5n     &&  m.obs WHEN
#REGION 1
ON KEY LABEL TAB KEYBOARD "{CTRL-TAB}"
ON KEY LABEL ENTER KEYBOARD "{CTRL-TAB}"

RETURN(LFjanela  = "200B" AND isediting)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU5S           m.fantasia WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   34  º
*       º Variable:            m.fantasia                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      7                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru5s     &&  m.fantasia WHEN
#REGION 1
ON KEY LABEL TAB
ON KEY LABEL ENTER

RETURN(m.tp_pessoa = 2 AND (LFjanela  = "200B" AND isediting))

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU5V           m.empresa VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   35  º
*       º Variable:            m.empresa                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      8                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru5v     &&  m.empresa VALID
#REGION 1
SELECT empresa
SET ORDER TO TAG empresa
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT clientes
		RETURN .F.
   ENDIF
ELSE
	SET ORDER TO TAG empresa
	IF !SEEK(m.empresa)
		SELECT clientes
		RETURN .F.
	ENDIF
ENDIF

m.empresa	 = empresa.empresa
m.nome_emp	 = empresa.sigla
SELECT clientes
SHOW GET m.empresa
SHOW GET m.nome_emp

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU5Z           m.credito WHEN                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   37  º
*       º Variable:            m.credito                          º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      9                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru5z     &&  m.credito WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL TAB
RETURN(LFjanela  = "200B" AND isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU62           m.credito VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   37  º
*       º Variable:            m.credito                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      10                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru62     &&  m.credito VALID
#REGION 1
select usuario
SEEK nUsr
IF LNcr_ant <> m.credito
	IF  m.credito <= usuario.LIM_CR
		m.usr_altcr = nUsr
	ELSE
		wp_msg = 'Autorizar limite de credito de' + ;
			 TRANSFORM(m.credito,'999,999.99')
		BTMP   =  'm.credito < usuario.LIM_CR'
		LNusr_ret = 0
		DO obj_prmt.SPR WITH   wp_msg , Btmp
		IF LNusr_ret =  0
			 m.credito = LNcr_ant
			 return(.f.)
		ENDIF
		m.usr_altcr = LNusr_ret
	ENDIF	
	m.dt_altcr = wp_dtsys
	m.nm_usrCR = usuario.nome
	SHOW GET m.usr_altcr
	SHOW GET m.dt_altcr
	SHOW GET m.nm_usrcr
endif
RETURN(.T.)	

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU6N           m.strcliente WHEN                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   36   º
*       º Variable:            m.strcliente                       º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      11                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru6n     &&  m.strcliente WHEN
#REGION 2
RETURN(.F.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU6S           m.cliente WHEN                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   37   º
*       º Variable:            m.cliente                          º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      12                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
*
FUNCTION _1e20kru6s     &&  m.cliente WHEN
#REGION 2
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ON KEY LABEL ENTER
IF LASTKEY() = 15
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(LFjanela  = "200" AND (isadding or isreading))


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU6V           m.cliente VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   37   º
*       º Variable:            m.cliente                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      13                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru6v     &&  m.cliente VALID
#REGION 2
=UPdescanso()
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
IF isreading
	IF EMPTY(m.cliente)
		RETURN(1)
	ENDIF
ENDIF
wp_msg = "Numero de Docmento Invalido. <ENTER>"
IF EMPTY(m.cliente)
	RETURN(.F.)
ENDIF

SELE clientes
SET ORDER TO TAG cliente
SEEK m.cliente
=W_DEFPROC("CLIENTES.SPR")
LNtmp = CLCalc_cgc(m.cliente)
IF  isadding AND LNtmp = "3"
	RETURN .F.
ENDIF

IF LNtmp = "1" 		&& CPF
	m.tp_pessoa = 1
ELSE
	m.tp_pessoa = 2
ENDIF
SHOW GET m.tp_pessoa
m.strcliente = str(m.cliente,14)
SHOW GET m.strcliente
DO ULrefcgc
wp_msg = "Numero ja registrado. <ENTER>"

IF isadding
	IF found()
		IF !fox_alert("Cliente Ja Cadastrado. DUPLICAR ?")
			RETURN(.F.)
		ENDIF
		wp_msg = 'Informe Seu Codigo e sua Senha p/ DUPLICAR..'
		LNusuario = nUsr
		BTMP   =  'usuario.usuario = LNusuario '
		LNusr_ret = 0
		DO obj_prmt.SPR WITH   wp_msg , Btmp
		IF LNusr_ret <>  0
		   SELE clientes
		   RETURN(.T.)
		ENDIF
	    SELE clientes
	ENDIF
ENDIF
RETURN(UPtratachv())



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU73           m.cliente ERROR                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   37   º
*       º Variable:            m.cliente                          º
*       º Called By:           ERROR Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      14                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru73     &&  m.cliente ERROR
#REGION 2
=UPbeeps(.F.,wp_msg)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU79           m.tp_pessoa WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   38   º
*       º Variable:            m.tp_pessoa                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Radio Button                       º
*       º Snippet Number:      15                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru79     &&  m.tp_pessoa WHEN
#REGION 2
ON KEY LABEL ENTER  KEYBOARD "{RIGHTARROW}"
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(.F.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU7B           m.tp_pessoa VALID                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   38   º
*       º Variable:            m.tp_pessoa                        º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Radio Button                       º
*       º Snippet Number:      16                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru7b     &&  m.tp_pessoa VALID
#REGION 2
ON KEY LABEL ENTER


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU7E           m.inscricao WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   39   º
*       º Variable:            m.inscricao                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      17                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru7e     &&  m.inscricao WHEN
#REGION 2
ON KEY LABEL ENTER
RETURN(LFjanela  = "200" AND isediting)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU7H           m.tp_inscr WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   40   º
*       º Variable:            m.tp_inscr                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Radio Button                       º
*       º Snippet Number:      18                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru7h     &&  m.tp_inscr WHEN
#REGION 2
ON KEY LABEL ENTER  KEYBOARD "{RIGHTARROW}"
RETURN(LFjanela  = "200" AND isediting)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU7K           m.tp_inscr VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   40   º
*       º Variable:            m.tp_inscr                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Radio Button                       º
*       º Snippet Number:      19                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru7k     &&  m.tp_inscr VALID
#REGION 2
ON KEY LABEL ENTER
IF LASTKEY() = 32
	IF m.tp_inscr = 2
	   m.inscricao = "ISENTO"
	   SHOW GET m.inscricao
	ENDIF
	_CUROBJ = 9
	RETURN(.T.)
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU7N           m.INSSUBSISS WHEN                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   41   º
*       º Variable:            m.INSSUBSISS                       º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      20                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru7n     &&  m.INSSUBSISS WHEN
#REGION 2
ON KEY LABEL ENTER
RETURN(LFjanela  = "200" AND (isediting or isreading))

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU7R           m.nome WHEN                        º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   43   º
*       º Variable:            m.nome                             º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      21                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru7r     &&  m.nome WHEN
#REGION 2
ON KEY LABEL ENTER
RETURN(LFjanela  = "200" AND (isediting or isreading))

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU7T           m.nome VALID                       º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   43   º
*       º Variable:            m.nome                             º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      22                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru7t     &&  m.nome VALID
#REGION 2
=UPdescanso()
SELE clientes
IF isreading
	IF EMPTY(ALLTRIM(m.nome))
		RETURN(1)
	ENDIF
	SET ORDER TO TAG nome
	SET NEAR ON
	SEEK RTRIM(m.nome)
	SET NEAR OFF
	m.nome = LEFT(clientes.nome,45)
	SEEK m.nome
	RETURN(UPtratachv())
ENDIF
RETURN(.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU7Z           m.cidade VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   47   º
*       º Variable:            m.cidade                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      23                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru7z     &&  m.cidade VALID
#REGION 2
LSdbant = ALIAS()
SELECT cidbanc
set order to tag cidade
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT &LSdbant
		RETURN .F.
   ENDIF
   m.cidade = cidbanc.cidade
   m.estado = cidbanc.estado
ENDIF
SHOW GET m.cidade
SHOW GET m.estado
SELECT &LSdbant
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU84           m.estado VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   48   º
*       º Variable:            m.estado                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      24                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru84     &&  m.estado VALID
#REGION 2
IF LASTKEY() = 27 OR LASTKEY() = 15
	RETURN(.T.)
ENDIF	
IF !(m.estado $ wp_estado)
	WP_MSG = 'Estado invalido'
	RETURN(.F.)
ENDIF
SELE cidbanc
set order to tag cidade
seek m.estado+LEFT(m.cidade,25)
sele clientes
if !found('cidbanc')	
	WP_MSG = 'Localidade nao Cadastrada. Quer Cadastrar ?'
	IF fox_alert(wp_msg)
		SAVE SCREEN TO VLtela
		HIDE WINDOW SCGC200E
		HIDE WINDOW SCGC200C
		HIDE WINDOW SCGC200B
		HIDE WINDOW SCGC200
		***************************************************
		LFisad      = isadding
		LFised      = isediting
		IF EOF()
			LNregcl      = 0
		ELSE
			LNregcl      = RECNO()
		ENDIF
		LScid 		= m.cidade
		LSest		= m.estado

		WPprgativo  = "SCGC121"	&& PERMITE O CONTROLE DE ACESSO DO CADASTRO
							&& SEM INTERFERENCIA DO ACESSO DESTE PROG.
		DO SCGC121.SPR

		WPprgativo  = "SCGC200"	&&RETORNA O CONTROLE DE ACESSO AO PROGRAMADO

		SELE clientes
		isadding 	= LFisad
		isediting	= LFised
		m.cidade	= LScid
		m.estado	= LSest
		ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
		ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		IF LNregcl  <> 0
			GO 	LNregcl
		ENDIF
		ACTIVATE WINDOW SCGC200C
		SHOW WINDOW NAVEGA TOP
		SHOW WINDOW SCGC200 TOP		&& clientes
		SHOW WINDOW SCGC200B TOP	&& adicionais
		SHOW WINDOW SCGC200E TOP	&& adicionais
		if LFjanela  = "200"
   			SHOW WINDOW SCGC200 TOP		&& clientes
		ELSE
	   		SHOW WINDOW SCGC200B TOP	&& adicionais
		ENDIF
		SHOW WINDOW SCGC200C TOP
		DO refresh
		IF LNregcl  <> 0
			IF !REGLOCK()
				KEYBOARD "{END}"
				RETURN(.T.)
			ENDIF
		ENDIF
**********************************************************************
	ENDIF
	*RETURN(.F.)
endif
RETURN(.t.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU8F           m.cbnome VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   52   º
*       º Variable:            m.cbnome                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      25                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru8f     &&  m.cbnome VALID
#REGION 2
IF "IDEM"  $ UPPER(m.cbnome)
	cbnome   	 	= m.nome
	cbendereco   	= m.endereco
	cbbairro 	 	= m.bairro
	cbcidade 		= m.cidade
	cbestado 		= m.estado
	cbcep    		= m.cep
	cbfone   		= m.fone
	SHOW GET m.cbnome
	SHOW GET m.cbendereco
	SHOW GET m.cbbairro
	SHOW GET m.cbcidade
	SHOW GET m.cbestado
	SHOW GET m.cbcep
	SHOW GET m.cbfone
ENDIF
RETURN(.T.)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU8L           m.cbcidade VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   55   º
*       º Variable:            m.cbcidade                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      26                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru8l     &&  m.cbcidade VALID
#REGION 2
LSdbant = ALIAS()
SELECT cidbanc
set order to tag cidade
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT &LSdbant
		RETURN .F.
   ENDIF
   m.cbcidade = cidbanc.cidade
   m.cbestado = cidbanc.estado
ENDIF
SHOW GET m.cbcidade
SHOW GET m.cbestado
SELECT &LSdbant
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU8Q           m.cbestado VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   56   º
*       º Variable:            m.cbestado                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      27                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru8q     &&  m.cbestado VALID
#REGION 2
IF LASTKEY() = 27 OR LASTKEY() = 15
	RETURN(.T.)
ENDIF	
IF !(m.cbestado $ wp_estado)
	WP_MSG = 'Estado invalido'
	RETURN(.F.)
ENDIF
SELE cidbanc
set order to tag cidade
seek m.CBestado+LEFT(m.CBcidade,25)
sele clientes
if !found('cidbanc')	
	WP_MSG = 'Localidade nao Cadastrada. Quer Cadastrar ?'
	IF fox_alert(wp_msg)
		SAVE SCREEN TO VLtela
		HIDE WINDOW SCGC200E
		HIDE WINDOW SCGC200C
		HIDE WINDOW SCGC200B
		HIDE WINDOW SCGC200

**********************************************************************
		LFisad      = isadding
		LFised      = isediting
		IF EOF()
			LNregcl      = 0
		ELSE
			LNregcl      = RECNO()
		ENDIF

		WPprgativo  = "SCGC121"	&& PERMITE O CONTROLE DE ACESSO DO CADASTRO
							&& SEM INTERFERENCIA DO ACESSO DESTE PROG.
		DO SCGC121.SPR

		WPprgativo  = "SCGC200"	&&RETORNA O CONTROLE DE ACESSO AO PROGRAMADO

		SELE clientes
		isadding 	= LFisad
		isediting	= LFised
		IF LNregcl  <> 0
			GO 	LNregcl
		ENDIF
		
		ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
		ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
**********************************************************************
		SELE clientes

		ACTIVATE WINDOW SCGC200C
		SHOW WINDOW NAVEGA TOP
		SHOW WINDOW SCGC200 TOP		&& clientes
		SHOW WINDOW SCGC200B TOP	&& adicionais
		SHOW WINDOW SCGC200E TOP	&& adicionais
		if LFjanela  = "200"
   			SHOW WINDOW SCGC200 TOP		&& clientes
		ELSE
	   		SHOW WINDOW SCGC200B TOP	&& adicionais
		ENDIF
		SHOW WINDOW SCGC200C TOP
		DO refresh
		IF LNregcl  <> 0
			IF !REGLOCK()
				KEYBOARD "{END}"
				RETURN(.T.)
			ENDIF
		ENDIF
**********************************************************************
	ENDIF
	RETURN(.F.)
endif
RETURN(.t.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU90           m.cbfone VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   58   º
*       º Variable:            m.cbfone                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      28                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru90     &&  m.cbfone VALID
#REGION 2
LFjanela  = "200B"
RETURN(.T.)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU96           m.carteira VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200E,     Record Number:    8  º
*       º Variable:            m.carteira                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      29                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru96     &&  m.carteira VALID
#REGION 3
SELECT usuario
SET ORDER TO TAG usuario
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT clientes
		RETURN .F.
   ENDIF
ELSE
	SET ORDER TO TAG usuario
	IF m.carteira = 0
		m.nome_ct1	 = " "
		SHOW GET m.carteira
		SHOW GET m.nome_ct1
		SELECT clientes
		RETURN .T.
	ENDIF
	IF !SEEK(m.carteira)
		SELECT clientes
		RETURN .F.
	ENDIF
ENDIF

m.carteira	 = usuario.usuario
m.nome_ct1	 = usuario.nome
SELECT clientes
SHOW GET m.carteira
SHOW GET m.nome_ct1

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU9C           m.potencial WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200E,     Record Number:   10  º
*       º Variable:            m.potencial                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      30                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru9c     &&  m.potencial WHEN
#REGION 3
ON KEY LABEL ENTER
ON KEY LABEL TAB
RETURN(LFjanela  = "200E" AND isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU9K           nfs_btn VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200C,     Record Number:    8  º
*       º Variable:            nfs_btn                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      31                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru9k     &&  nfs_btn VALID
#REGION 4
LFmtvretorno=  "ABORTANDO"
LDdtinicio	=  	{}
LDdtfim		=	{}
do obj_dat1.SPX WITH	LDdtinicio,LDdtfim,LFmtvretorno
IF LFmtvretorno=  "NORMAL"
	DO OBJ_COME.SPR WITH clientes.cliente,LDdtinicio,LDdtfim
ENDIF
SELE clientes
ACTIVATE WINDOW SCGC200C
SHOW WINDOW NAVEGA TOP
SHOW WINDOW SCGC200 TOP		&& clientes
SHOW WINDOW SCGC200B TOP	&& adicionais
if LFjanela  = "200"
  		SHOW WINDOW SCGC200 TOP		&& clientes
ELSE
 		SHOW WINDOW SCGC200B TOP	&& adicionais
ENDIF
SHOW WINDOW SCGC200C TOP

=BTN_VAL("ATUALIZA")


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU9O           dup_btn VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200C,     Record Number:    9  º
*       º Variable:            dup_btn                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      32                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru9o     &&  dup_btn VALID
#REGION 4
HIDE WINDOW SCGC200C
HIDE WINDOW SCGC200B
HIDE WINDOW SCGC200



DO OBJ_FINA.SPR WITH m.cliente
SELE clientes

ACTIVATE WINDOW SCGC200C
** RESTORE SCREEN FROM VLtela
SHOW WINDOW NAVEGA TOP
SHOW WINDOW SCGC200 TOP		&& clientes
SHOW WINDOW SCGC200B TOP	&& adicionais
if LFjanela  = "200"
   		SHOW WINDOW SCGC200 TOP		&& clientes
ELSE
   		SHOW WINDOW SCGC200B TOP	&& adicionais
ENDIF
SHOW WINDOW SCGC200C TOP

=BTN_VAL("ATUALIZA")


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU9T           ext_btn VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200C,     Record Number:   10  º
*       º Variable:            ext_btn                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      33                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru9t     &&  ext_btn VALID
#REGION 4
PRIVATE VLtela, LNregant
	SELE clientes
	LNregant = RECNO()
***********************>
	SELECT duplicat
************************>
	wl_arqtmp = ""
	LNtmp     = 65		&& TABELA ASCII A = 65
	IF !UPabretmp("dpl")
		wp_flgfecha = .t.
	ENDIF
	IF wp_flgfecha
		RETURN
	ENDIF
	SET SAFET OFF
	LStmp = "&wp_dirtmp"+"&wl_arqtmp"
	WAIT WINDOW "AGUARDE. Gerando Arq. Temporario." NOWAIT
	SELECT  duplicat
	SET ORDER TO TAG doc_clie
	SET NEAR ON
	SEEK STR(m.cliente,14)
	SET NEAR OFF
	LStmp = wp_dirtmp+"&wl_arqtmp"
	COPY TO &LStmp  WHILE m.cliente = cliente
    SELE 0
    USE "&wp_dirtmp"+"&wl_arqtmp" exclu
    INDEX ON DT_VENC TAG dupl ADDITIVE
	SET ORDER TO TAG dupl
	GO TOP
	IF EOF()
		WAIT WINDOW "Nao foram encontrados dados..."
		SELE clientes
		RETURN
	ENDIF

**
	ACTIVATE WINDOW SCGC200C
	SAVE SCREEN TO VLtela
	HIDE WINDOW ALL
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    COUNT  TO LNimpressao
	LNimpressos = 0
	GO LNregistro
***************************
	SELECT &wl_arqtmp
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	

	LF_fim  = .f.
    LSrel = "REL500"      && relatorio padrao
    LSorienta = " FOR LFsegue "
	m.titulo = "Extrato de Cliente"
	m.dt_inicio = wp_dtoper
	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
	SELECT &wl_arqtmp
    USE
    SELE clientes
	ACTIVATE WINDOW SCGC200C
**	RESTORE SCREEN FROM VLtela
	SHOW WINDOW NAVEGA TOP
	SHOW WINDOW SCGC200 TOP		&& clientes
	SHOW WINDOW SCGC200B TOP	&& adicionais
	if LFjanela  = "200"
   		SHOW WINDOW SCGC200 TOP		&& clientes
	ELSE
   		SHOW WINDOW SCGC200B TOP	&& adicionais
	ENDIF
	SHOW WINDOW SCGC200C TOP

RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRUA4           res_btn VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200C,     Record Number:   11  º
*       º Variable:            res_btn                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      34                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20krua4     &&  res_btn VALID
#REGION 4
HIDE WINDOW SCGC200C
HIDE WINDOW SCGC200B
HIDE WINDOW SCGC200E
HIDE WINDOW SCGC200



DO SCR0100.SPR WITH m.cliente

SELE clientes

ACTIVATE WINDOW SCGC200C
** RESTORE SCREEN FROM VLtela
SHOW WINDOW NAVEGA TOP
SHOW WINDOW SCGC200 TOP		&& clientes
SHOW WINDOW SCGC200E TOP	
SHOW WINDOW SCGC200B TOP	&& adicionais
if LFjanela  = "200"
   		SHOW WINDOW SCGC200 TOP		&& clientes
ELSE
   		SHOW WINDOW SCGC200B TOP	&& adicionais
ENDIF
SHOW WINDOW SCGC200C TOP

=BTN_VAL("ATUALIZA")


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRUAA           atlz_btn VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200C,     Record Number:   13  º
*       º Variable:            atlz_btn                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      35                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _1e20kruaa     &&  atlz_btn VALID
#REGION 4
	HIDE WINDOW SCGC200C
	HIDE WINDOW SCGC200B
	HIDE WINDOW SCGC200E
	HIDE WINDOW SCGC200

	wp_msg = 'Registra AtualizaÆo do  Cadastro ' + ;
		 TRANSFORM(m.credito,'999,999.99')
	BTMP   =  'm.credito =< usuario.LIM_CR'
	LNusr_ret = 0
	DO obj_prmt.SPR WITH   wp_msg , Btmp
	IF LNusr_ret <>  0
		SELE clientes
		M.DTLIBERACD = date()
		M.USLIBERACD = LNusr_ret
		=EDITHAND("REGRAVA")				
	ENDIF


	SELE clientes

	ACTIVATE WINDOW SCGC200C
	** RESTORE SCREEN FROM VLtela
	SHOW WINDOW NAVEGA TOP
	SHOW WINDOW SCGC200 TOP		&& clientes
	SHOW WINDOW SCGC200E TOP	
	SHOW WINDOW SCGC200B TOP	&& adicionais
	if LFjanela  = "200"
   		SHOW WINDOW SCGC200 TOP		&& clientes
	ELSE
   		SHOW WINDOW SCGC200B TOP	&& adicionais
	ENDIF
	SHOW WINDOW SCGC200C TOP

	=BTN_VAL("ATUALIZA")

RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _1E20KRU94           Read Level Show                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         Multiple Screens                   º
*       º Called By:           READ Statement                     º
*       º Snippet Number:      36                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _1e20kru94     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: SCGC200B
*
#REGION 1
IF SYS(2016) = "SCGC200B" OR SYS(2016) = "*"
	ACTIVATE WINDOW scgc200b SAME
	@ 1,60 SAY IIF(m.tp_pessoa < 2,"Nascimento:","Fundacao..:") ;
		SIZE 1,11, 0 ;
		COLOR W+/W    
	@ 3,26 SAY IIF(m.tp_pessoa < 2,"","Fantasia.:") ;
		SIZE 1,12, 0 ;
		COLOR W+/W    
ENDIF
*
* Show Code from screen: SCGC200
*
#REGION 2
IF SYS(2016) = "SCGC200" OR SYS(2016) = "*"
	ACTIVATE WINDOW scgc200 SAME
	@ 5,1 SAY IIF(m.tp_pessoa < 2,"Nome.....:","Rz.Social:") ;
		SIZE 1,12, 0 ;
		COLOR W+/W    
	@ 12,1 SAY IIF(m.tp_pessoa < 2,"Nome.....:","Rz.Social:") ;
		SIZE 1,12, 0 ;
		COLOR W+/W    
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF