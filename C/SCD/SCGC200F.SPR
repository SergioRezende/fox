*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º 10/11/2008           SCGC200F.SPR              17:23:51 º
*       º                                                         º
*       ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
*       º                                                         º
*       º Author's Name                                           º
*       º                                                         º
*       º Copyright (c) 2008 Company Name                         º
*       º Address                                                 º
*       º City,     Zip                                           º
*       º                                                         º
*       º Description:                                            º
*       º This program was automatically generated by GENSCRN.    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC200/MS-DOS Setup Code - SECTION 1          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 2
*~ WIZARDSCREEN
*---------------------------------------------------------------------*
* ARQUIVOS UTILIZADOS :                                               *
*              - CLIENTES
* OBJETIVOS : CADASTRO DE CLIENTES
*	
*---------------------------------------------------------------------*
#DEFINE C_DELREC		'Apagar Registro Selecionado ?'
******>>>> INICIO CONTROLE AMBIENTAL
CLEAR TYPEAHEAD
PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
******************************************************************
PRIVATE wl_areant, isediting,isadding,isreading,wp_record,wp_flgfecha
m.isediting   	= .F.
m.isadding    	= .F.
m.isreading   	= .F.
m.is2table    	= .F.


PRIVATE LFjanela, wp_ref_local, LNcr_ant
PRIVATE VLleitura, VLlerfim, VLcompara, VLchvlimi
PRIVATE LFcli,LFclx, LFreg, LFtb1, LFusr, LFdup, LFcid,LFemp
*****************************************************************
PRIVATE EMPRESA,TP_PESSOA,CLIENTE,NOME,TP_INSCR,INSCRICAO,REVENDEDOR
PRIVATE FANTASIA,ENDERECO,BAIRRO,CIDADE,ESTADO,CEP,FONE,CBNOME
PRIVATE CBENDERECO,CBBAIRRO,CBCIDADE,CBESTADO,CBCEP,CBFONE
PRIVATE CREDITO,DTCAD, ULTSERVICO,OBS,ULT_ATEND,REGIAO, STATUS
PRIVATE NATUREZA, VENDEDOR, SEXO, DT_NASC, DT_ALTER
PRIVATE Lt200,Lt200B,Lt200E

******************************************************************

ON KEY LABEL ESCAPE
wl_areant = ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.isreadonly  	= IIF(ISREAD(),.T.,.F.)
m.isediting	=	.F.
m.isadding	=	.F.
m.isreading =   .F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
LNcr_ant	= 0
m.tp_pessoa = 1

LFjanela    = "SCGC200"
LFcli 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFclx 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFreg 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFtb1 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFtb2 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFusr 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFdup 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFcid 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFemp 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
wp_ref_local =  .T.     && NAO POSSUI CONTROLE DE REFRESH LOCAL
******>>>> INICIO CONTROLE ARQUIVOS
*>> parametros repassados a btn_val
VLleitura = ""   && repassa chave de leitura p/ btn_val
VLlerfim  = ""   && p/ leitura do ultimo reg + 1
VLcompara = ""   && repassa chave de comparacao p/ btn_val
VLchvlimi = ""   && otimiza browse
**************************************************************

IF !USED("cidbanc")
	LFcid 	= .T.
	IF ! NetUse("cidbanc")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("usuario")
	LFusr 	= .T.
	IF ! NetUse("usuario")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("empresa")
	LFemp 	= .T.
	IF ! NetUse("empresa")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("tab001")
	LFtb1 	= .T.
	IF ! NetUse("tab001")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("tab002")
	LFtb2 	= .T.
	IF ! NetUse("tab002")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("regiao")
	LFreg 	= .T.
	IF ! NetUse("regiao")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("duplicat")
	LFdup 	= .T.
	IF ! NetUse("duplicat")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("clianx_a")
	LFclx 	= .T.
	IF ! NetUse("clianx_a")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("clientes")
	LFcli 	= .T.
	IF ! NetUse("clientes")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

IF wp_flgfecha
	do ULfecha
	RETURN
ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                MS-DOS Window definitions                º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

IF NOT WEXIST("scgc200f") ;
	OR UPPER(WTITLE("SCGC200F")) == "SCGC200F.PJX" ;
	OR UPPER(WTITLE("SCGC200F")) == "SCGC200F.SCX" ;
	OR UPPER(WTITLE("SCGC200F")) == "SCGC200F.MNX" ;
	OR UPPER(WTITLE("SCGC200F")) == "SCGC200F.PRG" ;
	OR UPPER(WTITLE("SCGC200F")) == "SCGC200F.FRX" ;
	OR UPPER(WTITLE("SCGC200F")) == "SCGC200F.QPR"
	DEFINE WINDOW scgc200f ;
		FROM 0, 0 ;
		TO 1,79 ;
		FOOTER "[200F]" ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("scgc200") ;
	OR UPPER(WTITLE("SCGC200")) == "SCGC200.PJX" ;
	OR UPPER(WTITLE("SCGC200")) == "SCGC200.SCX" ;
	OR UPPER(WTITLE("SCGC200")) == "SCGC200.MNX" ;
	OR UPPER(WTITLE("SCGC200")) == "SCGC200.PRG" ;
	OR UPPER(WTITLE("SCGC200")) == "SCGC200.FRX" ;
	OR UPPER(WTITLE("SCGC200")) == "SCGC200.QPR"
	DEFINE WINDOW scgc200 ;
		FROM INT((SROW()-19)/2),INT((SCOL()-80)/2) ;
		TO INT((SROW()-19)/2)+18,INT((SCOL()-80)/2)+79 ;
		TITLE "[ Cadastro de Clientes ]" ;
		FOOTER "[200]" ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("scgc200b") ;
	OR UPPER(WTITLE("SCGC200B")) == "SCGC200B.PJX" ;
	OR UPPER(WTITLE("SCGC200B")) == "SCGC200B.SCX" ;
	OR UPPER(WTITLE("SCGC200B")) == "SCGC200B.MNX" ;
	OR UPPER(WTITLE("SCGC200B")) == "SCGC200B.PRG" ;
	OR UPPER(WTITLE("SCGC200B")) == "SCGC200B.FRX" ;
	OR UPPER(WTITLE("SCGC200B")) == "SCGC200B.QPR"
	DEFINE WINDOW scgc200b ;
		FROM 2, 0 ;
		TO 20,79 ;
		TITLE "[ Cadastro de Clientes ]" ;
		FOOTER "[200b]" ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("scgc200e") ;
	OR UPPER(WTITLE("SCGC200E")) == "SCGC200E.PJX" ;
	OR UPPER(WTITLE("SCGC200E")) == "SCGC200E.SCX" ;
	OR UPPER(WTITLE("SCGC200E")) == "SCGC200E.MNX" ;
	OR UPPER(WTITLE("SCGC200E")) == "SCGC200E.PRG" ;
	OR UPPER(WTITLE("SCGC200E")) == "SCGC200E.FRX" ;
	OR UPPER(WTITLE("SCGC200E")) == "SCGC200E.QPR"
	DEFINE WINDOW scgc200e ;
		FROM 2, 0 ;
		TO 20,79 ;
		TITLE "[ Anexo de Clientes ]" ;
		FOOTER "[200e]" ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("scgc200c") ;
	OR UPPER(WTITLE("SCGC200C")) == "SCGC200C.PJX" ;
	OR UPPER(WTITLE("SCGC200C")) == "SCGC200C.SCX" ;
	OR UPPER(WTITLE("SCGC200C")) == "SCGC200C.MNX" ;
	OR UPPER(WTITLE("SCGC200C")) == "SCGC200C.PRG" ;
	OR UPPER(WTITLE("SCGC200C")) == "SCGC200C.FRX" ;
	OR UPPER(WTITLE("SCGC200C")) == "SCGC200C.QPR"
	DEFINE WINDOW scgc200c ;
		FROM 2, 0 ;
		TO 20,79 ;
		TITLE "[ Cadastro de Clientes ]" ;
		FOOTER "[200C]" ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("navega") ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.PJX" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.SCX" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.MNX" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.PRG" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.FRX" ;
	OR UPPER(WTITLE("NAVEGA")) == "NAVEGA.QPR"
	DEFINE WINDOW navega ;
		FROM 22, 0 ;
		TO 24,79 ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("scgc200r") ;
	OR UPPER(WTITLE("SCGC200R")) == "SCGC200R.PJX" ;
	OR UPPER(WTITLE("SCGC200R")) == "SCGC200R.SCX" ;
	OR UPPER(WTITLE("SCGC200R")) == "SCGC200R.MNX" ;
	OR UPPER(WTITLE("SCGC200R")) == "SCGC200R.PRG" ;
	OR UPPER(WTITLE("SCGC200R")) == "SCGC200R.FRX" ;
	OR UPPER(WTITLE("SCGC200R")) == "SCGC200R.QPR"
	DEFINE WINDOW scgc200r ;
		FROM 0, 0 ;
		TO 18,79 ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC200/MS-DOS Setup Code - SECTION 2          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 2
******>>>> INICIO CONTROLE LOCAL
**************************************
SELE clianx_a
SET ORDER TO TAG cliente
IF EOF() AND BOF()
	m.cliente = clientes.cliente
	=edithand('SAVE')
ENDIF
**************************************
SELECT clientes
SET ORDER TO TAG cliente
IF TYPE("LNcliente") = "N"
	SEEK LNcliente
	IF FOUND()
		KEYBOARD "1"
	ELSE
		KEYBOARD "I"
	ENDIF
ELSE
	KEYBOARD "I"
ENDIF			
SET ORDER TO TAG nome

ON KEY LABEL CTRL-ENTER ;
  do RTacesso WITH PROGRAM(),"Cadastro de Clientes",VARREAD()

= ULativaTela("SCGC200")




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC200F/MS-DOS Screen Layout              º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
IF WVISIBLE("scgc200f")
	ACTIVATE WINDOW scgc200f SAME
ELSE
	ACTIVATE WINDOW scgc200f NOSHOW
ENDIF
@ 1,0 SAY "/" ;
	SIZE 1,1, 0
@ 1,1 GET SCGC200 ;
	PICTURE "@*HN \<1Cadastro" ;
	SIZE 1,11,1 ;
	DEFAULT 1 ;
	WHEN _2ib11aeq3() ;
	VALID _2ib11aeq7()
@ 1,11 SAY "\" ;
	SIZE 1,1, 0
@ 1,42 SAY "\" ;
	SIZE 1,1, 0
@ 0,1 SAY "__________" ;
	SIZE 1,10, 0
@ 0,29 SAY "_____________" ;
	SIZE 1,13, 0
@ 1,43 SAY "/" ;
	SIZE 1,1, 0
@ 1,57 SAY "\" ;
	SIZE 1,1, 0
@ 0,44 SAY "_____________" ;
	SIZE 1,13, 0
@ 1,13 GET SCGC200B ;
	PICTURE "@*HN \<2Complemento" ;
	SIZE 1,14,1 ;
	DEFAULT 1 ;
	WHEN _2ib11aeqb() ;
	VALID _2ib11aeqf()
@ 1,30 GET SCGC200E ;
	PICTURE "@*HN \<3Carteira" ;
	SIZE 1,11,1 ;
	DEFAULT 1 ;
	WHEN _2ib11aeqi() ;
	VALID _2ib11aeql()
@ 1,45 GET SCGC200C ;
	PICTURE "@*HN \<4Consultas" ;
	SIZE 1,12,1 ;
	DEFAULT 1 ;
	WHEN _2ib11aeqo() ;
	VALID _2ib11aeqr()
@ 1,27 SAY "\" ;
	SIZE 1,1, 0
@ 1,12 SAY "/" ;
	SIZE 1,1, 0
@ 1,28 SAY "/" ;
	SIZE 1,1, 0
@ 0,13 SAY "______________" ;
	SIZE 1,14, 0




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC200/MS-DOS Screen Layout               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 2
IF WVISIBLE("scgc200")
	ACTIVATE WINDOW scgc200 SAME
ELSE
	ACTIVATE WINDOW scgc200 NOSHOW
ENDIF
@ 14,13 SAY "-" ;
	SIZE 1,1, 0
@ 9,9 SAY "Cidade" ;
	SIZE 1,6, 0
@ 9,2 SAY "UF" ;
	SIZE 1,2, 0
@ 14,62 SAY "{* IDEM }" ;
	SIZE 1,9, 0
@ 16,9 SAY "Cidade" ;
	SIZE 1,6, 0
@ 16,2 SAY "UF" ;
	SIZE 1,2, 0
@ 0,0 TO 18,79 ;
	COLOR SCHEME 23
@ 18,1 TO 18,78 ;
	COLOR SCHEME 24
@ 18,79 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,79 TO 17,79 ;
	COLOR SCHEME 24
@ 0,79 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,7 SAY "e-mail:" ;
	SIZE 1,7, 0
@ 10,55 SAY "Fone" ;
	SIZE 1,4, 0
@ 9,39 SAY "CEP" ;
	SIZE 1,3, 0
@ 17,55 SAY "Fone" ;
	SIZE 1,4, 0
@ 16,39 SAY "CEP" ;
	SIZE 1,3, 0
@ 9,53 SAY "Bairro" ;
	SIZE 1,6, 0
@ 16,53 SAY "Bairro" ;
	SIZE 1,6, 0
@ 1,1 SAY "CNPJ/CPF:" ;
	SIZE 1,9, 0
@ 10,1 SAY "Endereco" ;
	SIZE 1,8, 0
@ 1,34 SAY "Inscricao:" ;
	SIZE 1,10, 0
@ 17,1 SAY "Endereco" ;
	SIZE 1,8, 0
@ 12,2 SAY "-ENDERECO DE COBRANCA:" ;
	SIZE 1,22, 0
@ 1,10 GET m.strcliente ;
	SIZE 1,20 ;
	DEFAULT " " ;
	PICTURE "@R 99.999.999/9999-99" ;
	WHEN _2ib11aeqy()
@ 1,10 GET m.cliente ;
	SIZE 1,20 ;
	DEFAULT 0 ;
	PICTURE "99999999999999" ;
	WHEN _2ib11aer1() ;
	VALID _2ib11aer4() ;
	ERROR _2ib11aess()
@ 1,44 GET m.inscricao ;
	SIZE 1,18 ;
	DEFAULT " " ;
	WHEN _2ib11aesw()
@ 1,66 SAY IIF(m.tp_pessoa < 2,"Nascimento:","Fundacao..:") ;
	SIZE 1,11 ;
	COLOR W+/W    
@ 2,6 GET m.tp_pessoa ;
	PICTURE "@*RHN Fisica;Juridica" ;
	SIZE 1,12,0 ;
	DEFAULT 1 ;
	WHEN _2ib11aesz() ;
	VALID _2ib11aet0()
@ 2,36 GET m.tp_inscr ;
	PICTURE "@*RHN Estadual ;Isento" ;
	SIZE 1,13,0 ;
	DEFAULT 1 ;
	WHEN _2ib11aet1() ;
	VALID _2ib11aet2()
@ 2,66 GET m.dt_nasc ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN (LFjanela  = "SCGC200" AND isediting)
@ 4,2 SAY IIF(m.tp_pessoa < 2,"Nome.....:","Rz.Social:") ;
	SIZE 1,12 ;
	COLOR W+/W    
@ 4,15 GET m.nome ;
	SIZE 1,47 ;
	DEFAULT " " ;
	PICTURE "@!K" ;
	WHEN _2ib11aet3() ;
	VALID _2ib11aet4()
@ 5,2 SAY IIF(m.tp_pessoa < 2,"","Fantasia.:") ;
	SIZE 1,12 ;
	COLOR W+/W    
@ 5,15 GET m.fantasia ;
	SIZE 1,47 ;
	DEFAULT " " ;
	PICTURE "@!K" ;
	WHEN _2ib11aet5()
@ 6,15 GET m.e_mail ;
	SIZE 1,63 ;
	DEFAULT " " ;
	WHEN (LFjanela  = "SCGC200" AND isediting)
@ 9,4 GET m.estado ;
	SIZE 1,2 ;
	DEFAULT " " ;
	WHEN (LFjanela  = "SCGC200" AND isediting) ;
	VALID _2ib11aet6() ;
	ERROR wp_msg
@ 9,15 GET m.cidade ;
	SIZE 1,20 ;
	DEFAULT " " ;
	PICTURE "@S25" ;
	WHEN (LFjanela  = "SCGC200" AND isediting) ;
	VALID _2ib11aet7()
@ 9,42 GET m.cep ;
	SIZE 1,10 ;
	DEFAULT " " ;
	PICTURE "@R 99999-999" ;
	WHEN (LFjanela  = "SCGC200" AND isediting) ;
	VALID _2ib11aet8()
@ 9,59 GET m.bairro ;
	SIZE 1,20 ;
	DEFAULT " " ;
	PICTURE "@S20" ;
	WHEN (LFjanela  = "SCGC200" AND isediting) ;
	VALID _2ib11aet9()
@ 10,9 GET m.endereco ;
	SIZE 1,43 ;
	DEFAULT " " ;
	PICTURE "@S45" ;
	WHEN (LFjanela  = "SCGC200" AND isediting)
@ 10,59 GET m.fone ;
	SIZE 1,15 ;
	DEFAULT " " ;
	WHEN (LFjanela  = "SCGC200" AND isediting)
@ 14,1 SAY IIF(m.tp_pessoa < 2,"Nome.....:","Rz.Social:") ;
	SIZE 1,12 ;
	COLOR W+/W    
@ 14,14 GET m.cbnome ;
	SIZE 1,48 ;
	DEFAULT " " ;
	PICTURE "@!K" ;
	WHEN (LFjanela  = "SCGC200" AND isediting) ;
	VALID _2ib11aeta()
@ 16,4 GET m.cbestado ;
	SIZE 1,2 ;
	DEFAULT " " ;
	WHEN (LFjanela  = "SCGC200" AND isediting) ;
	VALID _2ib11aetb() ;
	ERROR wp_msg
@ 16,15 GET m.cbcidade ;
	SIZE 1,20 ;
	DEFAULT " " ;
	PICTURE "@S25" ;
	WHEN (LFjanela  = "SCGC200" AND isediting) ;
	VALID _2ib11aeuc()
@ 16,42 GET m.cbcep ;
	SIZE 1,10 ;
	DEFAULT " " ;
	PICTURE "@R 99999-999" ;
	WHEN (LFjanela  = "SCGC200" AND isediting) ;
	VALID _2ib11aeuh()
@ 16,59 GET m.cbbairro ;
	SIZE 1,20 ;
	DEFAULT " " ;
	PICTURE "@S20" ;
	WHEN (LFjanela  = "SCGC200" AND isediting) ;
	VALID _2ib11aeui()
@ 17,9 GET m.CBendereco ;
	SIZE 1,44 ;
	DEFAULT " " ;
	WHEN (LFjanela  = "SCGC200" AND isediting)
@ 17,59 GET m.cbfone ;
	SIZE 1,15 ;
	DEFAULT " " ;
	WHEN (LFjanela  = "SCGC200" AND isediting) ;
	VALID _2ib11aeuj()




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC200B/MS-DOS Screen Layout              º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 3
IF WVISIBLE("scgc200b")
	ACTIVATE WINDOW scgc200b SAME
ELSE
	ACTIVATE WINDOW scgc200b NOSHOW
ENDIF
@ 14,1 SAY "Obs.:" ;
	SIZE 1,5, 0
@ 0,0 TO 18,79 ;
	COLOR SCHEME 24
@ 18,1 TO 18,78 ;
	COLOR SCHEME 23
@ 1,79 TO 17,79 ;
	COLOR SCHEME 23
@ 0,79 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 18,79 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,47 SAY "-" ;
	SIZE 1,1, 0
@ 3,43 SAY "Natureza" ;
	SIZE 1,8, 0
@ 10,18 SAY "-" ;
	SIZE 1,1, 0
@ 4,44 SAY "-" ;
	SIZE 1,1, 0
@ 3,61 SAY "Filial Origem Cad." ;
	SIZE 1,18, 0
@ 4,65 SAY "-" ;
	SIZE 1,1, 0
@ 11,1 SAY "Limitar Tipo de " ;
	SIZE 1,16, 0
@ 12,1 SAY "Parcelamento S/N ?" ;
	SIZE 1,18, 0
@ 10,59 SAY "  Por:" ;
	SIZE 1,6, 0
@ 4,3 SAY "-" ;
	SIZE 1,1, 0
@ 4,31 SAY "ISS:" ;
	SIZE 1,4, 0
@ 3,31 SAY "Ins.Subs." ;
	SIZE 1,9, 0
@ 3,1 SAY "Seguimento:" ;
	SIZE 1,11, 0
@ 4,18 SAY "-" ;
	SIZE 1,1, 0
@ 3,16 SAY "Subtitui ISS:" ;
	SIZE 1,13, 0
@ 10,1 SAY "Alterado por:" ;
	SIZE 1,13, 0
@ 9,1 SAY "Alterado em.:" ;
	SIZE 1,13, 0
@ 8,1 SAY "Limite CR...:" ;
	SIZE 1,13, 0
@ 8,29 SAY "Cadastrado em:" ;
	SIZE 1,14, 0
@ 9,29 SAY "Alterado em..:" ;
	SIZE 1,14, 0
@ 10,29 SAY "Alterado por.:" ;
	SIZE 1,14, 0
@ 13,47 SAY "Ultimo Atendimento:" ;
	SIZE 1,19, 0
@ 3,53 SAY "Regiao" ;
	SIZE 1,6, 0
@ 6,1 SAY "Status" ;
	SIZE 1,6, 0
@ 8,61 SAY "Liberado em " ;
	SIZE 1,12, 0
@ 4,1 GET m.seguimento ;
	SIZE 1,2 ;
	DEFAULT 0 ;
	PICTURE "99" ;
	WHEN _2ib11aeul() ;
	VALID _2ib11aeum()
@ 4,4 GET m.nome_seg ;
	SIZE 1,11 ;
	DEFAULT " " ;
	WHEN .f.
@ 4,16 GET m.seguimento ;
	SIZE 1,2 ;
	DEFAULT 0 ;
	PICTURE "99" ;
	WHEN _2ib11aeun() ;
	VALID _2ib11aeuo()
@ 4,19 GET m.nome_seg ;
	SIZE 1,11 ;
	DEFAULT " " ;
	WHEN .f.
@ 4,35 GET m.INSSUBSISS ;
	SIZE 1,6 ;
	DEFAULT 0 ;
	PICTURE "999999" ;
	WHEN _2ib11aeup()
@ 4,43 GET m.natureza ;
	SIZE 1,1 ;
	DEFAULT 0 ;
	PICTURE "9" ;
	WHEN (LFjanela  = "SCGC200B" AND isediting) ;
	VALID _2ib11aeuq()
@ 4,45 GET m.nome_natu ;
	SIZE 1,6 ;
	DEFAULT " " ;
	WHEN .f.
@ 4,53 GET m.regiao ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN (LFjanela  = "SCGC200B" AND isediting) ;
	VALID _2ib11aeur()
@ 4,62 GET m.empresa ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN (LFjanela  = "SCGC200B" AND isediting) ;
	VALID _2ib11aeus()
@ 4,66 GET m.nome_emp ;
	SIZE 1,9 ;
	DEFAULT " " ;
	WHEN .f.
@ 6,7 GET m.status ;
	SIZE 1,1 ;
	DEFAULT 0 ;
	PICTURE "9" ;
	WHEN (LFjanela  = "SCGC200B" AND isediting)
@ 8,14 GET m.credito ;
	SIZE 1,12 ;
	DEFAULT 0 ;
	PICTURE "9,999,999.99" ;
	WHEN _2ib11aevt() ;
	VALID _2ib11aevx()
@ 9,14 GET m.dt_altcr ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN .f.
@ 10,14 GET m.usr_altcr ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .f.
@ 10,19 GET m.nm_usrCR ;
	SIZE 1,8 ;
	DEFAULT " " ;
	WHEN .f.
@ 12,19 GET m.lmt_PARCELA ;
	SIZE 1,1 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN (LFjanela  = "SCGC200B" AND isediting) ;
	VALID _2ib11aew1()
@ 8,43 GET m.dtcad ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN .f.
@ 9,43 GET m.dt_alter ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN .f.
@ 10,43 GET m.usr_regis ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .f.
@ 10,48 GET m.nome_usr ;
	SIZE 1,8 ;
	DEFAULT " " ;
	WHEN .f.
@ 9,65 GET DTLIBERACD ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN .f.
@ 10,65 GET M.usliberacd ;
	SIZE 1,4 ;
	DEFAULT " " ;
	WHEN .F.
@ 11,65 GET m.nm_usrLIBCD ;
	SIZE 1,13 ;
	DEFAULT " " ;
	WHEN .F.
@ 13,66 GET m.ult_atend ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN .f.
@ 15,1 EDIT m.obs ;
	SIZE 3,78,0 ;
	DEFAULT " " ;
	TAB ;
	SCROLL ;
	WHEN _2ib11aew2()
@ 1,1 GET m.nome ;
	SIZE 1,47 ;
	DEFAULT " " ;
	PICTURE "@!K" ;
	WHEN .f. ;
	VALID _2ib11aew3()




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC200E/MS-DOS Screen Layout              º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 4
IF WVISIBLE("scgc200e")
	ACTIVATE WINDOW scgc200e SAME
ELSE
	ACTIVATE WINDOW scgc200e NOSHOW
ENDIF
@ 5,0 TO 14,74 ;
	COLOR SCHEME 24
@ 14,1 TO 14,73 ;
	COLOR SCHEME 23
@ 6,74 TO 14,74 ;
	COLOR SCHEME 23
@ 5,74 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 14,74 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 7,9 SAY "-" ;
	SIZE 1,1, 0
@ 7,5 GET m.carteira ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN (LFjanela  = "SCGC200E" AND isediting) ;
	VALID _2ib11aew4()
@ 7,10 GET m.nome_ct1 ;
	SIZE 1,9 ;
	DEFAULT " " ;
	WHEN .f.
@ 7,33 GET m.potencial ;
	SIZE 1,9 ;
	DEFAULT 0 ;
	PICTURE "99,999.99" ;
	WHEN _2ib11aew5()
@ 6,2 SAY "Carteira Vinculada" ;
	SIZE 1,18, 0
@ 6,26 SAY "Potencial de Compra Mes" ;
	SIZE 1,23, 0
@ 11,7 SAY "-" ;
	SIZE 1,1, 0
@ 11,3 GET m.vendedor ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN _2ib11aew6() ;
	VALID _2ib11aew7()
@ 11,8 GET m.nome_vd1 ;
	SIZE 1,13 ;
	DEFAULT " " ;
	WHEN .f.
@ 11,26 SAY "(" ;
	SIZE 1,1, 0
@ 11,31 SAY "-" ;
	SIZE 1,1, 0
@ 11,27 GET m.usrvincvnd ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN .f.
@ 11,32 GET m.nmusrvincvnd ;
	SIZE 1,16 ;
	DEFAULT " " ;
	WHEN .f.
@ 11,48 SAY ")" ;
	SIZE 1,1, 0
@ 10,3 SAY "Vendedor Vinculado" ;
	SIZE 1,18, 0
@ 10,26 SAY "Usr.q.Cadastrou Vinculo" ;
	SIZE 1,23, 0




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC200C/MS-DOS Screen Layout              º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 5
IF WVISIBLE("scgc200c")
	ACTIVATE WINDOW scgc200c SAME
ELSE
	ACTIVATE WINDOW scgc200c NOSHOW
ENDIF
@ 2,6 GET nfs_btn ;
	PICTURE "@*HN \<2-Notas" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	WHEN LFJanela = "SCGC200C" ;
	VALID _2ib11aew8() ;
	MESSAGE 'Busca dirata pela chave do documento.'
@ 2,16 GET dup_btn ;
	PICTURE "@*HN \<3-Duplicat" ;
	SIZE 1,12,1 ;
	DEFAULT 1 ;
	WHEN LFJanela = "SCGC200C" ;
	VALID _2ib11aew9() ;
	MESSAGE 'Busca dirata pela chave do documento.'
@ 2,29 GET ext_btn ;
	PICTURE "@*HN \<4-Extr.Imp." ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	WHEN LFJanela = "SCGC200C" ;
	VALID _2ib11aewa() ;
	MESSAGE 'Busca dirata pela chave do documento.'
@ 2,43 GET res_btn ;
	PICTURE "@*HN \<5-Resumo Cr" ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	WHEN LFJanela = "SCGC200C" ;
	VALID _2ib11aewb()
@ 5,22 GET atlz_btn ;
	PICTURE "@*HN \<6-Atualiza" ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	WHEN LFJanela = "SCGC200C" ;
	VALID _2ib11aexe()
@ 5,6 GET CART_BTN ;
	PICTURE "@*HN \<7-Carteira" ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	WHEN LFJanela = "SCGC200C" ;
	VALID BTN_VAL1('ANEXO')




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              OBJ_WNAV/MS-DOS Screen Layout              º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 6
IF WVISIBLE("navega")
	ACTIVATE WINDOW navega SAME
ELSE
	ACTIVATE WINDOW navega NOSHOW
ENDIF
@ 1,8 GET m.top_btn ;
	PICTURE "@*HN \<Inicio" ;
	SIZE 1,8,1 ;
	DEFAULT 1 ;
	VALID BTN_VAL1('TOP', VLleitura, Vlcompara) ;
	MESSAGE 'Primeiro registro'
@ 1,16 GET m.prev_btn ;
	PICTURE "@*HN \<Ant" ;
	SIZE 1,5,1 ;
	DEFAULT 1 ;
	VALID btn_val1('PREV', VLleitura, Vlcompara) ;
	MESSAGE 'Posiciona no registro anterior.' 	
@ 1,21 GET m.next_btn ;
	PICTURE "@*HN \<Proximo" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID btn_val1('NEXT', VLleitura, Vlcompara) ;
	MESSAGE 'Avanca para proximo registro'
@ 1,30 GET m.end_btn ;
	PICTURE "@*HN \<Fim" ;
	SIZE 1,5,1 ;
	DEFAULT 1 ;
	VALID btn_val1('END', VLlerfim, Vlcompara) ;
	MESSAGE 'Ultimo registro do arquivo' 																																													
@ 1,35 GET m.loc_btn ;
	PICTURE "@*HN \<Zoom" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID btn_val1('LOCATE', VLleitura, Vlcompara,VLchvlimi)		 ;
	MESSAGE 'Permite consulta visual ampliada a varios registros na tela'
@ 1,41 GET m.add_btn ;
	PICTURE "@*HN \<Lanca" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID btn_val1('ADD') ;
	MESSAGE 'Abre novo registro para lancamento de dados' 
@ 1,55 GET m.edit_btn ;
	PICTURE "@*HN \<Edit" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 1,61 GET m.del_btn ;
	PICTURE "@*HN \<Del" ;
	SIZE 1,5,1 ;
	DEFAULT 1 ;
	VALID btn_val1('DELETE', VLleitura, Vlcompara) ;
	MESSAGE 'Delete current record.'
@ 1,73 GET m.exit_btn ;
	PICTURE "@*HN \<Sair" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EXIT') ;
	MESSAGE 'Close screen.'
@ 1,48 GET m.cop_btn ;
	PICTURE "@*HN \<Copia" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID btn_val1('COPY') ;
	MESSAGE 'Abre novo registro sel limpar os dados do reg corrente' 
@ 1,1 GET m.busca_btn ;
	PICTURE "@*HN \<Busca" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID BTN_VAL1('BUSCA') ;
	MESSAGE 'Busca dirata pela chave do documento.'
@ 1,66 GET m.imp_btn ;
	PICTURE "@*HN i\<Mpr" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID btn_val1('PRINT') ;
	MESSAGE 'Close screen.'
@ 0,0 TO 2,79 DOUBLE ;
	COLOR SCHEME 24
@ 2,1 TO 2,78 DOUBLE ;
	COLOR SCHEME 23
@ 1,79 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 0,79 SAY "»" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 2,79 SAY "¼" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 1,79 SAY "º" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC200R/MS-DOS Screen Layout              º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 7
IF WVISIBLE("scgc200r")
	ACTIVATE WINDOW scgc200r SAME
ELSE
	ACTIVATE WINDOW scgc200r NOSHOW
ENDIF
@ 2,2 GET ULativaTela ;
	PICTURE "@*HN ULativaTela - Controla Exibicao das telas" ;
	SIZE 1,43,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _2ib11aexf()
@ 4,2 GET ULsaida ;
	PICTURE "@*HN ULsaida - Saida da tela de Cadastro" ;
	SIZE 1,37,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _2ib11aexg()
@ 5,6 GET ULfecha ;
	PICTURE "@*HN ULfecha - Fechamento de Arq da tela de Cadastro" ;
	SIZE 1,49,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _2ib11aexh()
@ 7,2 GET BTN_VAL1 ;
	PICTURE "@*HN BTN_VAL1 - Controle de Navegacao da tela de Cadastro" ;
	SIZE 1,54,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _2ib11aexi()
@ 9,2 GET local_refresh ;
	PICTURE "@*HN local_refresh - Atualiza telas de Cadastro" ;
	SIZE 1,44,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _2ib11aexj()
@ 10,2 GET ULrefcgc ;
	PICTURE "@*HN ULrefcgc - Atualiza CPF/CNPJ" ;
	SIZE 1,30,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _2ib11aexk()
@ 1,2 GET ULWhenTela ;
	PICTURE "@*HN ULWhenTela" ;
	SIZE 1,12,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _2ib11aexl()

IF NOT WVISIBLE("scgc200r")
	ACTIVATE WINDOW scgc200r
ENDIF
IF NOT WVISIBLE("navega")
	ACTIVATE WINDOW navega
ENDIF
IF NOT WVISIBLE("scgc200c")
	ACTIVATE WINDOW scgc200c
ENDIF
IF NOT WVISIBLE("scgc200e")
	ACTIVATE WINDOW scgc200e
ENDIF
IF NOT WVISIBLE("scgc200b")
	ACTIVATE WINDOW scgc200b
ENDIF
IF NOT WVISIBLE("scgc200")
	ACTIVATE WINDOW scgc200
ENDIF
IF NOT WVISIBLE("scgc200f")
	ACTIVATE WINDOW scgc200f
ENDIF



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º     MS-DOSREAD contains clauses from SCREEN scgc200     º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

READ CYCLE MODAL ;
	ACTIVATE LFjanela  = "200E" AND READACT() ;
	DEACTIVATE ULshow() AND READDEAC() ;
	SHOW _2ib11aeuk() ;
	NOLOCK


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º               SCGC200/MS-DOS Cleanup Code               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 2
	=ULsaida()

RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEQ3           SCGC200 WHEN                       º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200F,     Record Number:    3  º
*       º Variable:            SCGC200                            º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      1                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _2ib11aeq3     &&  SCGC200 WHEN
#REGION 1
RETURN(!ISEDITING)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEQ7           SCGC200 VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200F,     Record Number:    3  º
*       º Variable:            SCGC200                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      2                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeq7     &&  SCGC200 VALID
#REGION 1
  A=  ULativaTela(VARREAD())

RETURN(A)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEQB           SCGC200B WHEN                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200F,     Record Number:   11  º
*       º Variable:            SCGC200B                           º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      3                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeqb     &&  SCGC200B WHEN
#REGION 1
RETURN(!ISEDITING)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEQF           SCGC200B VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200F,     Record Number:   11  º
*       º Variable:            SCGC200B                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      4                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeqf     &&  SCGC200B VALID
#REGION 1
  A=  ULativaTela(VARREAD())

RETURN(A)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEQI           SCGC200E WHEN                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200F,     Record Number:   12  º
*       º Variable:            SCGC200E                           º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      5                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeqi     &&  SCGC200E WHEN
#REGION 1
RETURN(!ISEDITING)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEQL           SCGC200E VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200F,     Record Number:   12  º
*       º Variable:            SCGC200E                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      6                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeql     &&  SCGC200E VALID
#REGION 1
  A=  ULativaTela(VARREAD())

RETURN(A)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEQO           SCGC200C WHEN                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200F,     Record Number:   13  º
*       º Variable:            SCGC200C                           º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      7                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeqo     &&  SCGC200C WHEN
#REGION 1
RETURN(!ISEDITING)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEQR           SCGC200C VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200F,     Record Number:   13  º
*       º Variable:            SCGC200C                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      8                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeqr     &&  SCGC200C VALID
#REGION 1
  A=  ULativaTela(VARREAD())

RETURN(A)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEQY           m.strcliente WHEN                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   25   º
*       º Variable:            m.strcliente                       º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      9                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeqy     &&  m.strcliente WHEN
#REGION 2
RETURN(.F.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AER1           m.cliente WHEN                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   26   º
*       º Variable:            m.cliente                          º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      10                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
*
FUNCTION _2ib11aer1     &&  m.cliente WHEN
#REGION 2
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ON KEY LABEL ENTER
IF LASTKEY() = 15
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(LFjanela  = "SCGC200" AND (isadding or isreading))


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AER4           m.cliente VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   26   º
*       º Variable:            m.cliente                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      11                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aer4     &&  m.cliente VALID
#REGION 2
=UPdescanso()
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
IF isreading
	IF EMPTY(m.cliente)
		RETURN(1)
	ENDIF
ENDIF
wp_msg = "Numero de Docmento Invalido. <ENTER>"
IF EMPTY(m.cliente)
	RETURN(.F.)
ENDIF

SELE clientes
SET ORDER TO TAG cliente
SEEK m.cliente
=W_DEFPROC("CLIENTES.SPR")
LNtmp = CLCalc_cgc(m.cliente)
IF  isadding AND LNtmp = "3"
	RETURN .F.
ENDIF

IF LNtmp = "1" 		&& CPF
	m.tp_pessoa = 1
ELSE
	m.tp_pessoa = 2
ENDIF
SHOW GET m.tp_pessoa
m.strcliente = str(m.cliente,14)
SHOW GET m.strcliente
DO ULrefcgc
wp_msg = "Numero ja registrado. <ENTER>"

IF isadding
	IF found()
		IF !fox_alert("Cliente Ja Cadastrado. DUPLICAR ?")
			RETURN(.F.)
		ENDIF
		wp_msg = 'Informe Seu Codigo e sua Senha p/ DUPLICAR..'
		LNusuario = nUsr
		BTMP   =  'usuario.usuario = LNusuario '
		LNusr_ret = 0
		DO obj_prmt.SPR WITH   wp_msg , Btmp
		IF LNusr_ret <>  0
		   SELE clientes
		   RETURN(.T.)
		ENDIF
	    SELE clientes
	ENDIF
ENDIF
RETURN(UPtratachv())



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AESS           m.cliente ERROR                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   26   º
*       º Variable:            m.cliente                          º
*       º Called By:           ERROR Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      12                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aess     &&  m.cliente ERROR
#REGION 2
=UPbeeps(.F.,wp_msg)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AESW           m.inscricao WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   27   º
*       º Variable:            m.inscricao                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      13                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aesw     &&  m.inscricao WHEN
#REGION 2
ON KEY LABEL ENTER
RETURN(LFjanela  = "SCGC200" AND isediting)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AESZ           m.tp_pessoa WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   29   º
*       º Variable:            m.tp_pessoa                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Radio Button                       º
*       º Snippet Number:      14                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aesz     &&  m.tp_pessoa WHEN
#REGION 2
ON KEY LABEL ENTER  KEYBOARD "{RIGHTARROW}"
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(.F.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AET0           m.tp_pessoa VALID                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   29   º
*       º Variable:            m.tp_pessoa                        º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Radio Button                       º
*       º Snippet Number:      15                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aet0     &&  m.tp_pessoa VALID
#REGION 2
 ON KEY LABEL ENTER
RETURN(.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AET1           m.tp_inscr WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   30   º
*       º Variable:            m.tp_inscr                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Radio Button                       º
*       º Snippet Number:      16                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aet1     &&  m.tp_inscr WHEN
#REGION 2
ON KEY LABEL ENTER  KEYBOARD "{RIGHTARROW}"
RETURN(LFjanela  = "SCGC200" AND isediting)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AET2           m.tp_inscr VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   30   º
*       º Variable:            m.tp_inscr                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Radio Button                       º
*       º Snippet Number:      17                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aet2     &&  m.tp_inscr VALID
#REGION 2
	ON KEY LABEL ENTER
	IF LASTKEY() = 32
		IF m.tp_inscr = 2
		   m.inscricao = "ISENTO"
		   SHOW GET m.inscricao
		ENDIF
		_CUROBJ = 9
		RETURN(.T.)
	ENDIF
return(.t.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AET3           m.nome WHEN                        º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   33   º
*       º Variable:            m.nome                             º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      18                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aet3     &&  m.nome WHEN
#REGION 2
ON KEY LABEL ENTER
RETURN(LFjanela  = "SCGC200" AND (isediting or isreading))

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AET4           m.nome VALID                       º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   33   º
*       º Variable:            m.nome                             º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      19                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aet4     &&  m.nome VALID
#REGION 2
=UPdescanso()
SELE clientes
IF isreading
	IF EMPTY(ALLTRIM(m.nome))
		RETURN(1)
	ENDIF
	SET ORDER TO TAG nome
	SET NEAR ON
	SEEK RTRIM(m.nome)
	SET NEAR OFF
	m.nome = LEFT(clientes.nome,45)
	SEEK m.nome
	RETURN(UPtratachv())
ENDIF
RETURN(.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AET5           m.fantasia WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   35   º
*       º Variable:            m.fantasia                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      20                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aet5     &&  m.fantasia WHEN
#REGION 2
ON KEY LABEL TAB
ON KEY LABEL ENTER

RETURN(m.tp_pessoa = 2 AND (LFjanela  = "SCGC200" AND isediting))

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AET6           m.estado VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   37   º
*       º Variable:            m.estado                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      21                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aet6     &&  m.estado VALID
#REGION 2
IF LASTKEY() = 27 OR LASTKEY() = 15
	RETURN .T.
ENDIF	

IF LASTKEY() = 9
	=W_DEFPROC("ESTADOS.SPR")
	m.estado = UFView(m.estado)
    SELECT clientes
    IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
	=W_DEFPROC("ESTADOS.SPR")
	IF !UFVld_Estado(m.Estado)
   		SELECT clientes
		RETURN .F.
	ENDIF
ENDIF
SELECT clientes
SHOW GET m.ESTADO

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AET7           m.cidade VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   38   º
*       º Variable:            m.cidade                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      22                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aet7     &&  m.cidade VALID
#REGION 2
IF LASTKEY() = 27 OR LASTKEY() = 15
	RETURN .T.
ENDIF	

IF LASTKEY() = 9
	=W_DEFPROC("MUNICPIO.SPR")
	m.cidade = MNView(m.estado,m.cidade)
    SELECT clientes
    IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
	=W_DEFPROC("MUNICPIO.SPR")
	IF !MNVld_Municipio(m.Estado,m.cidade)
   		SELECT clientes
		DO OBJ_MENS.SPR WITH ;
		"Cidade nao Cadastrada  (use TAB para Listar.)"
		RETURN .F.
	ENDIF
ENDIF
=W_DEFPROC("MUNICPIO.SPR")
m.muni_ibge = MNGet_MUNI_IBGE(m.Estado,m.cidade)


SELECT clientes
SHOW GET m.ESTADO
SHOW GET m.cidade
SHOW GET m.muni_ibge

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AET8           m.cep VALID                        º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   39   º
*       º Variable:            m.cep                              º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      23                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aet8     &&  m.cep VALID
#REGION 2
IF LASTKEY() = 27 OR LASTKEY() = 15
	RETURN .T.
ENDIF	


IF LASTKEY() = 9
	=W_DEFPROC("CEP.SPR")
	m.cep = STR(CPView(m.estado,m.cidade,m.bairro),8)
    SELECT clientes
    IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ENDIF


=W_DEFPROC("CEP.SPR")
IF CPVld_CEP(INT(VAL(m.cep)))
	=W_DEFPROC("CEP.SPR")
	m.bairro = CPgetBairro(INT(VAL(m.cep)),m.bairro)

	=W_DEFPROC("CEP.SPR")
	m.estado = CPgetEstado(INT(VAL(m.cep)),m.estado)

	=W_DEFPROC("CEP.SPR")
	m.cidade = CPgetMunicipio(INT(VAL(m.cep)),m.cidade)
ELSE
	IF EMPTY(INT(VAL(m.cep)))
		=W_DEFPROC("MUNICPIO.SPR")
		m.cep = STR(MNGet_CEP_MUNI(m.estado,m.cidade),8)
	ELSE
		DO OBJ_MENS.SPR WITH ;
			"CEP nao Cadastrado  (Certifique-se.)"
	ENDIF
ENDIF


SHOW GET m.bairro
SHOW GET m.estado
SHOW GET m.cidade

SELECT clientes
SHOW GET m.CEP

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AET9           m.bairro VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   40   º
*       º Variable:            m.bairro                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      24                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aet9     &&  m.bairro VALID
#REGION 2
IF LASTKEY() = 27 OR LASTKEY() = 15
	RETURN .T.
ENDIF	

IF LASTKEY() = 13 AND EMPTY(m.bairro)
	RETURN .T.
ENDIF	

IF LASTKEY() = 9
	=W_DEFPROC("BAIRROS.SPR")
	m.bairro = BRView(m.estado,m.cidade,m.bairro)
    SELECT clientes
    IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
	=W_DEFPROC("BAIRROS.SPR")
	IF !BRVld_Bairro(m.Estado,m.cidade,m.bairro)
   		SELECT clientes
		DO OBJ_MENS.SPR WITH ;
		"Bairro nao Cadastrado  (use TAB para Listar Bairros)"
		RETURN .t.
	ENDIF
ENDIF
SELECT clientes
SHOW GET m.ESTADO
SHOW GET m.cidade
SHOW GET m.bairro

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AETA           m.cbnome VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   44   º
*       º Variable:            m.cbnome                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      25                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeta     &&  m.cbnome VALID
#REGION 2
IF "IDEM"  $ UPPER(m.cbnome)
	cbnome   	 	= m.nome
	cbendereco   	= m.endereco
	cbbairro 	 	= m.bairro
	cbcidade 		= m.cidade
	cbestado 		= m.estado
	cbcep    		= m.cep
	cbfone   		= m.fone
	SHOW GET m.cbnome
	SHOW GET m.cbendereco
	SHOW GET m.cbbairro
	SHOW GET m.cbcidade
	SHOW GET m.cbestado
	SHOW GET m.cbcep
	SHOW GET m.cbfone
ENDIF
RETURN(.T.)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AETB           m.cbestado VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   45   º
*       º Variable:            m.cbestado                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      26                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aetb     &&  m.cbestado VALID
#REGION 2
IF LASTKEY() = 27 OR LASTKEY() = 15
	RETURN .T.
ENDIF	

IF LASTKEY() = 9
	=W_DEFPROC("ESTADOS.SPR")
	m.cbEstado = UFView(m.cbEstado)
    SELECT clientes
    IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
	=W_DEFPROC("ESTADOS.SPR")
	IF !UFVld_Estado(m.cbEstado)
   		SELECT clientes
		RETURN .F.
	ENDIF
ENDIF
SELECT clientes
SHOW GET m.cbEstado

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUC           m.cbcidade VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   46   º
*       º Variable:            m.cbcidade                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      27                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeuc     &&  m.cbcidade VALID
#REGION 2
IF LASTKEY() = 27 OR LASTKEY() = 15
	RETURN .T.
ENDIF	

IF LASTKEY() = 9
	=W_DEFPROC("MUNICPIO.SPR")
	m.cbcidade = MNView(m.cbEstado,m.cbcidade)
    SELECT clientes
    IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
	=W_DEFPROC("MUNICPIO.SPR")
	IF !MNVld_Municipio(m.cbEstado,m.cbcidade)
   		SELECT clientes
		DO OBJ_MENS.SPR WITH ;
		"Cidade nao Cadastrada  (use TAB para Listar.)"
		RETURN .F.
	ENDIF
ENDIF
=W_DEFPROC("MUNICPIO.SPR")
m.cbmuni_ibge = MNGet_MUNI_IBGE(m.cbEstado,m.cbcidade)


SELECT clientes
SHOW GET m.cbEstado
SHOW GET m.cbcidade
SHOW GET m.CBmuni_ibge

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUH           m.cbcep VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   47   º
*       º Variable:            m.cbcep                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      28                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeuh     &&  m.cbcep VALID
#REGION 2
IF LASTKEY() = 27 OR LASTKEY() = 15
	RETURN .T.
ENDIF	


IF LASTKEY() = 9
	=W_DEFPROC("CEP.SPR")
	m.cbcep = STR(CPView(m.cbestado,m.cbcidade,m.cbbairro),8)
    SELECT clientes
    IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ENDIF

=W_DEFPROC("CEP.SPR")
IF CPVld_CEP(INT(VAL(m.cbcep)))
	=W_DEFPROC("CEP.SPR")
	m.cbbairro = CPgetBairro(INT(VAL(m.cbcep)),m.cbbairro)

	=W_DEFPROC("CEP.SPR")
	m.cbestado = CPgetEstado(INT(VAL(m.cbcep)),m.cbestado)

	=W_DEFPROC("CEP.SPR")
	m.cbcidade = CPgetMunicipio(INT(VAL(m.cbcep)),m.cbcidade)
ELSE
	IF EMPTY(INT(VAL(m.cbcep)))
		=W_DEFPROC("MUNICPIO.SPR")
		m.cbcep = STR(MNGet_CEP_MUNI(m.cbestado,m.cbcidade),8)
	ELSE
		DO OBJ_MENS.SPR WITH ;
			"CEP nao Cadastrado  (Certifique-se.)"
	ENDIF
ENDIF


SHOW GET m.cbbairro
SHOW GET m.cbestado
SHOW GET m.cbcidade

SELECT clientes
SHOW GET m.cbcep

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUI           m.cbbairro VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   48   º
*       º Variable:            m.cbbairro                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      29                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeui     &&  m.cbbairro VALID
#REGION 2
IF LASTKEY() = 27 OR LASTKEY() = 15
	RETURN .T.
ENDIF	

IF LASTKEY() = 13 AND EMPTY(m.cbbairro)
	RETURN .T.
ENDIF	

IF LASTKEY() = 9
	=W_DEFPROC("BAIRROS.SPR")
	m.cbbairro = BRView(m.cbestado,m.cbcidade,m.cbbairro)
    SELECT clientes
    IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
	=W_DEFPROC("BAIRROS.SPR")
	IF !BRVld_Bairro(m.cbestado,m.cbcidade,m.cbbairro)
   		SELECT clientes
		DO OBJ_MENS.SPR WITH ;
		"Bairro nao Cadastrado <ENTER> (use TAB para Listar Bairros)"
		RETURN .t.
	ENDIF
ENDIF
SELECT clientes
SHOW GET m.cbestado
SHOW GET m.cbcidade
SHOW GET m.cbbairro

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUJ           m.cbfone VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200,     Record Number:   50   º
*       º Variable:            m.cbfone                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      30                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeuj     &&  m.cbfone VALID
#REGION 2
  LFjanela  = "SCGC200B"
RETURN(.T.)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUL           m.seguimento WHEN                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   33  º
*       º Variable:            m.seguimento                       º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      31                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeul     &&  m.seguimento WHEN
#REGION 3
ON KEY LABEL ENTER
RETURN(LFjanela  = "SCGC200B" AND (isediting or isreading))

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUM           m.seguimento VALID                 º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   33  º
*       º Variable:            m.seguimento                       º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      32                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeum     &&  m.seguimento VALID
#REGION 3
IF LASTKEY() = 27
	RETURN .T.
ENDIF	

SELECT tab002
SET ORDER TO TAG codigo

IF LASTKEY() = 9
   SEEK 'SEG'+CHRTRAN(STR(m.seguimento,2)," ","0")
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .t.,.F.,"'SEG'"
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT clientes
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF !SEEK('SEG'+CHRTRAN(STR(m.seguimento,2)," ","0"))
   		SELECT clientes
		RETURN .F.
   ENDIF
ENDIF
SELECT clientes
m.seguimento = INT(VAL(tab002.codigo))
m.nome_seg = tab002.descricao
SHOW GET m.seguimento
SHOW GET m.nome_seg

IF m.natureza =  1
	m.revendedor = "S"
ELSE
	m.revendedor = "N"
ENDIF	

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUN           m.seguimento WHEN                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   35  º
*       º Variable:            m.seguimento                       º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      33                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeun     &&  m.seguimento WHEN
#REGION 3
ON KEY LABEL ENTER
RETURN(LFjanela  = "SCGC200B" AND (isediting or isreading))

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUO           m.seguimento VALID                 º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   35  º
*       º Variable:            m.seguimento                       º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      34                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeuo     &&  m.seguimento VALID
#REGION 3
IF LASTKEY() = 27
	RETURN .T.
ENDIF	

SELECT tab002
SET ORDER TO TAG codigo

IF LASTKEY() = 9
   SEEK 'SEG'+CHRTRAN(STR(m.seguimento,2)," ","0")
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .t.,.F.,"'SEG'"
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT clientes
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF !SEEK('SEG'+CHRTRAN(STR(m.seguimento,2)," ","0"))
   		SELECT clientes
		RETURN .F.
   ENDIF
ENDIF
SELECT clientes
m.seguimento = INT(VAL(tab002.codigo))
m.nome_seg = tab002.descricao
SHOW GET m.seguimento
SHOW GET m.nome_seg

IF m.natureza =  1
	m.revendedor = "S"
ELSE
	m.revendedor = "N"
ENDIF	

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUP           m.INSSUBSISS WHEN                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   37  º
*       º Variable:            m.INSSUBSISS                       º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      35                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeup     &&  m.INSSUBSISS WHEN
#REGION 3
ON KEY LABEL ENTER
RETURN(LFjanela  = "SCGC200B" AND (isediting or isreading))

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUQ           m.natureza VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   38  º
*       º Variable:            m.natureza                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      36                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeuq     &&  m.natureza VALID
#REGION 3
IF LASTKEY() = 27
	RETURN .T.
ENDIF	

SELECT tab001
SET ORDER TO TAG codigo

IF LASTKEY() = 9
   SEEK 'NTZ'+CHRTRAN(STR(m.natureza,1)," ","0")
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .t.,.F.,"'NTZ'"
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT clientes
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
ELSE
   IF !SEEK('NTZ'+CHRTRAN(STR(m.natureza,1)," ","0"))
   		SELECT clientes
		RETURN .F.
   ENDIF
ENDIF
SELECT clientes
m.natureza = INT(VAL(tab001.codigo))
m.nome_natu = tab001.descricao
SHOW GET m.natureza
SHOW GET m.nome_natu

IF m.natureza =  1
	m.revendedor = "S"
ELSE
	m.revendedor = "N"
ENDIF	

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUR           m.regiao VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   40  º
*       º Variable:            m.regiao                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      37                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeur     &&  m.regiao VALID
#REGION 3
SELECT regiao
SET ORDER TO TAG regiao
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT clientes
   IF LASTKEY() = 27
	   RETURN .F.
   ENDIF
   m.regiao 	 = regiao.regiao
ENDIF
IF !SEEK(m.regiao)
  		SELECT clientes
		RETURN .F.
ENDIF
SELECT clientes
m.regiao 	 = regiao.regiao
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUS           m.empresa VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   41  º
*       º Variable:            m.empresa                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      38                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeus     &&  m.empresa VALID
#REGION 3
SELECT empresa
SET ORDER TO TAG empresa
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT clientes
		RETURN .F.
   ENDIF
ELSE
	SET ORDER TO TAG empresa
	IF !SEEK(m.empresa)
		SELECT clientes
		RETURN .F.
	ENDIF
ENDIF

m.empresa	 = empresa.empresa
m.nome_emp	 = empresa.sigla
SELECT clientes
SHOW GET m.empresa
SHOW GET m.nome_emp

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEVT           m.credito WHEN                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   44  º
*       º Variable:            m.credito                          º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      39                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aevt     &&  m.credito WHEN
#REGION 3
ON KEY LABEL ENTER
ON KEY LABEL TAB
RETURN(LFjanela  = "SCGC200B" AND isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEVX           m.credito VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   44  º
*       º Variable:            m.credito                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      40                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aevx     &&  m.credito VALID
#REGION 3
select usuario
SEEK nUsr
IF LNcr_ant <> m.credito
	IF  m.credito <= usuario.LIM_CR
		m.usr_altcr = nUsr
	ELSE
		wp_msg = 'Autorizar limite de credito de' + ;
			 TRANSFORM(m.credito,'999,999.99')
		BTMP   =  'm.credito < usuario.LIM_CR'
		LNusr_ret = 0
		DO obj_prmt.SPR WITH   wp_msg , Btmp
		IF LNusr_ret =  0
			 m.credito = LNcr_ant
			 return(.f.)
		ENDIF
		m.usr_altcr = LNusr_ret
	ENDIF	
	m.dt_altcr = date()
	m.nm_usrCR = usuario.nome
	SHOW GET m.usr_altcr
	SHOW GET m.dt_altcr
	SHOW GET m.nm_usrcr
endif
RETURN(.T.)	

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEW1           m.lmt_PARCELA VALID                º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   48  º
*       º Variable:            m.lmt_PARCELA                      º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      41                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _2ib11aew1     &&  m.lmt_PARCELA VALID
#REGION 3
IF !(m.lmt_parcela $ "SN")
	RETURN(.F.)
ENDIF
RETURN(.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEW2           m.obs WHEN                         º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   57  º
*       º Variable:            m.obs                              º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      42                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aew2     &&  m.obs WHEN
#REGION 3
ON KEY LABEL TAB KEYBOARD "{CTRL-TAB}"
ON KEY LABEL ENTER KEYBOARD "{CTRL-TAB}"

RETURN(LFjanela  = "SCGC200B" AND isediting)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEW3           m.nome VALID                       º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200B,     Record Number:   58  º
*       º Variable:            m.nome                             º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      43                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aew3     &&  m.nome VALID
#REGION 3
=UPdescanso()
SELE clientes
IF isreading
	IF EMPTY(ALLTRIM(m.nome))
		RETURN(1)
	ENDIF
	SET ORDER TO TAG nome
	SET NEAR ON
	SEEK RTRIM(m.nome)
	SET NEAR OFF
	m.nome = LEFT(clientes.nome,45)
	SEEK m.nome
	RETURN(UPtratachv())
ENDIF
RETURN(.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEW4           m.carteira VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200E,     Record Number:    8  º
*       º Variable:            m.carteira                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      44                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aew4     &&  m.carteira VALID
#REGION 4
SELECT usuario
SET ORDER TO TAG usuario
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT clientes
		RETURN .F.
   ENDIF
ELSE
	SET ORDER TO TAG usuario
	IF m.carteira = 0
		m.nome_ct1	 = " "
		SHOW GET m.carteira
		SHOW GET m.nome_ct1
		SELECT clientes
		RETURN .T.
	ENDIF
	IF !SEEK(m.carteira)
		SELECT clientes
		RETURN .F.
	ENDIF
ENDIF

m.carteira	 = usuario.usuario
m.nome_ct1	 = usuario.nome
SELECT clientes
SHOW GET m.carteira
SHOW GET m.nome_ct1

RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEW5           m.potencial WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200E,     Record Number:   10  º
*       º Variable:            m.potencial                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      45                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aew5     &&  m.potencial WHEN
#REGION 4
ON KEY LABEL ENTER
ON KEY LABEL TAB
RETURN(LFjanela  = "SCGC200E" AND isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEW6           m.vendedor WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200E,     Record Number:   14  º
*       º Variable:            m.vendedor                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      46                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aew6     &&  m.vendedor WHEN
#REGION 4
	=W_DEFPROC("ACESSO.SPR")
	IF !ACGetAutorizacao(nUsr,"SCGC200E", VARREAD())
		return(.f.)
	ENDIF

RETURN(LFjanela  = "SCGC200E" AND isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEW7           m.vendedor VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200E,     Record Number:   14  º
*       º Variable:            m.vendedor                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      47                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aew7     &&  m.vendedor VALID
#REGION 4
SELECT usuario
SET ORDER TO TAG usuario
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT clientes
		RETURN .F.
   ENDIF
ELSE
	SET ORDER TO TAG usuario
	IF m.vendedor = 0 and m.vendedor = clientes.vendedor
		m.nome_vd1	 = " "
		SHOW GET m.vendedor
		SHOW GET m.nome_vd1
		SELECT clientes
		RETURN .T.
	ENDIF
	IF m.vendedor <> 0
		IF !SEEK(m.vendedor)
			SELECT clientes
			RETURN .F.
		ENDIF
	endif
ENDIF
IF m.vendedor = 0
	m.nome_vd1	 = ""
ELSE
	m.vendedor	 = usuario.usuario
	m.nome_vd1	 = usuario.nome
ENDIF

SELECT clientes
SHOW GET m.vendedor
SHOW GET m.nome_vd1

IF m.vendedor <> clientes.vendedor
	select usuario
	SEEK nUsr
	wp_msg = 'Confirme .'
	BTMP   =  'nUsr = usuario.usuario'
	LNusr_ret = 0
	DO obj_prmt.SPR WITH   wp_msg , Btmp
	IF LNusr_ret =  0
	    m.vendedor = clientes.vendedor
		IF SEEK(m.vendedor)
			m.nome_vd1	 = usuario.nome
			SELECT clientes
		else
			m.nome_vd1	 = ""
		ENDIF
		SHOW GET m.vendedor
		return(.T.)
	ENDIF
	SELECT usuario
	m.usrvincvnd = nUsr
	SET ORDER TO TAG usuario
	SEEK m.usrvincvnd
	m.nmusrvincvnd = usuario.nome
	SHOW GET m.usrvincvnd
	SHOW GET m.nmusrvincvnd
endif
SELECT clientes


RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEW8           nfs_btn VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200C,     Record Number:    2  º
*       º Variable:            nfs_btn                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      48                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aew8     &&  nfs_btn VALID
#REGION 5
LFmtvretorno=  "ABORTANDO"
LDdtinicio	=  	{}
LDdtfim		=	{}
do obj_dat1.SPX WITH	LDdtinicio,LDdtfim,LFmtvretorno
IF LFmtvretorno=  "NORMAL"
	DO OBJ_COME.SPR WITH clientes.cliente,LDdtinicio,LDdtfim
ENDIF
SELE clientes
ACTIVATE WINDOW SCGC200C
SHOW WINDOW NAVEGA TOP
SHOW WINDOW SCGC200 TOP		&& clientes
SHOW WINDOW SCGC200B TOP	&& adicionais
if LFjanela  = "200"
  		SHOW WINDOW SCGC200 TOP		&& clientes
ELSE
 		SHOW WINDOW SCGC200B TOP	&& adicionais
ENDIF
SHOW WINDOW SCGC200C TOP

=BTN_VAL("ATUALIZA")


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEW9           dup_btn VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200C,     Record Number:    3  º
*       º Variable:            dup_btn                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      49                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aew9     &&  dup_btn VALID
#REGION 5
HIDE WINDOW SCGC200C
HIDE WINDOW SCGC200B
HIDE WINDOW SCGC200



DO OBJ_FINA.SPR WITH m.cliente
SELE clientes

ACTIVATE WINDOW SCGC200C
** RESTORE SCREEN FROM VLtela
SHOW WINDOW NAVEGA TOP
SHOW WINDOW SCGC200 TOP		&& clientes
SHOW WINDOW SCGC200B TOP	&& adicionais
if LFjanela  = "200"
   		SHOW WINDOW SCGC200 TOP		&& clientes
ELSE
   		SHOW WINDOW SCGC200B TOP	&& adicionais
ENDIF
SHOW WINDOW SCGC200C TOP

=BTN_VAL("ATUALIZA")


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEWA           ext_btn VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200C,     Record Number:    4  º
*       º Variable:            ext_btn                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      50                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aewa     &&  ext_btn VALID
#REGION 5
PRIVATE VLtela, LNregant
	SELE clientes
	LNregant = RECNO()
***********************>
	SELECT duplicat
************************>
	wl_arqtmp = ""
	LNtmp     = 65		&& TABELA ASCII A = 65
	IF !UPabretmp("dpl")
		wp_flgfecha = .t.
	ENDIF
	IF wp_flgfecha
		RETURN
	ENDIF
	SET SAFET OFF
	LStmp = "&wp_dirtmp"+"&wl_arqtmp"
	WAIT WINDOW "AGUARDE. Gerando Arq. Temporario." NOWAIT
	SELECT  duplicat
	SET ORDER TO TAG doc_clie
	SET NEAR ON
	SEEK STR(m.cliente,14)
	SET NEAR OFF
	LStmp = wp_dirtmp+"&wl_arqtmp"
	COPY TO &LStmp  WHILE m.cliente = cliente
    SELE 0
    USE "&wp_dirtmp"+"&wl_arqtmp" exclu
    INDEX ON DT_VENC TAG dupl ADDITIVE
	SET ORDER TO TAG dupl
	GO TOP
	IF EOF()
		WAIT WINDOW "Nao foram encontrados dados..."
		SELE clientes
		RETURN
	ENDIF

**
	ACTIVATE WINDOW SCGC200C
	SAVE SCREEN TO VLtela
	HIDE WINDOW ALL
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    COUNT  TO LNimpressao
	LNimpressos = 0
	GO LNregistro
***************************
	SELECT &wl_arqtmp
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	

	LF_fim  = .f.
    LSrel = "REL500"      && relatorio padrao
    LSorienta = " FOR LFsegue "
	m.titulo = "Extrato de Cliente"
	m.dt_inicio = wp_dtoper
	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	LNpagina = _PAGENO   && DAR SEQUENCIA AO N. PAGINA
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
	SELECT &wl_arqtmp
    USE
    SELE clientes
	ACTIVATE WINDOW SCGC200C
**	RESTORE SCREEN FROM VLtela
	SHOW WINDOW NAVEGA TOP
	SHOW WINDOW SCGC200 TOP		&& clientes
	SHOW WINDOW SCGC200B TOP	&& adicionais
	if LFjanela  = "200"
   		SHOW WINDOW SCGC200 TOP		&& clientes
	ELSE
   		SHOW WINDOW SCGC200B TOP	&& adicionais
	ENDIF
	SHOW WINDOW SCGC200C TOP

RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEWB           res_btn VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200C,     Record Number:    5  º
*       º Variable:            res_btn                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      51                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aewb     &&  res_btn VALID
#REGION 5
HIDE WINDOW SCGC200C
HIDE WINDOW SCGC200B
HIDE WINDOW SCGC200E
HIDE WINDOW SCGC200



DO SCR0100.SPR WITH m.cliente

SELE clientes

ACTIVATE WINDOW SCGC200C
** RESTORE SCREEN FROM VLtela
SHOW WINDOW NAVEGA TOP
SHOW WINDOW SCGC200 TOP		&& clientes
SHOW WINDOW SCGC200E TOP	
SHOW WINDOW SCGC200B TOP	&& adicionais
if LFjanela  = "200"
   		SHOW WINDOW SCGC200 TOP		&& clientes
ELSE
   		SHOW WINDOW SCGC200B TOP	&& adicionais
ENDIF
SHOW WINDOW SCGC200C TOP

=BTN_VAL("ATUALIZA")


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEXE           atlz_btn VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200C,     Record Number:    6  º
*       º Variable:            atlz_btn                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      52                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _2ib11aexe     &&  atlz_btn VALID
#REGION 5
	HIDE WINDOW SCGC200C
	HIDE WINDOW SCGC200B
	HIDE WINDOW SCGC200E
	HIDE WINDOW SCGC200

	wp_msg = 'Registra AtualizaÆo do  Cadastro ' + ;
		 TRANSFORM(m.credito,'999,999.99')
	BTMP   =  'm.credito =< usuario.LIM_CR'
	LNusr_ret = 0
	DO obj_prmt.SPR WITH   wp_msg , Btmp
	IF LNusr_ret <>  0
		SELE clientes
		M.DTLIBERACD = date()
		M.USLIBERACD = LNusr_ret
		=EDITHAND("REGRAVA")				
	ENDIF


	SELE clientes

	ACTIVATE WINDOW SCGC200C
	** RESTORE SCREEN FROM VLtela
	SHOW WINDOW NAVEGA TOP
	SHOW WINDOW SCGC200 TOP		&& clientes
	SHOW WINDOW SCGC200E TOP	
	SHOW WINDOW SCGC200B TOP	&& adicionais
	if LFjanela  = "200"
   		SHOW WINDOW SCGC200 TOP		&& clientes
	ELSE
   		SHOW WINDOW SCGC200B TOP	&& adicionais
	ENDIF
	SHOW WINDOW SCGC200C TOP

	=BTN_VAL("ATUALIZA")

RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEXF           ULativaTela VALID                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200R,     Record Number:    2  º
*       º Variable:            ULativaTela                        º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      53                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aexf     &&  ULativaTela VALID
#REGION 7
RETURN

FUNCTION ULativaTela
PARAMETER PrmTela

	DO CASE
		CASE PrmTela = "SCGC200"
			   LFjanela  = PrmTela
		  	   HIDE WINDOW SCGC200E
		  	   HIDE WINDOW SCGC200B
		  	   HIDE WINDOW SCGC200C


		  	   ACTIVATE WINDOW SCGC200
 			   _CUROBJ = OBJNUM(SCGC200)
		  	   SHOW WINDOW SCGC200 TOP


		CASE PrmTela = "SCGC200B"
			   LFjanela  = PrmTela

		  	   HIDE WINDOW SCGC200
		  	   HIDE WINDOW SCGC200E
		  	   HIDE WINDOW SCGC200C


		  	   ACTIVATE WINDOW SCGC200B
 			   _CUROBJ = OBJNUM(SCGC200B)
		  	   SHOW WINDOW SCGC200B TOP

		CASE PrmTela = "SCGC200C"
			   LFjanela  = PrmTela
		  	   HIDE WINDOW SCGC200
		  	   HIDE WINDOW SCGC200B
		  	   HIDE WINDOW SCGC200E

		  	   ACTIVATE WINDOW SCGC200C
 			   _CUROBJ = OBJNUM(SCGC200C)
		  	   SHOW WINDOW SCGC200C TOP

		CASE PrmTela = "SCGC200E"
			   LFjanela  = PrmTela
		  	   HIDE WINDOW SCGC200
		  	   HIDE WINDOW SCGC200B
		  	   HIDE WINDOW SCGC200C

		  	   ACTIVATE WINDOW SCGC200E
 			   _CUROBJ = OBJNUM(SCGC200E)
		  	   SHOW WINDOW SCGC200E TOP

	ENDCASE
    HIDE WINDOW SCGC200R
    SHOW GET SCGC200  ENABLE
    SHOW GET SCGC200B  ENABLE
    SHOW GET SCGC200E  ENABLE
    SHOW GET SCGC200C  ENABLE
    SHOW GET &PrmTela disable
RETURN(.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEXG           ULsaida VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200R,     Record Number:    3  º
*       º Variable:            ULsaida                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      54                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aexg     &&  ULsaida VALID
#REGION 7
RETURN

FUNCTION ULsaida


	ON KEY LABEL CTRL-ENTER

	RELEASE WINDOW SCGC200
	RELEASE WINDOW SCGC200C
	RELEASE WINDOW SCGC200B
	RELEASE WINDOW SCGC200E
	RELEASE WINDOW SCGC200F
	RELEASE WINDOW SCGC200R
	*HIDE    WINDOW NAVEGA
	IF !WEXIST('SCGC201') AND !WEXIST('SCGC201A') AND !WEXIST('SVD0500')
	   RELEASE WINDOW NAVEGA
	ENDIF
	DO ULfecha
	************************************
	POP KEY 			&& reabilita teclas de atalho def. anteriormente
RETURN(.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEXH           ULfecha VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200R,     Record Number:    4  º
*       º Variable:            ULfecha                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      55                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aexh     &&  ULfecha VALID
#REGION 7
RETURN

PROCEDURE ULfecha
	IF LFcid   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("cidbanc")
	ENDIF
	IF LFdup   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("duplicat")
	ENDIF
	IF LFtb1   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("tab001")
	ENDIF
	IF LFtb2   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("tab002")
	ENDIF
	IF LFreg   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("regiao")
	ENDIF
	IF LFusr   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("usuario")
	ENDIF
	IF LFemp   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	IF LFcli   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("clientes")
	ENDIF
	IF LFclx   		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("clianx_a")
	ENDIF

	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(wl_areant)
		SELECT &wl_areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
	************************************
	POP KEY 			&& reabilita teclas de atalho def. anteriormente


RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEXI           BTN_VAL1 VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200R,     Record Number:    5  º
*       º Variable:            BTN_VAL1                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      56                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aexi     &&  BTN_VAL1 VALID
#REGION 7
RETURN

PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	ON KEY LABEL ENTER
	ON KEY LABEL TAB
	SELE clientes
	SET ORDER TO TAG nome
	=W_DEFPROC("CLIENTES.SPR")

    m.e_mail = 	LOWER(m.e_mail)
	IF TYPE("M.USLIBERACD") = "U"
			M.USLIBERACD = clientes.usliberacd
	ENDIF

	IF isediting AND tecla = 'EDIT' && COMANDO PARA GRAVAR
		IF !CLInscricao((m.ESTADO),(m.INSCRICAO),1,0,0,'')
			WAIT WINDOWS "Nro. Inscricao Invalido..<ENTER>"
			_CUROBJ = OBJNUM(m.inscricao)
	  	   SHOW WINDOW SCGC200 TOP
			LFjanela  = "200"
			RETURN(.F.)
		ENDIF
	ENDIF


	IF isediting AND tecla = 'EDIT' && COMANDO PARA GRAVAR
		IF (m.tp_inscr= 2 AND m.inscricao <> "ISENTO") OR;
		   (m.tp_inscr= 1 AND "ISENTO"  $ m.inscricao )

		   WAIT WINDOWS "Inscricao ou Tipo Inscricao Invalido..<ENTER>"
			_CUROBJ = OBJNUM(m.inscricao)
	  	   SHOW WINDOW SCGC200 TOP
			LFjanela  = "200"
			RETURN(.F.)
		ENDIF
	ENDIF


******************************************************************
    IF tecla $ 'ADD/COPY/BUSCA'
		   LFjanela  = "200"		
	ENDIF
**	=ULshow()
******************************************************************
    IF tecla $ 'JANELA/ANEXO'
		DO CASE
			CASE tecla = 'ANEXO'
		  	   HIDE WINDOW SCGC200B
		  	   SHOW WINDOW SCGC200E TOP
			   LFjanela  = "200E"		
			CASE tecla = 'JANELA' AND LFjanela  <> "200B"
		  	   HIDE WINDOW SCGC200E
		  	   ACTIVATE WINDOW SCGC200B
		  	   SHOW WINDOW SCGC200B TOP
			   LFjanela  = "200B"		
			CASE tecla = 'JANELA' AND LFjanela  <> "200"
		  	   HIDE WINDOW SCGC200E
		  	   ACTIVATE WINDOW SCGC200B
		  	   SHOW WINDOW SCGC200B TOP
		  	   SHOW WINDOW SCGC200 TOP
			   LFjanela  = "200"		
		ENDCASE
	ENDIF
*****************************************************************
*	TRATAMENTO ESPECIFICO PARA 200E
*****************************************************************
	LFposanx = .t.		&& DEVE SE FEITO O POSICIONAMENTO DO ANEXO
						&& CONFORME O CLIENTE POIS QUEM ESTA EM OPERACAO
						&& E O CLIENTE
						&& QUANDO A OPERACAO FOR NO ANEXO NAO DEVE
						&& HAVER POSICIONAMENTO
******************************************************************
	if LFjanela  = "200E"
		DO CASE
				CASE  tecla='EDIT'  AND !isediting  &&edit record
					   LFposanx = .F.
					   SELE clianx_a
					   IF !FOUND() OR clianx_a.cliente <> m.cliente
							tecla='ADD' && FORCA A CRIACAO DO REG				
					   ENDIF
				CASE  tecla='EDIT'  AND isediting  &&save record
					   LFposanx = .F.
					   SELE clianx_a
					   IF !FOUND() OR clianx_a.cliente <> m.cliente
							isadding = .t. && FORCA A CRIACAO DO REG				
					   ENDIF
		ENDCASE
	ENDIF
***************************************************
	KEYBOARD "{CTRL-F10}"
	IF tecla = 'DELETE'  AND !isediting 	&& DELETANDO
			IF EOF() OR BOF()
				WAIT WINDOW C_ENDFILE NOWAIT
			ELSE
				IF !REGLOCK()
					WAIT WINDOW C_NOLOCK NOWAIT
				ELSE
					IF fox_alert(C_DELREC)
						=edithand('APAGA')
					    SELE clianx_a
						IF FOUND() AND clianx_a.cliente = m.cliente
							=REGLOCK(.T.)
							=edithand('APAGA')
						ENDIF
						SELE clientes
						IF !EOF() AND DELETED()
							SKIP 1
						ENDIF
						IF EOF()
							WAIT WINDOW C_ENDFILE NOWAIT
							GO BOTTOM
						ENDIF
					ENDIF
					_curobj=1
			    ENDIF
			ENDIF
	   m.tecla = "ATUALILIZA"
	   DO btn_val with tecla, m.chv_ler, m.chv_compara, m.chv_brow, .T., .T.
	ELSE
	   IF UPPER(ALIAS()) = "CLIANX_A"
	   	  LNcliant = m.cliente
	   ENDIF
	   DO btn_val with tecla, m.chv_ler, m.chv_compara, m.chv_brow, .T., .T.
	   IF UPPER(ALIAS()) = "CLIANX_A"
	   	  m.cliente = LNcliant
	   ENDIF
	ENDIF
***************************************************
	LNcr_ant = m.credito
    IF tecla $ 'ADD/EDIT'
	    IF tecla $ 'ADD'
			m.empresa  = wp_empresa
			m.nome_emp = wp_sigla_emp
			m.dtcad	   = wp_dtoper
		ENDIF
		m.usr_regis  = nUsr
		m.dt_alter   = wp_dtsys
		SHOW GET m.dt_alter
    ENDIF
	m.strcliente = str(m.cliente,14)
	SHOW GET m.strcliente

*
	SELE TAB001
	SET ORDER TO TAG CODIGO
    SEEK 'NTZ'+CHRTRAN(STR(m.natureza,1)," ","0")
	m.nome_natu = tab001.descricao
	SHOW GET m.nome_natu

*
	SELE TAB002
	SET ORDER TO TAG CODIGO
    SEEK 'SEG'+CHRTRAN(STR(m.seguimento,2)," ","0")
	m.nome_seg = tab002.descricao
	SHOW GET m.nome_seg

	SHOW GET m.seguimento
	SHOW GET m.nome_seg


*
	=W_DEFPROC("MUNICPIO.SPR")
	m.muni_ibge = MNGet_MUNI_IBGE(m.Estado,m.cidade)
	SHOW GET m.muni_ibge

	=W_DEFPROC("MUNICPIO.SPR")
	m.cbmuni_ibge = MNGet_MUNI_IBGE(m.cbEstado,m.cbcidade)
	SHOW GET m.CBmuni_ibge

*
	select usuario
	SEEK m.vendedor
	m.nome_vd1	 = usuario.nome

	SEEK m.usr_regis
	m.nome_usr	 = usuario.nome

	SEEK m.usr_altcr
	m.nm_usrCR = usuario.nome

	SEEK m.usliberacd
	m.nm_usrLIBCD = usuario.nome

	SEEK m.usrvincvnd
	m.nmusrvincvnd = usuario.nome

	SHOW GET m.nome_vd1
	SHOW GET m.nome_usr
	SHOW GET m.nm_usrcr
	SHOW GET m.nmusrvincvnd
	
*
	IF LFposanx 		&& POSICIONAR ANEXO
		SELE clianx_a
		SET ORDER TO TAG cliente
		SEEK m.cliente
		IF FOUND()
			SCATTER MEMVAR FIELDS potencial,carteira
		ELSE
			STORE 0 TO potencial,carteira
		ENDIF
		SELE usuario
		SET ORDER TO TAG usuario
		IF SEEK(m.carteira)
			m.nome_ct1	 = usuario.nome
		ELSE
			m.nome_ct1	 = ""
		ENDIF		
		SHOW GET m.carteira
		SHOW GET m.nome_ct1
		SHOW GET m.potencial
	ENDIF
*
	SELE empresa
	SET ORDER TO TAG empresa
	SEEK m.empresa
	m.nome_emp	 = empresa.sigla
	SHOW GET m.nome_emp
*
	sele clientes
RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEXJ           local_refresh VALID                º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200R,     Record Number:    6  º
*       º Variable:            local_refresh                      º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      57                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aexj     &&  local_refresh VALID
#REGION 7
RETURN

PROCEDURE local_refresh
PARAMETERS wl_branco, LSaces
*****>>>>>>>>>>>  abilita os acessos permitidos
	LNindice = 0
	LSaces = "   "
	IF !lMaster
		LNindice = ASCAN(vAcessos,WPprgativo)
		IF LNindice > 0
				LNindice = ASUBSCRIPT(VACESSOS,LNindice,1)
				LSaces = vAcessos(LNindice,2)
		ENDIF
	ENDIF

   IF isediting or wl_branco or isreading
	        SHOW GETS OFF
			SHOW OBJECT 5		  ENABLE
			SHOW OBJECT 7		  ENABLE
			SHOW OBJECT 9		  ENABLE
			SHOW GET m.inf_btn    DISABLE
			SHOW GET m.nfs_btn    DISABLE
			SHOW GET m.dup_btn    DISABLE
			SHOW GET m.ext_btn    DISABLE
			SHOW GET m.res_btn    DISABLE
			SHOW GET anx_btn   	  DISABLE
			SHOW GET atlz_btn  	  DISABLE
			SHOW GET cart_btn  	  DISABLE
			RETURN

	ENDIF
	*****************
	IF "1" $ LSaces
		SHOW GET inf_btn   DISABLE
	ENDIF
	IF "2" $ LSaces	
		SHOW GET nfs_btn   DISABLE
	ENDIF
	IF "3" $ LSaces	
		SHOW GET dup_btn   DISABLE
	ENDIF
	IF "4" $ LSaces	
		SHOW GET ext_btn   DISABLE
	ENDIF
	IF "5" $ LSaces	
		SHOW GET res_btn   DISABLE
	ENDIF
	if nUsr<>1
		SHOW GET atlz_btn   DISABLE
	endif
	IF "7" $ LSaces	
		SHOW GET cart_btn   DISABLE
	ENDIF

	=W_DEFPROC("ACESSO.SPR")
	IF !ACGetAutorizacao(nUsr,"SCGC200", "ATLZ_BTN")
		SHOW GET ATLZ_btn   DISABLE
	ENDIF



	*****************
    IF m.tp_pessoa = 1
    	SHOW GET m.fantasia   DISABLE
	ELSE
    	SHOW GET m.fantasia   ENABLE
	ENDIF
RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEXK           ULrefcgc VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200R,     Record Number:    7  º
*       º Variable:            ULrefcgc                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      58                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aexk     &&  ULrefcgc VALID
#REGION 7
RETURN

PROCEDURE ULrefcgc
	    IF m.tp_pessoa = 1
	    	SHOW GET m.fantasia   DISABLE
	        SHOW GETS OFF
		ELSE
	    	SHOW GET m.fantasia   ENABLE
            SHOW GETS OFF
		ENDIF
RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEXL           ULWhenTela VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC200R,     Record Number:    8  º
*       º Variable:            ULWhenTela                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      59                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aexl     &&  ULWhenTela VALID
#REGION 7
RETURN

FUNCTION ULWhenTela
PARAMETERS PrmBtn,PrmWindow
	PRIVATE LFreturn
	
	PrmBtn = UPPER(PrmBtn)
	PrmWindou = UPPER(PrmWindow)
	IF PrmBtn=PrmWindow
       LFreturn = .T.
    ELSE
       LFreturn = .F.
    ENDIF

RETURN(LFreturn)
	


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2IB11AEUK           Read Level Show                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         Multiple Screens                   º
*       º Called By:           READ Statement                     º
*       º Snippet Number:      60                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2ib11aeuk     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: SCGC200
*
#REGION 2
IF SYS(2016) = "SCGC200" OR SYS(2016) = "*"
	ACTIVATE WINDOW scgc200 SAME
	@ 1,66 SAY IIF(m.tp_pessoa < 2,"Nascimento:","Fundacao..:") ;
		SIZE 1,11, 0 ;
		COLOR W+/W    
	@ 4,2 SAY IIF(m.tp_pessoa < 2,"Nome.....:","Rz.Social:") ;
		SIZE 1,12, 0 ;
		COLOR W+/W    
	@ 5,2 SAY IIF(m.tp_pessoa < 2,"","Fantasia.:") ;
		SIZE 1,12, 0 ;
		COLOR W+/W    
	@ 14,1 SAY IIF(m.tp_pessoa < 2,"Nome.....:","Rz.Social:") ;
		SIZE 1,12, 0 ;
		COLOR W+/W    
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF