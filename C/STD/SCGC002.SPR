*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ 07/29/14             SCGC002.SPR               10:26:55 ╨
*       ╨                                                         ╨
*       гддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╤
*       ╨                                                         ╨
*       ╨ Author's Name                                           ╨
*       ╨                                                         ╨
*       ╨ Copyright (c) 2014 Company Name                         ╨
*       ╨ Address                                                 ╨
*       ╨ City,     Zip                                           ╨
*       ╨                                                         ╨
*       ╨ Description:                                            ╨
*       ╨ This program was automatically generated by GENSCRN.    ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨          SCGC002/MS-DOS Setup Code - SECTION 1          ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
	*~ WIZARDSCREEN
	*---------------------------------------------------------------------*
	* ARQUIVOS UTILIZADOS :                                               *
	*              - TRANSMIT  e INDICADOS
	* OBJETIVOS : EXPORTACAO DE DADOS
	*	
	*---------------------------------------------------------------------*


	*---------------------------------------------------------------------*
	
	******>>>> INICIO CONTROLE AMBIENTAL POR INTERFACE TELA
	
	*---------------------------------------------------------------------*

	CLEAR TYPEAHEAD
	PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
	ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
	******************************************************************
	PRIVATE wl_areant, isediting,isadding,isreading,wp_record,wp_flgfecha
	PRIVATE LFjanela, wp_ref_local, LNcr_ant
	PRIVATE VLleitura, VLlerfim, VLcompara, VLchvlimi

	PRIVATE LFtra,LFcomp,LFentra,LFsaida,LFcarteira,LFqe,LFci,data
	PRIVATE LFcompacta
	PRIVATE dt_inicio, dt_fim,saida
	PRIVATE m.drive, m.drivetmp

	*---------------------------------------------------------------*

	ON KEY LABEL ESCAPE

	*---------------------------------------------------------------*
	* INICIALIZA VARIAVEIS
	*---------------------------------------------------------------*


	wl_areant = ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA
	m.wzalias	=	SELECT()
	m.isediting	=	.F.
	m.isadding	=	.F.
	m.isreading = 	.F.
	m.is2table 	= 	.F.
	wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
	WP_RECORD 	= 	 0
	wp_ref_local=   .f.     && NAO POSSUI CONTROLE DE REFRESH LOCAL


	m.drive =""
	*****************>>>> INICIO CONTROLE ARQUIVOS<<<<<<<<

	*>> parametros repassados a btn_val
	VLleitura = ""   && repassa chave de leitura p/ btn_val
	VLlerfim  = ""   && p/ leitura do ultimo reg + 1
	VLcompara = ""   && repassa chave de comparacao p/ btn_val
	VLchvlimi = ""   && otimiza browse


	***********>>>>> USO LOCAL <<<<< ******************************

	LFtra 		= .F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
	LFexp001	= .F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
	LFcli		= .t.     && indica que arquivos estao compactados
	LFfor		= .t.     && indica que arquivos estao compactados
	LFcomp		= .t.     && indica que arquivos estao compactados
	LFentra		= .t.     && indica que arquivos estao compactados
	LFsaida		= .t.     && indica que arquivos estao compactados
	LFcarteira	= .t.     && indica que arquivos estao compactados
	LFqe     	= .t.     && indica que arquivos estao compactados
	LFci     	= .t.     && indica que arquivos estao compactados
	LFcompacta  = .T.     && ASSUME COMPACTACAO COMO DEFAUT

	m.saida     =  2
	STORE 		DATE() TO m.data, m.dt_inicio, m.dt_fim

	*-----------------------------------------------------------*

	wl_record = 1

	DIMENSION wv_seletor(wl_record,1)
	DIMENSION wv_marcador(wl_record,1)

	wi_seletor = 0

	wl_marca = " "


	*--------------BUSCA PARAMETROS PARA PROXIMO RELATO -----------*


	*--------------------------------------------------------------*
	ON ERROR TMP=""   && EVITA MENS. DE ERRO QDO ARQ.NAO EXISTIR
	*--------------------------------------------------------------*

	RESTORE FROM  \SCGC\COMUM\temp002a ADDITIVE
	RESTORE FROM  \SCGC\COMUM\temp002b ADDITIVE
	RESTORE FROM  \SCGC\COMUM\temp002C ADDITIVE

	*--------------------------------------------------------------*
	ON ERROR
	*--------------------------------------------------------------*


	IF EMPTY(m.drive)
		m.drive 	= "\SCGC\TRANSF\"
		m.drivetmp 	= "\TMP\" 			&& ARQUIVOS ANTES DA COMPACTACAO
	ENDIF


	*--------------------------------------------------------------*
	*--------------------------------------------------------------*



	IF !ULOpenTransmite()
		RETURN
	ENDIF

	*---------------------------------------------------------------------*
	
	******>>>> FIM CONTROLE AMBIENTAL POR INTERFACE TELA
	
	*---------------------------------------------------------------------*





#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨                MS-DOS Window definitions                ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

IF NOT WEXIST("scgc002") ;
	OR UPPER(WTITLE("SCGC002")) == "SCGC002.PJX" ;
	OR UPPER(WTITLE("SCGC002")) == "SCGC002.SCX" ;
	OR UPPER(WTITLE("SCGC002")) == "SCGC002.MNX" ;
	OR UPPER(WTITLE("SCGC002")) == "SCGC002.PRG" ;
	OR UPPER(WTITLE("SCGC002")) == "SCGC002.FRX" ;
	OR UPPER(WTITLE("SCGC002")) == "SCGC002.QPR"
	DEFINE WINDOW scgc002 ;
		FROM INT((SROW()-21)/2),INT((SCOL()-76)/2) ;
		TO INT((SROW()-21)/2)+20,INT((SCOL()-76)/2)+75 ;
		TITLE "[ EXPORTACAO DO MOVIMENTO COMERCIAL ]" ;
		FOOTER "[ 002 ]" ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF

IF NOT WEXIST("scgc002a") ;
	OR UPPER(WTITLE("SCGC002A")) == "SCGC002A.PJX" ;
	OR UPPER(WTITLE("SCGC002A")) == "SCGC002A.SCX" ;
	OR UPPER(WTITLE("SCGC002A")) == "SCGC002A.MNX" ;
	OR UPPER(WTITLE("SCGC002A")) == "SCGC002A.PRG" ;
	OR UPPER(WTITLE("SCGC002A")) == "SCGC002A.FRX" ;
	OR UPPER(WTITLE("SCGC002A")) == "SCGC002A.QPR"
	DEFINE WINDOW scgc002a ;
		FROM INT((SROW()-27)/2),INT((SCOL()-77)/2) ;
		TO INT((SROW()-27)/2)+26,INT((SCOL()-77)/2)+76 ;
		TITLE "[ METODOS EXPORTACAO DADOS ]" ;
		FOOTER "[ SCGC002A ]" ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨          SCGC002/MS-DOS Setup Code - SECTION 2          ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
******************  PARA SELECIONAR ARQUIVOS A RESTURAR ********


	SHOW GET m.drive

	SHOW GETS


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨              SCGC002/MS-DOS Screen Layout               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
IF WVISIBLE("scgc002")
	ACTIVATE WINDOW scgc002 SAME
ELSE
	ACTIVATE WINDOW scgc002 NOSHOW
ENDIF
@ 1,2 TO 3,35 ;
	COLOR SCHEME 23
@ 5,57 SAY ".???" ;
	SIZE 1,4, 0
@ 0,0 TO 20,75 ;
	COLOR SCHEME 23
@ 1,75 TO 19,75 ;
	COLOR SCHEME 24
@ 20,1 TO 20,74 ;
	COLOR SCHEME 24
@ 20,75 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,75 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,26 SAY "[ Exportacao de Dados ]" ;
	SIZE 1,23, 0
@ 0,68 SAY "[002]" ;
	SIZE 1,5, 0
@ 3,3 TO 3,34 ;
	COLOR SCHEME 24
@ 3,35 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,35 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,35 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,2 TO 6,32 ;
	COLOR SCHEME 23
@ 6,3 TO 6,31 ;
	COLOR SCHEME 24
@ 6,32 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,32 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,32 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,40 TO 6,72 ;
	COLOR SCHEME 23
@ 6,41 TO 6,71 ;
	COLOR SCHEME 24
@ 6,72 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,72 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,72 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 17,1 TO 19,11 ;
	COLOR SCHEME 24
@ 19,2 TO 19,10 ;
	COLOR SCHEME 23
@ 18,11 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 19,11 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,11 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,12 TO 19,23 ;
	COLOR SCHEME 24
@ 19,13 TO 19,22 ;
	COLOR SCHEME 23
@ 18,23 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 19,23 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,23 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,24 TO 19,34 ;
	COLOR SCHEME 24
@ 19,25 TO 19,33 ;
	COLOR SCHEME 23
@ 18,34 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 19,34 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,34 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 4,4 SAY "[ Periodo para Exportacao ]" ;
	SIZE 1,27, 0
@ 5,17 SAY "a" ;
	SIZE 1,1, 0
@ 17,35 TO 19,47 ;
	COLOR SCHEME 24
@ 19,36 TO 19,46 ;
	COLOR SCHEME 23
@ 18,47 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 19,47 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,47 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,48 TO 19,60 ;
	COLOR SCHEME 24
@ 19,49 TO 19,59 ;
	COLOR SCHEME 23
@ 18,60 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 19,60 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,60 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,61 TO 19,74 ;
	COLOR SCHEME 24
@ 19,62 TO 19,73 ;
	COLOR SCHEME 23
@ 18,74 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 19,74 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 17,74 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 1,40 TO 3,73 ;
	COLOR SCHEME 23
@ 3,41 TO 3,72 ;
	COLOR SCHEME 24
@ 3,73 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,73 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,73 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,3 SAY "[ Dir.P/Arq.Compactados ]" ;
	SIZE 1,25, 0
@ 1,41 SAY "[ Dir.P/ Nao Compactados <tmp>]" ;
	SIZE 1,31, 0
@ 2,4 GET m.drive ;
	SIZE 1,30 ;
	DEFAULT " " ;
	WHEN _44k0me8mi() ;
	VALID _44k0me8mq() ;
	ERROR _44k0me8my()
@ 2,42 GET m.drivetmp ;
	SIZE 1,30 ;
	DEFAULT " " ;
	WHEN _44k0me8n6() ;
	VALID _44k0me8n7() ;
	ERROR _44k0me8n8()
@ 5,6 GET m.dt_inicio ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN isediting ;
	VALID _44k0me8np()
@ 5,19 GET m.dt_fim ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _44k0me8nv() ;
	VALID _44k0me8o2() ;
	MESSAGE "Data Final deve ser maior ou igual a Inicial"
@ 5,49 GET m.nomearq ;
	SIZE 1,8 ;
	DEFAULT " " ;
	WHEN _44k0me8o9()
@ 7,1 GET wi_seletor ;
 	PICTURE "@&N" ;
	FROM wv_seletor ;
	SIZE 10,34 ;
	DEFAULT 1 ;
	WHEN _44k0me8of() ;
	VALID _44k0me8ol() ;
	MESSAGE "<ENTER> - Seleciona    -   <F2> - Sai " ;
	COLOR SCHEME 2
@ 8,40 GET LFcompacta ;
	PICTURE "@*C Compactar Arquivos em MLddmmff" ;
	SIZE 1,34 ;
	DEFAULT 0 ;
	WHEN _44k0me8os()
@ 10,40 GET LFentra ;
	PICTURE "@*C Entradas" ;
	SIZE 1,12 ;
	DEFAULT 0 ;
	WHEN _44k0me8ot() ;
	VALID _44k0me8ou()
@ 11,40 GET LFsaida ;
	PICTURE "@*C Saidas" ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	WHEN _44k0me8pb() ;
	VALID _44k0me8ph()
@ 12,40 GET LFcarteira ;
	PICTURE "@*C Carteira" ;
	SIZE 1,12 ;
	DEFAULT 0 ;
	WHEN _44k0me8pn()
@ 13,40 GET LFci ;
	PICTURE "@*C C.I." ;
	SIZE 1,8 ;
	DEFAULT 0 ;
	WHEN _44k0me8pt()
@ 14,40 GET LFqe ;
	PICTURE "@*C Q.E." ;
	SIZE 1,8 ;
	DEFAULT 0 ;
	WHEN _44k0me8q0()
@ 15,46 GET LNqe ;
	PICTURE "@*RVN Q.E Geral;Q.E Movimentado" ;
	SIZE 1,19,0 ;
	DEFAULT 1 ;
	WHEN _44k0me8q6() ;
	DISABLE
@ 18,2 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	WHEN _44k0me8qd() ;
	VALID _44k0me8qe() ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 18,13 GET m.imp_btn ;
	PICTURE "@*HN \<Processa" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _44k0me8qq() ;
	DISABLE
@ 18,25 GET m.canc_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _44k0me8qw()
@ 18,36 GET m.grv ;
	PICTURE "@*VN \<Grv.Marca" ;
	SIZE 1,11,1 ;
	DEFAULT 1 ;
	WHEN _44k0me8r2() ;
	VALID _44k0me8r9()
@ 18,49 GET m.rec ;
	PICTURE "@*VN Rec.\<Marca" ;
	SIZE 1,11,1 ;
	DEFAULT 1 ;
	WHEN _44k0me8rf() ;
	VALID _44k0me8rm()
@ 18,62 GET m.nov ;
	PICTURE "@*VN \<Nova Marca" ;
	SIZE 1,12,1 ;
	DEFAULT 1 ;
	WHEN _44k0me8rr() ;
	VALID _44k0me8rs()
@ 4,41 SAY "[ Nome do arq. de Saida ]" ;
	SIZE 1,25, 0




*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨              SCGC002A/MS-DOS Screen Layout              ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 2
IF WVISIBLE("scgc002a")
	ACTIVATE WINDOW scgc002a SAME
ELSE
	ACTIVATE WINDOW scgc002a NOSHOW
ENDIF
@ 24,2 GET ULGrv_Var ;
	PICTURE "@*VN ULGrv_Var - Salva var como PARAMETROS PARA proxima exportacao" ;
	SIZE 1,63,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8ru()
@ 25,2 GET ULLer_Var ;
	PICTURE "@*VN ULLer_Var - Ler var como PARAMETROS da exportacao anterior" ;
	SIZE 1,60,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8sb()
@ 23,2 GET ULBTN_VAL1 ;
	PICTURE "@*VN BTN_VAL1 - Controle de navegacao/opcoes" ;
	SIZE 1,41,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8sh()
@ 26,2 GET ULCarregaArq ;
	PICTURE "@*VN ULCarregaArq - Monta vetor com Arquivos p transmissao" ;
	SIZE 1,55,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8so()
@ 3,3 GET ULinicializa ;
	PICTURE "@*HN ULinicializa - Ambiente Controle exportacao sem Interface" ;
	SIZE 1,59,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8su()
@ 1,2 GET ULOpenTransmite ;
	PICTURE "@*HN ULOpenTransmite - Abere arq transmite" ;
	SIZE 1,39,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8t3()
@ 4,7 GET ULExportaML ;
	PICTURE "@*HN ULExportaML - Exportacao ML" ;
	SIZE 1,29,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8ta()
@ 11,13 GET ULconvqe ;
	PICTURE "@*HN ULconvqe" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8tb()
@ 6,10 GET antULtransarq ;
	PICTURE "@*HN antULtransarq - TRANSFERENCIA SIMPLES DE ARQUIVOS" ;
	SIZE 1,51,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8tc() ;
	DISABLE
@ 8,13 GET ULtransfere ;
	PICTURE "@*HN ULtransfere" ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8ty()
@ 13,13 GET ULconvci ;
	PICTURE "@*HN ULconvci" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8u6()
@ 19,8 GET ULcompacta ;
	PICTURE "@*HN ULcompacta" ;
	SIZE 1,12,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8ud()
@ 20,3 GET ULfecha ;
	PICTURE "@*HN ULfecha" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8uk()
@ 21,3 GET ULerrodrive ;
	PICTURE "@*HN ULerrodrive" ;
	SIZE 1,13,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8uq()
@ 14,10 GET ULCvOrcament ;
	PICTURE "@*HN ULCvOrcament - Exp.Orcamentos" ;
	SIZE 1,31,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8ux()
@ 15,10 GET ULCvNfCanCpm ;
	PICTURE "@*HN ULCvNfCanCpm - Exp.NFs Canceladas e Copias de Cupons" ;
	SIZE 1,54,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8uy()
@ 10,10 GET ULvrif_qe ;
	PICTURE "@*HN ULvrif_qe" ;
	SIZE 1,11,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8vd()
@ 12,10 GET ULvrif_ci ;
	PICTURE "@*HN ULvrif_ci" ;
	SIZE 1,11,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8vj()
@ 16,10 GET ULCvNfEntrada ;
	PICTURE "@*HN ULCvNfEntrada - Exp.NFs de Entrada" ;
	SIZE 1,36,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8vq()
@ 18,10 GET ULCvCarteira ;
	PICTURE "@*HN ULCvCarteira - Exp.Comandos de Cobranca" ;
	SIZE 1,41,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8vz()
@ 5,9 GET ULNomeArqML ;
	PICTURE "@*HN ULNomeArqML - Define Nome para Arquivos do ML" ;
	SIZE 1,47,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8w7()
@ 7,10 GET ULtransarq ;
	PICTURE "@*HN ULtransarq - TRANSFERENCIA SIMPLES DE ARQUIVOS" ;
	SIZE 1,48,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8wd()
@ 17,10 GET ULCvPedidos ;
	PICTURE "@*HN ULCvPedidos - Exp.Pedido de Compra " ;
	SIZE 1,37,1 ;
	DEFAULT 1 ;
	WHEN .F. ;
	VALID _44k0me8we()

IF NOT WVISIBLE("scgc002a")
	ACTIVATE WINDOW scgc002a
ENDIF
IF NOT WVISIBLE("scgc002")
	ACTIVATE WINDOW scgc002
ENDIF



*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨     MS-DOSREAD contains clauses from SCREEN scgc002     ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

READ CYCLE ;
	ACTIVATE READACT() ;
	DEACTIVATE READDEAC() ;
	SHOW _44k0me8wf()

RELEASE WINDOW scgc002
RELEASE WINDOW scgc002a

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨               SCGC002/MS-DOS Cleanup Code               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
	DO ULfecha 		&& FECHA ARQUIVOS ABERTOS
RETURN






*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨              SCGC002A/MS-DOS Cleanup Code               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 2

	do ULfecha
RETURN









********************************


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8MI           m.drive WHEN                       ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   64   ╨
*       ╨ Variable:            m.drive                            ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      1                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8mi     &&  m.drive WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8MQ           m.drive VALID                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   64   ╨
*       ╨ Variable:            m.drive                            ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      2                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8mq     &&  m.drive VALID
#REGION 1
m.drive = ALLTRIM(m.drive)

IF RIGHT(m.drive,1) <> "\"
    m.drive = ALLTRIM(m.drive)+"\"
ENDIF

SHOW GET m.drive
**
LSdirant = SYS(5)+CURDIR()

LFokdrive = .t.
ON ERROR DO ULerrodrive

SET DEFA TO &drive
IF !LFokdrive
	wp_msg = "O Caminho Nao Existe :" +m.drive+"  <ENTER>"
ENDIF	

SET DEFA TO &LSdirant
ON ERROR DO UPerrosys

ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN (LFokdrive)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8MY           m.drive ERROR                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   64   ╨
*       ╨ Variable:            m.drive                            ╨
*       ╨ Called By:           ERROR Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      3                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8my     &&  m.drive ERROR
#REGION 1
WAIT WINDOW WP_MSG

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8N6           m.drivetmp WHEN                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   65   ╨
*       ╨ Variable:            m.drivetmp                         ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      4                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8n6     &&  m.drivetmp WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8N7           m.drivetmp VALID                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   65   ╨
*       ╨ Variable:            m.drivetmp                         ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      5                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8n7     &&  m.drivetmp VALID
#REGION 1
m.drivetmp = ALLTRIM(m.drivetmp)

IF RIGHT(m.drivetmp,1) <> "\"
    m.drivetmp = ALLTRIM(m.drivetmp)+"\"
ENDIF

SHOW GET m.drivetmp
**
LSdirant = SYS(5)+CURDIR()

LFokdrive = .t.
ON ERROR DO ULerrodrive

SET DEFA TO &drivetmp
IF !LFokdrive
	wp_msg = "O Caminho Nao Existe :" +m.drivetmp+"  <ENTER>"
ENDIF	

SET DEFA TO &LSdirant
ON ERROR DO UPerrosys

ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN (LFokdrive)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8N8           m.drivetmp ERROR                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   65   ╨
*       ╨ Variable:            m.drivetmp                         ╨
*       ╨ Called By:           ERROR Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      6                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8n8     &&  m.drivetmp ERROR
#REGION 1
WAIT WINDOW WP_MSG

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8NP           m.dt_inicio VALID                  ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   66   ╨
*       ╨ Variable:            m.dt_inicio                        ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      7                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8np     &&  m.dt_inicio VALID
#REGION 1
m.dt_fim = m.dt_inicio
SHOW GET m.dt_fim
RETURN .T.

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8NV           m.dt_fim WHEN                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   67   ╨
*       ╨ Variable:            m.dt_fim                           ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      8                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8nv     &&  m.dt_fim WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8O2           m.dt_fim VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   67   ╨
*       ╨ Variable:            m.dt_fim                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      9                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8o2     &&  m.dt_fim VALID
#REGION 1
if  m.dt_fim >= m.dt_inicio
	m.nomearq = CHRTRAN(STR(MONTH(m.dt_fim ),2)," ","0") + ;
				CHRTRAN(STR(DAY(m.dt_fim ),2)," ","0") + ;
			CHRTRAN(STR(wp_empresa,2)," ","0")
	SHOW GET m.nomearq
	ON KEY LABEL ENTER
	RETURN(.T.)
ENDIF
RETURN(.F.)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8O9           m.nomearq WHEN                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   68   ╨
*       ╨ Variable:            m.nomearq                          ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      10                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8o9     &&  m.nomearq WHEN
#REGION 1
ON KEY LABEL SPACEBAR
ON KEY LABEL ENTER
RETURN(.f.)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8OF           wi_seletor WHEN                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   69   ╨
*       ╨ Variable:            wi_seletor                         ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         List                               ╨
*       ╨ Snippet Number:      11                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8of     &&  wi_seletor WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL SPACEBAR  KEYBOARD "{ENTER}"
RETURN(isediting)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8OL           wi_seletor VALID                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   69   ╨
*       ╨ Variable:            wi_seletor                         ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         List                               ╨
*       ╨ Snippet Number:      12                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8ol     &&  wi_seletor VALID
#REGION 1
	wl_marca = ""
	wl_max = wi_seletor
	wl_marca = LEFT(wv_seletor(wi_seletor),1)

	DO CASE
	   CASE wi_seletor = 1
    	    wl_comando = "ZERA"
	        wi_seletor = 3
    	    wl_max     = ALEN(wv_seletor,1)
        	wl_marca   = " "
	   CASE wi_seletor = 2
    	    wl_comando = "TODAS"
        	wi_seletor = 3
	        wl_max     = ALEN(wv_seletor,1)
    	    wl_marca = chr(10)
	   OTHERWISE
    	    if wl_marca = " "
        	   wl_marca = chr(10)
	           wl_comando = "MARCA"
    	    else
        	   wl_marca = " "
	           wl_comando = "ZERA"
    	    endif
	ENDCASE

	*--->   MARCA ou DESMARCA

	DO WHILE ! (wi_seletor > wl_max)
	   wv_seletor(wi_seletor)= wl_marca+SUBS(wv_seletor(wi_seletor),2)
	   wi_seletor = wi_seletor + 1
	ENDDO

	_CUROBJ = OBJNUM(wi_seletor)
	SHOW GET wi_seletor
RETURN(0)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8OS           LFcompacta WHEN                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   70   ╨
*       ╨ Variable:            LFcompacta                         ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      13                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8os     &&  LFcompacta WHEN
#REGION 1
ON KEY LABEL SPACEBAR
IF isediting
	ON KEY LABEL ENTER KEYBOARD "{RIGHTARROW}"
ENDIF	
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8OT           LFentra WHEN                       ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   71   ╨
*       ╨ Variable:            LFentra                            ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      14                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8ot     &&  LFentra WHEN
#REGION 1
ON KEY LABEL SPACEBAR
IF isediting
	ON KEY LABEL ENTER KEYBOARD "{RIGHTARROW}"
ENDIF	
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8OU           LFentra VALID                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   71   ╨
*       ╨ Variable:            LFentra                            ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      15                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8ou     &&  LFentra VALID
#REGION 1
if LFentra
	LFfor = .t.
	SHOW GET LFfor
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8PB           LFsaida WHEN                       ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   72   ╨
*       ╨ Variable:            LFsaida                            ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      16                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8pb     &&  LFsaida WHEN
#REGION 1
IF isediting
	ON KEY LABEL ENTER KEYBOARD "{RIGHTARROW}"
ENDIF	
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8PH           LFsaida VALID                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   72   ╨
*       ╨ Variable:            LFsaida                            ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      17                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8ph     &&  LFsaida VALID
#REGION 1
if LFsaida
	LFcli = .t.
	SHOW GET LFcli
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8PN           LFcarteira WHEN                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   73   ╨
*       ╨ Variable:            LFcarteira                         ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      18                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8pn     &&  LFcarteira WHEN
#REGION 1
IF isediting
	ON KEY LABEL ENTER KEYBOARD "{RIGHTARROW}"
ENDIF	
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8PT           LFci WHEN                          ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   74   ╨
*       ╨ Variable:            LFci                               ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      19                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8pt     &&  LFci WHEN
#REGION 1
IF isediting
	ON KEY LABEL ENTER KEYBOARD "{RIGHTARROW}"
ENDIF	
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8Q0           LFqe WHEN                          ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   75   ╨
*       ╨ Variable:            LFqe                               ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Check Box                          ╨
*       ╨ Snippet Number:      20                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8q0     &&  LFqe WHEN
#REGION 1
ON KEY LABEL SPACEBAR
IF isediting
	ON KEY LABEL ENTER KEYBOARD "{RIGHTARROW}"
ENDIF	
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8Q6           LNqe WHEN                          ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   76   ╨
*       ╨ Variable:            LNqe                               ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Radio Button                       ╨
*       ╨ Snippet Number:      21                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8q6     &&  LNqe WHEN
#REGION 1
IF isediting
	ON KEY LABEL ENTER KEYBOARD "{RIGHTARROW}"
ENDIF	
IF DAY(DATE()) >= 27 AND DAY(DATE()) <= 31
	= W_DEFPROC("rotinas.SPR")
	LSarqocorr  = "\TMP\SCGC002.LOG"
	LSusuario   = wp_nmusr
	LSpcodocorr  = "03"
	LSpdia      = "00"
	LSpmes      = STR(MONTH(DATE()),2)
	LSpano      = STR(YEAR(DATE()),4)
	IF !LeLog(LSarqocorr,LSusuario,LSpdia,LSpmes,LSpano,LSpcodocorr)
		LNqe=1
		WAIT WIND "VOCE DEVE FAVER O Q.E GERAL"
      ELSE
		LNqe=2
		WAIT WIND "VOCE JA FEZ Q.E GERAL FA─A O Q.E MOVIMENTA"
	ENDI
ENDI
RETURN(isediting)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8QD           m.edit_btn WHEN                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   77   ╨
*       ╨ Variable:            m.edit_btn                         ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      22                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8qd     &&  m.edit_btn WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(.T.)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8QE           m.edit_btn VALID                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   77   ╨
*       ╨ Variable:            m.edit_btn                         ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      23                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8qe     &&  m.edit_btn VALID
#REGION 1
	=btn_val1('EDIT')
return

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8QQ           m.imp_btn VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   78   ╨
*       ╨ Variable:            m.imp_btn                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      24                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8qq     &&  m.imp_btn VALID
#REGION 1
PrmDtInicio =   m.dt_inicio
PrmDtFinal  =   m.dt_fim



	DO WHILE PrmDtInicio <= PrmDtFinal



	    m.dt_inicio = PrmDtInicio
    	m.dt_fim    = PrmDtInicio



		DO ULExportaML WITH ;
		     (m.drive), ;
	    	 (m.drivetmp),;
	    	 (m.dt_inicio),;
		     (m.dt_fim),;
		     wv_seletor,;
		     (LFcompacta),;
		     (LFentra),;
	    	 (LFsaida),;
		     (LFcarteira),;
		     (LFci),;
		     (LFqe),;
			 (LNqe),;
		     "TELA"
	
    	PrmDtInicio = PrmDtInicio + 1
	ENDDO

	SHOW WINDOW SCGC002 TOP
	SHOW GET m.imp_btn DISABLE


RETURN





*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8QW           m.canc_btn VALID                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   79   ╨
*       ╨ Variable:            m.canc_btn                         ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      25                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8qw     &&  m.canc_btn VALID
#REGION 1
	CLEAR GETS
	CLEAR READ
	isediting = .f.
RETURN .T.

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8R2           m.grv WHEN                         ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   80   ╨
*       ╨ Variable:            m.grv                              ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      26                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8r2     &&  m.grv WHEN
#REGION 1
ON KEY LABEL SPACEBAR  KEYBOARD "{ENTER}"
RETURN(.T.)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8R9           m.grv VALID                        ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   80   ╨
*       ╨ Variable:            m.grv                              ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      27                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8r9     &&  m.grv VALID
#REGION 1
	=ULGrv_Var()
RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8RF           m.rec WHEN                         ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   81   ╨
*       ╨ Variable:            m.rec                              ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      28                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8rf     &&  m.rec WHEN
#REGION 1
ON KEY LABEL SPACEBAR  KEYBOARD "{ENTER}"
RETURN(.T.)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8RM           m.rec VALID                        ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   81   ╨
*       ╨ Variable:            m.rec                              ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      29                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8rm     &&  m.rec VALID
#REGION 1
	=ULLer_Var()
	SHOW GETS
RETURN

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8RR           m.nov WHEN                         ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   82   ╨
*       ╨ Variable:            m.nov                              ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      30                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8rr     &&  m.nov WHEN
#REGION 1
ON KEY LABEL SPACEBAR  KEYBOARD "{ENTER}"
RETURN(.T.)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8RS           m.nov VALID                        ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002,     Record Number:   82   ╨
*       ╨ Variable:            m.nov                              ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      31                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8rs     &&  m.nov VALID
#REGION 1
	do ULCarregaArq	
	SHOW GETS
RETURN










*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8RU           ULGrv_Var VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:    2  ╨
*       ╨ Variable:            ULGrv_Var                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      32                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8ru     &&  ULGrv_Var VALID
#REGION 2
RETURN

FUNCTION ULGrv_Var
	SAVE TO \SCGC\COMUM\temp002A ALL LIKE wv_marcador
	SAVE TO \SCGC\COMUM\temp002B ALL LIKE wv_seletor
	SAVE TO \SCGC\COMUM\temp002C ALL LIKE drive*
RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8SB           ULLer_Var VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:    3  ╨
*       ╨ Variable:            ULLer_Var                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      33                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8sb     &&  ULLer_Var VALID
#REGION 2
RETURN

FUNCTION ULLer_Var
	*************** BUSCA PARAMETROS PARA PROXIMO RELATO *****
	ON ERROR TMP=""   && EVITA MENS. DE ERRO QDO ARQ.NAO EXISTIR
	RESTORE FROM  \SCGC\COMUM\temp002a ADDITIVE
	RESTORE FROM  \SCGC\COMUM\temp002b ADDITIVE
	RESTORE FROM  \SCGC\COMUM\temp002C ADDITIVE
	ON ERROR
	LSdrvtmp = ALLTRIM(m.drive)+"TMP\"
	****************************************************************
RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8SH           ULBTN_VAL1 VALID                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:    4  ╨
*       ╨ Variable:            ULBTN_VAL1                         ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      34                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8sh     &&  ULBTN_VAL1 VALID
#REGION 2
RETURN

PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	LN_prxobj = _CUROBJ
	ON KEY LABEL ENTER
    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
			SHOW GETS
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.imp_btn DISABLE
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn ENABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn DISABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8SO           ULCarregaArq VALID                 ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:    5  ╨
*       ╨ Variable:            ULCarregaArq                       ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      35                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8so     &&  ULCarregaArq VALID
#REGION 2
RETURN

PROCEDURE ULCarregaArq	

	sele transmit
	go top
	******************  PARA SELECIONAR ARQUIVOS A RESTURAR ********
	COUNT FOR transmit.envia TO wl_record
	wl_record = wl_record + 2

	DIMENSION wv_seletor(wl_record,1)
	DIMENSION wv_marcador(wl_record,1)

	wi_seletor = 3
	GO TOP

	wv_seletor(1) = "Anula Selecoes."
	wv_seletor(2) = "Seleciona Todas."
	wv_marcador(1) = "Anula Selecoes."
	wv_marcador(2) = "Seleciona Todas."

	DO WHILE !EOF()
	   IF transmit.envia
		   wl_marca = " "
		   wv_seletor(wi_seletor)  = ;
		   		wl_marca+transmit.arquivo+" - "+descricao
		   wv_marcador(wi_seletor) = transmit.arquivo
		   wi_seletor = wi_seletor + 1
	   ENDIF
	   SKIP
	ENDDO


SHOW GETS










*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8SU           ULinicializa VALID                 ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:    6  ╨
*       ╨ Variable:            ULinicializa                       ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      36                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8su     &&  ULinicializa VALID
#REGION 2
RETURN

PROCEDURE ULinicializa

	*---------------------------------------------------------------------*
	
	******>>>> INICIO CONTROLE AMBIENTAL POR INTERFACE TELA
	
	*---------------------------------------------------------------------*

	CLEAR TYPEAHEAD
	PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
	ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
	******************************************************************
	PRIVATE wl_areant, isediting,isadding,isreading,wp_record,wp_flgfecha
	PRIVATE LFjanela, wp_ref_local, LNcr_ant
	PRIVATE VLleitura, VLlerfim, VLcompara, VLchvlimi

	PRIVATE LFtra,LFcomp,LFentra,LFsaida,LFcarteira,LFqe,LNqe,LFci,data
	PRIVATE LFcompacta
	PRIVATE dt_inicio, dt_fim,saida
	PRIVATE m.drive, m.drivetmp

	*---------------------------------------------------------------*

	ON KEY LABEL ESCAPE

	*---------------------------------------------------------------*
	* INICIALIZA VARIAVEIS
	*---------------------------------------------------------------*


	wl_areant = ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA
	m.wzalias	=	SELECT()
	m.isediting	=	.F.
	m.isadding	=	.F.
	m.isreading = 	.F.
	m.is2table 	= 	.F.
	wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
	WP_RECORD 	= 	 0
	wp_ref_local=   .f.     && NAO POSSUI CONTROLE DE REFRESH LOCAL


	*****************>>>> INICIO CONTROLE ARQUIVOS<<<<<<<<

	*>> parametros repassados a btn_val
	VLleitura = ""   && repassa chave de leitura p/ btn_val
	VLlerfim  = ""   && p/ leitura do ultimo reg + 1
	VLcompara = ""   && repassa chave de comparacao p/ btn_val
	VLchvlimi = ""   && otimiza browse


	***********>>>>> USO LOCAL <<<<< ******************************

	LFtra 		= .F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
	LFexp001	= .F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
	LFcli		= .t.     && indica que arquivos estao compactados
	LFfor		= .t.     && indica que arquivos estao compactados
	LFcomp		= .t.     && indica que arquivos estao compactados
	LFentra		= .t.     && indica que arquivos estao compactados
	LFsaida		= .t.     && indica que arquivos estao compactados
	LFcarteira	= .t.     && indica que arquivos estao compactados
	LFqe     	= .t.     && indica que arquivos estao compactados
	LFci     	= .t.     && indica que arquivos estao compactados
	LFcompacta  = .T.     && ASSUME COMPACTACAO COMO DEFAUT
	LNqe        = 1

	m.saida     =  2

	*-----------------------------------------------------------*

	wl_record = 1

	DIMENSION wv_seletor(wl_record,1)
	DIMENSION wv_marcador(wl_record,1)

	wi_seletor = 0

	wl_marca = " "


	*--------------BUSCA PARAMETROS PARA PROXIMO RELATO -----------*


	*--------------------------------------------------------------*
	ON ERROR TMP=""   && EVITA MENS. DE ERRO QDO ARQ.NAO EXISTIR
	*--------------------------------------------------------------*

	RESTORE FROM  temp002a ADDITIVE
	RESTORE FROM  temp002b ADDITIVE
	RESTORE FROM  temp002C ADDITIVE


	*--------------------------------------------------------------*
	ON ERROR
	*--------------------------------------------------------------*
	STORE 		DATE() TO m.data, m.dt_inicio, m.dt_fim


	IF EMPTY(m.drive)
		m.drive 	= "\SCGC\TRANSF\"
		m.drivetmp 	= "\TMP\" 			&& ARQUIVOS ANTES DA COMPACTACAO
	ENDIF

	m.drive 	= "L:\BKP\"
	m.drivetmp 	= "L:\BKP\" 			&& ARQUIVOS ANTES DA COMPACTACAO

	*--------------------------------------------------------------*
	*--------------------------------------------------------------*



	IF !ULOpenTransmite()
		RETURN
	ENDIF

	*---------------------------------------------------------------------*
	
	******>>>> FIM CONTROLE AMBIENTAL POR INTERFACE TELA
	
	*---------------------------------------------------------------------*
	STORE .T. TO ;
	    LFtra,LFcomp,LFentra,LFsaida,LFcarteira

	LNqe = 1
	LFqe = .F.     && NAO GERA QE PARA BKP
	LFci = .F.     && NAO GERA CI PARA BKP

	DO ULExportaML WITH ;
	     m.drive, ;
	     m.drivetmp,;
	     m.dt_inicio,;
	     m.dt_fim,;
	     wv_seletor,;
	     LFcompacta,;
	     LFentra,;
	     LFsaida,;
	     LFcarteira,;
	     LFci,;
	     LFqe,;
		 LNqe,;
	     "INTERNA"


	***** DO ULfecha
	IF LFtra		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("transmit")
	ENDIF
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(wl_areant)
		SELECT &wl_areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
	************************************
	POP KEY 			&& reabilita teclas de atalho def. anteriormente

RETURN




*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8T3           ULOpenTransmite VALID              ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:    7  ╨
*       ╨ Variable:            ULOpenTransmite                    ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      37                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8t3     &&  ULOpenTransmite VALID
#REGION 2
RETURN

FUNCTION ULOpenTransmite

	IF !USED("transmit")
		LFtra 	= .T.
		IF ! NetUse("transmit")
			wp_flgfecha = .t.  && implica no fechamento da secao
		ENDIF
	ENDIF
	IF wp_flgfecha
		do ULfecha
		RETURN(.F.)
	ENDIF
	
RETURN(.T.)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8TA           ULExportaML VALID                  ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:    8  ╨
*       ╨ Variable:            ULExportaML                        ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      38                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8ta     &&  ULExportaML VALID
#REGION 2
RETURN

PROCEDURE ULExportaML
PARAMETERS ;
	     m.drive, ;
	     m.drivetmp,;
	     m.dt_inicio,;
	     m.dt_fim,;
	     wv_seletor,;
	     LFcompacta,;
	     LFentra,;
	     LFsaida,;
	     LFcarteira,;
	     LFci,;
	     LFqe,;
		 LNqe,;
	     PrmChamador

	PRIVATE	m.NomeArq,PrmNomeArq
	m.NomeArq = ""
	PrmNomeArq =""

	IF !ULNomeArqML(m.drive, ;
		    	 m.drivetmp,;
			     m.dt_inicio,;
			     m.dt_fim,;
			     PrmChamador,;
		    	 PrmNomeArq)
		   RETURN(.f.)
	ENDIF	
	m.NomeArq  = PrmNomeArq

	
	LSdrvtmpII = m.drivetmp+m.nomearq+"*.*"
	!DEL &LSdrvtmpII

	**************************************************************
	* Rotina: 	 GrvLog
	* Descricao: Grava uma ocorrencia em uma arquivo tipo txt
	*
	* DESCRICAO DAS OCORRENCIA DESTE PROGRAMA NO ARQUIVO DE LOG
	*
	* 01 - INICIO DOS PROCESSOS
	* 02 - FIM DOS PROCESSOS
	* 03 - INICIO DO PROCESSO Q.E GERAL
	* 04 - INICIO DO PROCESSO Q.E MOVIMENTA
	* 05 - FIM DO PROCESSO Q.E GERAL
	* 06 - FIM DO PROCESSO Q.E MOVIMENTA
	*
	****************************
	= W_DEFPROC("ROTINAS.SPR")
	LSarqocorr  = "\TMP\SCGC002.LOG"
	LSusuario   = wp_nmusr
	LScodocorr  = "01"
	LSdescocorr = "INICIO DOS PROCESSOS"
	= GrvLog(LSarqocorr,LSusuario,LScodocorr,LSdescocorr)
	= W_DEFPROC("ROTINAS.SPR")
	
	**************************************************************
	*																*
	* 	INICIO TRANSFERENCIA DE ARQUIVOS POR ALTERACAO DE DADOS		*
	* 		< ESTES ARQUIVOS NAO DESENCADEIAM PROCESSOS >			*
	*   A TRANSFERENCIA APENAS MANTEM AS BASES ATUALIZADAS			*
	*																*
	**************************************************************

	LFflag	= .T.	&& .T. INDICA QUE PROCESSO FOI BEM SUCEDIDO
				&& .F. FORCA A INTERRUPCAO DO PROCESSO

	LNfilial	= wp_empresa



	DO ULtransarq WITH LNfilial,m.drivetmp,;
					 wv_seletor,wv_marcador,m.dt_inicio,m.dt_fim


	**************************************************************
	IF !LFentra AND !LFsaida AND !LFcarteira AND !LFci AND !LFqe
		***
		DO ULcompacta WITH m.dt_inicio,wp_empresa ;
					&& Compactacao de arq gerados
		***
		RETURN
	ENDIF
	**************************************************************


	DO WHILE LFflag AND m.dt_inicio <= m.dt_fim



		=!ULNomeArqML(m.drive, ;
		    	 m.drivetmp,;
			     m.dt_inicio,;
			     m.dt_fim,;
			     PrmChamador,;
		    	 m.NomeArq)
		m.NomeArq  = PrmNomeArq




		SHOW GET m.nomearq


		*****************************************************************
		*																*
		* 	INICIO TRANSFERENCIA DE ARQUIVOS POR PROCESSO  DE DADOS		*
		* 		< ESTES ARQUIVOS SAO PROCESSADOS QDO. RECEBIDOS			*
		*    OS PROCESSOS SAO USADOS P/ CHECAGEM GERAL DAS FILIAIS		*
		*																*
		*****************************************************************
		**********************>>> MOVIMENTO OU Q.E. QTDE ESTOQUE P/ CONF

		IF !ULvrif_qe(LNqe)
			RETURN .F.
		ENDIF

		**********************>>> SALDO DE CARTEIRA
		IF !ULvrif_ci()
		   RETURN .F.
		ENDIF
		
		**********************>>> ORCAMENTO
		IF LFsaida
			IF !ULCvOrcament()
				return(.f.)
			ENDIF
		ENDIF
		**********************>>> NOTAS CANCELADAS e COPIAS DE CUPOM

		IF LFsaida
			IF !ULCvNfCanCpm()
				return(.f.)
			ENDIF
		ENDIF

		****************>>> NOTAS DE ENTRADS COM TRATAMENTO POR ALTERACAO

		IF LFentra
			IF !ULCvNfEntrada()
				return(.f.)
			ENDIF
		ENDIF

		**********************>>> PEDIDOS
		IF LFentra
			IF !ULCvPedidos()
				return(.f.)
			ENDIF
		ENDIF

		**********************>>> AVISOS BANC. E COMANDOS DE CARTEIRA
		IF LFcarteira
			IF !ULCvCarteira()
				return(.f.)
			ENDIF
		ENDIF

		if LFcompacta		&& foi solicitada compactacao
			***
			DO ULcompacta WITH m.dt_inicio,wp_empresa && Compactacao de arq
												  && gerados
			***
			LSdrvtmpII = m.drivetmp+m.nomearq+"*.*"
			!DEL &LSdrvtmpII
		ENDIF
		***
		m.dt_inicio = m.dt_inicio + 1
	ENDDO



	= W_DEFPROC("ROTINAS.SPR")
	LSarqocorr  = "\TMP\SCGC002.LOG"
	LSusuario   = wp_nmusr
	LScodocorr  = "02"
	LSdescocorr = "FIM DOS PROCESSOS"
	= GrvLog(LSarqocorr,LSusuario,LScodocorr,LSdescocorr)
	= W_DEFPROC("ROTINAS.SPR")

RETURN

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8TB           ULconvqe VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:    9  ╨
*       ╨ Variable:            ULconvqe                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      39                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8tb     &&  ULconvqe VALID
#REGION 2
RETURN

PROCEDURE ULconvqe
    PARA LNqe

	= W_DEFPROC("ROTINAS.SPR")
	LSarqocorr  = "\TMP\SCGC002.LOG"
	LSusuario   = wp_nmusr
	IF LNqe = 1
		LScodocorr  = "03"
		LSdescocorr = "INICIO DO PROCESSOS QE GERAL"
      ELSE
		LScodocorr  = "04"
		LSdescocorr = "INICIO DO PROCESSOS QE MOVIMENTO"
	ENDI
	= GrvLog(LSarqocorr,LSusuario,LScodocorr,LSdescocorr)
	= W_DEFPROC("ROTINAS.SPR")

   	SELECT grupo
    SET ORDER TO  TAG codigo
	GO TOP
	SELE itemmov
	SET ORDER TO TAG movimento
	wp_flgfecha = .F.

*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	

	SELE grupo
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue     = .t.
	LNregistro  = RECNO()
	COUNT TO  LNimpressao
	LNimpressos = 0
	GO LNregistro
*******************
	DO WHILE !EOF() AND !wp_flgfecha AND LFsegue
		wp_msg = "EXPORTANDO QE [Emp.: "+STR(wp_empresa,3)+ " ] "+;
									DTOC(m.dt_inicio)
		=UPtermo()

		* NAO EXPORTAR CONFERENCIA DE SERVICO E MAT. EXPEDIENTE

		IF LEFT(grupo.classifica,2) $ "09"
			SKIP
			LOOP
		ENDIF


 		LDdtqe = m.dt_inicio	&& passar pelos qes das datas envolvidas
		DO WHILE LDdtqe <= m.dt_fim
			***********************************************
			m.codigo		=	grupo.codigo
			m.classifica 	=   grupo.classifica
            m.empresa 		= 	wp_empresa
			m.data 			=	LDdtqe
			************************************************
			sele itemmov
			LDtmp = LDdtqe + 1 	&& p/pegar o ultimo mov. do dia ao voltar
								&& um registro
			SET NEAR ON
			SEEK STR(m.empresa,3)+m.codigo+DTOS(LDtmp)
			SET NEAR OFF
****************  LOCALIZAR ULT.OPERACAO NAO INCLUINDO RESERVA ********
			SKIP -1
			DO WHILE !BOF() AND m.codigo = itemmov.codigo  ;
							AND m.empresa= itemmov.empresa

				IF LNqe = 2 AND LDdtqe   <> itemmov.data  && SO MOVIMENTADO
				   EXIT
				ENDIF
				IF LEFT(itemmov.operacao,1) <> "R"  && RESERVA NAO ENV.QE
					EXIT
				ENDIF
				SKIP -1
			ENDDO
			
		    m.sld_loja   = 0
			m.vlr_loja   = 0

			IF (m.codigo = itemmov.codigo ;
				AND m.empresa = itemmov.empresa)
			    m.sld_loja   = itemmov.sld_estq
				m.vlr_loja   = itemmov.vlr_estq
			ELSE
				SELE SALDO
				SET ORDER TO TAG EMP_MES
                SEEK STR(m.empresa,3)+STR(YEAR(LDdtqe),4) + ;
                              STR(MONTH(LDdtqe),2)+ ;
                                m.classifica
				IF FOUND()
				    m.sld_loja   = saldo.sld_atu
					m.vlr_loja   = saldo.vlr_atu
				ENDIF
			ENDIF

***********************************************************************

		    m.sld_centro = 0
			m.vlr_centro = 0

			SELE qetmp
			=edithand('SAVE')
			LDdtqe = LDdtqe + 1	&& p/pegar o ultimo mov. do dia ao voltar
		ENDDO
		SELE grupo
		SKIP
	ENDDO
*****
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
	= W_DEFPROC("ROTINAS.SPR")
	LSarqocorr  = "\TMP\SCGC002.LOG"
	LSusuario   = wp_nmusr
	IF LNqe = 1
		LScodocorr  = "05"
		LSdescocorr = "FIM DO PROCESSOS QE GERAL"
      ELSE
		LScodocorr  = "06"
		LSdescocorr = "FIM DO PROCESSOS QE MOVIMENTO"
	ENDI
	= GrvLog(LSarqocorr,LSusuario,LScodocorr,LSdescocorr)
	= W_DEFPROC("ROTINAS.SPR")
RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8TC           antULtransarq VALID                ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   10  ╨
*       ╨ Variable:            antULtransarq                      ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      40                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

	**************************************************************
	*																*
	* 	INICIO TRANSFERENCIA SIMPLES DE ARQUIVOS POR ALTER.DE DADOS *
	* 		< ESTES ARQUIVOS NAO DESENCADEIAM PROCESSOS >			*
	*   A TRANSFERENCIA APENAS MANTEM AS BASES ATUALIZADAS			*
	*																*
	**************************************************************

FUNCTION _44k0me8tc     &&  antULtransarq VALID
#REGION 2
RETURN


PROCEDURE antULtransarq	&& TRANSFERENCIA SIMPLES DE ARQUIVOS

	PARAMETERS LNfilial, LSdrivetmp, LVTmrc,LVTarq, LDdtini, LDdtfim

	PRIVATE LFsegue		&& indicativo p/ proceguir o processo
	PRIVATE LNind		&& indice do vetos
	PRIVATE LFarqfch    && indicador p/ fechar arq ao final do processo
	PRIVATE LStmpO		&& PATH E NOME DO ARQ. ORIGEM DOS DADOS
	PRIVATE LStmpD		&& PATH E NOME DO ARQ. DESTINO DOS DADOS
	PRIVATE LSnomearq 	&& COMPOSICAO DO NOME DO ARQ. DESTINO
	PRIVATE LNregional 	&& Regional da Empresa Destino - LNfilial
					&& Utilizado para Remessa de Saldo entre Filiais da
					&& Mesma Regional




	LFsegue = .t.
	CLEAR TYPEAHEAD
	LNind 		= 3
	LFarqfch	= .f.
	DO WHILE LNind <= ALEN(LVTmrc,1) AND LFsegue AND !CHRSAW(0.1)
		IF LEFT(LVTmrc(LNind),1) = " "
			LNind	= LNind + 1
			LOOP
		ENDIF
		SET DELE ON

		SELE transmit
		SET ORDER TO TAG arquivo
		SEEK LVTarq(LNind)
		IF !FOUND()
			DO OBJ_ALER.SPR WITH ;
			"Arquivo ( "+LVTarq(LNind)+"  ) Nao Esta Configurado p/ "+;
			"Para Transmissao/Recepcao de Dados. Solicite Suporte..."
			LNind	= LNind + 1
			LOOP
		ENDIF
		SCATTER MEMVAR
		LTchave 	= 	m.chave
		LTdescricao	=	m.descricao
		LTarquivo	=	m.arquivo
		LTindica_emp=	m.indica_emp
		LTchr_ident	=	m.chr_ident

		wp_msg = ALLTRIM(m.descricao)+" "+m.arquivo
		wait window wp_msg nowait
		LSarq = ALLTRIM(m.arquivo)
		LFarqfch	= .f.

		*---
		*-------->   ABRE ARQUIVO ORIGEM
		*---

		IF !USED(ALLTRIM(LSarq))
			LFarqfch	= .t.
			IF !NetUse(LSarq)
			   DO OBJ_ALER.SPR WITH ;
			   "Nao Foi Possivel Acessar Arquivo Origem. "+LSarq+ ;
		    	chr(13)+chr(13)+;
			   "Repita o Processo. "
				LFsegue = .F.
				LOOP
			ENDIF
		ENDIF

		*---
		*-------->
		*---


		SELECT &LSarq
		**************************************************
		*   INICIO DA TRANSFERENCIA DE DADOS			  *
		**************************************************
		SET DELE OFF   && COPIAR REGISTRO DELETADOS DEIXANDO-OS ATIVOS
						   && NO ARQUIVO DESTINO, POREM COM O CAMPO
						   && deletado = .t. QUE PERMITE TRATAMENTO NA
						   && RECUPERACAO
		*********   IDENTIFICA DIRETORIO ORIGEM DO ARQUIVO ********
		LStmpO = DBF()				&& ARQUIVO ORIGEM
		LStmpD = ""    				&& ARQUIVO DESTINO

		******************   MONTA NOME DO ARQUIVO  ********************
		* O ARUIVO  E UNICO PARA TODAS AS DATAS E RECEBE NOME REFERENTE *
		* A  DATA FINAL DO PERIODO										*
		****************************************************************


		m.NomeArq  = PrmNomeArq

		LSnomearq = m.NomeArq+LTchr_ident

		*********   COPIA DADOS PARA ARQUIVO DESTINO *********
		IF FILE(LSdrivetmp+LSnomearq+".DBF")
		   IF !fox_alert('Arquivo '+LSnomearq+' ja existe. Substituir ?')
				IF	LFarqfch
					=UP_fecha(LSarq)
				ENDIF
				LNind	= LNind + 1
				LOOP
			ENDIF
		ENDIF
		*********   CARACTERIZA ARQUIVO DESTINO *********
		LStmpD = LSdrivetmp+LSnomearq
		*************************************************
		DO ULtransfere WITH LStmpD,LDdtini, LDdtfim, LSarq, LFsegue



		*---
		*-------->   FECHA ARQUIVO ORIGEM
		*---
		
		IF	LFarqfch
			=UP_fecha(LSarq)
		ENDIF


		*-------->

		
		IF !FILE(LStmpD+".DBF")
		   DO OBJ_ALER.SPR WITH ;
		   "Arq.Destino "+LStmpd+" nao foi Gerado. "+chr(13)+chr(13)+;
		   "Repita o Processo. "
			LFsegue = .f.
			LOOP		
		ENDIF

		SET DELE ON
		**************************************************
		*   FIM DA TRANSFERENCIA DE DADOS			  *
		**************************************************
		SELE transmit
		LNind	= LNind + 1
	ENDDO
	SET DELE ON
	IF !LFsegue
		LFflag	= .f.	&& .T. INDICA QUE PROCESSO FOI BEM SUCEDIDO
					&& .F. FORCA A INTERRUPCAO DO PROCESSO
	ENDIF
RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8TY           ULtransfere VALID                  ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   11  ╨
*       ╨ Variable:            ULtransfere                        ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      41                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

	**************************************************************

FUNCTION _44k0me8ty     &&  ULtransfere VALID
#REGION 2
RETURN


******************************************************************
PROCEDURE ULtransfere
PARAMETERS LStmpD, LDdtini, LDdtfim, LSarq,LFsegue

		PRIVATE LFerro
		PRIVATE LFgeral  && caso o registro nao tenha DTREGIS serao
						&& transmitidos todos os registros
		LFgeral = .f.
		LFerro = .f.
		SELECT &LSarq		&& ARQ. ORIGEM DE REGISTROS
		COPY STRU TO &LStmpD
	    on error LFerro = .t.
		select 0
	    use &LStmpD exclusive ALIAS destino

		IF LFerro
		   on error
		   DO OBJ_ALER.SPR WITH ;
		   "Nao Foi Possivel Acessar Arquivo Destino. "+LStmpD+ ;
		    chr(13)+chr(13)+;
		   "Repita o Processo. "
			LFsegue = .F.
			RETURN
		ENDIF
	    on error

		SELECT &LSarq		&& ARQ. ORIGEM DE REGISTROS

	    on error LFerro = .t.
		SET ORDER TO TAG DTREGIS
		IF LFerro
			LFgeral = .t.	&& transmitir todos registros
			SET DELE ON		&& POR NAO TER CONTROLE DE DELETADO SO TRANS
							&& REG ATIVOS
			GO TOP
		ELSE
			LFgeral = .f.	&& transmitir so alterados
			SET NEAR ON
			SEEK LDdtini
			SET NEAR OFF
		ENDIF
		DO WHILE !EOF() AND  ;
			(LFgeral OR &LSarq .dtregis >= LDdtini) AND LFsegue

			SCATTER MEMVAR MEMO

			*---------------------------------------------------------*
			*   A Transmissфo dos Registro de Saldo Objetiva Viabilizar
			* a Consulta OFF-LINE do Saldo de Estoque de Outras Filiais
			* da Mesma Regional Pela Filial Destino. O Saldo da Propria
			* Filial Destino nao Deve ser Remetido para Evitar Corrup┤фo
			* dos Dados com Valores Desatualizados.
			*---------------------------------------------------------*
			DO CASE
				CASE UPPER(LSarq) = "SALDO"	&& ARQ. ORIGEM DE REGISTROS
					SELECT &LSarq		&& ARQ. ORIGEM DE REGISTROS
					IF LNfilial = m.empresa
						SELECT &LSarq		&& ARQ. ORIGEM DE REGISTROS
						SKIP
						LOOP
					ENDIF
				CASE UPPER(LSarq) = "DUPLICAT"	&& ARQ. ORIGEM DE REGISTROS
					SELECT &LSarq		&& ARQ. ORIGEM DE REGISTROS
					IF m.FLG_REFIN <> .f.
						SELECT &LSarq		&& ARQ. ORIGEM DE REGISTROS
						SKIP
						LOOP
					ENDIF
				CASE LTindica_emp
					IF TYPE("M.EMPRESA") <> "U"
						IF LNfilial <> m.empresa
							SELECT &LSarq		&& ARQ. ORIGEM DE REGISTROS
							SKIP
							LOOP
						ENDIF
					ENDIF
			ENDCASE


			WAIT WINDOW STR(RECNO(),7)  NOWAIT
			SELE destino
			APPEND BLANK
			GATHER MEMVAR MEMO
			SELECT &LSarq		&& ARQ. ORIGEM DE REGISTROS
			SKIP
		ENDDO
		=UP_fecha("destino")

RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8U6           ULconvci VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   12  ╨
*       ╨ Variable:            ULconvci                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      42                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8u6     &&  ULconvci VALID
#REGION 2
RETURN

PROCEDURE ULconvci
	SELE duplicat
	wp_flgfecha = .F.
	*******************
	*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
	*******************	
	WAIT WINDOW wp_msg NOWAIT
	
	LDci = m.dt_inicio	
	m.empresa = wp_empresa
	m.data    = LDci
	wp_msg = "EXPORTANDO CI [Emp.: "+STR(m.empresa,3)+ " ] "+;
									DTOC(m.LDci)

	*------------------------------------------------------------*
		=W_DEFPROC("DUPLICAT.SPR")
	m.debito  = CRdb_Cobr((m.empresa), (m.data), (m.data))
		=W_DEFPROC("DUPLICAT.SPR")
	m.credito = CRcr_Cobr((m.empresa), (m.data), (m.data))
		=W_DEFPROC("DUPLICAT.SPR")
	m.saldo   = CRsld_Cobr((m.empresa), (m.data))
		=W_DEFPROC("NOTA.SPR")
	m.totnfs  = NFtot_nfs((m.empresa), (m.data), (m.data))
	*------------------------------------------------------------*
	SELE lnmarq
	=edithand('SAVE')
RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8UD           ULcompacta VALID                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   13  ╨
*       ╨ Variable:            ULcompacta                         ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      43                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8ud     &&  ULcompacta VALID
#REGION 2
RETURN

PROCEDURE ULcompacta		&& Compactacao de Arquivos

   PARAMETERS LDdata,wp_empresa


		PRIVATE LSNmArqZip,LSChamador

			*<modelo> PKZIP  \SCGC\TRANSF\MLddmmff.ZIP \SCGC\TRANSF\TMP\*.*


			LSNmArqZip   = ""

			LSChamador = PrmChamador+"ZIP"

			IF !ULNomeArqML(m.drive, ;
		    	 m.drivetmp,;
			     m.dt_inicio,;
			     m.dt_fim,;
			     LSChamador,;
		    	 LSNmArqZip)
			   RETURN(.f.)
			ENDIF	

			IF PrmChamador = "INTERNA"
				LSarqzip = m.drive + "BK"+;
						LSNmArqZip+;
					   	".ZIP"
			ELSE
				LSarqzip = m.drive + "ML"+;
						LSNmArqZip+;
					   	".ZIP"
			ENDIF
			LSfiles = m.drivetmp+;
						m.NomeArq+;
						"*.*"

			!PKZIP  &LSarqzip   &LSfiles
RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8UK           ULfecha VALID                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   14  ╨
*       ╨ Variable:            ULfecha                            ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      44                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8uk     &&  ULfecha VALID
#REGION 2
RETURN

PROCEDURE ULfecha
	IF LFtra		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("transmit")
	ENDIF
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(wl_areant)
		SELECT &wl_areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
	************************************
	POP KEY 			&& reabilita teclas de atalho def. anteriormente
RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8UQ           ULerrodrive VALID                  ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   15  ╨
*       ╨ Variable:            ULerrodrive                        ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      45                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8uq     &&  ULerrodrive VALID
#REGION 2
RETURN

PROCEDURE  ULerrodrive
	LFokdrive = .f.   && nao existe o diretorio

RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8UX           ULCvOrcament VALID                 ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   16  ╨
*       ╨ Variable:            ULCvOrcament                       ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      46                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8ux     &&  ULCvOrcament VALID
#REGION 2
RETURN

PROCEDURE ULCvOrcament

		PRIVATE LForcament,LForcatmp,LForc_anex,	LForca_pgt,;
				LFclienc,LFbonus
				
		PRIVATE LAorcament,LAorcatmp,LAorc_anex,	LAorca_pgt,;
				LAclienc,LAbonus

		PRIVATE LDorcament,LDorcatmp,LDorc_anex,	LDorca_pgt,;
				LDclienc,LDbonus

		
		LForcament  = NetArqAgain("orcament")
		LAorcament  = ALIAS()

		LForcatmp   = NetArqAgain("orcatmp")
		LAorcatmp   = ALIAS()

		LForc_anex  = NetArqAgain("orc_anex")
		LAorc_anex  = ALIAS()

		LForca_pgt  = NetArqAgain("orca_pgt")
		LAorca_pgt  = ALIAS()

		LFclienc	= NetArqAgain("clienc")
		LAclienc	= ALIAS()

		LFbonus		= NetArqAgain("bonus")
		LAbonus		= ALIAS()

		IF (LForcament+LForcatmp+LForc_anex+LForca_pgt;
			+LFclienc+LFbonus) > 100000
			=UP_fecha("&LAorcament")
			=UP_fecha("&LAorcatmp")
			=UP_fecha("&LAorc_anex")
			=UP_fecha("&LAorca_pgt")
			=UP_fecha("&LAclienc")
			=UP_fecha("&LAbonus")
			wp_msg = "Houve falha na abertura de Arq. para ML"
			RETURN .f.
		ENDIF

		LDorcament 		 = m.drivetmp+m.nomearq+"OR"
		LDorcatmp		 = m.drivetmp+m.nomearq+"IO"
		LDorc_anex 		 = m.drivetmp+m.nomearq+"OX"
		LDorca_pgt 		 = m.drivetmp+m.nomearq+"OP"
		LDclienc 		 = m.drivetmp+m.nomearq+"CN"
		LDbonus 		 = m.drivetmp+m.nomearq+"BN"

		SELE &LAorcament
		COPY STRU TO &LDorcament

		SELE &LAorcatmp
		COPY STRU TO &LDorcatmp
		
		SELE &LAorc_anex
		COPY STRU TO &LDorc_anex

		SELE &LAorca_pgt
		COPY STRU TO &LDorca_pgt

		SELE &LAclienc
		COPY STRU TO &LDclienc

		SELE &LAbonus
		COPY STRU TO &LDbonus

		SELE 0
		USE &LDorcament  	EXCL ALIAS DstOrcamen
		SELE 0
		USE &LDorcatmp 	 	EXCL ALIAS DstOrcatmp
		SELE 0
		USE &LDorc_anex  	EXCL ALIAS DstOrc_ane
		SELE 0
		USE &LDorca_pgt  	EXCL ALIAS DstOrc_pgt
		SELE 0
		USE &LDclienc		EXCL ALIAS DstClienc
		SELE 0
		USE &LDbonus		EXCL ALIAS DstBonus

		SELE &LAorcament
		SET ORDER TO TAG data_fat
		SET NEAR ON
		SEEK STR(wp_empresa,3)+DTOS(m.dt_inicio)
		SET NEAR OFF
		DO WHILE !EOF() AND dt_fat >= m.dt_inicio AND dt_fat <= m.dt_fim
			SCATTER MEMVAR
			SELE DstOrcament
			=edithand('SAVE')

			SELE &LAorcatmp
			SET ORDER TO TAG orcamento
			SET NEAR ON
			IF "TIPO" $ KEY()
				SEEK STR( &LAorcament .EMPRESA,3)+;
				    LEFT( &LAorcament .TIPO,1)+;
					 STR( &LAorcament .ORCAMENTO,6)
			ELSE
				SEEK STR( &LAorcament .EMPRESA,3)+;
				     STR( &LAorcament .ORCAMENTO,6)
			ENDIF
			SET NEAR OFF
			DO WHILE !EOF() ;
			      AND &LAorcament .empresa = &LAorcatmp .empresa ;
				  AND &LAorcament .orcamento = &LAorcatmp .orcamento
				SCATTER MEMVAR
				SELE DstOrcatmp
				=edithand('SAVE')
				SELE &LAorcatmp
				SKIP
			ENDDO
			SELE &LAorc_anex
			SET ORDER TO TAG orcamento
			SEEK STR( &LAorcament .EMPRESA,3)+STR( &LAorcament .ORCAMENTO,6)
			IF found()
				SCATTER MEMVAR
				SELE DstOrc_anex
				=edithand('SAVE')
			ENDIF
			SELE &LAorca_pgt
			SET ORDER TO TAG orca_pgto
			SET NEAR ON
			SEEK STR( &LAorcament .EMPRESA,3)+STR( &LAorcament .ORCAMENTO,6)
			SET NEAR OFF
			DO WHILE !EOF() ;
			      AND &LAorcament .empresa = &LAorca_pgt .empresa ;
				  AND &LAorcament .orcamento = &LAorca_pgt .orcamento
				SCATTER MEMVAR
				SELE DstOrc_pgt
				=edithand('SAVE')
				SELE &LAorca_pgt
				SKIP
			ENDDO

			SELE &LAclienc
			SET ORDER TO TAG emporca
			SEEK STR( &LAorcament .EMPRESA,3)+ ;
			      STR( &LAorcament .ORCAMENTO,6)
			IF found()
				SCATTER MEMVAR
				SELE DstClienc
				=edithand('SAVE')
			ENDIF

			SELE &LAbonus
			SET ORDER TO TAG emp_osi
			SET NEAR ON
			SEEK STR( &LAorcament .EMPRESA,3)+;
			     STR( &LAorcament .ORCAMENTO,6)
			SET NEAR OFF
			DO WHILE !EOF() AND &LAorcament .empresa = &LAbonus.empresa ;
						    AND &LAorcament .orcamento = &LAbonus .orcamento
				SCATTER MEMVAR
				SELE DstBonus
				=edithand('SAVE')
				SELE bonus
				SKIP
			ENDDO

			SELE &LAorcament
			SKIP
		ENDDO
		=UP_fecha("&LAorcament")
		=UP_fecha("&LAorcatmp")
		=UP_fecha("&LAorc_anex")
		=UP_fecha("&LAorca_pgt")
		=UP_fecha("&LAclienc")
		=UP_fecha("&LAbonus")

		=UP_fecha("DstOrcamen"   ,2)
		=UP_fecha("DstOrcatmp"   ,2)
		=UP_fecha("DstOrc_ane"   ,2)
		=UP_fecha("DstOrc_pgt"   ,2)
		=UP_fecha("DstClienc"   ,2)
		=UP_fecha("DstBonus"   ,2)

RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8UY           ULCvNfCanCpm VALID                 ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   17  ╨
*       ╨ Variable:            ULCvNfCanCpm                       ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      47                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8uy     &&  ULCvNfCanCpm VALID
#REGION 2
RETURN

FUNCTION ULCvNfCanCpm

		PRIVATE LFnota
				
		PRIVATE LAnota

		PRIVATE LDnota


		LDnota = m.drivetmp+m.nomearq+"NF"


		LFnota  = NetArqAgain("nota")
		LAnota  = ALIAS()


		IF (LFnota) > 100000
			=UP_fecha("&LAnota")
			wp_msg = "Arquivo de N.F. nao pode ser aberto."
			RETURN .f.
		ENDIF

		SELE &LAnota
		SET ORDER TO TAG data
		SET NEAR ON
		SEEK STR(wp_empresa,3)+DTOS(m.dt_inicio)
		IF m.saida = 1
			COPY TO &LDnota ;
			      FOR &LAnota .status = 2 ;
			      OR  &LAnota .tipo = "CPM"  ;
			      OR  &LAnota .tipo = "ENT"  ;
			      WHILE;
				       ( &LAnota .data >= m.dt_inicio ;
				     AND &LAnota .data <= m.dt_fim) ;
 				TYPE SDF
		ELSE
			COPY STRU TO &LDnota
			COPY TO &LDnota  ;
			      FOR &LAnota .status = 2 ;
			      OR  &LAnota .tipo = "CPM"  ;
			      OR  &LAnota .tipo = "ENT"  ;
			     WHILE;
				      ( &LAnota .data >= m.dt_inicio ;
				    AND &LAnota .data <= m.dt_fim)
		ENDIF							
		=UP_fecha("&LAnota")

RETURN(.t.)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8VD           ULvrif_qe VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   18  ╨
*       ╨ Variable:            ULvrif_qe                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      48                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

FUNCTION _44k0me8vd     &&  ULvrif_qe VALID
#REGION 2
RETURN

FUNCTION ULvrif_qe
PARAMETERS	 LNqe

		IF LFqe
			IF !USED("saldo")
				IF !NetUse("saldo")
					wp_msg = "Arquivo de Saldo nao pode ser aberto."
					RETURN(.F.)
				ENDIF
			ENDIF
			IF !USED("grupo")
				IF !NetUse("grupo")
					wp_msg = "Arquivo de Cad. Produtos nao pode ser aberto."
					RETURN(.F.)
				ENDIF
			ENDIF
			IF !USED("itemmov")
				IF !NetUse("itemmov")
					=UP_fecha("grupo")
					wp_msg = "Arquivo de Movimento nao pode ser aberto."
					RETURN(.F.)
				ENDIF
			ENDIF
			IF !USED("QE")
				IF !NetUse("QE")
					=UP_fecha("grupo")
					=UP_fecha("itemmov")
					wp_msg = "Arquivo de QE nao pode ser aberto."
					RETURN(.F.)
				ENDIF
			ENDIF
			LSarqtmp = m.drivetmp+m.nomearq+"QE"
			SELE QE
			COPY STRU TO &LSarqtmp WITH CDX
			SELE 2
			USE &LSarqtmp ALIAS QETMP

			DO ULconvqe WITH LNqe
			SELE QETMP
			USE
			=UP_fecha("itemmov")
			=UP_fecha("grupo")
			=UP_fecha("saldo")
		ENDIF
RETURN(.T.)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8VJ           ULvrif_ci VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   19  ╨
*       ╨ Variable:            ULvrif_ci                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      49                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

FUNCTION _44k0me8vj     &&  ULvrif_ci VALID
#REGION 2
RETURN

FUNCTION ULvrif_ci

		IF LFci

			IF !USED("retornbc")
				IF !NetUse("retornbc")
					wp_msg = "Arquivo de Aviso Banco nao pode ser aberto."
					RETURN .F.
				ENDIF
			ENDIF
			IF !USED("retornmv")
				IF !NetUse("retornmv")
					=UP_fecha("retornbc")
					wp_msg = ;
					"Arquivo de Itens de Aviso Banco nao pode ser aberto."
					RETURN .F.
				ENDIF
			ENDIF
			IF !USED("duplicat")
				IF !NetUse("duplicat")
					=UP_fecha("retornbc")
					=UP_fecha("retornmv")
					wp_msg = "Arquivo de Duplicatas nao pode ser aberto."
					RETURN .F.
				ENDIF
			ENDIF
			LSarqtmp = m.drivetmp+m.nomearq+"CI"

			SELE duplicat
			CREATE TABLE  &LSarqtmp  (EMPRESA 	N(3,0),;
										DATA		D,;
										DEBITO		N(10,2),;
										CREDITO		N(10,2),;
										SALDO		N(10,2),;
										TOTNFS		N(10,2))
			USE
			SELE 2
			USE &LSarqtmp  ALIAS lnmarq exclu
			SELE duplicat
			DO ULconvci
	
			SELE lnmarq
			USE
			=UP_fecha("retornbc")
			=UP_fecha("retornmv")
			=UP_fecha("duplicat")
		ENDIF
RETURN(.T.)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8VQ           ULCvNfEntrada VALID                ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   20  ╨
*       ╨ Variable:            ULCvNfEntrada                      ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      50                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8vq     &&  ULCvNfEntrada VALID
#REGION 2
RETURN

FUNCTION ULCvNfEntrada

		PRIVATE LFNfEnt,LFNFeIte
				
		PRIVATE LANfEnt,LANFeIte

		PRIVATE LDNfEnt,LDNfeIte




		LDNfEnt = m.drivetmp+m.nomearq+"NE"
		LDNfeIte = m.drivetmp+m.nomearq+"IE"


		LFNfEnt  = NetArqAgain("notaent")
		LANfEnt  = ALIAS()

		LFNFeIte  = NetArqAgain("notaite")
		LANFeIte  = ALIAS()


		IF (LFNfEnt+LFNFeIte) > 100000
			=UP_fecha("&LANfEnt")
			=UP_fecha("&LANFeIte")
			wp_msg = "Falha abertura Arq. Notas de Entrada..."
			RETURN(.f.)
		ENDIF


		SELE &LANfEnt
		COPY STRU TO &LDNfEnt
		SELE 0
		USE  &LDNfEnt	ALIAS NE excl
		
		SELE &LANFeIte
		SET ORDER TO TAG orcamento
		COPY STRU TO &LDNfeIte
		SELE 0
		USE  &LDNfeIte	ALIAS NI excl

		*----------------------------------------------------------*
		*  NOTAS DE ENTRADA
		*		Gerando Notas que Foram Editadas na Data em Questao
		*  mas que pertencem a outra DATA DE ENTRADA
		*----------------------------------------------------------*
		SELE &LANfEnt
		SET ORDER TO TAG dtultedita
		SET NEAR ON
		SEEK STR(wp_empresa,3)+DTOS(m.dt_inicio)
		DO WHILE !EOF() ;
			AND &LANfEnt .empresa = wp_empresa ;
			AND &LANfEnt .dtregis <= m.dt_fim
			*----------------------------------------------------------*
			*    NOTAS COM ENTRADA NO PERIODO SERAO PROCESSADAS NO PROXIMO
			* LACO. ESTE LACO TRATA APENAS ENTRADAS FEITAS FORA DO PERIODO
			* E QUE FORAM EDITADAS NO PERIODO.
			*----------------------------------------------------------*
			IF &LANfEnt .data >= m.dt_inicio ;
			   AND &LANfEnt .data <= m.dt_fim
				 SKIP
				 LOOP
			ENDIF
		
			IF !(LEFT( &LANfEnt .situacao,1) $ "BCc")
				SKIP
				LOOP
			ENDIF
			SCATTER MEMVAR
			SELE NE
			APPEND BLANK
			GATHER MEMVAR

			SELECT  &LANFeIte
			SEEK STR( &LANfEnt .empresa,3)+;
			     STR( &LANfEnt .referencia,6)+;
				 STR( &LANfEnt .codforn,5)+;
				 STR( &LANfEnt .nota,6)+;
				      &LANfEnt .serie+;
				LEFT( &LANfEnt .tipo,1)

			DO WHILE !EOF() AND ULtstWhile()

				SCATTER MEMVAR
				SELE NI
				APPEND BLANK
				GATHER MEMVAR
				SELE &LANFeIte
				SKIP
			ENDDO
			SELE &LANfEnt
			SKIP
		ENDDO
		*----------------------------------------------------------*
		*  NOTAS DE ENTRADA
		*		Gerando Notas que Foram Entradas no Periodo em Questao
		*----------------------------------------------------------*
		SELE &LANfEnt
		SET ORDER TO TAG data_fat
		SET NEAR ON
		SEEK STR(wp_empresa,3)+DTOS(m.dt_inicio)
		DO WHILE !EOF() ;
			AND &LANfEnt .empresa = wp_empresa ;
			AND &LANfEnt .data   <= m.dt_fim
			*----------------------------------------------------------*
			*    NOTAS COM ENTRADA NO PERIODO SERAO PROCESSADAS NESTE
			* LACO. ESTE LACO TRATA ENTRADAS FEITAS NO PERIODO
			*----------------------------------------------------------*
			IF !(LEFT( &LANfEnt .situacao,1) $ "BCc")
				SKIP
				LOOP
			ENDIF
			SCATTER MEMVAR
			SELE NE
			APPEND BLANK
			GATHER MEMVAR

			SELECT  &LANFeIte
			SEEK STR( &LANfEnt .empresa,3)+;
			     STR( &LANfEnt .referencia,6)+;
				 STR( &LANfEnt .codforn,5)+;
				 STR( &LANfEnt .nota,6)+;
				      &LANfEnt .serie+;
			    LEFT( &LANfEnt .tipo,1)

			DO WHILE !EOF() AND ULtstWhile()

				SCATTER MEMVAR
				SELE NI
				APPEND BLANK
				GATHER MEMVAR
				SELE &LANFeIte
				SKIP
			ENDDO
			SELE &LANfEnt
			SKIP
		ENDDO

		=UP_fecha("&LANfEnt")
		=UP_fecha("&LANFeIte")
		=UP_fecha("ne")
		=UP_fecha("ni")


RETURN(.t.)

FUNCTION ULtstWhile

    *------------------------------------------------------*
    * ERRO NAO EXPLICAVEL
    *------------------------------------------------------*
	* ESTA FUNCAO FOI CRIADA POR ESTAR OCORRENDO ERRO DE SITAXE
	* QDO A CONDICAO ESTA ESCRITA NO PROPRIO COMANDO WHILE
	*-----------------------------------------------------*
	IF      &LANfEnt .empresa   = &LANFeIte .EMPRESA ;
		AND &LANfEnt .referencia= &LANFeIte .orcamento ;
		AND &LANfEnt .codforn   = &LANFeIte .codforn ;
		AND &LANfEnt .nota 	  = &LANFeIte .nota ;
		AND &LANfEnt .serie	  = &LANFeIte .serie ;
		AND (LEFT( &LANfEnt .tipo,1)= LEFT( &LANFeIte .tipo,1))
		RETURN(.T.)
	ENDIF
RETURN(.F.)



*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8VZ           ULCvCarteira VALID                 ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   21  ╨
*       ╨ Variable:            ULCvCarteira                       ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      51                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8vz     &&  ULCvCarteira VALID
#REGION 2
RETURN

FUNCTION ULCvCarteira

		PRIVATE LFRetornBC,LFRetornMV,LFRefinanc
				
		PRIVATE LARetornBC,LARetornMV,LARefinanc

		PRIVATE LDRetornBC,LDRetornMV,LDRefinanc

		LDRetornBC = m.drivetmp+m.nomearq+"RB"
		LDRetornMV  = m.drivetmp+m.nomearq+"IR"
		LDRefinanc  = m.drivetmp+m.nomearq+"RF"


		LFRetornBC  = NetArqAgain("RetornBC")
		LARetornBC  = ALIAS()

		LFRetornMV  = NetArqAgain("RetornMV")
		LARetornMV  = ALIAS()

		LFRefinanc  = NetArqAgain("ctrlrefn")
		LARefinanc  = ALIAS()

		IF (LFRetornBC+LFRetornMV+LFRefinanc) > 100000
			=UP_fecha("&LARetornBC")
			=UP_fecha("&LARetornMV")
			=UP_fecha("&LARefinanc")
			wp_msg = "Falha abertura Arq. Cobranca ..."
			RETURN(.f.)
		ENDIF

		SELE &LARetornBC
		SET ORDER TO TAG dtprocesso
		SET NEAR ON
		SEEK STR(wp_empresa,3)+DTOS(m.dt_inicio)
		SET NEAR OFF
		COPY TO &LDRetornBC ;
			  WHILE   &LARetornBC .empresa = wp_empresa  ;
				AND &LARetornBC .STATUS = "PR" ;
			    AND ;
			    ( ;
			    	 (&LARetornBC .dtprocesso >= m.dt_inicio ;
			          AND &LARetornBC .dtprocesso <= m.dt_fim ;
			         ) ;
			         OR ;
			    	 (&LARetornBC .dtregis >= m.dt_inicio ;
			          AND &LARetornBC .dtregis <= m.dt_fim ;
			         ) ;
		        )			

		**************>>> ITENS DOS AVISOS BANC. E COMANDOS DE CARTEIRA

		SELE &LARetornMV
		SET ORDER TO TAG dtprocesso
		SET NEAR ON
		SEEK STR(wp_empresa,3)+DTOS(m.dt_inicio)
		SET NEAR OFF
		COPY TO &LDRetornMV ;
			WHILE  &LARetornMV .empresa = wp_empresa  ;
			  AND ;
			    ( ;
			      ( &LARetornMV .dtprocesso >= m.dt_inicio ;
			        AND &LARetornMV .dtprocesso <= m.dt_fim ;
			      );
                  or ;
			      ( &LARetornMV .dtregis >= m.dt_inicio ;
			        AND &LARetornMV .dtregis <= m.dt_fim ;
			      );
			    )
	
		*****************>>> REFINANCIAMENTOS
		

		SELE &LARefinanc
		SET ORDER TO TAG CHV_REFIN
		SET NEAR ON
		SEEK STR(wp_empresa,3)+DTOS(m.dt_inicio)
		SET NEAR OFF
		IF m.saida = 1
			COPY TO &LDRefinanc ;
			  WHILE   &LARefinanc .empresa = wp_empresa  ;
			    AND;
			      (;
			        (;
			              &LARefinanc .data >= m.dt_inicio ;
			          AND &LARefinanc .data  <= m.dt_fim;
			        ) ;
			        OR ;
			        (;
			              &LARefinanc .dtregis >= m.dt_inicio ;
			          AND &LARefinanc .dtregis  <= m.dt_fim;
			        );
			       )
 				TYPE SDF
		ELSE
			COPY TO &LDRefinanc  ;
			  WHILE   &LARefinanc .empresa = wp_empresa  ;
			    AND;
			      (;
			        (;
			              &LARefinanc .data >= m.dt_inicio ;
			          AND &LARefinanc .data  <= m.dt_fim;
			        ) ;
			        OR ;
			        (;
			              &LARefinanc .dtregis >= m.dt_inicio ;
			          AND &LARefinanc .dtregis  <= m.dt_fim;
			        );
			       )
		ENDIF							

		=UP_fecha("&LARetornBC")
		=UP_fecha("&LARetornMV")
		=UP_fecha("&LARefinanc")

RETURN(.t.)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8W7           ULNomeArqML VALID                  ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   22  ╨
*       ╨ Variable:            ULNomeArqML                        ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      52                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8w7     &&  ULNomeArqML VALID
#REGION 2
RETURN

FUNCTION ULNomeArqML
PARAMETERS ;
	     m.drive, ;
	     m.drivetmp,;
	     m.dt_inicio,;
	     m.dt_fim,;
	     PrmChamador,;
	     RtnNomeArq
	
	m.drive    = ALLTRIM(m.drive)
	m.drivetmp = ALLTRIM(m.drivetmp)


	DO CASE
		CASE PrmChamador = "TELA"
			RtnNomeArq = CHRTRAN(STR(MONTH(m.dt_inicio),2)," ","0") + ;
				CHRTRAN(STR(DAY(m.dt_inicio),2)," ","0") + ;
				CHRTRAN(STR(wp_empresa,2)," ","0")

		CASE PrmChamador = "INTERNA"
			RtnNomeArq = CHRTRAN(STR(MONTH(m.dt_inicio),2)," ","0") + ;
				CHRTRAN(STR(DAY(m.dt_inicio),2)," ","0") + ;
				CHRTRAN(STR(wp_empresa,2)," ","0")

		CASE PrmChamador = "TELAZIP"
			RtnNomeArq = CHRTRAN(STR(DAY(m.dt_inicio),2)," ","0") + ;
				CHRTRAN(STR(MONTH(m.dt_inicio),2)," ","0") + ;
				CHRTRAN(STR(wp_empresa,2)," ","0")

		CASE PrmChamador = "INTERNAZIP"
			RtnNomeArq = CHRTRAN(STR(DAY(m.dt_inicio),2)," ","0")
			RtnNomeArq = RtnNomeArq+"_"+LEFT(TIME(),5)
			RtnNomeArq = STRTRAN(RtnNomeArq,":","")
			RtnNomeArq = RtnNomeArq

		OTHERWISE
		    RETURN(.f.)
	ENDCASE
RETURN(.t.)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8WD           ULtransarq VALID                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   23  ╨
*       ╨ Variable:            ULtransarq                         ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      53                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

	**************************************************************
	*																*
	* 	INICIO TRANSFERENCIA SIMPLES DE ARQUIVOS POR ALTER.DE DADOS *
	* 		< ESTES ARQUIVOS NAO DESENCADEIAM PROCESSOS >			*
	*   A TRANSFERENCIA APENAS MANTEM AS BASES ATUALIZADAS			*
	*																*
	**************************************************************

FUNCTION _44k0me8wd     &&  ULtransarq VALID
#REGION 2
RETURN


PROCEDURE ULtransarq	&& TRANSFERENCIA SIMPLES DE ARQUIVOS

	PARAMETERS LNfilial, LSdrivetmp, LVTmrc,LVTarq, LDdtini, LDdtfim

	PRIVATE LFsegue		&& indicativo p/ proceguir o processo
	PRIVATE LNind		&& indice do vetos
	PRIVATE LFarqfch    && indicador p/ fechar arq ao final do processo
	PRIVATE LStmpO		&& PATH E NOME DO ARQ. ORIGEM DOS DADOS
	PRIVATE LStmpD		&& PATH E NOME DO ARQ. DESTINO DOS DADOS
	PRIVATE LSnomearq 	&& COMPOSICAO DO NOME DO ARQ. DESTINO
	PRIVATE LNregional 	&& Regional da Empresa Destino - LNfilial
					&& Utilizado para Remessa de Saldo entre Filiais da
					&& Mesma Regional


    PRIVATE ARQ_Origem,ALS_Origem




	LFsegue = .t.
	CLEAR TYPEAHEAD
	LNind 		= 3
	LFarqfch	= .f.
	DO WHILE LNind <= ALEN(LVTmrc,1) AND LFsegue AND !CHRSAW(0.1)
		IF LEFT(LVTmrc(LNind),1) = " "
			LNind	= LNind + 1
			LOOP
		ENDIF
		SET DELE ON

		SELE transmit
		SET ORDER TO TAG arquivo
		SEEK LVTarq(LNind)
		IF !FOUND()
			DO OBJ_ALER.SPR WITH ;
			"Arquivo ( "+LVTarq(LNind)+"  ) Nao Esta Configurado p/ "+;
			"Para Transmissao/Recepcao de Dados. Solicite Suporte..."
			LNind	= LNind + 1
			LOOP
		ENDIF
		SCATTER MEMVAR
		LTchave 	= 	m.chave
		LTdescricao	=	m.descricao
		LTarquivo	=	m.arquivo
		LTindica_emp=	m.indica_emp
		LTchr_ident	=	m.chr_ident

		wp_msg = ALLTRIM(m.descricao)+" "+m.arquivo
		wait window wp_msg nowait
		LSarq = ALLTRIM(m.arquivo)

		LFarqfch	= .f.

		*---
		*-------->   ABRE ARQUIVO ORIGEM
		*---

    	ARQ_Origem     = NetArqAgain(LSarq)
	    ALS_Origem     = Alias()

		*---
		*-------->
		*---


		SELECT &ALS_Origem
		**************************************************
		*   INICIO DA TRANSFERENCIA DE DADOS			  *
		**************************************************
		SET DELE OFF   && COPIAR REGISTRO DELETADOS DEIXANDO-OS ATIVOS
						   && NO ARQUIVO DESTINO, POREM COM O CAMPO
						   && deletado = .t. QUE PERMITE TRATAMENTO NA
						   && RECUPERACAO
		*********   IDENTIFICA DIRETORIO ORIGEM DO ARQUIVO ********
		LStmpO = DBF()				&& ARQUIVO ORIGEM
		LStmpD = ""    				&& ARQUIVO DESTINO

		******************   MONTA NOME DO ARQUIVO  ********************
		* O ARUIVO  E UNICO PARA TODAS AS DATAS E RECEBE NOME REFERENTE *
		* A  DATA FINAL DO PERIODO										*
		****************************************************************


		m.NomeArq  = PrmNomeArq

		LSnomearq = m.NomeArq+LTchr_ident

		*********   COPIA DADOS PARA ARQUIVO DESTINO *********
		IF FILE(LSdrivetmp+LSnomearq+".DBF")
		   IF !fox_alert('Arquivo '+LSnomearq+' ja existe. Substituir ?')
				=UP_fecha("&ALS_Origem")
				LNind	= LNind + 1
				LOOP
			ENDIF
		ENDIF
		*********   CARACTERIZA ARQUIVO DESTINO *********
		LStmpD = LSdrivetmp+LSnomearq
		*************************************************
		DO ULtransfere WITH LStmpD,LDdtini, LDdtfim, ALS_Origem, LFsegue



		*---
		*-------->   FECHA ARQUIVO ORIGEM
		*---
		
		=UP_fecha("&ALS_Origem")

		*-------->

		
		IF !FILE(LStmpD+".DBF")
		   DO OBJ_ALER.SPR WITH ;
		   "Arq.Destino "+LStmpd+" nao foi Gerado. "+chr(13)+chr(13)+;
		   "Repita o Processo. "
			LFsegue = .f.
			LOOP		
		ENDIF

		SET DELE ON
		**************************************************
		*   FIM DA TRANSFERENCIA DE DADOS			  *
		**************************************************
		SELE transmit
		LNind	= LNind + 1
	ENDDO
	SET DELE ON
	IF !LFsegue
		LFflag	= .f.	&& .T. INDICA QUE PROCESSO FOI BEM SUCEDIDO
					&& .F. FORCA A INTERRUPCAO DO PROCESSO
	ENDIF
RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8WE           ULCvPedidos VALID                  ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC002A,     Record Number:   24  ╨
*       ╨ Variable:            ULCvPedidos                        ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      54                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8we     &&  ULCvPedidos VALID
#REGION 2
RETURN

FUNCTION ULCvPedidos

		PRIVATE LFPedido,LFPedite
				
		PRIVATE LAPedido,LAPedite

		PRIVATE LDPedido,LDPedite




		LDPedido = m.drivetmp+m.nomearq+"PE"
		LDPedite  = m.drivetmp+m.nomearq+"PI"


		LFPedido  = NetArqAgain("pedido")
		LAPedido  = ALIAS()

		LFPedite  = NetArqAgain("pedite")
		LAPedite  = ALIAS()


		IF (LFPedido+LFpedite) > 100000
			=UP_fecha("&LAPedido")
			=UP_fecha("&LAPedite")
			wp_msg = "Falha abertura Arq. Pedidos ..."
			RETURN(.f.)
		ENDIF


**********************>>> PEDIDOS
		SELE &LApedido
		SET ORDER TO TAG dtregis
		SET NEAR ON
		SEEK m.dt_inicio
		SET NEAR OFF
		IF m.saida = 1
			COPY TO &LDpedido ;
			    WHILE &LApedido .empresa = wp_empresa AND ;
					  &LApedido .dtregis >= m.dt_inicio AND ;
					  &LApedido .dtregis <= m.dt_fim ;
	 			TYPE SDF
		ELSE
			COPY TO &LDpedido  ;
			    WHILE &LApedido .empresa = wp_empresa AND ;
					  &LApedido .dtregis >= m.dt_inicio AND ;
					  &LApedido .dtregis <= m.dt_fim
		ENDIF							
**********************>>> ITEN PEDIDOS
		SELE &LApedite
		SET ORDER TO TAG dtregis
		SET NEAR ON
		SEEK m.dt_inicio
		SET NEAR OFF
		IF m.saida = 1
			COPY TO &LDpedite ;
				WHILE &LApedite .empresa = wp_empresa AND ;
					  &LApedite .dtregis >= m.dt_inicio AND ;
					  &LApedite .dtregis <= m.dt_fim ;
	 			TYPE SDF
		ELSE
			COPY TO &LDpedite  ;
			    WHILE &LApedite .empresa = wp_empresa AND ;
					  &LApedite .dtregis >= m.dt_inicio AND ;
					  &LApedite .dtregis <= m.dt_fim

		ENDIF
		=UP_fecha("&LAPedido")
		=UP_fecha("&LApedite")

RETURN(.t.)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44K0ME8WF           Read Level Show                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         Multiple Screens                   ╨
*       ╨ Called By:           READ Statement                     ╨
*       ╨ Snippet Number:      55                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44k0me8wf     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: SCGC002
*
#REGION 1
HIDE WINDOW SCGC002A
*
* Show Code from screen: SCGC002A
*
#REGION 2
HIDE WINDOW SCGC002A
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF