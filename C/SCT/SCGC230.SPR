*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 07/19/14             SCGC230.SPR               10:34:19 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 2014 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є          SCGC230/MS-DOS Setup Code - SECTION 1          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
*---------------------------------------------------------------*
* OPERA ARQUIVOS :
*			ITEMMOV
*		    EMPRESA
*
* OBJETIVO:	RESUMO DE VENDAS POR GRUPOS
*	
*---------------------------------------------------------------*

******>>>> INICIO CONTROLE AMBIENTAL

ON KEY LABEL ESCAPE

PRIVATE isediting,isadding,isreading
PRIVATE wp_record
PRIVATE isreadonly,is2table,wzalias
PRIVATE LS230areant
LS230areant = ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.wzalias	=	SELECT()
m.isediting	=	.F.
m.isadding	=	.F.
m.isreading=	.F.
m.is2table 	= 	.F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
wp_ref_local =  .f.     && NAO POSSUI CONTROLE DE REFRESH LOCAL

REGIONAL conta

LFemp230	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFite230	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA

******>>>> INICIO CONTROLE ARQUIVOS
IF !USED("itemmov")
	LFite230	= .T.
	IF ! NetUse("itemmov")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("empresa")
	LFemp230	= .T.
	IF ! NetUse("empresa")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF wp_flgfecha
	DO ULfecha
	RETURN
ENDIF
******>>>> INICIO CONTROLE LOCAL

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

IF NOT WEXIST("scgc230") ;
	OR UPPER(WTITLE("SCGC230")) == "SCGC230.PJX" ;
	OR UPPER(WTITLE("SCGC230")) == "SCGC230.SCX" ;
	OR UPPER(WTITLE("SCGC230")) == "SCGC230.MNX" ;
	OR UPPER(WTITLE("SCGC230")) == "SCGC230.PRG" ;
	OR UPPER(WTITLE("SCGC230")) == "SCGC230.FRX" ;
	OR UPPER(WTITLE("SCGC230")) == "SCGC230.QPR"
	DEFINE WINDOW scgc230 ;
		FROM INT((SROW()-14)/2),INT((SCOL()-70)/2) ;
		TO INT((SROW()-14)/2)+13,INT((SCOL()-70)/2)+69 ;
		TITLE "[ Demostrativo de Vendas ]" ;
		FOOTER "[ 230 ]" ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є          SCGC230/MS-DOS Setup Code - SECTION 2          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1

DO CASE
	CASE !wp_flgfecha
		SELECT empresa
		SET ORDER TO TAG empresa
		SEEK wp_empresa
		m.nome_emp = empresa.nome
		*-------------------------> criado pelo wizard
		m.wzalias=SELECT()
		m.isreadonly=IIF(ISREAD(),.T.,.F.)
ENDCASE



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              SCGC230/MS-DOS Screen Layout               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("scgc230")
	ACTIVATE WINDOW scgc230 SAME
ELSE
	ACTIVATE WINDOW scgc230 NOSHOW
ENDIF
@ 0,0 TO 13,69 ;
	COLOR SCHEME 23
@ 0,16 SAY "[ Demonstrativo de Vendas Dia a Dia ]" ;
	SIZE 1,37, 0
@ 0,63 SAY "[230]" ;
	SIZE 1,5, 0
@ 0,69 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,69 TO 12,69 ;
	COLOR SCHEME 24
@ 13,69 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 13,1 TO 13,68 ;
	COLOR SCHEME 24
@ 4,32 TO 6,63 ;
	COLOR SCHEME 23
@ 6,33 TO 6,62 ;
	COLOR SCHEME 24
@ 6,63 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,63 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,63 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,48 SAY "e" ;
	SIZE 1,1, 0
@ 4,34 SAY "[ Vendas no Periodo ]" ;
	SIZE 1,21, 0
@ 2,5 TO 4,29 ;
	COLOR SCHEME 23
@ 4,6 TO 4,28 ;
	COLOR SCHEME 24
@ 4,29 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,29 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,29 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,7 SAY "[ Filial ]" ;
	SIZE 1,10, 0
@ 3,10 SAY "-" ;
	SIZE 1,1, 0
@ 9,4 TO 11,20 ;
	COLOR SCHEME 24
@ 11,5 TO 11,19 ;
	COLOR SCHEME 23
@ 10,20 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 11,20 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 9,20 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 9,26 TO 11,42 ;
	COLOR SCHEME 24
@ 11,27 TO 11,41 ;
	COLOR SCHEME 23
@ 10,42 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 11,42 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 9,42 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 9,48 TO 11,64 ;
	COLOR SCHEME 24
@ 11,49 TO 11,63 ;
	COLOR SCHEME 23
@ 10,64 SAY "і" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 11,64 SAY "Щ" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 9,64 SAY "ї" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 3,7 GET m.empresa ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN _44a0mnqjz() ;
	VALID _44a0mnqk9()
@ 3,11 GET m.nome_emp ;
	SIZE 1,17 ;
	DEFAULT " " ;
	WHEN _44a0mnqm3()
@ 5,35 GET m.dt_inicio ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _44a0mnqm4() ;
	VALID _44a0mnqm5()
@ 5,51 GET m.dt_fim ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _44a0mnqm6() ;
	VALID _44a0mnqm7() ;
	MESSAGE "Data Final deve ser maior ou igual a Inicial"
@ 10,8 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 10,29 GET m.imp_btn ;
	PICTURE "@*HN \<Imprime" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _44a0mnqm8() ;
	DISABLE
@ 10,52 GET m.canc_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _44a0mnqnk()

IF NOT WVISIBLE("scgc230")
	ACTIVATE WINDOW scgc230
ENDIF

READ CYCLE ;
	ACTIVATE READACT() ;
	DEACTIVATE READDEAC()

RELEASE WINDOW scgc230

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є               SCGC230/MS-DOS Cleanup Code               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
DO ULfecha
RETURN

**************************************


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є   SCGC230/MS-DOS Supporting Procedures and Functions    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
PROCEDURE ULfecha
	IF LFite230  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("itemmov")
	ENDIF
	IF LFemp230  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(LS230areant)
		SELECT &LS230areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
RETURN

PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	LN_prxobj = _CUROBJ
	SHOW GET wp_empresa
	SHOW GET wp_nome_emp
    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
			STORE wp_dtoper to m.dt_inicio, m.dt_fim
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.imp_btn DISABLE
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			IF  m.dt_fim < m.dt_inicio
				SHOW GET m.imp_btn DISABLE
			ELSE
				SHOW GET m.imp_btn ENABLE
			ENDIF
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn DISABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _44A0MNQJZ           m.empresa WHEN                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC230,     Record Number:   38   є
*       є Variable:            m.empresa                          є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _44a0mnqjz     &&  m.empresa WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _44A0MNQK9           m.empresa VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC230,     Record Number:   38   є
*       є Variable:            m.empresa                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _44a0mnqk9     &&  m.empresa VALID
#REGION 1
SELECT empresa
SET ORDER TO TAG empresa
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .F.
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() = 27
		SELECT empresa
		RETURN .F.
	ENDIF
ELSE
	IF !SEEK(m.empresa)
		SELECT empresa
		RETURN .F.
	ENDIF
ENDIF
m.empresa   = empresa
m.nome_emp  = empresa.nome
m.inscricao = empresa.inscricao
SHOW GET m.empresa
SHOW GET m.nome_emp
SELECT empresa
RETURN .T.


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _44A0MNQM3           m.nome_emp WHEN                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC230,     Record Number:   39   є
*       є Variable:            m.nome_emp                         є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _44a0mnqm3     &&  m.nome_emp WHEN
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(.f.)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _44A0MNQM4           m.dt_inicio WHEN                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC230,     Record Number:   40   є
*       є Variable:            m.dt_inicio                        є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      4                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _44a0mnqm4     &&  m.dt_inicio WHEN
#REGION 1
IF isediting
	ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ENDIF
RETURN(isediting)

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _44A0MNQM5           m.dt_inicio VALID                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC230,     Record Number:   40   є
*       є Variable:            m.dt_inicio                        є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      5                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _44a0mnqm5     &&  m.dt_inicio VALID
#REGION 1
m.dt_fim = m.dt_inicio
SHOW GET m.dt_fim
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN (.T.)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _44A0MNQM6           m.dt_fim WHEN                      є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC230,     Record Number:   41   є
*       є Variable:            m.dt_fim                           є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      6                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _44a0mnqm6     &&  m.dt_fim WHEN
#REGION 1
ON KEY LABEL ENTER
RETURN(isediting)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _44A0MNQM7           m.dt_fim VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC230,     Record Number:   41   є
*       є Variable:            m.dt_fim                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      7                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _44a0mnqm7     &&  m.dt_fim VALID
#REGION 1
RETURN(m.dt_fim >= m.dt_inicio)


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _44A0MNQM8           m.imp_btn VALID                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC230,     Record Number:   43   є
*       є Variable:            m.imp_btn                          є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      8                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

FUNCTION _44a0mnqm8     &&  m.imp_btn VALID
#REGION 1
	DO  ULdia_dia
RETURN




PROCEDURE ULdia_dia


	SELE EMPRESA
	SET ORDER TO TAG empresa
	SEEK m.empresa
	SELE itemmov
	SET ORDER TO TAG dt_mov
	GO TOP
	SET NEAR ON
	LDtmp = m.dt_inicio - DAY(m.dt_inicio) + 1 && INICIO DO MES
	SEEK STR(m.empresa,3)+DTOS(LDtmp)
	SET NEAR OFF
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
*******************	

    wl_tmp =  STRTRAN(STR(m.empresa,3),' ','0')
	WAIT WINDOW "AGUARDE. Preparando impressao..." NOWAIT

	SET TALK ON
	select it.data,;
       	SUM(IIF(LEFT(it.classifica,2) $ "00",it.qtde,000000000.00)) as D_QTDE,;
		SUM(IIF(LEFT(it.classifica,2) $ "00/01",it.vlrvenda,000000000.00)) AS d_pneus,;
		SUM(IIF(LEFT(it.classifica,2) $ "00/01",it.vlrvenda+it.vlripi,000000000.00)) AS di_pneus,;
		SUM(IIF(LEFT(it.classifica,2) $ "02/04",it.vlrvenda,000000000.00)) AS D_RODAS,;
		SUM(IIF(LEFT(it.classifica,2) $ "05/03",it.vlrvenda,000000000.00)) AS D_BORRACHA,;
		SUM(IIF(LEFT(it.classifica,2) $ "09",it.vlrvenda,000000000.00))    AS D_SERVICO,;
		SUM(IIF(!LEFT(it.classifica,2) $ "00/01/02/04/05/03/09" ,it.vlrvenda,000000000.00)) AS D_OUTRAS ;
	FROM itemmov it;
	WHERE     it.empresa = m.empresa ;
		  AND it.data >= m.dt_fim - DAY(m.dt_fim)+1 ;
		  AND it.data <= m.dt_fim ;
	      AND LEFT(it.operacao,1) = "S" ;
	      AND it.tp_mercad <> 5;
	      AND it.ch_opera = "1" ;
	      AND it.ch_motiv <> "3" ;
	      AND ((it.ch_produ $ "1/5") ;
	            OR (it.empresa = 10 and it.ch_produ $ "1/5/8"))  ;
	      AND it.tipo <> "ENT" ;
	GROUP BY DATA ;
	ORDER BY DATA ;
  	into cursor CRSDIARIO


  	select * FROM CRSDIARIO ;
  	UNION ;
  	select {31.12.9999} 	AS data,;
       	SUM(it.D_QTDE) 	as D_QTDE,;
		SUM(it.d_pneus) 	AS d_pneus,;
		SUM(it.di_pneus) 	AS di_pneus,;
		SUM(it.D_RODAS) 	AS D_RODAS,;
		SUM(it.D_BORRACHA) AS D_BORRACHA,;
		SUM(it.D_SERVICO) 	AS D_SERVICO,;
		SUM(it.D_OUTRAS) 	AS D_OUTRAS ;
	FROM CRSDIARIO it;
	GROUP BY 1 ;
  	into cursor CRSfinal

	SET TALK OFF

	sele CRSfinal

	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO

    COUNT TO LNimpressao

	KEYBOARD CHR(13)
	WAIT WINDOW " "
	LNimpressos = 0
	GO TOP
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
**************************>>> REGISTRO DE SAIDAS
	LFsegue = .t.
    LSrel = "REL230"
	LSorienta = "WHILE LFsegue "

***********
	wp_msg = "Imprimindo Resumo Dia a Dia......."
	DO UPimpressao     && COORDENA TRAB. DE IMPR SEM REDIRECIONAR
***********
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
*-----------------------------
	sele CRSfinal
	use
	SELE CRSDIARIO
	USE
	sele itemmov
	
    SET PRINTER TO SET('PRINTER',1)
	SET RELATION TO
	SET POINT TO
	SET SEPARATOR  TO
	SHOW GET m.imp_btn DISABLE

RETURN


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _44A0MNQNK           m.canc_btn VALID                   є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         SCGC230,     Record Number:   44   є
*       є Variable:            m.canc_btn                         є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      9                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _44a0mnqnk     &&  m.canc_btn VALID
#REGION 1
CLEAR GETS
CLEAR READ
isediting = .f.
RETURN .T.