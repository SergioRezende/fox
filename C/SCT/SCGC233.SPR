*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º 07/19/14             SCGC233.SPR               10:34:34 º
*       º                                                         º
*       ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
*       º                                                         º
*       º Author's Name                                           º
*       º                                                         º
*       º Copyright (c) 2014 Company Name                         º
*       º Address                                                 º
*       º City,     Zip                                           º
*       º                                                         º
*       º Description:                                            º
*       º This program was automatically generated by GENSCRN.    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC233/MS-DOS Setup Code - SECTION 1          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1

*~ WIZARDSCREEN
#DEFINE C_DBFEMPTY		'Database is empty, add a record?'
#DEFINE C_DELREC		'Apagar Registro Selecionado ?'
#DEFINE C_ENDFILE		'Final do Arquivo.'
#DEFINE C_CANCTRF		'Confirma o Cancelamento da Devolucao ? '
#DEFINE C_APROTRF		'Confirma o Aprovacao da Devolucao ? '
*---------------------------------------------------------------------*
* ARQUIVOS UTILIZADOS :                                               *
*              - EMPRESA
*              - ITEMMOV
*              - SALDO
*              - GRUPO
*			   - TAB001
* OBJETIVOS : RESUMO DE VENDAS NOS GRUPOS
*	
*---------------------------------------------------------------------*
******>>>> INICIO CONTROLE AMBIENTAL
ON KEY LABEL ESCAPE
PRIVATE isediting,isadding,isreading
PRIVATE wp_record
PRIVATE isreadonly,is2table,wzalias
PRIVATE LS233areant
LS233areant	= ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.wzalias	=	SELECT()
m.isediting	=	.F.
m.isadding	=	.F.
m.isreading =  	.F.
m.is2table 	= 	.F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
wp_ref_local =  .T.     &&  POSSUI CONTROLE DE REFRESH LOCAL
m.dolar     = 0

m.restgrup  = .T.       && AUTORIZA OU NAO EMI. resumo todos os grupos
m.ventgrup  = .T.       && AUTORIZA OU NAO EMI. vendas todos os grupos
m.pcres     = .t.       && AUTORIZA OU NAO EMI. pneus e camaras / resumo
m.venpc     = .t.       && AUTORIZA OU NAO EMI. pneus e camaras / venda
m.resras    = .T.       && AUTORIZA OU NAO EMI. resumo rodas/acess/serv
m.venras    = .T.       && AUTORIZA OU NAO EMI. vendas rodas/acess/serv
m.cmpVE		= .T.		
m.cmpVEacm	= .T.		
m.dt_inicio = {}
m.dt_fim	= {}

m.codinicio  = ""
m.clasinicio = ""
m.descinicio = ""
m.ordinicio  = 0

m.codfim  	= ""
m.clasfim 	= ""
m.descfim 	= ""
m.ordfim  	= 0

LFemp233	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFsld233 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFgru233 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFtab233 	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA



********>>>>>> INTERESE LOCAL
wl_cota     = .f.
iscancela   = .f.
isitens     = .f.     && indica se houve edicao doas itens durante ed. orca.

wl_arqtmp    = ""   && alias para arq. temporario

******>>>> INICIO CONTROLE ARQUIVOS

*>> parametros repassados a btn_val


VLleitura = "" && OPERACOES DE REMESSA
                         * repassa chave de leitura p/ btn_val
VLlerfim  = ""  && 1o REG. DE OPERACOES DE REQUISICAO
           * repassa chave de leitura p/ btn_val (POSICAO FINAL + 1 REG)
VLcompara = ""
                         * repassa chave de comparacao p/ btn_val
VLchvlimi = ""  && otimiza browse
*******************************************************
IF !USED("empresa")
	LFemp233	= .T.
	IF ! NetUse("empresa")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("grupo")
	LFgru233	= .T.
	IF ! NetUse("grupo")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("tab001")
	LFtab233	= .T.
	IF ! NetUse("tab001")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("saldo")
	LFsld233	= .T.
	IF ! NetUse("saldo")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF wp_flgfecha
	DO ULfecha 		&& FECHA ARQUIVOS ABERTOS
	RETURN
ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                MS-DOS Window definitions                º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

IF NOT WEXIST("scgc233") ;
	OR UPPER(WTITLE("SCGC233")) == "SCGC233.PJX" ;
	OR UPPER(WTITLE("SCGC233")) == "SCGC233.SCX" ;
	OR UPPER(WTITLE("SCGC233")) == "SCGC233.MNX" ;
	OR UPPER(WTITLE("SCGC233")) == "SCGC233.PRG" ;
	OR UPPER(WTITLE("SCGC233")) == "SCGC233.FRX" ;
	OR UPPER(WTITLE("SCGC233")) == "SCGC233.QPR"
	DEFINE WINDOW scgc233 ;
		FROM INT((SROW()-20)/2),INT((SCOL()-77)/2) ;
		TO INT((SROW()-20)/2)+19,INT((SCOL()-77)/2)+76 ;
		TITLE "[ Entradas e Saidas em Peso Borracha ]" ;
		FOOTER "[ 233 ]" ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC233/MS-DOS Setup Code - SECTION 2          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
******>>>> INICIO CONTROLE LOCAL


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC233/MS-DOS Screen Layout               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
IF WVISIBLE("scgc233")
	ACTIVATE WINDOW scgc233 SAME
ELSE
	ACTIVATE WINDOW scgc233 NOSHOW
ENDIF
@ 0,0 TO 19,76 ;
	COLOR SCHEME 23
@ 1,2 TO 3,30 ;
	COLOR SCHEME 23
@ 3,3 TO 3,29 ;
	COLOR SCHEME 24
@ 3,30 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,30 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,30 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 16,2 TO 18,18 ;
	COLOR SCHEME 24
@ 18,3 TO 18,17 ;
	COLOR SCHEME 23
@ 17,18 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 18,18 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 16,18 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 16,30 TO 18,46 ;
	COLOR SCHEME 24
@ 18,31 TO 18,45 ;
	COLOR SCHEME 23
@ 17,46 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 18,46 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 16,46 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 16,58 TO 18,74 ;
	COLOR SCHEME 24
@ 18,59 TO 18,73 ;
	COLOR SCHEME 23
@ 17,74 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 18,74 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 16,74 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 19,1 TO 19,75 ;
	COLOR SCHEME 24
@ 19,76 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,76 TO 18,76 ;
	COLOR SCHEME 24
@ 0,76 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,59 SAY "[233]" ;
	SIZE 1,5, 0
@ 1,38 TO 3,57 ;
	COLOR SCHEME 23
@ 3,39 TO 3,56 ;
	COLOR SCHEME 24
@ 3,57 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,57 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,57 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,39 SAY "[Dolar U$]" ;
	SIZE 1,10, 0
@ 0,14 SAY "[ Resumos  Fisico Financeiro e Vendas]" ;
	SIZE 1,38, 0
@ 2,10 SAY "ate" ;
	SIZE 1,3, 0
@ 13,3 TO 15,40 ;
	COLOR SCHEME 23
@ 15,4 TO 15,39 ;
	COLOR SCHEME 24
@ 13,40 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 15,40 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 13,5 SAY "[Intervalo Produtos]" ;
	SIZE 1,20, 0
@ 14,40 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 13,47 TO 15,71 ;
	COLOR SCHEME 23
@ 15,48 TO 15,70 ;
	COLOR SCHEME 24
@ 15,71 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 14,71 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 13,71 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 15,55 SAY "<TAB>-> Opcoes" ;
	SIZE 1,14, 0 ;
	COLOR SCHEME 24
@ 13,48 SAY "[ Tip.Controle.Prod. ]" ;
	SIZE 1,22, 0
@ 2,4 GET mes_a ;
	SIZE 1,5 ;
	DEFAULT " " ;
	PICTURE "99.99" ;
	WHEN _44a0mo2vg() ;
	VALID _44a0mo2vs()
@ 2,14 GET m.mes_b ;
	SIZE 1,5 ;
	DEFAULT " " ;
	PICTURE "99.99" ;
	WHEN isediting ;
	VALID _44a0mo2w4()
@ 2,44 GET m.dolar ;
	SIZE 1,8 ;
	DEFAULT 0 ;
	PICTURE "9,999.99" ;
	WHEN _44a0mo2wd()
@ 5,2 GET m.restgrup ;
	PICTURE "@*C Fis/Fin. Todos Grupos" ;
	SIZE 1,25 ;
	DEFAULT 0 ;
	WHEN _44a0mo2wn()
@ 6,2 GET m.ventgrup ;
	PICTURE "@*C Vendas Todos Grupos" ;
	SIZE 1,23 ;
	DEFAULT 0 ;
	WHEN _44a0mo2wx()
@ 7,2 GET m.pcres ;
	PICTURE "@*C Fis/Fin. Pneus e Camaras" ;
	SIZE 1,28 ;
	DEFAULT 0 ;
	WHEN isediting
@ 8,2 GET m.venpc ;
	PICTURE "@*C Vendas Pneus e Camaras" ;
	SIZE 1,26 ;
	DEFAULT 0 ;
	WHEN isediting
@ 9,2 GET m.resras ;
	PICTURE "@*C Fis/Fin. Rodas,Aces. e Serv." ;
	SIZE 1,32 ;
	DEFAULT 0 ;
	WHEN isediting
@ 10,2 GET m.venras ;
	PICTURE "@*C Vendas Rodas,Aces. e Serv." ;
	SIZE 1,30 ;
	DEFAULT 0 ;
	WHEN isediting
@ 5,39 GET m.cmpVE ;
	PICTURE "@*C Compara Vend.X Estoq.(LOJA)" ;
	SIZE 1,31 ;
	DEFAULT 0 ;
	WHEN isediting
@ 6,39 GET m.cmpVEacm ;
	PICTURE "@*C Compara Vend.X Estoq.(GRUPO)" ;
	SIZE 1,32 ;
	DEFAULT 0 ;
	WHEN isediting
@ 14,5 GET m.codinicio ;
	SIZE 1,16 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN _44a0mo2x7() ;
	VALID _44a0mo2xf() ;
	ERROR wp_msg
@ 14,23 GET m.codfim ;
	SIZE 1,16 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN _44a0mo2xq() ;
	VALID _44a0mo2xz() ;
	ERROR wp_msg
@ 14,54 GET LScontroles ;
	SIZE 1,10 ;
	DEFAULT " " ;
	WHEN _44a0mo2y8() ;
	VALID _44a0mo2yi()
@ 17,5 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	WHEN _44a0mo2yq() ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 17,34 GET m.imp_btn ;
	PICTURE "@*HN \<Imprimir" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _44a0mo2z1() ;
	DISABLE
@ 17,63 GET m.canc_btn ;
	PICTURE "@*HT \<Saida" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _44a0mo2zb()
@ 1,3 SAY "[Periodo " ;
	SIZE 1,9, 0

IF NOT WVISIBLE("scgc233")
	ACTIVATE WINDOW scgc233
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º     MS-DOSREAD contains clauses from SCREEN scgc233     º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

READ CYCLE ;
	ACTIVATE READACT() ;
	DEACTIVATE READDEAC() ;
	NOLOCK

RELEASE WINDOW scgc233

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º               SCGC233/MS-DOS Cleanup Code               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
DO ULfecha 		&& FECHA ARQUIVOS ABERTOS
RETURN

*********************************
*    P R O C E D I M E N T O S  *
*********************************


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º   SCGC233/MS-DOS Supporting Procedures and Functions    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
PROCEDURE ULfecha
	IF LFemp233		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	IF LFgru233		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("grupo")
	ENDIF
	IF LFtab233		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("tab001")
	ENDIF
	IF LFsld233		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("saldo")
	ENDIF
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(LS233areant)
		SELECT &LS233areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
	ON KEY LABEL CTRL-I
RETURN
*-------------->

PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	LN_prxobj = _CUROBJ
	ON KEY LABEL ENTER
    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
			SHOW GETS
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.imp_btn DISABLE
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn ENABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn DISABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN

**********************************************************************
*	INICIO - Impressao de Relatorio de Resumo Fis/Fin Todos os Grupos *
**********************************************************************
* REL233*
*********

PROCEDURE ULresgrupo	

	SELE EMPRESA
	SET ORDER TO TAG empresa
	SEEK wp_empresa
	SELE GRUPO
	SET ORDER TO TAG classifica

	SELE  &wl_arqtmp
	GO TOP
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SET RELATION TO classifica  INTO grupo
	SET RELATION TO empresa     INTO empresa ADDITIVE
*******************	

	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	wp_msg = "Resumo Fisico Financeiro Todos Grupos....."
	LFsegue = .t.
	LNregistro = RECNO()
    LNimpressao = RECCOUNT()

	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
**************************>>> REGISTRO DE SAIDAS
	LSorienta = " WHILE LFsegue "
    LSrel = "REL233"      && relatorio padrao p/ impressoras ex: epson
	DO UPimpressao WITH .T.    && COORDENA TRABALHO DE IMPRESSAO
***********
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
RETURN
		
**********************************************************************
*	FIM - Impressao de Relatorio de Resumo Fis/Fin Todos os Grupos *
**********************************************************************
* REL233*
*********



**********************************************************************
*	INICIO - Impressao de Relatorio de Resumo Fis/Fin Todos os Grupos *
**********************************************************************
* REL233*
*********

PROCEDURE ULvengrupo	

	SELE EMPRESA
	SET ORDER TO TAG empresa
	SEEK wp_empresa
	SELE GRUPO
	SET ORDER TO TAG classifica

	SELE  &wl_arqtmp
	GO TOP
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SET RELATION TO classifica  INTO grupo
	SET RELATION TO empresa     INTO empresa ADDITIVE
*******************	

	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	wp_msg = "Resumo Vendas Todos Grupos....."
	LFsegue = .t.
	LNregistro = RECNO()
    LNimpressao = RECCOUNT()

	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
**************************>>> REGISTRO DE SAIDAS
	LSorienta = " WHILE LFsegue "
    LSrel = "REL233D"      && relatorio padrao p/ impressoras ex: epson
	DO UPimpressao WITH .T.    && COORDENA TRABALHO DE IMPRESSAO
***********
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
RETURN
		
**********************************************************************
*	FIM - Impressao de Relatorio de Resumo VENDAS Todos os Grupos *
**********************************************************************
* REL233D*
*********




**********************************************************************
*	INICIO - Impressao de Relatorio de Resumo Pneus e Camaras Fis/Fin *
**********************************************************************
* REL233A*
*********

PROCEDURE ULrespc

	SELE EMPRESA
	SET ORDER TO TAG empresa
	SEEK wp_empresa
	SELE GRUPO
	SET ORDER TO TAG classifica

	SELE  &wl_arqtmp
	GO TOP
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SET RELATION TO classifica  INTO grupo
	SET RELATION TO empresa     INTO empresa ADDITIVE
*******************	

	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	wp_msg = "Resumo Fisico Financeiro - Pneus e Camaras.."
	LFsegue = .t.
	LNregistro = RECNO()
    COUNT FOR LEFT(classifica,2) $ "00/01/04" 	TO   LNimpressao
	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
**************************>>> REGISTRO DE SAIDAS
	LSorienta = " FOR LEFT(classifica,2) $ '00/01/04' WHILE LFsegue "
    LSrel = "REL233A"      && relatorio padrao p/ impressoras ex: epson
	DO UPimpressao WITH .T.    && COORDENA TRABALHO DE IMPRESSAO
***********
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
RETURN
		
**********************************************************************
*	FIM - Impressao de Relatorio de Resumo Pneus e Camaras Fis/Fin *
**********************************************************************
* REL233A*
*********
		
**********************************************************************
*	INICIO - Impressao de Relatorio de Resumo Pneus e Camaras Vendas *
**********************************************************************
* REL233A1*
*********

PROCEDURE ULvenpc

	SELE EMPRESA
	SET ORDER TO TAG empresa
	SEEK wp_empresa
	SELE GRUPO
	SET ORDER TO TAG classifica

	SELE  &wl_arqtmp
	GO TOP
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SET RELATION TO classifica  INTO grupo
	SET RELATION TO empresa     INTO empresa ADDITIVE
*******************	

	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	wp_msg = "Resumo Fisico Financeiro - Pneus e Camaras.."
	LFsegue = .t.
	LNregistro = RECNO()
    COUNT FOR LEFT(classifica,2) $ "00/01/04" 	TO   LNimpressao
	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
**************************>>> REGISTRO DE SAIDAS
	LSorienta = " FOR LEFT(classifica,2) $ '00/01/04' WHILE LFsegue "
    LSrel = "REL233A1"      && relatorio padrao p/ impressoras ex: epson
	DO UPimpressao WITH .T.    && COORDENA TRABALHO DE IMPRESSAO
***********
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
RETURN
		
**********************************************************************
*	FIM - Impressao de Relatorio de Resumo Pneus e Camaras Vendas *
**********************************************************************
* REL233A1*
*********
		
		
**********************************************************************
*	INICIO - Impressao de Relatorio de Resumo Fis/Fin Rodas/Aces/Serv.
**********************************************************************
* REL233B*
*********

PROCEDURE ULresras

	SELE EMPRESA
	SET ORDER TO TAG empresa
	SEEK wp_empresa
	SELE GRUPO
	SET ORDER TO TAG classifica

	SELE  &wl_arqtmp
	GO TOP
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SET RELATION TO classifica  INTO grupo
	SET RELATION TO empresa     INTO empresa ADDITIVE
*******************	

	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	wp_msg = "Resumo Fisico/Financeiro Rodas/Acess./Serv."
	LFsegue = .t.
	LNregistro = RECNO()
    LNimpressao = RECCOUNT()

	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
**************************>>> REGISTRO DE SAIDAS
	LSorienta = " WHILE LFsegue "
    LSrel = "REL233B"      && relatorio padrao p/ impressoras ex: epson
	DO UPimpressao WITH .T.    && COORDENA TRABALHO DE IMPRESSAO
***********
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
RETURN
		
**********************************************************************
*	FIM     - Impressao de Relatorio de Resumo Fis/Fin Rodas/Aces/Serv.
**********************************************************************
* REL233B*
*********
		
		
**********************************************************************
*	INICIO - Impressao de Relatorio de Resumo Vendas Rodas/Aces/Serv.
**********************************************************************
* REL233C*
*********

PROCEDURE ULvenras

	SELE EMPRESA
	SET ORDER TO TAG empresa
	SEEK wp_empresa
	SELE GRUPO
	SET ORDER TO TAG classifica

	SELE  &wl_arqtmp
	GO TOP
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SET RELATION TO classifica  INTO grupo
	SET RELATION TO empresa     INTO empresa ADDITIVE
*******************	

	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	wp_msg = "Resumo Vendas Rodas/Acess./Serv."
	LFsegue = .t.
	LNregistro = RECNO()
    LNimpressao = RECCOUNT()

	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
**************************>>> REGISTRO DE SAIDAS
	LSorienta = " WHILE LFsegue "
    LSrel = "REL233C"      && relatorio padrao p/ impressoras ex: epson
	DO UPimpressao WITH .T.    && COORDENA TRABALHO DE IMPRESSAO
***********
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
RETURN
		
**********************************************************************
*	FIM     - Impressao de Relatorio de Resumo Vendas Rodas/Aces/Serv.
**********************************************************************
* REL233C*
*********
		

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2VG           mes_a WHEN                         º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   49   º
*       º Variable:            mes_a                              º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      1                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2vg     &&  mes_a WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
ON KEY LABEL ENTER
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2VS           mes_a VALID                        º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   49   º
*       º Variable:            mes_a                              º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      2                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2vs     &&  mes_a VALID
#REGION 1
m.dt_inicio = UPValData(CTOD("01."+mes_A))


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2W4           m.mes_b VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   50   º
*       º Variable:            m.mes_b                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      3                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2w4     &&  m.mes_b VALID
#REGION 1
IF mes_B		= "02.00"
	m.dt_fim	= {29.02.2000}
ELSE
	m.dt_fim = UPValData(GOMONTH(CTOD("01."+mes_B),1) - 1)
ENDIF

IF m.dt_fim < m.dt_inicio AND LASTKEY() = 13
	m.dt_fim = GOMONTH(CTOD("01."+mes_A),1) - 1
	RETURN(.F.)
ENDIF
RETURN(.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2WD           m.dolar WHEN                       º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   51   º
*       º Variable:            m.dolar                            º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      4                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2wd     &&  m.dolar WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2WN           m.restgrup WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   52   º
*       º Variable:            m.restgrup                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Check Box                          º
*       º Snippet Number:      5                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2wn     &&  m.restgrup WHEN
#REGION 1
ON KEY LABEL ENTER  KEYBOARD "{RIGHTARROW}"
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2WX           m.ventgrup WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   53   º
*       º Variable:            m.ventgrup                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Check Box                          º
*       º Snippet Number:      6                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2wx     &&  m.ventgrup WHEN
#REGION 1
ON KEY LABEL ENTER  KEYBOARD "{RIGHTARROW}"
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2X7           m.codinicio WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   60   º
*       º Variable:            m.codinicio                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      7                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2x7     &&  m.codinicio WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting AND (m.cmpVE OR m.cmpVEacm))

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2XF           m.codinicio VALID                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   60   º
*       º Variable:            m.codinicio                        º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      8                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2xf     &&  m.codinicio VALID
#REGION 1
PRIVATE LSforlocal, LSgrupo

IF EMPTY(m.codinicio) AND LASTKEY() <> 9
	m.clasinicio  = " "
	m.descinicio  =   "PRIMEIRO"
	m.ordinicio  = 1
	SHOW GET  m.descinicio
	RETURN(.T.)
ENDIF
SELE grupo
SET ORDER TO TAG codigo
SET NEAR ON
SEEK ALLTRIM(m.codinicio)
SET NEAR OFF
*----------------------------------------------------------*
LSforlocal  = ""
*----------------------------------------------------------*
SELECT grupo
ON KEY LABEL ESCAPE
IF LASTKEY() = 9
	SET ORDER TO TAG classifica
	ON KEY LABEL ESCAPE
	DO loc_dlog WITH .T.,LSforlocal
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
	IF LASTKEY() = 27
		RETURN .F.
	ENDIF
ENDIF
m.codinicio  = grupo.codigo
m.clasinicio = grupo.classifica
m.descinicio = grupo.descricao
m.ordinicio  = grupo.ordem
*******
SHOW GET  m.codinicio
RETURN .t.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2XQ           m.codfim WHEN                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   61   º
*       º Variable:            m.codfim                           º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      9                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2xq     &&  m.codfim WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting AND (m.cmpVE OR m.cmpVEacm))

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2XZ           m.codfim VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   61   º
*       º Variable:            m.codfim                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      10                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2xz     &&  m.codfim VALID
#REGION 1
PRIVATE LSforlocal, LSgrupo

IF EMPTY(m.codfim) AND LASTKEY() <> 9
	m.clasfim 	= 	REPL("9",15)
	m.descfim   =   "ULTIMO"
	m.ordfim  	 = 9999999
	SHOW GET  m.descfim
	RETURN(.T.)
ENDIF
SELE grupo
SET ORDER TO TAG codigo
SET NEAR ON
SEEK ALLTRIM(m.codfim)
SET NEAR OFF
*----------------------------------------------------------*
LSforlocal  = ""
*----------------------------------------------------------*
SELECT grupo
ON KEY LABEL ESCAPE
IF LASTKEY() = 9
	SET ORDER TO TAG classifica
	ON KEY LABEL ESCAPE
	DO loc_dlog WITH .T.,LSforlocal
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
	IF LASTKEY() = 27
		RETURN .F.
	ENDIF
ENDIF
m.codfim  = grupo.codigo
m.clasfim = grupo.classifica
m.descfim = grupo.descricao
m.ordfim  = grupo.ordem
*******
SHOW GET  m.codfim
RETURN .t.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2Y8           LScontroles WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   62   º
*       º Variable:            LScontroles                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      11                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2y8     &&  LScontroles WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting AND (m.cmpVE OR m.cmpVEacm))

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2YI           LScontroles VALID                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   62   º
*       º Variable:            LScontroles                        º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      12                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2yi     &&  LScontroles VALID
#REGION 1
IF LASTKEY() = 13 OR LASTKEY() = 27 OR LASTKEY() = 15
	RETURN(.T.)
ENDIF
SELECT tab001
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T., "tab001.tabela = 'TPC'"
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT grupo
   IF LASTKEY() = 27
      RETURN .F.
   ENDIF
   LScontroles = ALLTRIM(LScontroles)+(tab001.codigo)+"/"
   SHOW GET m.LScontroles
ENDIF
SELECT grupo
KEYBOARD CHR(13)
RETURN(-1)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2YQ           m.edit_btn WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   63   º
*       º Variable:            m.edit_btn                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      13                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2yq     &&  m.edit_btn WHEN
#REGION 1
ON KEY LABEL ENTER


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2Z1           m.imp_btn VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   64   º
*       º Variable:            m.imp_btn                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      14                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2z1     &&  m.imp_btn VALID
#REGION 1
	DO CASE
		CASE m.cmpVE
			 	=W_DEFPROC("rotrelat.SPR")
				LNemp 		= 	wp_empresa
				DO UR418 WITH ;
					 LNemp,m.clasinicio,m.clasfim,LScontroles,;
					 	m.dt_inicio,m.dt_fim,"LOJA"
		CASE m.cmpVEacm
			 	=W_DEFPROC("rotrelat.SPR")
				LNemp 		= 	wp_empresa
				DO UR418 WITH ;
					 LNemp,m.clasinicio,m.clasfim,LScontroles,;
					 	m.dt_inicio,m.dt_fim,"GRUPO"
		OTHERWISE
		 	***************
			wl_arqtmp = ""
			LNtmp     = 65		&& TABELA ASCII A = 65
			IF !UPabretmp("rst")
				SHOW GET m.imp_btn DISABLE
				RETURN
			ENDIF

			**************
			LStmp = "&wp_dirtmp"+"&wl_arqtmp"
			**************
			SELE saldo
			SET ORDER TO TAG dtabert
			GO TOP
			SET NEAR ON
			SEEK DTOS(m.dt_inicio)
			SET NEAR OFF
			WAIT WINDOW "AGUARDE. Gerando Arq. Temporario....." NOWAIT

			COPY TO &LStmp WHILE  saldo.dtabert <= m.dt_fim

			KEYBOARD CHR(13)
			CLEAR TYPEAHEAD

			SELE 0
			USE &LStmp
		    INDEX ON STR(EMPRESA,3) + CLASSIFICA  TAG tmpind ADDITIVE
			SET ORDER TO TAG tmpind
			SELE  &wl_arqtmp
			GO TOP
			IF  EOF()
				USE
				WAIT WINDOW ;
					"Nao ha dados nos criterios solicitados. <ENTER>"
					SHOW GET m.imp_btn DISABLE
				RETURN
			ENDIF	
			*************************************************************
			DO PRTSETUP.SPR
			IF LASTKEY() = 27
				SHOW GET m.imp_btn DISABLE
				RETURN
			ENDIF
			IF m.restgrup
				m.titulo = ;
					" Resumo de Fisico Financeiro Todos Grupos Mes : "+mes_A
				DO ULresgrupo
			ENDIF
			IF m.ventgrup
				m.titulo = " Resumo de Vendas - Todos Grupos Mes : "+mes_A
				DO ULvengrupo
			ENDIF
			IF m.pcres
				m.titulo = ;
				" Resumo de Fisico Financeiro - Pneus e Camaras Mes :"+mes_A
				DO ULrespc
			ENDIF
			IF m.venpc
				m.titulo = ;
				" Resumo de  Vendas - Pneus e Camaras Mes : "+mes_A
				DO ULvenpc
			ENDIF
			IF m.resras
				m.titulo = ;
					" Resumo de Fisico Financeiro -"+;
					" Rodas,Acessorios e Servicos - Mes  : " + mes_A
				DO ULresras
			ENDIF
			IF m.venras
				m.titulo = ;
				" Resumo de Vendas - Rodas,Acessorios e Servicos"+;
				" - Mes  : " + mes_A
				DO ULvenras
			ENDIF
			SELE  &wl_arqtmp
			USE
	ENDCASE

********************************************************************
SELE GRUPO
SET PRINTER TO SET('PRINTER',1)
SET RELATION TO
SET POINT TO
SET SEPARATOR  TO

SHOW WINDOW SCGC233 TOP
SHOW GET m.imp_btn DISABLE


RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _44A0MO2ZB           m.canc_btn VALID                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC233,     Record Number:   65   º
*       º Variable:            m.canc_btn                         º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      15                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _44a0mo2zb     &&  m.canc_btn VALID
#REGION 1
CLEAR GETS
CLEAR READ
isediting = .f.
RETURN .T.