*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ 07/19/14             SCT1101.SPR               10:36:53 ╨
*       ╨                                                         ╨
*       гддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╤
*       ╨                                                         ╨
*       ╨ Author's Name                                           ╨
*       ╨                                                         ╨
*       ╨ Copyright (c) 2014 Company Name                         ╨
*       ╨ Address                                                 ╨
*       ╨ City,     Zip                                           ╨
*       ╨                                                         ╨
*       ╨ Description:                                            ╨
*       ╨ This program was automatically generated by GENSCRN.    ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫

PARAMETERS lnempresa,lstag,lskeyinicio,lskeyfinal,;
	 lddtinicio,lddtfim,lscontroles,lnpagina,lfmtvretorno

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨          SCT1101/MS-DOS Setup Code - SECTION 1          ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1

*---------------------------------------------------------------*
* OPERA ARQUIVOS :
*			GRUPO
*			EMPRESA
*			SELECT tab001
* OBJETIVO:	ENTRADA DE PARAMETROS PARA RELATORIOS ENVOLVENDO ESTOQUE
*---------------------------------------------------------------*
*	DEFINICOES DE USO GENERICO
*---------------------------------------------------------------*
* 					[ INICIO CONTROLE AMBIENTAL ]				*
CLEAR TYPEAHEAD
PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()
*---------------------------------------------------------------*
ON KEY LABEL END DO ULencerra
ON KEY LABEL ESCAPE KEYBOARD "{END}"
PRIVATE isediting
PRIVATE LSareant
LSareant 	= ALLTRIM(ALIAS()) 	&& PERMITE RETORNAR A AREA ANTER. A CHAMADA
m.isediting	=	.T.
wp_flgfecha = 	.F. 			&& defaut nao fechamento da secao

*---------------------------------------------------------------*
*	DEFINICOES DE USO ESPECIFICO DESTE PROGRAMA
*---------------------------------------------------------------*
*   PRIVATE LScodinicio,LSclasinicio,LSdescinicio,LScodfim,LSclasfim,;
*				 		LSdescfim,LScontroles,LNpagina
*   PRIVATE LStag, LSdescricao
*---------------------------------------------------------------*

PRIVATE LSdescricao
PRIVATE LFgrupo,LFempresa,LFtab001

LScodinicio  = " "
LSdescinicio = " "
LScodfim     = " "    && CODIGO FINAL INFORMADO
LSdescfim    = " "
LScontroles  = "     "  && CONTEM OS CODIGOS DE CONTROLE DE PRODUTO QUE
						&& DEVEM SER IMPRESSOS
LSkeyinicio	 = "" 	    && VALOR A SER SUBSTITUIDO PELA KEY() DO 1o
						&& REGISTRO
LSkeyfinal 	 = "" 	    && VALOR A SER SUBSTITUIDO PELA KEY() DO ULTIMO
						&& REGISTRO

LNpagina	=  1
LFmtvretorno=  "ABORTADO" 	&& OU "NORMAL"
LStag 		=  "CLASSIFICA"
LSdescricao =  "Classificacao"

LFgrupo		= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFempresa	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFtab001	=	.F.

******>>>> INICIO CONTROLE ARQUIVOS

LFgrupo 		= NetArq("grupo")
LFempresa 		= NetArq("empresa")
LFtab001		= NetArq("tab001") 	
IF (LFgrupo+LFempresa+LFtab001) > 100000 && HOUVE FALHA DE ABERTURA
	=UP_fecha("grupo" ,LFgrupo)
	=UP_fecha("empresa" ,LFempresa)
	=UP_fecha("tab001" ,LFtab001)
	SELE &LSareant
	RETURN(1)
ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨                MS-DOS Window definitions                ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

IF NOT WEXIST("sct1101") ;
	OR UPPER(WTITLE("SCT1101")) == "SCT1101.PJX" ;
	OR UPPER(WTITLE("SCT1101")) == "SCT1101.SCX" ;
	OR UPPER(WTITLE("SCT1101")) == "SCT1101.MNX" ;
	OR UPPER(WTITLE("SCT1101")) == "SCT1101.PRG" ;
	OR UPPER(WTITLE("SCT1101")) == "SCT1101.FRX" ;
	OR UPPER(WTITLE("SCT1101")) == "SCT1101.QPR"
	DEFINE WINDOW sct1101 ;
		FROM INT((SROW()-16)/2),INT((SCOL()-78)/2) ;
		TO INT((SROW()-16)/2)+15,INT((SCOL()-78)/2)+77 ;
		TITLE "[ Parametros para Relatorios de Envolvendo Estoque ]" ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨          SCT1101/MS-DOS Setup Code - SECTION 2          ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
******>>>> INICIO CONTROLE LOCAL
SELE grupo
SET ORDER TO TAG classifica	
SHOW  GET LStag
SHOW  GET LSdescricao

GO TOP
LSkeyinicio	 = KEY() 	&& VALOR A SER SUBSTITUIDO PELA KEY() DO 1o
						&& REGISTRO
LSkeyinicio	 = &LSkeyinicio

GO BOTT
LSkeyfinal 	 = KEY() 	    && VALOR A SER SUBSTITUIDO PELA KEY() DO ULTIMO
							&& REGISTRO
LSkeyfinal	 = &LSkeyfinal
GO TOP

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨              SCT1101/MS-DOS Screen Layout               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
IF WVISIBLE("sct1101")
	ACTIVATE WINDOW sct1101 SAME
ELSE
	ACTIVATE WINDOW sct1101 NOSHOW
ENDIF
@ 3,7 SAY "-" ;
	SIZE 1,1, 0
@ 0,0 TO 15,77 ;
	COLOR SCHEME 23
@ 15,1 TO 15,76 ;
	COLOR SCHEME 24
@ 15,77 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,77 TO 14,77 ;
	COLOR SCHEME 24
@ 0,77 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,41 SAY "<TAB>-> Opcoes" ;
	SIZE 1,14, 0 ;
	COLOR SCHEME 24
@ 8,7 TO 11,69 ;
	COLOR SCHEME 23
@ 11,8 TO 11,68 ;
	COLOR SCHEME 24
@ 8,69 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 9,69 TO 10,69 ;
	COLOR SCHEME 24
@ 11,69 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 8,29 SAY "[Intervalo Produtos]" ;
	SIZE 1,20, 0
@ 12,61 SAY "[Pg.Inicial]" ;
	SIZE 1,12, 0
@ 0,14 SAY "[ Parametros para Relatorios Envolvendo Estoque ]" ;
	SIZE 1,49, 0
@ 2,3 SAY "[ Loja ]" ;
	SIZE 1,8, 0
@ 13,15 SAY "a" ;
	SIZE 1,1, 0
@ 12,3 SAY "[ Periodo ]" ;
	SIZE 1,11, 0
@ 5,28 SAY "[ Tipos de Estoque ]" ;
	SIZE 1,20, 0
@ 3,40 SAY "-" ;
	SIZE 1,1, 0
@ 3,23 SAY "[" ;
	SIZE 1,1, 0
@ 3,73 SAY "]" ;
	SIZE 1,1, 0
@ 15,68 SAY "[sct1100]" ;
	SIZE 1,9, 0 ;
	COLOR SCHEME 24
@ 3,4 GET LNempresa ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN _44a0mr1n8() ;
	VALID _44a0mr1nn()
@ 3,8 GET LSsigla ;
	SIZE 1,7 ;
	DEFAULT " " ;
	WHEN .f.
@ 2,18 GET LNindice ;
	PICTURE "@*HN \<Ordem" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	WHEN _44a0mr1no() ;
	VALID _44a0mr1od()
@ 3,24 GET LStag ;
	SIZE 1,16 ;
	DEFAULT " " ;
	WHEN .f.
@ 3,41 GET LSdescricao ;
	SIZE 1,32 ;
	DEFAULT " " ;
	WHEN .f.
@ 6,30 GET LScontroles ;
	SIZE 1,10 ;
	DEFAULT " " ;
	WHEN _44a0mr1oo() ;
	VALID _44a0mr1oz()
@ 9,8 GET LScodinicio ;
	SIZE 1,16 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN _44a0mr1p9() ;
	VALID _44a0mr1pa() ;
	ERROR wp_msg
@ 9,41 GET LScodfim ;
	SIZE 1,16 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN _44a0mr1pw() ;
	VALID _44a0mr1q8()
@ 10,14 GET LSdescinicio ;
	SIZE 1,22 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN .f.
@ 10,44 GET LSdescfim ;
	SIZE 1,24 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN .f.
@ 13,4 GET LDdtinicio ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN isediting ;
	VALID _44a0mr1qk()
@ 13,17 GET LDdtfim ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN isediting ;
	VALID LDdtfim >= LDdtinicio ;
	MESSAGE "Data Final deve ser maior ou igual a Inicial"
@ 13,65 GET LNpagina ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN _44a0mr1qw() ;
	VALID LNpagina > 0 ;
	ERROR "Numero deve ser > 0 "
@ 15,28 GET m.imp_btn ;
	PICTURE "@*HN \<Processar" ;
	SIZE 1,11,1 ;
	DEFAULT 1 ;
	WHEN isediting AND  ULvervalidade() ;
	VALID _44a0mr1qx()
@ 15,51 GET m.canc_btn ;
	PICTURE "@*HN \<Cancela" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	WHEN isediting OR ULvervalidade() ;
	VALID _44a0mr1rp()

IF NOT WVISIBLE("sct1101")
	ACTIVATE WINDOW sct1101
ENDIF

READ CYCLE ;
	ACTIVATE READACT() ;
	DEACTIVATE READDEAC()

RELEASE WINDOW sct1101

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨               SCT1101/MS-DOS Cleanup Code               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
DO ULfecha
POP KEY 			&& reabilita teclas de atalho def. anteriormente
RETURN

**********************



*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨   SCT1101/MS-DOS Supporting Procedures and Functions    ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
PROCEDURE ULencerra
	CLEAR GETS
	CLEAR READ
	isediting = .f.
RETURN

PROCEDURE ULfecha
	=UP_fecha("grupo" ,LFgrupo)
	=UP_fecha("empresa" ,LFempresa)
	=UP_fecha("tab001" ,LFtab001)
	IF !EMPTY(LSareant) AND USED(LSareant)
		SELECT &LSareant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
RETURN

FUNCTION ULvervalidade && HABILITAR OU NAO O BOTAO DE PROCESSA
	if isediting AND TYPE("LSkeyinicio") = TYPE("LSkeyfinal") ;
			 AND LSkeyfinal >= LSkeyinicio AND LDdtfim >= LDdtinicio
		SHOW GET imp_btn ENABLE
		RETURN(.T.)
	ELSE
		SHOW GET imp_btn DISABLE
		RETURN(.F.)
	ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1N8           LNempresa WHEN                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   25   ╨
*       ╨ Variable:            LNempresa                          ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      1                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1n8     &&  LNempresa WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1NN           LNempresa VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   25   ╨
*       ╨ Variable:            LNempresa                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      2                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1nn     &&  LNempresa VALID
#REGION 1
SELECT empresa
SET ORDER TO TAG empresa
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .F.
   ON KEY LABEL ESCAPE DO BTN_VAL WITH 'DELETE'
   IF LASTKEY() = 27
		SELECT empresa
		RETURN .F.
	ENDIF
ELSE
	IF !SEEK(LNempresa)
		SELECT empresa
		RETURN .F.
	ENDIF
ENDIF
LNempresa   = empresa
LSsigla 	= empresa.sigla
SHOW GET LNempresa
SHOW GET LSsigla
SELECT empresa
RETURN .T.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1NO           LNindice WHEN                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   27   ╨
*       ╨ Variable:            LNindice                           ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      3                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1no     &&  LNindice WHEN
#REGION 1
ON KEY LABEL ENTER  KEYBOARD "{TAB}"
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1OD           LNindice VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   27   ╨
*       ╨ Variable:            LNindice                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      4                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1od     &&  LNindice VALID
#REGION 1
SELE grupo
do psqcdx.spr WITH LStag,LSdescricao
SELE grupo
SET ORDER TO TAG &LStag
SHOW GET LStag
SHOW GET LSdescricao
ON KEY LABEL ENTER  KEYBOARD "{TAB}"


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1OO           LScontroles WHEN                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   30   ╨
*       ╨ Variable:            LScontroles                        ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      5                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1oo     &&  LScontroles WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1OZ           LScontroles VALID                  ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   30   ╨
*       ╨ Variable:            LScontroles                        ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      6                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1oz     &&  LScontroles VALID
#REGION 1
IF LASTKEY() = 13 OR LASTKEY() = 27 OR LASTKEY() = 15
	RETURN(.T.)
ENDIF
SELECT tab001
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T., "tab001.tabela = 'TPC'"
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   SELECT grupo
   IF LASTKEY() = 27
      RETURN .F.
   ENDIF
   LScontroles = ALLTRIM(LScontroles)+(tab001.codigo)+"/"
   SHOW GET m.LScontroles
ENDIF
SELECT grupo
KEYBOARD CHR(13)
RETURN(-1)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1P9           LScodinicio WHEN                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   31   ╨
*       ╨ Variable:            LScodinicio                        ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      7                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1p9     &&  LScodinicio WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1PA           LScodinicio VALID                  ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   31   ╨
*       ╨ Variable:            LScodinicio                        ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      8                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1pa     &&  LScodinicio VALID
#REGION 1
IF EMPTY(LScodinicio) AND LASTKEY() <> 9
	GO TOP
	LSkeyinicio	 = KEY() 		&& VALOR A SER SUBSTITUIDO PELA KEY() DO 1o
								&& REGISTRO
	LSkeyinicio	 = &LSkeyinicio	&& VALOR DA CHAVE

	LSdescinicio  =   "PRIMEIRO"
	SHOW GET  LSdescinicio
	RETURN(.T.)
ENDIF
SELE grupo
SET ORDER TO TAG codigo
SET NEAR ON
SEEK ALLTRIM(LScodinicio)
SET NEAR OFF
*----------------------------------------------------------*
SELECT grupo
SET ORDER TO TAG &LStag
ON KEY LABEL ESCAPE
IF LASTKEY() = 9
	ON KEY LABEL ESCAPE

 	DO loc_dlog WITH .T.,;
		 " STR(grupo.tp_control,1) $ '&LScontroles' "

	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
	IF LASTKEY() = 27
		RETURN .F.
	ENDIF
ENDIF
LScodinicio  = grupo.codigo
LSdescinicio = grupo.descricao
LSkeyinicio	 = KEY() 		&& VALOR A SER SUBSTITUIDO PELA KEY() DO 1o
							&& REGISTRO
LSkeyinicio	 = &LSkeyinicio	&& VALOR DA CHAVE
*******
SHOW GET  LScodinicio
SHOW GET  LSdescinicio

IF EMPTY(LScodfim) OR TYPE("LSkeyinicio") <> TYPE("LSkeyfinal")
	LScodfim  	 = grupo.codigo
	LSdescfim    = grupo.descricao
	SHOW GET  LScodfim
	SHOW GET  LSdescfim
	LSkeyfinal	 = KEY() 		&& VALOR A SER SUBSTITUIDO PELA KEY() DO 1o
	LSkeyfinal	 = &LSkeyfinal 	&& VALOR DA CHAVE
ENDIF
RETURN .t.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1PW           LScodfim WHEN                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   32   ╨
*       ╨ Variable:            LScodfim                           ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      9                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1pw     &&  LScodfim WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1Q8           LScodfim VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   32   ╨
*       ╨ Variable:            LScodfim                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      10                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1q8     &&  LScodfim VALID
#REGION 1
IF EMPTY(LScodfim) AND LASTKEY() <> 9
	GO BOTT
	LSkeyfinal	 = KEY() 		&& VALOR A SER SUBSTITUIDO PELA KEY() DO 1o
								&& REGISTRO
	LSkeyfinal	 = &LSkeyfinal	&& VALOR DA CHAVE
	LSdescfim   =   "ULTIMO"
	SHOW GET  LSdescfim
	RETURN(.T.)
ENDIF
SELE grupo
SET ORDER TO TAG codigo
SET NEAR ON
SEEK ALLTRIM(LScodfim)
SET NEAR OFF
*----------------------------------------------------------*
SELECT grupo
SET ORDER TO TAG &LStag
ON KEY LABEL ESCAPE
IF LASTKEY() = 9
	ON KEY LABEL ESCAPE
 	DO loc_dlog WITH .T.,;
		 " STR(grupo.tp_control,1) $ '&LScontroles' "
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
	IF LASTKEY() = 27
		RETURN .F.
	ENDIF
ENDIF
LScodfim  = grupo.codigo
LSdescfim = grupo.descricao
SHOW GET  LScodfim
SHOW GET  LSdescfim
LSkeyfinal	 = KEY() 		&& VALOR A SER SUBSTITUIDO PELA KEY() DO 1o
								&& REGISTRO
LSkeyfinal	 = &LSkeyfinal	&& VALOR DA CHAVE

IF TYPE("LSkeyinicio") <> TYPE("LSkeyfinal") OR LSkeyfinal < LSkeyinicio
	WAIT WINDOW "Chave Final Deve ser Maior que a Inicial..<ENTER>"
	RETURN .F.
ENDIF
*******
RETURN .t.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1QK           LDdtinicio VALID                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   35   ╨
*       ╨ Variable:            LDdtinicio                         ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      11                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1qk     &&  LDdtinicio VALID
#REGION 1
LDdtfim = LDdtinicio
SHOW GET LDdtfim
RETURN (.T.)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1QW           LNpagina WHEN                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   37   ╨
*       ╨ Variable:            LNpagina                           ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      12                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1qw     &&  LNpagina WHEN
#REGION 1
ON KEY LABEL ENTER
=ULvervalidade()
RETURN(isediting)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1QX           m.imp_btn VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   38   ╨
*       ╨ Variable:            m.imp_btn                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      13                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1qx     &&  m.imp_btn VALID
#REGION 1
LFmtvretorno=  "NORMAL"
DO ULencerra

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _44A0MR1RP           m.canc_btn VALID                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCT1101,     Record Number:   39   ╨
*       ╨ Variable:            m.canc_btn                         ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      14                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _44a0mr1rp     &&  m.canc_btn VALID
#REGION 1
LFmtvretorno =  "ABORTANDO"
DO ULencerra