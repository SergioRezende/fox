*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ 19/03/2009            SCGC619.SPR              11:35:22 ╨
*       ╨                                                         ╨
*       гддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╤
*       ╨                                                         ╨
*       ╨ Author's Name                                           ╨
*       ╨                                                         ╨
*       ╨ Copyright (c) 2009 Company Name                         ╨
*       ╨ Address                                                 ╨
*       ╨ City,     Zip                                           ╨
*       ╨                                                         ╨
*       ╨ Description:                                            ╨
*       ╨ This program was automatically generated by GENSCRN.    ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨          SCGC619/MS-DOS Setup Code - SECTION 1          ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
***************
*~ WIZARDSCREEN

*---------------------------------------------------------------------*
* ARQUIVOS UTILIZADOS :                                               *
*
*
* OBJETIVOS : COMISSIONAMENTO POR VENDEDOR/NOTA/ITEM
*	
*---------------------------------------------------------------------*
******>>>> INICIO CONTROLE AMBIENTAL

ON KEY LABEL ESCAPE

PRIVATE isediting,isadding,isreading
PRIVATE wp_record
PRIVATE isreadonly,is2table,wzalias
PRIVATE LS617areant
LS617areant	= ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.wzalias	=	SELECT()
m.isediting	=	.F.
m.isadding	=	.F.
m.isreading =   .f.
m.is2table 	= 	.F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
wp_ref_local =  .f.     && NAO POSSUI CONTROLE DE REFRESH LOCAL

LFfun617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFtab617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFusr617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFemp617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFnfs617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFitc617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFitm617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFgrp617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA

******>>>> INICIO CONTROLE ARQUIVOS

*>> parametros repassados a btn_val

VLleitura = ""    && repassa chave de leitura p/ btn_val
VLlerfim  = ""    && repassa chave de leitura p/ btn_val ultimo + 1 REG)
VLcompara = ""    && repassa chave de comparacao p/ btn_val
VLchvlimi = ""    && repassa chave de leitura p/ btn_val


IF !USED("empresa")
	LFemp617  	= .T.
	IF ! NetUse("empresa")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("usuario")
	LFusr617  	= .T.
	IF ! NetUse("usuario")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("itcomiss")
	LFitc617  	= .T.
	IF ! NetUse("itcomiss")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

IF !USED("nota")
	LFnfs617  	= .T.
	IF ! NetUse("nota")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF wp_flgfecha
	DO ULfecha
	RETURN
ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨                MS-DOS Window definitions                ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

IF NOT WEXIST("scgc619") ;
	OR UPPER(WTITLE("SCGC619")) == "SCGC619.PJX" ;
	OR UPPER(WTITLE("SCGC619")) == "SCGC619.SCX" ;
	OR UPPER(WTITLE("SCGC619")) == "SCGC619.MNX" ;
	OR UPPER(WTITLE("SCGC619")) == "SCGC619.PRG" ;
	OR UPPER(WTITLE("SCGC619")) == "SCGC619.FRX" ;
	OR UPPER(WTITLE("SCGC619")) == "SCGC619.QPR"
	DEFINE WINDOW scgc619 ;
		FROM INT((SROW()-16)/2),INT((SCOL()-76)/2) ;
		TO INT((SROW()-16)/2)+15,INT((SCOL()-76)/2)+75 ;
		TITLE "[ Comissionamento por Vendedor/Nota/Item]" ;
		FOOTER "[617]" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨          SCGC619/MS-DOS Setup Code - SECTION 2          ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1

******>>>> INICIO CONTROLE LOCAL




*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨              SCGC619/MS-DOS Screen Layout               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
IF WVISIBLE("scgc619")
	ACTIVATE WINDOW scgc619 SAME
ELSE
	ACTIVATE WINDOW scgc619 NOSHOW
ENDIF
@ 1,2 TO 11,72 ;
	COLOR SCHEME 23
@ 11,3 TO 11,71 ;
	COLOR SCHEME 24
@ 11,72 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,72 TO 10,72 ;
	COLOR SCHEME 24
@ 1,72 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,0 TO 15,75 ;
	COLOR SCHEME 23
@ 15,1 TO 15,74 ;
	COLOR SCHEME 24
@ 15,75 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,75 TO 14,75 ;
	COLOR SCHEME 24
@ 0,75 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 12,6 TO 14,22 ;
	COLOR SCHEME 24
@ 14,7 TO 14,21 ;
	COLOR SCHEME 23
@ 13,22 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 14,22 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,22 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,29 TO 14,45 ;
	COLOR SCHEME 24
@ 14,30 TO 14,44 ;
	COLOR SCHEME 23
@ 13,45 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 14,45 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,45 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,52 TO 14,68 ;
	COLOR SCHEME 24
@ 14,53 TO 14,67 ;
	COLOR SCHEME 23
@ 13,68 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 14,68 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,68 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 8,15 SAY "-" ;
	SIZE 1,1, 0
@ 8,48 SAY "-" ;
	SIZE 1,1, 0
@ 7,10 TO 9,31 ;
	COLOR SCHEME 23
@ 9,11 TO 9,30 ;
	COLOR SCHEME 24
@ 9,31 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 8,31 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 7,31 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 7,11 SAY "[Vendedor Inicial]" ;
	SIZE 1,18, 0
@ 7,43 TO 9,64 ;
	COLOR SCHEME 23
@ 9,44 TO 9,63 ;
	COLOR SCHEME 24
@ 9,64 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 8,64 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 7,64 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 7,44 SAY "[Vendedor Final]" ;
	SIZE 1,16, 0
@ 2,7 TO 4,25 ;
	COLOR SCHEME 23
@ 4,8 TO 4,24 ;
	COLOR SCHEME 24
@ 4,25 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,25 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,25 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,17 SAY "[ Extrato de Vendas - Vendedor / Periodo ]" ;
	SIZE 1,42, 0
@ 0,68 SAY "[619]" ;
	SIZE 1,5, 0
@ 2,9 SAY "[Mes Referencia]" ;
	SIZE 1,16, 0
@ 3,13 GET m.mes_ref ;
	SIZE 1,7 ;
	DEFAULT " " ;
	PICTURE "99.9999" ;
	WHEN isediting ;
	VALID _2lx0ou9hd() ;
	MESSAGE "Data Final deve ser maior ou igual a Inicial"
@ 8,11 GET m.vendini ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID _2lx0ou9hi() ;
	ERROR "Usuario nao Cadastrado no sistema"
@ 8,16 GET m.nomeini ;
	SIZE 1,15 ;
	DEFAULT " " ;
	WHEN .F.
@ 8,44 GET m.vendfim ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID _2lx0ou9hm() ;
	ERROR "Usuario nao Cadastrado no sistema"
@ 8,49 GET m.nomefim ;
	SIZE 1,15 ;
	DEFAULT " " ;
	WHEN .F.
@ 13,10 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 13,33 GET m.imp_btn ;
	PICTURE "@*HN \<Imprime" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _2lx0ou9hq() ;
	DISABLE
@ 13,57 GET exit_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _2lx0ou9jj()

IF NOT WVISIBLE("scgc619")
	ACTIVATE WINDOW scgc619
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨     MS-DOSREAD contains clauses from SCREEN scgc619     ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

READ CYCLE ;
	NOLOCK

RELEASE WINDOW scgc619

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨               SCGC619/MS-DOS Cleanup Code               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
DO ULfecha
RETURN



*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨   SCGC619/MS-DOS Supporting Procedures and Functions    ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
PROCEDURE ULfecha
	IF LFemp617  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	IF LFusr617  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("usuario")
	ENDIF
	IF LFnfs617  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("nota")
	ENDIF
	IF LFitc617  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("itcomiss")
	ENDIF
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(LS617areant)
		SELECT &LS617areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
RETURN

PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	LN_prxobj = _CUROBJ
	SHOW GET wp_empresa
	SHOW GET wp_nome_emp
    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.imp_btn DISABLE
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn ENABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn DISABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN




*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OU9HD           m.mes_ref VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC619,     Record Number:   49   ╨
*       ╨ Variable:            m.mes_ref                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      1                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0ou9hd     &&  m.mes_ref VALID
#REGION 1
SELECT nota
SET ORDER TO TAG data
RETURN(.t.)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OU9HI           m.vendini VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC619,     Record Number:   50   ╨
*       ╨ Variable:            m.vendini                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      2                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0ou9hi     &&  m.vendini VALID
#REGION 1
IF m.vendini = 0
	m.nomeini  = "PRIMEIRO"
	SHOW GET m.vendini
	SHOW GET m.nomeini
	RETURN .T.
ENDIF	

SELECT usuario
SET ORDER TO TAG usuario
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() =  27
		SELECT nota
		RETURN .F.
	ENDIF
ELSE
	IF !SEEK(m.vendini)
		SELECT nota
		RETURN .F.
	ENDIF
ENDIF
m.vendini  = usuario.usuario
m.nomeini  = usuario.nome
SHOW GET m.vendini
SHOW GET m.nomeini
RETURN .T.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OU9HM           m.vendfim VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC619,     Record Number:   52   ╨
*       ╨ Variable:            m.vendfim                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      3                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0ou9hm     &&  m.vendfim VALID
#REGION 1
IF m.vendfim = 0 or m.vendfim = 9999
	m.vendfim = 9999
	m.nomefim  = "ULTIMO"
	SHOW GET m.vendfim
	SHOW GET m.nomefim
	RETURN .T.
ENDIF	
SELECT usuario
SET ORDER TO TAG usuario
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() =  27
		SELECT nota
		RETURN .F.
	ENDIF
ELSE
	IF !SEEK(m.vendfim)
		SELECT nota
		RETURN .F.
	ENDIF
ENDIF
m.vendfim  = usuario.usuario
m.nomefim  = usuario.nome
SHOW GET m.vendfim
SHOW GET m.nomefim
RETURN .T.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OU9HQ           m.imp_btn VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC619,     Record Number:   55   ╨
*       ╨ Variable:            m.imp_btn                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      4                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*



FUNCTION _2lx0ou9hq     &&  m.imp_btn VALID
#REGION 1
  m.dt_inicio = CTOD("01."+m.mes_ref)
  m.dt_fim    = CTOD("01."+m.mes_ref)
  m.dt_inicio = GOMONTH(m.dt_inicio,-5)
  m.dt_fim    = GOMONTH(m.dt_fim,+1) - 1

  MES0 = MONTH(m.dt_fim) - 5
  IF MES0 <= 0
  	MES0 = MES0 + 12
  ENDIF

  MES1 = MONTH(m.dt_fim) - 4
  IF MES1 <= 0
  	MES1 = MES1 + 12
  ENDIF

  MES2 = MONTH(m.dt_fim) - 3
  IF MES2 <= 0
  	MES2 = MES2 + 12
  ENDIF

  MES3 = MONTH(m.dt_fim) - 2
  IF MES3 <= 0
  	MES3 = MES3 + 12
  ENDIF

  MES4 = MONTH(m.dt_fim) - 1
  IF MES4 <= 0
  	MES4 = MES4 + 12
  ENDIF

  MES5 = MONTH(m.dt_fim) - 0
  IF MES5 <= 0
  	MES5 = MES5 + 12
  ENDIF


  SELECT CM.EMPRESA,CM.DATA,CM.NOTA,CM.VENDEDOR ;
    FROM itcomiss CM;
    WHERE ;
		     CM.empresa = wp_empresa ;
         AND CM.DATA >= m.dt_inicio ;
         AND CM.DATA <= m.dt_fim ;
         AND CM.VENDEDOR >= m.vendini ;
         AND CM.VENDEDOR <= m.vendfim ;
         GROUP BY CM.EMPRESA,CM.NOTA,CM.VENDEDOR ;
    INTO CURSOR selevds


  SELECT EMP.SIGLA,EMP.nome AS EMPRESA ,;
         USR.USUARIO,USR.NOME AS VENDEDOR,NF.;
         NOME AS CLIENTE,;
		 MES0  AS MES0,;
         IIF(MONTH(CM.DATA) = MES0,TOTAL_NOTA,0000000000.00) AS VDA0,;
		 MES1  AS MES1,;
         IIF(MONTH(CM.DATA) = MES1,TOTAL_NOTA,0000000000.00) AS VDA1,;
		 MES2  AS MES2,;
         IIF(MONTH(CM.DATA) = MES2,TOTAL_NOTA,0000000000.00) AS VDA2,;
		 MES3  AS MES3,;
         IIF(MONTH(CM.DATA) = MES3,TOTAL_NOTA,0000000000.00) AS VDA3,;
		 MES4  AS MES4,;
         IIF(MONTH(CM.DATA) = MES4,TOTAL_NOTA,0000000000.00) AS VDA4,;
		 MES5  AS MES5,;
         IIF(MONTH(CM.DATA) = MES5,TOTAL_NOTA,0000000000.00) AS VDA5,;
		 IIF(MONTH(CM.DATA) <> MES5,TOTAL_NOTA,0000000000.00) AS VDATOT;
   FROM USUARIO USR,;
        EMPRESA EMP ,;
        selevds CM,;
        NOTA NF;
   WHERE ;
             NF.EMPRESA = CM.EMPRESA;
         AND NF.NOTA    = CM.NOTA;
         AND NF.CH_OPERA = "1" ;
         AND NF.STATUS <> 2 ;
         AND EMP.EMPRESA = NF.EMPRESA;
         AND USR.USUARIO = CM.VENDEDOR ;
    INTO CURSOR extr




  SELECT SIGLA,EMPRESA ,;
         USUARIO,VENDEDOR,CLIENTE,;
		 MES0  AS MES0,;
         SUM(VDA0) as VDA0,;
		 MES1  AS MES1,;
         SUM(VDA1) as VDA1,;
		 MES2  AS MES2,;
         SUM(VDA2) as VDA2,;
		 MES3  AS MES3,;
         SUM(VDA3) as VDA3,;
		 MES4  AS MES4,;
         SUM(VDA4) as VDA4,;
		 MES5  AS MES5,;
         SUM(VDA5) as VDA5,;
         SUM(VDATOT)       AS VDATOT;
   FROM extr ;
   GROUP BY VENDEDOR,CLIENTE;
   INTO CURSOR extrvds



	IF EOF()
		SELE extr
		USE
		SELE selevds
		USE
		SELE extrvds
		USE
		SELE nota
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
 		RETURN
 	ENDIF		
*******************	

*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
*******************
************************>

    LSrel = "REL619"      && relatorio padrao
    LSorienta = " WHILE LFsegue "

	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
*-----------------------------
	SELE usuario
	SET RELATION TO
	SELE selevds
	USE
	SELE extr
	USE
	SELE extrvds
	USE
	SELE nota
	SET RELATION TO
	SHOW WINDOW SCGC619 TOP
	SHOW GET m.imp_btn DISABLE



*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OU9JJ           exit_btn VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC619,     Record Number:   56   ╨
*       ╨ Variable:            exit_btn                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      5                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0ou9jj     &&  exit_btn VALID
#REGION 1
CLEAR READ
CLEAR GETS
