*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ 19/03/2009            SCGC608.SPR              11:33:53 ╨
*       ╨                                                         ╨
*       гддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╤
*       ╨                                                         ╨
*       ╨ Author's Name                                           ╨
*       ╨                                                         ╨
*       ╨ Copyright (c) 2009 Company Name                         ╨
*       ╨ Address                                                 ╨
*       ╨ City,     Zip                                           ╨
*       ╨                                                         ╨
*       ╨ Description:                                            ╨
*       ╨ This program was automatically generated by GENSCRN.    ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨          SCGC608/MS-DOS Setup Code - SECTION 1          ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
*---------------------------------------------------------------*
* OPERA ARQUIVOS :
*			EMPRESA
*			GRUPO
*		    CADTAB
*		    PRECO
* 			PROD_CMS
* OBJETIVO:	IMPRIMIR TABELA DE PRECOS
*	
*---------------------------------------------------------------*

******>>>> INICIO CONTROLE AMBIENTAL

ON KEY LABEL ESCAPE

PRIVATE isediting,isadding,isreading
PRIVATE wp_record
PRIVATE isreadonly,is2table,wzalias
PRIVATE LS608areant
LS608areant = ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.wzalias	=	SELECT()
m.isediting	=	.F.
m.isadding	=	.F.
m.isreading=	.F.
m.is2table 	= 	.F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
wp_ref_local =  .f.     && NAO POSSUI CONTROLE DE REFRESH LOCAL

m.codinicio  = " "
m.clasinicio = " "
m.descinicio = " "
m.codfim     = " "    && CODIGO FINAL INFORMADO
m.clasfim    = " "    && CLASSIFIC. DE ENCERRA ALTERACAO
m.descfim    = " "
LFemp608	= 	.F.		&& .F. => EMPRESA DEVE SER FECHADA NA SAIDA
LFgrp608	= 	.F.		&& .F. => GRUPO DEVE SER FECHADA NA SAIDA
LFpre608	= 	.F.		&& .F. => PRECO  DEVE SER FECHADA NA SAIDA
LFctb608	= 	.F.		&& .F. => CADTAB DEVE SER FECHADA NA SAIDA
LFprc608	= 	.F.		&& .F. => CADTAB DEVE SER FECHADA NA SAIDA

******>>>> INICIO CONTROLE ARQUIVOS
IF !USED("empresa")
	LFemp608	= .T.
	IF ! NetUse("empresa")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("grupo")
	LFgrp608	= .T.
	IF ! NetUse("grupo")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("preco")
	LFpre608	= .T.
	IF ! NetUse("preco")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("cadtab")
	LFctb608	= .T.
	IF ! NetUse("cadtab")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("prod_cms")
	LFprc608	= .T.
	IF ! NetUse("prod_cms")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

IF wp_flgfecha
	DO ULfecha 		&& FECHA ARQUIVOS ABERTOS
	RETURN
ENDIF
m.ordeminicio  = 0
m.ordemfim	= 0



#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨                MS-DOS Window definitions                ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

IF NOT WEXIST("scgc608") ;
	OR UPPER(WTITLE("SCGC608")) == "SCGC608.PJX" ;
	OR UPPER(WTITLE("SCGC608")) == "SCGC608.SCX" ;
	OR UPPER(WTITLE("SCGC608")) == "SCGC608.MNX" ;
	OR UPPER(WTITLE("SCGC608")) == "SCGC608.PRG" ;
	OR UPPER(WTITLE("SCGC608")) == "SCGC608.FRX" ;
	OR UPPER(WTITLE("SCGC608")) == "SCGC608.QPR"
	DEFINE WINDOW scgc608 ;
		FROM INT((SROW()-14)/2),INT((SCOL()-73)/2) ;
		TO INT((SROW()-14)/2)+13,INT((SCOL()-73)/2)+72 ;
		TITLE "[ Imprime Tabela de Class. Comissao ]" ;
		FOOTER "[608]" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨          SCGC608/MS-DOS Setup Code - SECTION 2          ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1

******>>>> INICIO CONTROLE LOCAL

DO CASE
	CASE !wp_flgfecha
		*-------------------------> criado pelo wizard
		m.wzalias=SELECT()
		m.isreadonly=IIF(ISREAD(),.T.,.F.)
		SELE GRUPO
ENDCASE



*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨              SCGC608/MS-DOS Screen Layout               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
IF WVISIBLE("scgc608")
	ACTIVATE WINDOW scgc608 SAME
ELSE
	ACTIVATE WINDOW scgc608 NOSHOW
ENDIF
@ 3,8 SAY "-" ;
	SIZE 1,1, 0
@ 0,0 TO 13,72 ;
	COLOR SCHEME 23
@ 13,1 TO 13,72 ;
	COLOR SCHEME 24
@ 13,72 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,72 TO 12,72 ;
	COLOR SCHEME 24
@ 10,2 TO 12,18 ;
	COLOR SCHEME 24
@ 12,3 TO 12,17 ;
	COLOR SCHEME 23
@ 11,18 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,18 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,18 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,27 TO 12,43 ;
	COLOR SCHEME 24
@ 12,28 TO 12,42 ;
	COLOR SCHEME 23
@ 11,43 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,43 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,43 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,52 TO 12,68 ;
	COLOR SCHEME 24
@ 12,53 TO 12,67 ;
	COLOR SCHEME 23
@ 11,68 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 12,68 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 10,68 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 0,3 SAY "[Impressao Tabela de Produtos com Classificao de Comissao]" ;
	SIZE 1,58, 0
@ 0,65 SAY "[608]" ;
	SIZE 1,5, 0
@ 2,2 TO 4,23 ;
	COLOR SCHEME 23
@ 4,3 TO 4,22 ;
	COLOR SCHEME 24
@ 4,23 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,23 SAY "Ё" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,23 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,3 SAY "[Tabela]" ;
	SIZE 1,8, 0
@ 2,14 SAY "[Filial]" ;
	SIZE 1,8, 0
@ 5,2 TO 8,64 ;
	COLOR SCHEME 23
@ 8,3 TO 8,63 ;
	COLOR SCHEME 24
@ 5,64 SAY "©" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,64 TO 7,64 ;
	COLOR SCHEME 24
@ 8,64 SAY "ы" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,3 SAY "[Intervalo Produtos]" ;
	SIZE 1,20, 0
@ 3,5 GET m.tbbase ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN _2lx0oscgc() ;
	VALID _2lx0oscge() ;
	MESSAGE "<TAB> = Zoom  ;  <ESC> = Sai " ;
	ERROR "Codigo de Tabela Nao Confere."
@ 3,9 GET m.sbase ;
	SIZE 1,1 ;
	DEFAULT " " ;
	WHEN _2lx0oscgi() ;
	VALID _2lx0oscgk()
@ 3,16 GET m.empbase ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN isediting ;
	VALID _2lx0oscgo() ;
	MESSAGE "<TAB> = Zoom  ;  <ESC> = Sai " ;
	ERROR "Codigo de Tabela Nao Confere."
@ 6,3 GET m.codinicio ;
	SIZE 1,16 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN _2lx0oscgp() ;
	VALID _2lx0oscgu() ;
	ERROR wp_msg
@ 6,36 GET m.codfim ;
	SIZE 1,16 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN _2lx0oscgy() ;
	VALID _2lx0osch1() ;
	ERROR wp_msg
@ 7,9 GET m.descinicio ;
	SIZE 1,22 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN .f.
@ 7,39 GET m.descfim ;
	SIZE 1,24 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN .f.
@ 11,5 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 11,31 GET m.imp_btn ;
	PICTURE "@*HN \<Imprime" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID _2lx0osch5() ;
	DISABLE
@ 11,57 GET exit_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _2lx0oschd()

IF NOT WVISIBLE("scgc608")
	ACTIVATE WINDOW scgc608
ENDIF

READ CYCLE

RELEASE WINDOW scgc608

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨               SCGC608/MS-DOS Cleanup Code               ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
DO ULfecha
ON KEY LABEL ESCAPE
SET FORMAT TO
RETURN

*-------------------->>>>>>>>>


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨   SCGC608/MS-DOS Supporting Procedures and Functions    ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

#REGION 1
PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	LN_prxobj = _CUROBJ
    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.imp_btn DISABLE
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn ENABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn DISABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN


PROCEDURE ULfecha
	IF LFctb608		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("cadtab")
	ENDIF
	IF LFpre608		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("preco")
	ENDIF
	IF LFemp608		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	IF LFgrp608		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("grupo")
	ENDIF
	IF LFprc608		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("prod_cms")
	ENDIF
RETURN

FUNCTION ULlecodigo  && RETORNA O NOME DO CODIGO INFORMADO GRUPO//SUBGRUPO
PARAMETERS LScdg
	LSalias = ALIAS()

	SELE GRUPO
	LNrgtmp = RECNO()
	SET ORDER TO classifica
	SEEK LScdg
	LSnome = grupo.descricao
	SET ORDER TO ordem
	GO LNrgtmp
	
	SELE &LSalias
RETURN(LSnome)

FUNCTION ULcol  && RETORNA A DESCRICAO CONFORME A COLUNA INFORMADA
PARAMETERS LScoluna
	_PLENGTH = 9999
	IF LScoluna = 1
		LSdesc = &wl_arqtb1 .descricao
	ELSE
		LSdesc = &wl_arqtb2 .descricao
	ENDIF
RETURN(LSdesc)


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OSCGC           m.tbbase WHEN                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC608,     Record Number:   37   ╨
*       ╨ Variable:            m.tbbase                           ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      1                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0oscgc     &&  m.tbbase WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OSCGE           m.tbbase VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC608,     Record Number:   37   ╨
*       ╨ Variable:            m.tbbase                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      2                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

FUNCTION _2lx0oscge     &&  m.tbbase VALID
#REGION 1
SELECT cadtab
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.,""
   m.tbbase = cadtab.tabela
   m.sbase  = cadtab.serie
   SHOW GET  m.tbbase
   SHOW GET  m.sbase
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
ENDIF
RETURN .T.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OSCGI           m.sbase WHEN                       ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC608,     Record Number:   38   ╨
*       ╨ Variable:            m.sbase                            ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      3                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0oscgi     &&  m.sbase WHEN
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OSCGK           m.sbase VALID                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC608,     Record Number:   38   ╨
*       ╨ Variable:            m.sbase                            ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      4                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0oscgk     &&  m.sbase VALID
#REGION 1
IF SEEK(STR(m.tbbase,3)+m.sbase)
   SHOW GET  m.tbbase
   SHOW GET  m.sbase
   RETURN .T.
ENDIF
_CUROBJ = 1
RETURN .T.

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OSCGO           m.empbase VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC608,     Record Number:   39   ╨
*       ╨ Variable:            m.empbase                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      5                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*

FUNCTION _2lx0oscgo     &&  m.empbase VALID
#REGION 1
SELECT empresa
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   m.empbase = empresa.empresa
   SHOW GET  m.empresa
ELSE
	SET ORDER TO TAG empresa
	IF SEEK(m.empbase)
   	   m.empbase = empresa.empresa
	   SHOW GET  m.empbase
	ELSE
	   RETURN .F.
	ENDIF
ENDIF
RETURN .T.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OSCGP           m.codinicio WHEN                   ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC608,     Record Number:   40   ╨
*       ╨ Variable:            m.codinicio                        ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      6                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0oscgp     &&  m.codinicio WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting or isreading)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OSCGU           m.codinicio VALID                  ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC608,     Record Number:   40   ╨
*       ╨ Variable:            m.codinicio                        ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      7                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0oscgu     &&  m.codinicio VALID
#REGION 1
IF EMPTY(m.codinicio) AND LASTKEY() <> 9
    m.ordeminicio  = 1
	m.clasinicio  = " "
	m.descinicio  =   "PRIMEIRO"
	SHOW GET  m.descinicio
	RETURN(.T.)
ENDIF
SELE grupo
SET ORDER TO TAG codigo
SET NEAR ON
SEEK ALLTRIM(m.codinicio)
SET NEAR OFF
*----------------------------------------------------------*
SELECT grupo
ON KEY LABEL ESCAPE
IF LASTKEY() = 9
	SET ORDER TO TAG ordem
	ON KEY LABEL ESCAPE
	DO loc_dlog WITH .T.
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
	IF LASTKEY() = 27
		RETURN .F.
	ENDIF
ENDIF
m.ordeminicio  = grupo.ordem
m.descinicio   = grupo.descricao
*******
SHOW GET  m.codinicio
SHOW GET  m.descinicio
RETURN .t.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OSCGY           m.codfim WHEN                      ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC608,     Record Number:   41   ╨
*       ╨ Variable:            m.codfim                           ╨
*       ╨ Called By:           WHEN Clause                        ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      8                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0oscgy     &&  m.codfim WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting or isreading)

*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OSCH1           m.codfim VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC608,     Record Number:   41   ╨
*       ╨ Variable:            m.codfim                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Field                              ╨
*       ╨ Snippet Number:      9                                  ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0osch1     &&  m.codfim VALID
#REGION 1
IF EMPTY(m.codfim) AND LASTKEY() <> 9
    m.ordemfim  =    999999999

	m.clasfim 	= 	REPL("9",15)
	m.descfim   =   "ULTIMO"
	SHOW GET  m.descfim
	RETURN(.T.)
ENDIF
SELE grupo
SET ORDER TO TAG codigo
SET NEAR ON
SEEK ALLTRIM(m.codfim)
SET NEAR OFF
*----------------------------------------------------------*
SELECT grupo
ON KEY LABEL ESCAPE
IF LASTKEY() = 9
	SET ORDER TO TAG ordem
	ON KEY LABEL ESCAPE
	DO loc_dlog WITH .T.
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
	IF LASTKEY() = 27
		RETURN .F.
	ENDIF
ENDIF
m.ordemfim  = grupo.ordem
m.descfim   = grupo.descricao
*******
SHOW GET  m.codfim
SHOW GET  m.descfim
RETURN .t.


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OSCH5           m.imp_btn VALID                    ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC608,     Record Number:   45   ╨
*       ╨ Variable:            m.imp_btn                          ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      10                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0osch5     &&  m.imp_btn VALID
#REGION 1
    PRIVATE Larqgrupo,LarqPreco,LarqPromocao,LarqProdCms


    LarqGrupo    = UPobterPath("GRUPO")+"GRUPO.DBF"
    LarqPreco    = UPobterPath("PRECO")+"PRECO.DBF"
    LarqPromocao = UPobterPath("PROMOCAO")+"PROMOCAO.DBF"
    LarqProdCms  = UPobterPath("PROD_CMS")+"PROD_CMS.DBF"



	SELE EMPRESA
	SET ORDER TO TAG empresa
	SEEK m.empbase


    *------------------------------------------------------------*
    *    Uma Filial Pode utilizar a TABELA DE PRECOS de outra filial
    * por este motivo a (LNempReferencia) seleciona a tabela de
    * precos conforme a referencia do registro da empresa que se
    * deseja obter a tabela *
    *
    *    EX: Deseja-se a tebela da filial W-3 =>
    *
    *     W-3----->EMPTAB(USA TABELA DE PRECOS)------> SIA = LNempReferencia
    *      |
    *       ------>PROMOCAO(CADA FILIAL TEM A SUA)---> W-3 = m.empbase
    *
    *----------------------------------------------------------------


	LNempReferencia = empresa.emptab && BUSCA A TABELA DA EM
									 && PRESA DE REFERENCIA



    wl_tmp =  STRTRAN(STR(m.empbase,3),' ','0')

    SELECT GR.ORDEM,GR.cdg_tipo,GR.CODIGO,GR.CLASSIFICA,GR.DESCRICAO ;
         FROM &LarqGrupo GR ;
         WHERE    GR.cdg_tipo = 4 ;
              AND wl_tmp $ GR.tab_preco ;
	    	  AND GR.ORDEM > m.ordeminicio ;
	    	  AND GR.ORDEM < m.ordemfim;
         INTO CURSOR TMPGRUPO ;
         ORDER BY GR.ORDEM

    SELECT TMPGRUPO
	IF EOF()
		USE
		WAIT WINDOW 'NAO EXISTEM DADOS  PARA PROCESSO.'
		SHOW GET m.imp_btn DISABLE
		RETURN
	ENDIF
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SELECT TMPGRUPO

	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()

    COUNT TO   LNimpressao

	LNimpressos = 0

	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
    SELECT "* Promocao *" AS PROMOCAO, GR.*, PR.PRECO,PR.CLAS_CMS,;
            PRM.desc_varej,PRM.desc_frota,PRM.desc_reven,PRM.desc_ppubl;
        FROM TMPGRUPO      GR,;
             &LarqPreco    PR,;
             &LarqPromocao PRM       ;
        WHERE ;
                   GR.codigo       = PR.codigo;
               AND LNempReferencia = PR.EMPRESA;
               AND m.tbbase        = PR.TABPRECO;
               AND m.sbase         = PR.SERIE;
              ;
               AND m.empbase       = PRM.EMPRESA    ;
               AND GR.codigo       = PRM.codigo ;
               AND PRM.DT_INICIO  <= DATE()   ;
               AND PRM.DT_FIM     >= DATE()  ;
        INTO CURSOR TMPPROMO


    SELECT "            " AS PROMOCAO, GR.*, PR.PRECO,PR.CLAS_CMS,;
            cms.desc_varej,cms.desc_frota,cms.desc_reven,cms.desc_ppubl;
        FROM TMPGRUPO GR,;
             &LarqPreco    PR,;
             &LarqProdCms CMS ;
        WHERE ;
                   GR.codigo       = PR.codigo;
               AND LNempReferencia = PR.EMPRESA;
               AND m.tbbase        = PR.TABPRECO;
               AND m.sbase         = PR.SERIE;
               AND m.empbase       = CMS.EMPRESA;
               AND m.tbbase        = CMS.TABPRECO;
               AND m.sbase         = CMS.SERIE;
               AND PR.clas_cms     = CMS.CODIGO;
               AND CMS.NIVEL       = 0;
               AND GR.CODIGO  not IN (SELECT CODIGO FROM TMPPROMO);
        INTO CURSOR TMPPRECO


       SELECT * FROM TMPPRECO UNION SELECT * FROM TMPPROMO ;
        INTO CURSOR TMPPRINT



       SELECT * FROM TMPPRINT ORDER BY ORDEM INTO CURSOR TMP_REL

**************************>>> REGISTRO DE SAIDAS
    LSrel = "REL608"      && relatorio para classificacao de comissao
    LSorienta = "FOR  LFsegue "
***********
	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
***********
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
*-----------------------------
    =UP_fecha("TMPGRUPO")
    =UP_fecha("TMPPROMO")
    =UP_fecha("TMPPRECO")
    =UP_fecha("TMPPRINT")
    =UP_fecha("TMP_REL")

    SELECT GRUPO
    SET PRINTER TO SET('PRINTER',1)
	SET RELATION TO
	SET POINT TO
	SET SEPARATOR  TO

	SHOW WINDOW SCGC608 TOP
	SHOW GET m.imp_btn DISABLE

RETURN


*       жддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥
*       ╨                                                         ╨
*       ╨ _2LX0OSCHD           exit_btn VALID                     ╨
*       ╨                                                         ╨
*       ╨ Function Origin:                                        ╨
*       ╨                                                         ╨
*       ╨ From Platform:       MS-DOS                             ╨
*       ╨ From Screen:         SCGC608,     Record Number:   46   ╨
*       ╨ Variable:            exit_btn                           ╨
*       ╨ Called By:           VALID Clause                       ╨
*       ╨ Object Type:         Push Button                        ╨
*       ╨ Snippet Number:      11                                 ╨
*       ╨                                                         ╨
*       сддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╫
*
FUNCTION _2lx0oschd     &&  exit_btn VALID
#REGION 1
CLEAR READ
CLEAR GETS
