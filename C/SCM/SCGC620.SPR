*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º 28/09/2015            SCGC620.SPR              11:14:42 º
*       º                                                         º
*       ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
*       º                                                         º
*       º Author's Name                                           º
*       º                                                         º
*       º Copyright (c) 2015 Company Name                         º
*       º Address                                                 º
*       º City,     Zip                                           º
*       º                                                         º
*       º Description:                                            º
*       º This program was automatically generated by GENSCRN.    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC620/MS-DOS Setup Code - SECTION 1          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
***************
*~ WIZARDSCREEN

*---------------------------------------------------------------------*
* ARQUIVOS UTILIZADOS :                                               *
*
*
* OBJETIVOS : COMISSIONAMENTO POR VENDEDOR/NOTA/ITEM
*	
*---------------------------------------------------------------------*
******>>>> INICIO CONTROLE AMBIENTAL

ON KEY LABEL ESCAPE

PRIVATE isediting,isadding,isreading
PRIVATE wp_record
PRIVATE isreadonly,is2table,wzalias
PRIVATE LS617areant
LS617areant	= ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.wzalias	=	SELECT()
m.isediting	=	.F.
m.isadding	=	.F.
m.isreading =   .f.
m.is2table 	= 	.F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
wp_ref_local =  .f.     && NAO POSSUI CONTROLE DE REFRESH LOCAL

LFfun617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFtab617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFusr617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFemp617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFnfs617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFitc617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFitm617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFgrp617  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA

******>>>> INICIO CONTROLE ARQUIVOS

*>> parametros repassados a btn_val

VLleitura = ""    && repassa chave de leitura p/ btn_val
VLlerfim  = ""    && repassa chave de leitura p/ btn_val ultimo + 1 REG)
VLcompara = ""    && repassa chave de comparacao p/ btn_val
VLchvlimi = ""    && repassa chave de leitura p/ btn_val



**************

m.clasinicio = ""
m.clasfim 	 = ""

M.MARCA_INI = 0
M.MARCA_FIN = 99

m.Emp_Ini    = 0
m.Emp_Fin    = 999


**************


IF !USED("empresa")
	LFemp617  	= .T.
	IF ! NetUse("empresa")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("usuario")
	LFusr617  	= .T.
	IF ! NetUse("usuario")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("itcomiss")
	LFitc617  	= .T.
	IF ! NetUse("itcomiss")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

IF !USED("itemmov")
	LFitm617  	= .T.
	IF ! NetUse("itemmov")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

IF !USED("nota")
	LFnfs617  	= .T.
	IF ! NetUse("nota")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

IF !USED("marca")
	LFmarfecha	= .T.
	IF ! NetUse("marca")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF


IF !USED("funcao")
	LFfun609  	= .T.
	IF ! NetUse("funcao")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

IF !USED("grup_cms")
	LFgru609  	= .T.
	IF ! NetUse("grup_cms")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF

IF !USED("TABFORN")
	LFtbforn09  	= .T.
	IF ! NetUse("tabforn")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF


IF !USED("grupo")
	LFgrp609  	= .T.
	IF ! NetUse("grupo")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF


IF wp_flgfecha
	DO ULfecha
	RETURN
ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                MS-DOS Window definitions                º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

IF NOT WEXIST("scgc620") ;
	OR UPPER(WTITLE("SCGC620")) == "SCGC620.PJX" ;
	OR UPPER(WTITLE("SCGC620")) == "SCGC620.SCX" ;
	OR UPPER(WTITLE("SCGC620")) == "SCGC620.MNX" ;
	OR UPPER(WTITLE("SCGC620")) == "SCGC620.PRG" ;
	OR UPPER(WTITLE("SCGC620")) == "SCGC620.FRX" ;
	OR UPPER(WTITLE("SCGC620")) == "SCGC620.QPR"
	DEFINE WINDOW scgc620 ;
		FROM INT((SROW()-25)/2),INT((SCOL()-76)/2) ;
		TO INT((SROW()-25)/2)+24,INT((SCOL()-76)/2)+75 ;
		TITLE "[ Extrato de Vendas de produtos por Vendedor/Nota/Item]" ;
		FOOTER "[620]" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC620/MS-DOS Setup Code - SECTION 2          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1

******>>>> INICIO CONTROLE LOCAL




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC620/MS-DOS Screen Layout               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
IF WVISIBLE("scgc620")
	ACTIVATE WINDOW scgc620 SAME
ELSE
	ACTIVATE WINDOW scgc620 NOSHOW
ENDIF
@ 0,0 TO 24,75 ;
	COLOR SCHEME 23
@ 24,1 TO 24,74 ;
	COLOR SCHEME 24
@ 24,75 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,75 TO 23,75 ;
	COLOR SCHEME 24
@ 0,75 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 20,2 TO 22,14 ;
	COLOR SCHEME 24
@ 22,3 TO 22,13 ;
	COLOR SCHEME 23
@ 21,14 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 22,14 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 20,14 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 20,17 TO 22,33 ;
	COLOR SCHEME 24
@ 22,18 TO 22,32 ;
	COLOR SCHEME 23
@ 21,33 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 22,33 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 20,33 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 20,55 TO 22,71 ;
	COLOR SCHEME 24
@ 22,56 TO 22,70 ;
	COLOR SCHEME 23
@ 21,71 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 22,71 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 20,71 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 6,15 SAY "-" ;
	SIZE 1,1, 0
@ 6,48 SAY "-" ;
	SIZE 1,1, 0
@ 5,10 TO 7,31 ;
	COLOR SCHEME 23
@ 7,11 TO 7,30 ;
	COLOR SCHEME 24
@ 7,31 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,31 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,31 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,11 SAY "[Vendedor Inicial]" ;
	SIZE 1,18, 0
@ 5,43 TO 7,64 ;
	COLOR SCHEME 23
@ 7,44 TO 7,63 ;
	COLOR SCHEME 24
@ 7,64 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 6,64 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,64 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 5,44 SAY "[Vendedor Final]" ;
	SIZE 1,16, 0
@ 0,7 SAY "[ Extrato de Vendas de produtos - Vendedor / Periodo ]" ;
	SIZE 1,54, 0
@ 0,68 SAY "[620]" ;
	SIZE 1,5, 0
@ 13,14 SAY "-" ;
	SIZE 1,1, 0
@ 12,10 TO 14,31 ;
	COLOR SCHEME 23
@ 14,11 TO 14,30 ;
	COLOR SCHEME 24
@ 14,31 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 13,31 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 12,31 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 12,11 SAY "[Marca]" ;
	SIZE 1,7, 0
@ 17,22 SAY "a" ;
	SIZE 1,1, 0
@ 16,10 TO 18,34 ;
	COLOR SCHEME 23
@ 18,11 TO 18,33 ;
	COLOR SCHEME 24
@ 16,11 SAY "[ Periodo ]" ;
	SIZE 1,11, 0
@ 8,10 TO 11,60 ;
	COLOR SCHEME 23
@ 11,11 TO 11,59 ;
	COLOR SCHEME 24
@ 8,60 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 9,60 TO 10,60 ;
	COLOR SCHEME 24
@ 11,60 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 8,26 SAY "[Intervalo Produtos]" ;
	SIZE 1,20, 0
@ 3,16 SAY "-" ;
	SIZE 1,1, 0
@ 2,10 TO 4,38 ;
	COLOR SCHEME 23
@ 4,11 TO 4,37 ;
	COLOR SCHEME 24
@ 4,38 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,38 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,38 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,11 SAY "[Filial]" ;
	SIZE 1,8, 0
@ 2,20 SAY "[999-todas]" ;
	SIZE 1,11, 0
@ 3,13 GET m.empresa ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN _4gg0o3o60() ;
	VALID _4gg0o3o6a()
@ 3,17 GET m.nome_emp ;
	SIZE 1,20 ;
	DEFAULT " " ;
	PICTURE "@!K" ;
	WHEN _4gg0o3o6i()
@ 6,11 GET m.vendini ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID _4gg0o3o6o() ;
	ERROR "Usuario nao Cadastrado no sistema"
@ 6,16 GET m.nomeini ;
	SIZE 1,15 ;
	DEFAULT " " ;
	WHEN .F.
@ 6,44 GET m.vendfim ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID _4gg0o3o6u() ;
	ERROR "Usuario nao Cadastrado no sistema"
@ 6,49 GET m.nomefim ;
	SIZE 1,15 ;
	DEFAULT " " ;
	WHEN .F.
@ 9,11 GET m.codinicio ;
	SIZE 1,16 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN _4gg0o3o6z() ;
	VALID _4gg0o3o8n() ;
	ERROR wp_msg
@ 9,35 GET m.codfim ;
	SIZE 1,16 ;
	DEFAULT " " ;
	PICTURE "&masc_codi" ;
	WHEN _4gg0o3o8u() ;
	VALID _4gg0o3o8v() ;
	ERROR wp_msg
@ 10,12 GET m.descinicio ;
	SIZE 1,22 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN .f.
@ 10,36 GET m.descfim ;
	SIZE 1,24 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN .f.
@ 13,11 GET m.marca ;
	SIZE 1,2 ;
	DEFAULT 0 ;
	PICTURE "99" ;
	WHEN isediting ;
	VALID _4gg0o3o8w() ;
	ERROR "Usuario nao Cadastrado no sistema"
@ 13,16 GET m.marcdesc ;
	SIZE 1,15 ;
	DEFAULT " " ;
	WHEN .F.
@ 17,11 GET m.dt_inicio ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _4gg0o3o8x() ;
	VALID _4gg0o3o8y()
@ 17,24 GET m.dt_fim ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN isediting ;
	VALID _4gg0o3o8z() ;
	MESSAGE "Data Final deve ser maior ou igual a Inicial"
@ 21,4 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 21,18 GET m.imp_btn ;
	PICTURE "@*HN \<Rel.Analitico" ;
	SIZE 1,15,1 ;
	DEFAULT 1 ;
	VALID _4gg0o3o90() ;
	DISABLE
@ 21,60 GET exit_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _4gg0o3o91()
@ 20,37 TO 22,53 ;
	COLOR SCHEME 24
@ 22,38 TO 22,52 ;
	COLOR SCHEME 23
@ 21,53 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 22,53 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 20,53 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 21,38 GET m.impsint_btn ;
	PICTURE "@*HN \<Rel.Sintetico" ;
	SIZE 1,15,1 ;
	DEFAULT 1 ;
	VALID _4gg0o3o9h() ;
	DISABLE

IF NOT WVISIBLE("scgc620")
	ACTIVATE WINDOW scgc620
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º     MS-DOSREAD contains clauses from SCREEN scgc620     º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

READ CYCLE ;
	NOLOCK

RELEASE WINDOW scgc620

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º               SCGC620/MS-DOS Cleanup Code               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
DO ULfecha
RETURN



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º   SCGC620/MS-DOS Supporting Procedures and Functions    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
PROCEDURE ULfecha
	IF LFemp617  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	IF LFusr617  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("usuario")
	ENDIF
	IF LFnfs617  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("nota")
	ENDIF
	IF LFitc617  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("itcomiss")
	ENDIF
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(LS617areant)
		SELECT &LS617areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
RETURN

PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	LN_prxobj = _CUROBJ
	SHOW GET wp_empresa
	SHOW GET wp_nome_emp
    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.imp_btn DISABLE
			SHOW GET m.impsint_btn DISABLE
			
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn ENABLE
			SHOW GET m.impsint_btn ENABLE

		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn DISABLE
			SHOW GET m.impsint_btn DISABLE

		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN


****************************************************

FUNCTION ULGeraTmp

  sele tabforn
  set order to tag tabela



  SELECT CM.EMPRESA;
  		,CM.DTFAT    AS DATA;
  		,CM.NOTA;
  		,CM.OPERADOR AS VENDEDOR ;
  		,CM.CODIGO ;
  		,CM.CLASSIFICA ;
  		,CM.QTDE ;
  		,CM.CH_OPERA AS MOTIVO ;
  		,CM.VLRVENDA AS VALOR ;
    FROM itemmov CM;
    WHERE ;
		     CM.empresa >= m.Emp_Ini ;
		 AND CM.empresa <= m.Emp_Fin ;
         AND CM.DTFAT >= m.dt_inicio ;
         AND CM.DTFAT <= m.dt_fim ;
         AND CM.OPERADOR >= m.vendini ;
         AND CM.OPERADOR <= m.vendfim ;
         AND CM.CH_OPERA  = "1" ;
         AND LEFT(CM.OPERACAO,1) = "S" ;
         GROUP BY CM.EMPRESA,CM.OPERADOR,CM.NOTA,CM.CODIGO ;
    INTO CURSOR selevds


*  CM.vinculo  = 1  && vendedor principal 2 = participoui na venda
*  CM.motivo = 1    && comissao normal 2 = comissÆo superavit



  SELECT EMP.SIGLA,;
  	     EMP.nome AS EMPRESA ,;
         USR.USUARIO,;
         USR.NOME AS VENDEDOR,;
         GR.CODFORN,;
         CM.CODIGO,;
         LEFT(CM.CLASSIFICA,2) AS GRUPO,;
         LEFT(CM.CLASSIFICA,5) AS SUBGRUPO,;
         CM.CLASSIFICA,;
         GR.DESCRICAO  AS DESCRICAO,;
         MC.DESCRICAO  AS MARCA,;
         CM.QTDE       AS VDA5,;
         CM.valor      AS VLR5;
   FROM USUARIO USR,;
        EMPRESA EMP ,;
        selevds CM,;
        grupo GR,;
        marca MC,;
        NOTA NF;
   WHERE ;
             NF.EMPRESA = CM.EMPRESA;
         AND NF.NOTA    = CM.NOTA;
         AND NF.CH_OPERA = "1" ;
         AND NF.STATUS <> 2 ;
         AND EMP.EMPRESA = NF.EMPRESA;
         AND USR.USUARIO = CM.VENDEDOR ;
         AND GR.CODIGO = CM.CODIGO;
         AND GR.MARCA >= M.MARCA_INI;
         AND GR.MARCA <= M.MARCA_FIN;
         AND GR.classifica >= m.clasinicio ;
         AND GR.classifica <= m.clasfim ;
         AND INT(VAL(LEFT(GR.classifica,2))) = MC.grupo ;
         AND GR.marca = MC.marca ;
    INTO CURSOR extr




  SELECT SIGLA,;
  		 EMPRESA ,;
         USUARIO,;
         VENDEDOR,;
	     codforn,;
         CODIGO,;
         CLASSIFICA,;
         DESCRICAO,;
         GRUPO,;
		 SUBGRUPO,;
         MARCA,;
         SUM(VDA5) as VDA5,;
         SUM(VLR5) as VLR5;
   FROM extr ;
   GROUP BY VENDEDOR,CLASSIFICA;
   ORDER BY VENDEDOR,SUBGRUPO,MARCA,CLASSIFICA;
   INTO CURSOR extrvds


   set relation to STR(CODFORN,5)+CODIGO into tabforn


  SELECT ;
         GRUPO,;
         MARCA,;
         SUM(VDA5) as VDA5,;
         SUM(VLR5) as VLR5;
   FROM extr ;
   GROUP BY ;
		 GRUPO,;
         MARCA;
   ORDER BY;
		 GRUPO,;
         MARCA;
   INTO CURSOR extrmrk





RETURN


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O60           m.empresa WHEN                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   63   º
*       º Variable:            m.empresa                          º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      1                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o60     &&  m.empresa WHEN
#REGION 1
ON KEY LABEL ESCAPE	KEYBOARD "{END}"
IF LASTKEY() = 15 AND !(isediting)
	KEYBOARD "{ESCAPE}"
ENDIF
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O6A           m.empresa VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   63   º
*       º Variable:            m.empresa                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      2                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o6a     &&  m.empresa VALID
#REGION 1
SELECT empresa
SET ORDER TO TAG empresa

IF m.empresa = 999
	m.nome_emp  = "TODAS"

	m.Emp_Ini    = 0
	m.Emp_Fin    = 999

	SHOW GET m.empresa
	SHOW GET m.nome_emp
	SELECT empresa
	RETURN .T.
endif

IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .F.
   ON KEY LABEL ESCAPE DO BTN_VAL WITH 'DELETE'
   IF LASTKEY() = 27
		SELECT empresa
		RETURN .F.
	ENDIF
ELSE
	IF !SEEK(m.empresa)
		SELECT empresa
		RETURN .F.
	ENDIF
ENDIF
m.empresa   = empresa
m.Emp_Ini    = empresa
m.Emp_Fin    = empresa

m.nome_emp  = empresa.nome
SHOW GET m.empresa
SHOW GET m.nome_emp
SELECT empresa
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O6I           m.nome_emp WHEN                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   64   º
*       º Variable:            m.nome_emp                         º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      3                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o6i     &&  m.nome_emp WHEN
#REGION 1
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(.f.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O6O           m.vendini VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   65   º
*       º Variable:            m.vendini                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      4                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o6o     &&  m.vendini VALID
#REGION 1
IF m.vendini = 0
	m.nomeini  = "PRIMEIRO"
	SHOW GET m.vendini
	SHOW GET m.nomeini
	RETURN .T.
ENDIF	

SELECT usuario
SET ORDER TO TAG usuario
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() =  27
		SELECT nota
		RETURN .F.
	ENDIF
ELSE
	IF !SEEK(m.vendini)
		SELECT nota
		RETURN .F.
	ENDIF
ENDIF
m.vendini  = usuario.usuario
m.nomeini  = usuario.nome
SHOW GET m.vendini
SHOW GET m.nomeini
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O6U           m.vendfim VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   67   º
*       º Variable:            m.vendfim                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      5                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o6u     &&  m.vendfim VALID
#REGION 1
IF m.vendfim = 0 or m.vendfim = 9999
	m.vendfim = 9999
	m.nomefim  = "ULTIMO"
	SHOW GET m.vendfim
	SHOW GET m.nomefim
	RETURN .T.
ENDIF	
SELECT usuario
SET ORDER TO TAG usuario
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   IF LASTKEY() =  27
		SELECT nota
		RETURN .F.
	ENDIF
ELSE
	IF !SEEK(m.vendfim)
		SELECT nota
		RETURN .F.
	ENDIF
ENDIF
m.vendfim  = usuario.usuario
m.nomefim  = usuario.nome
SHOW GET m.vendfim
SHOW GET m.nomefim
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O6Z           m.codinicio WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   69   º
*       º Variable:            m.codinicio                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      6                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o6z     &&  m.codinicio WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting or isreading)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O8N           m.codinicio VALID                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   69   º
*       º Variable:            m.codinicio                        º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      7                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o8n     &&  m.codinicio VALID
#REGION 1
SELE grupo

IF EMPTY(m.codinicio) AND LASTKEY() <> 9
	SET ORDER TO TAG classifica
	GO TOP
	m.clasinicio  = grupo.CLASSIFICA
	m.descinicio  =   "PRIMEIRO"
	SHOW GET  m.descinicio
	RETURN(.T.)
ENDIF
SELE grupo
SET ORDER TO TAG codigo
SET NEAR ON
SEEK ALLTRIM(m.codinicio)
SET NEAR OFF
*----------------------------------------------------------*
SELECT grupo
ON KEY LABEL ESCAPE
IF LASTKEY() = 9
	SET ORDER TO TAG classifica
	ON KEY LABEL ESCAPE
	DO loc_dlog WITH .T.
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
	IF LASTKEY() = 27
		RETURN .F.
	ENDIF
ENDIF
m.codinicio  = grupo.codigo
m.clasinicio = grupo.classifica
m.descinicio = grupo.descricao
*******
SHOW GET  m.descinicio
RETURN .t.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O8U           m.codfim WHEN                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   70   º
*       º Variable:            m.codfim                           º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      8                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o8u     &&  m.codfim WHEN
#REGION 1
ON KEY LABEL ENTER
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
RETURN(isediting or isreading)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O8V           m.codfim VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   70   º
*       º Variable:            m.codfim                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      9                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o8v     &&  m.codfim VALID
#REGION 1
SELE grupo
IF EMPTY(m.codfim) AND LASTKEY() <> 9
	SET ORDER TO TAG classifica
	GO BOTT
	m.clasfim 	= 	alltrim(grupo.classifica)+REPL("9",15)
	m.descfim   =   "ULTIMO"
	SHOW GET  m.descfim
	RETURN(.T.)
ENDIF
SELE grupo
SET ORDER TO TAG codigo
SET NEAR ON
SEEK ALLTRIM(m.codfim)
SET NEAR OFF
*----------------------------------------------------------*
SELECT grupo
ON KEY LABEL ESCAPE
IF LASTKEY() = 9
	SET ORDER TO TAG classifica
	ON KEY LABEL ESCAPE
	DO loc_dlog WITH .T.
	ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
	IF LASTKEY() = 27
		RETURN .F.
	ENDIF
ENDIF
m.codfim  = grupo.codigo
m.clasfim = grupo.classifica
m.descfim = grupo.descricao
*******
*******
SHOW GET  m.descfim
RETURN .t.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O8W           m.marca VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   73   º
*       º Variable:            m.marca                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      10                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o8w     &&  m.marca VALID
#REGION 1
select marca
SET ORDER TO TAG marca
if lastkey() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
   m.marca = marca
   m.marcdesc = descricao
   select grupo
   show get m.marca
   SHOW GET m.marcdesc
	IF LASTKEY() = 27
		RETURN .F.
	ENDIF
   return .T.
endif

IF EMPTY(m.marca) or m.marca=99
      M.MARCA_INI = 0
      M.MARCA_FIN = 99
	  m.marcdesc = "TODAS"

ELSE
      M.MARCA_INI = m.marca
      M.MARCA_FIN = m.marca
	if SEEK(STR(INT(VAL(LEFT(m.clasinicio,2))),2)+STR(m.marca,2))
	   m.marcdesc = descricao
	ENDIF
ENDIF	
select grupo
SHOW GET m.marcdesc
return .t.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O8X           m.dt_inicio WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   75   º
*       º Variable:            m.dt_inicio                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      11                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o8x     &&  m.dt_inicio WHEN
#REGION 1
IF isediting
	ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ENDIF
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O8Y           m.dt_inicio VALID                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   75   º
*       º Variable:            m.dt_inicio                        º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      12                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o8y     &&  m.dt_inicio VALID
#REGION 1
m.dt_fim = m.dt_inicio
SHOW GET m.dt_fim
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
SELECT nota
SET ORDER TO TAG data
SET NEAR ON
SEEK STR(wp_empresa,3)+DTOS(m.dt_inicio)
SET NEAR OFF
IF EOF() OR nota.empresa <> wp_empresa
	WAIT WINDOW "Nao exitem Duplicatas "
ELSE
	m.num_inicio = nota.nota
	SHOW GET m.num_inicio
ENDIF
RETURN (.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O8Z           m.dt_fim VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   76   º
*       º Variable:            m.dt_fim                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      13                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o8z     &&  m.dt_fim VALID
#REGION 1
SELECT nota
SET ORDER TO TAG data
SET NEAR ON
SEEK STR(wp_empresa,3)+DTOS(m.dt_fim+1)
SET NEAR OFF
IF m.dt_fim < nota.data OR  nota.empresa <> wp_empresa
	SKIP -1
ENDIF
IF EOF() OR nota.empresa <> wp_empresa
	m.num_fim = 999999
	SHOW GET m.num_fim
ELSE
	m.num_fim = nota.nota
	SHOW GET m.num_fim
ENDIF
RETURN(m.dt_fim >= m.dt_inicio)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O90           m.imp_btn VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   78   º
*       º Variable:            m.imp_btn                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      14                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o90     &&  m.imp_btn VALID
#REGION 1
	=ULGeraTmp()


	IF EOF()
		SELE extr
		USE
		SELE selevds
		USE
		SELE extrvds
		USE
		SELE nota
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
 		RETURN
	ENDIF		
	*******************	

	sele extrvds
	=ULimpAnalitico()
	



	*-----------------------------
	SHOW WINDOW SCGC620 TOP
	




RETURN

FUNCTION ULimpAnalitico	


*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
*******************
************************>

    LSrel = "REL620"      && relatorio padrao
    LSorienta = " WHILE LFsegue "

	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
RETURN
	


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O91           exit_btn VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   79   º
*       º Variable:            exit_btn                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      15                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o91     &&  exit_btn VALID
#REGION 1
CLEAR READ
CLEAR GETS


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _4GG0O3O9H           m.impsint_btn VALID                º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC620,     Record Number:   85   º
*       º Variable:            m.impsint_btn                      º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      16                                 º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _4gg0o3o9h     &&  m.impsint_btn VALID
#REGION 1
	=ULGeraTmp()


	IF EOF()
		SELE extr
		USE
		SELE selevds
		USE
		SELE extrvds
		USE
		SELE nota
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
 		RETURN
	ENDIF		
	*******************	

	

	sele extrmrk
	=ULimpResumo()



	*-----------------------------
	SHOW WINDOW SCGC620 TOP
	



RETURN




FUNCTION ULimpResumo





*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    LNimpressao = RECCOUNT()
	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
*******************
************************>

    LSrel = "REL620B"      && relatorio padrao
    LSorienta = " WHILE LFsegue "

	DO UPimpressao    && COORDENA TRABALHO DE IMPRESSAO
************
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
**************************>>> RESUMO POR CFO
RETURN
	

