*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º 19/03/2009            SCGC616.SPR              11:35:02 º
*       º                                                         º
*       ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶
*       º                                                         º
*       º Author's Name                                           º
*       º                                                         º
*       º Copyright (c) 2009 Company Name                         º
*       º Address                                                 º
*       º City,     Zip                                           º
*       º                                                         º
*       º Description:                                            º
*       º This program was automatically generated by GENSCRN.    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC616/MS-DOS Setup Code - SECTION 1          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
***************
*~ WIZARDSCREEN

*---------------------------------------------------------------------*
* ARQUIVOS UTILIZADOS :                                               *
*              - GRUP_CMS
*              - GRUP_VEN
*              - USUARIO
* OBJETIVOS : RELACIONAR COMISSIONADOS / NOTA / ITEM
*	
*---------------------------------------------------------------------*
******>>>> INICIO CONTROLE AMBIENTAL

ON KEY LABEL ESCAPE

PRIVATE isediting,isadding,isreading
PRIVATE wp_record
PRIVATE isreadonly,is2table,wzalias
PRIVATE LS616areant
LS616areant	= ALLTRIM(ALIAS()) && PERMITE RETORNAR A AREA ANTER. A CHAMADA

m.wzalias	=	SELECT()
m.isediting	=	.F.
m.isadding	=	.F.
m.isreading =   .f.
m.is2table 	= 	.F.
wp_flgfecha = 	.F. 		&& defaut nao fechamento da secao
WP_RECORD 	= 	0
wp_ref_local =  .f.     && NAO POSSUI CONTROLE DE REFRESH LOCAL

LFitm616  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFusr616  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFemp616  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFnfs616  	= 	.F.		&& .F. =>  DEVE SER FECHADA NA SAIDA
LFgrv616  	=   .f.
LFctb616  	=   .f.

******>>>> INICIO CONTROLE ARQUIVOS

*>> parametros repassados a btn_val

VLleitura = ""    && repassa chave de leitura p/ btn_val
VLlerfim  = ""    && repassa chave de leitura p/ btn_val ultimo + 1 REG)
VLcompara = ""    && repassa chave de comparacao p/ btn_val
VLchvlimi = ""    && repassa chave de leitura p/ btn_val

IF !USED("cadtab")
	LFctb616  	= .T.
	IF ! NetUse("cadtab")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("empresa")
	LFemp616  	= .T.
	IF ! NetUse("empresa")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("itemmov")
	LFitm616  	= .T.
	IF ! NetUse("itemmov")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("usuario")
	LFusr616  	= .T.
	IF ! NetUse("usuario")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("grup_ven")
	LFgrv616  	= .T.
	IF ! NetUse("grup_ven")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF !USED("nota")
	LFnfs616  	= .T.
	IF ! NetUse("nota")
		wp_flgfecha = .t.  && implica no fechamento da secao
	ENDIF
ENDIF
IF wp_flgfecha
	DO ULfecha
	RETURN
ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º                MS-DOS Window definitions                º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

IF NOT WEXIST("scgc616") ;
	OR UPPER(WTITLE("SCGC616")) == "SCGC616.PJX" ;
	OR UPPER(WTITLE("SCGC616")) == "SCGC616.SCX" ;
	OR UPPER(WTITLE("SCGC616")) == "SCGC616.MNX" ;
	OR UPPER(WTITLE("SCGC616")) == "SCGC616.PRG" ;
	OR UPPER(WTITLE("SCGC616")) == "SCGC616.FRX" ;
	OR UPPER(WTITLE("SCGC616")) == "SCGC616.QPR"
	DEFINE WINDOW scgc616 ;
		FROM INT((SROW()-15)/2),INT((SCOL()-76)/2) ;
		TO INT((SROW()-15)/2)+14,INT((SCOL()-76)/2)+75 ;
		TITLE "[ Lanca Serv. Fixos ] " ;
		FOOTER "[616]" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		NONE ;
		COLOR SCHEME 1
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º          SCGC616/MS-DOS Setup Code - SECTION 2          º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1

******>>>> INICIO CONTROLE LOCAL




*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º              SCGC616/MS-DOS Screen Layout               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
IF WVISIBLE("scgc616")
	ACTIVATE WINDOW scgc616 SAME
ELSE
	ACTIVATE WINDOW scgc616 NOSHOW
ENDIF
@ 1,2 TO 10,73 ;
	COLOR SCHEME 23
@ 10,3 TO 10,72 ;
	COLOR SCHEME 24
@ 10,73 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 2,73 TO 9,73 ;
	COLOR SCHEME 24
@ 1,73 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 0,0 TO 14,75 ;
	COLOR SCHEME 23
@ 14,1 TO 14,61 ;
	COLOR SCHEME 24
@ 14,1 TO 14,74 ;
	COLOR SCHEME 24
@ 14,75 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 1,75 TO 13,75 ;
	COLOR SCHEME 24
@ 0,75 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 11,6 TO 13,22 ;
	COLOR SCHEME 24
@ 13,7 TO 13,21 ;
	COLOR SCHEME 23
@ 12,22 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 13,22 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 11,22 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 11,29 TO 13,45 ;
	COLOR SCHEME 24
@ 13,30 TO 13,44 ;
	COLOR SCHEME 23
@ 12,45 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 13,45 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 11,45 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 11,52 TO 13,68 ;
	COLOR SCHEME 24
@ 13,53 TO 13,67 ;
	COLOR SCHEME 23
@ 12,68 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 13,68 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 11,68 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 23
@ 0,68 SAY "[616]" ;
	SIZE 1,5, 0
@ 8,57 SAY "," ;
	SIZE 1,1, 0
@ 8,62 SAY ", " ;
	SIZE 1,2, 0
@ 8,12 SAY ", " ;
	SIZE 1,2, 0
@ 8,17 SAY "," ;
	SIZE 1,1, 0
@ 8,22 SAY ", " ;
	SIZE 1,2, 0
@ 8,27 SAY "," ;
	SIZE 1,1, 0
@ 8,32 SAY ", " ;
	SIZE 1,2, 0
@ 7,7 TO 9,68 ;
	COLOR SCHEME 23
@ 9,8 TO 9,67 ;
	COLOR SCHEME 24
@ 9,68 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 8,68 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 7,68 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 7,26 SAY "[ Comissionados Fixos ] " ;
	SIZE 1,24, 0
@ 0,23 SAY "[ Lanca Comissionados Fixos ]" ;
	SIZE 1,29, 0
@ 4,16 SAY "-" ;
	SIZE 1,1, 0
@ 3,10 TO 5,30 ;
	COLOR SCHEME 23
@ 5,11 TO 5,29 ;
	COLOR SCHEME 24
@ 5,30 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,30 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,30 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,11 SAY "[Tabela]" ;
	SIZE 1,8, 0
@ 3,21 SAY "[Filial]" ;
	SIZE 1,8, 0
@ 4,54 SAY "a" ;
	SIZE 1,1, 0
@ 3,42 TO 5,66 ;
	COLOR SCHEME 23
@ 5,43 TO 5,63 ;
	COLOR SCHEME 24
@ 5,66 SAY "Ù" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 4,66 SAY "³" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,66 SAY "¿" ;
	SIZE 1,1, 0 ;
	COLOR SCHEME 24
@ 3,43 SAY "[ N.F. Periodo ]" ;
	SIZE 1,16, 0
@ 8,37 SAY "," ;
	SIZE 1,1, 0
@ 8,42 SAY "," ;
	SIZE 1,1, 0
@ 8,47 SAY "," ;
	SIZE 1,1, 0
@ 8,52 SAY "," ;
	SIZE 1,1, 0
@ 4,13 GET m.tbbase ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN isediting ;
	VALID _2lx0otu4r() ;
	MESSAGE "<TAB> = Zoom  ;  <ESC> = Sai " ;
	ERROR "Codigo de Tabela Nao Confere."
@ 4,17 GET m.sbase ;
	SIZE 1,1 ;
	DEFAULT " " ;
	WHEN isediting ;
	VALID _2lx0otu4v()
@ 4,23 GET m.empbase ;
	SIZE 1,3 ;
	DEFAULT 0 ;
	PICTURE "999" ;
	WHEN isediting ;
	VALID _2lx0otu4y() ;
	MESSAGE "<TAB> = Zoom  ;  <ESC> = Sai " ;
	ERROR "Codigo de Tabela Nao Confere."
@ 4,43 GET m.dt_inicio ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _2lx0otu52() ;
	VALID _2lx0otu54()
@ 4,56 GET m.dt_fim ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN isediting ;
	VALID _2lx0otu58() ;
	MESSAGE "Data Final deve ser maior ou igual a Inicial"
@ 8,8 GET m.serv_13 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID ULverserv("13") ;
	ERROR wp_msg	
@ 8,13 GET m.serv_14 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID ULverserv("14") ;
	ERROR wp_msg	
@ 8,18 GET m.serv_15 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID ULverserv("15") ;
	ERROR wp_msg	
@ 8,23 GET m.serv_16 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID ULverserv("16") ;
	ERROR wp_msg	
@ 8,28 GET m.serv_17 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID ULverserv("17") ;
	ERROR wp_msg	
@ 8,33 GET m.serv_18 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID ULverserv("18") ;
	ERROR wp_msg	
@ 8,38 GET m.serv_19 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID ULverserv("18") ;
	ERROR wp_msg	
@ 8,43 GET m.serv_20 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID ULverserv("18") ;
	ERROR wp_msg	
@ 8,48 GET m.serv_21 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID ULverserv("18") ;
	ERROR wp_msg	
@ 8,53 GET m.serv_22 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID ULverserv("22") ;
	ERROR wp_msg	
@ 8,58 GET m.serv_23 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID ULverserv("23") ;
	ERROR wp_msg	
@ 8,63 GET m.serv_24 ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN isediting ;
	VALID ULverserv("24") ;
	ERROR wp_msg	
@ 12,10 GET m.edit_btn ;
	PICTURE "@*HN \<Edita" ;
	SIZE 1,9,1 ;
	DEFAULT 1 ;
	VALID btn_val1('EDIT') ;
	MESSAGE 'Permite a alteracao de dados do registro corrente'
@ 12,33 GET m.imp_btn ;
	PICTURE "@*HN \<Lancar" ;
	SIZE 1,8,1 ;
	DEFAULT 1 ;
	VALID _2lx0otu5e() ;
	DISABLE
@ 12,57 GET exit_btn ;
	PICTURE "@*HN \<Saida" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _2lx0otu5m()

IF NOT WVISIBLE("scgc616")
	ACTIVATE WINDOW scgc616
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º     MS-DOSREAD contains clauses from SCREEN scgc616     º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

READ CYCLE ;
	NOLOCK

RELEASE WINDOW scgc616

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º               SCGC616/MS-DOS Cleanup Code               º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
DO ULfecha
RETURN



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º   SCGC616/MS-DOS Supporting Procedures and Functions    º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

#REGION 1
PROCEDURE ULfecha
	IF LFctb616  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("cadtab")
	ENDIF
	IF LFemp616  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("empresa")
	ENDIF
	IF LFgrv616  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("grup_ven")
	ENDIF
	IF LFusr616  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("usuario")
	ENDIF
	IF LFitm616  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("itemmov")
	ENDIF
	IF LFnfs616  		&& .t. =>  DEVE SER FECHADA NA SAIDA
		=UP_fecha("nota")
	ENDIF
	wp_flgfecha = .F. 		&& defaut nao fechamento da secao
	IF !EMPTY(LS616areant)
		SELECT &LS616areant
	ENDIF
	ON KEY LABEL ESCAPE
	SET FORMAT TO
RETURN

PROCEDURE BTN_VAL1
	PARAMETER tecla, m.chv_ler, m.chv_compara, m.chv_brow
	LN_prxobj = _CUROBJ
	SHOW GET wp_empresa
	SHOW GET wp_nome_emp
    DO CASE
		CASE tecla = "EDIT" AND !isediting   && INICIA EDICAO
		*************** SALVA COMO PARAMETROS PARA PROXIMO RELATO *****
			ON ERROR TMP=""   && EVITA MENS. DE ERRO QDO ARQ.NAO EXISTIR
			RESTORE FROM  temp616 ADDITIVE
			ON ERROR
		****************************************************************
			SHOW GETS
			SHOW GET edit_btn,1 PROMPT "\<Ok"
			SHOW GET m.imp_btn DISABLE
			isediting = .t.
			_CUROBJ = 1	
		    ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
			ON KEY LABEL END DO BTN_VAL1 WITH 'DELETE'
		CASE tecla = "EDIT" AND isediting     && CONFIRMA EDICAO

		*************** SALVA COMO PARAMETROS PARA PROXIMO RELATO *****
			SAVE TO temp616 ALL LIKE serv_??
		****************************************************************

			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn ENABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
		CASE tecla = "DELETE" AND isediting     && CANCELA EDICAO
			SHOW GET edit_btn,1 PROMPT "\<Edita"
			isediting = .f.
			_CUROBJ = 1	
			SHOW GET m.imp_btn DISABLE
		    ON KEY LABEL ESCAPE
			ON KEY LABEL END
	ENDCASE
RETURN

************************************************
FUNCTION ULverserv && verifica os codigo informados nos 9 niveis
PARAMETERS VLniv
	wp_msg = ""
    VLnum = INT(VAL(VLniv))
	SELE usuario
	SET ORDER TO TAG nome
	IF LASTKEY() = 9
		DO loc_dlog
		m.serv_&VLniv = usuario
        IF LASTKEY() = 27
       	   wp_msg = "Procura Cancelada."
           RETURN .F.
        ENDIF
		SHOW GET m.serv_&VLniv
    ELSE
		IF EMPTY(m.serv_&VLniv)
		   RETURN .T.
		ENDIF
		SET ORDER TO TAG usuario
		IF ! SEEK(m.serv_&VLniv)
		    wp_msg = "Usuario nao esta Cadastrado neste codigo."
			RETURN .F.
		ENDIF	
    ENDIF
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0OTU4R           m.tbbase VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC616,     Record Number:   62   º
*       º Variable:            m.tbbase                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      1                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _2lx0otu4r     &&  m.tbbase VALID
#REGION 1
SELECT cadtab
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.,""
   m.tbbase = cadtab.tabela
   m.sbase  = cadtab.serie
   SHOW GET  m.tbbase
   SHOW GET  m.sbase
   ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
ENDIF
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0OTU4V           m.sbase VALID                      º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC616,     Record Number:   63   º
*       º Variable:            m.sbase                            º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      2                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0otu4v     &&  m.sbase VALID
#REGION 1
IF SEEK(STR(m.tbbase,3)+m.sbase)
   SHOW GET  m.tbbase
   SHOW GET  m.sbase
   RETURN .T.
ENDIF
_CUROBJ = 1
RETURN .T.

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0OTU4Y           m.empbase VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC616,     Record Number:   64   º
*       º Variable:            m.empbase                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      3                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*

FUNCTION _2lx0otu4y     &&  m.empbase VALID
#REGION 1
SELECT empresa
IF LASTKEY() = 9
   ON KEY LABEL ESCAPE
   DO loc_dlog WITH .T.
   m.empbase = empresa.empresa
   SHOW GET  m.empbase
   ON KEY LABEL ESCAPE DO BTN_VAL1
ELSE
	SET ORDER TO TAG empresa
	IF SEEK(m.empbase)
   	   m.empbase = empresa.empresa
	   SHOW GET  m.empbase
	ELSE
	   RETURN .F.
	ENDIF
ENDIF
RETURN .T.


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0OTU52           m.dt_inicio WHEN                   º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC616,     Record Number:   65   º
*       º Variable:            m.dt_inicio                        º
*       º Called By:           WHEN Clause                        º
*       º Object Type:         Field                              º
*       º Snippet Number:      4                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0otu52     &&  m.dt_inicio WHEN
#REGION 1
IF isediting
	ON KEY LABEL ESCAPE	KEYBOARD "{END}"
ENDIF
RETURN(isediting)

*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0OTU54           m.dt_inicio VALID                  º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC616,     Record Number:   65   º
*       º Variable:            m.dt_inicio                        º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      5                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0otu54     &&  m.dt_inicio VALID
#REGION 1
m.dt_fim = m.dt_inicio
SHOW GET m.dt_fim
ON KEY LABEL ESCAPE KEYBOARD "{BACKTAB}"
SELECT nota
SET ORDER TO TAG data
SET NEAR ON
SEEK STR(wp_empresa,3)+DTOS(m.dt_inicio)
SET NEAR OFF
IF EOF() OR nota.empresa <> wp_empresa
	WAIT WINDOW "Nao exitem Duplicatas "
ELSE
	m.num_inicio = nota.nota
	SHOW GET m.num_inicio
ENDIF
RETURN (.T.)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0OTU58           m.dt_fim VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC616,     Record Number:   66   º
*       º Variable:            m.dt_fim                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Field                              º
*       º Snippet Number:      6                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0otu58     &&  m.dt_fim VALID
#REGION 1
SELECT nota
SET ORDER TO TAG data
SET NEAR ON
SEEK STR(wp_empresa,3)+DTOS(m.dt_fim+1)
SET NEAR OFF
IF m.dt_fim < nota.data OR  nota.empresa <> wp_empresa
	SKIP -1
ENDIF
IF EOF() OR nota.empresa <> wp_empresa
	m.num_fim = 999999
	SHOW GET m.num_fim
ELSE
	m.num_fim = nota.nota
	SHOW GET m.num_fim
ENDIF
RETURN(m.dt_fim >= m.dt_inicio)


*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0OTU5E           m.imp_btn VALID                    º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC616,     Record Number:   80   º
*       º Variable:            m.imp_btn                          º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      7                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0otu5e     &&  m.imp_btn VALID
#REGION 1
	SELE nota
	SET ORDER TO TAG data
	SET NEAR ON
	SEEK STR(m.empbase,3)+DTOS(m.dt_inicio)
	SET NEAR OFF
	IF EOF() OR nota.empresa <> m.empbase OR nota.data > m.dt_fim
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		UNLOCK
 		RETURN
 	ENDIF		
*******************	
*******************
*---->   (INICIALIZACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	DO RELINIC.PRG          && INICIA VAR P/ TERMOMETRO
	wp_msg = "Processado Critica de Vendas......."
	LFsegue = .t.
	LNregistro = RECNO()
	LNimpressao = 0
    COUNT   WHILE nota.empresa = m.empbase AND ;
    			  nota.data <= m.dt_fim TO LNimpressao
	IF LNimpressao = 0
 		WAIT WINDOW "Nao Foram encotrados dados para impessao."
		DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
		UNLOCK
 		RETURN
 	ENDIF		
	LNimpressos = 0
	GO LNregistro
*******************
*---->   (COMPLETADO PREPARACAO DO CONTROLE DE STATUS IMPRESSAO)
*******************	
	SELECT  cadtab
	SET ORDER TO TAG tabela
	SEEK STR(m.tbbase,3)+m.sbase


	SELE grup_ven
	SET ORDER TO TAG grupo_vend

	SELE itemmov
	SET ORDER TO TAG  itensnota
************************> TABELA P/ OS SERV. COMISSIONADOS NA NOTA *****
	DIMENSION  LVservcm(12)
************************>         <*************************************
	SELE nota
	SET ORDER TO TAG data
    DO WHILE !EOF() AND nota.empresa = m.empbase AND nota.data <= m.dt_fim ;
    		AND LFsegue
		=UPtermo()
		IF  nota.operacao <> "S" OR nota.ch_opera <> "1" ;
		    OR nota.status  <> 1
			SKIP
			LOOP
		ENDIF
		SELE itemmov
		SET NEAR ON
		SEEK STR(nota.empresa,3)+"S"+STR(nota.nota,7)
		SET NEAR OFF
		STORE 0 TO LVservcm
		LNindice   = 2
		LVservcm(1) = nota.serv_1  && O 1o SERV E RSPONSAVEL E PERMANECE
								   && INDEPENDENTE DE RECEBER COMISSAO

		DO WHILE !EOF() AND nota.empresa = itemmov.empresa  ;
						AND nota.nota    = itemmov.nota ;
						AND nota.tipo    = itemmov.tipo
			LNserv = 2
			DO WHILE LNserv <= 24    && INCLUI OS FIXOS
				IF LNserv < 13    && CODIGOS DA NOTA
					LSserv = ALLTRIM(STR(LNserv,2))
					IF nota.serv_&LSserv = 0
						LNserv = LNserv + 1
						LOOP
					ENDIF
					m.servidor = nota.serv_&LSserv
				ELSE
					LSserv = ALLTRIM(STR(LNserv,2))
					IF m.serv_&LSserv = 0
						LNserv = LNserv + 1
						LOOP
					ENDIF
					m.servidor = m.serv_&LSserv
				ENDIF
***------> verificar se o servidor recebe comissao no produto
				SELE grup_ven
				SEEK STR(m.servidor,4)+itemmov.clas_cms
				IF !FOUND()			&& NAO PREVE COMISSAO NO ITEM
					LNserv = LNserv + 1
					LOOP
				ENDIF
***------> registra comissionado na tabela
				IF ASCAN(LVservcm,m.servidor) > 0
					LNserv = LNserv + 1
					LOOP
				ENDIF
				IF LNindice > 12
			       DO OBJ_ALER.SPR WITH ;
				   "Foi excedido o Nro. de 12 comissionados. "+chr(13)+ ;
	  		       "    NOTA : "+STR(nota.nota,7)+CHR(13)+;
	  		       "    Faca lancamento especifico nesta N.F."
				   EXIT				
				ENDIF
				LVservcm(LNindice) = m.servidor
				LNindice   = LNindice + 1
				LNserv = LNserv + 1
			ENDDO
			SELE itemmov
			SKIP
		ENDDO
		SELE nota
		=REGLOCK()
		FOR LNindice = 1 TO 12
			LSserv = ALLTRIM(STR(LNindice,2))
			m.serv_&LSserv  = LVservcm(LNindice)
		NEXT
 	    GATHER MEMVAR FIELDS serv_1,serv_2,serv_3,serv_4,serv_5,serv_6,;
							serv_7,serv_8,serv_9,serv_10,serv_11,serv_12
		SKIP
	ENDDO
************
	DO RELFIM.PRG          && FIM VAR P/ TERMOMETRO
*-----------------------------
	SET RELATION TO
	SHOW GET m.imp_btn DISABLE



*       ÖÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ·
*       º                                                         º
*       º _2LX0OTU5M           exit_btn VALID                     º
*       º                                                         º
*       º Function Origin:                                        º
*       º                                                         º
*       º From Platform:       MS-DOS                             º
*       º From Screen:         SCGC616,     Record Number:   81   º
*       º Variable:            exit_btn                           º
*       º Called By:           VALID Clause                       º
*       º Object Type:         Push Button                        º
*       º Snippet Number:      8                                  º
*       º                                                         º
*       ÓÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ½
*
FUNCTION _2lx0otu5m     &&  exit_btn VALID
#REGION 1
CLEAR READ
CLEAR GETS
