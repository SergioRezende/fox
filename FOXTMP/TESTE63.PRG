SET DATE TO GERMAN
SET CENTU ON
SET ESCAPE ON
SET TALK ON
ON ERROR
ON KEY


CLOSE ALL

SELE 0
USE Q:\SCGC\COMUM\TIPOOPER
SET ORDER TO TAG TIPO

SELE 0
use Q:\scgc\LOJA\itemmov
SET ORDER TO TAG DT_MOV


SET NEAR ON

SEEK STR(8,3)+DTOS({01.01.2005})

do while !eof()

	if  EMPRESA <> 8 
	     EXIT
	ENDIF
  

	if LEFT(OPERACAO,1) <> "S" ;
	    OR ch_opera <> "1" ;
	    OR ch_desti <> "1" 
			skip
			loop
	endif
	
	if NOT LEFT(CLASSIFICA,5) $ "02099/04040/04044/04045/04047/04048/05050/05051/05052/05053"
			skip
			loop
	endif
	SELE TIPOOPER
	SEEK "S"+ITEMMOV.TIPO
  
  	SELE ITEMMOV
  
    IF CST $ "0/2"
       =RLOCK()
       REPLACE BASE_ISENT WITH BASE_ISENT + BASE_CALC
       REPLACE BASE_CALC WITH 0
  	   REPLACE CFO WITH TIPOOPER.CFOSUBS
	   REPLACE CST WITH "6"
	   REPLACE VLR_ICMS WITH 0
    ENDIF
	skip
enddo

