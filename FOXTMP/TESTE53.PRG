*-------------------------------------------------------------------*
******       ZERAR SALDO EM SALDOS PARA SERVICOS                *****
*-------------------------------------------------------------------*

SET STEP ON
SET TALK ON
SET ESCAPE ON
ON ERROR
ON KEY

CLOSE ALL

SELE 0
USE Q:\SCGC\COMUM\GRUPO
SET ORDER TO TAG CODIGO

SELE 0
USE Q:\SCGC\TESTE\SALDO
SET ORDER TO TAG CODIGO

DO   WHILE !EOF()
	SELE GRUPO
	SEEK SALDO.CODIGO
	IF !FOUND()
		SELE SALDO
	    SKIP
	    LOOP
	ENDIF

	IF      GRUPO.TP_CONTROL <> 2 ;
	    AND GRUPO.TP_CONTROL <> 7 ;
	    AND GRUPO.TP_CONTROL <> 9
		SELE SALDO
	    SKIP
	    LOOP
	ENDIF

	SELE SALDO
	SCATTER MEMVAR
	=RLOCK()
	STORE 0 TO SLD_ANTE,VLR_ANTE,RES_ANTE,SLD_ATU,VLR_ATU,;
			QTD_COMPRA,VLR_COMPRA,QTD_VENDA,VLR_VENDA,;
			QTD_E_TRAN,VLR_E_TRAN,QTD_E_OUTR,VLR_E_OUTR,;
 			QTD_S_TRAN,VLR_S_TRAN,QTD_S_OUTR,VLR_S_OUTR,RESERVA
	GATHER MEMVAR
	SKIP
ENDDO

