SET STEP ON
use q:\scgc\central\saldo
brows
SET ORDER TO TAG DTABERT OF Q:\SCGC\CENTRAL\SALDO.CDX
SET NEAR ON
SET TALK ON
SET ESCAPE ON
ON ERROR
SEEK DTOS({01.05.2000})
SET DATE GERMAN
DO WHILE !EOF() AND (DTABERT >= {01.05.2000} AND DTABERT < {01.06.2000})
		LNreg = RECNO()
		
		SCATTER MEMVAR
		
		SET ORDER TO TAG EMP_MES
		SET NEAR OFF
		SEEK STR(M.EMPRESA,3)+;
			STR(YEAR(GOMONTH(M.DTABERT,1)),4)+;
			STR(MONTH(GOMONTH(M.DTABERT,1)),2)+M.CLASSIFICA
		IF FOUND()
			IF M.VLR_ATU <> SALDO.VLR_ANTE AND  M.SLD_ATU = SALDO.SLD_ANTE
				=RLOCK()
				REPLACE  VLR_ANTE WITH M.VLR_ANTE
			ENDIF
		ENDIF
		SET ORDER TO TAG DTABERT
		GO LNreg
		SKIP
ENDDO
