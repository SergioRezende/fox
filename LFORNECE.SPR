*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        29/04/2000           LFORNECE.SPR              09:46:09 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 2000 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                LFORNECE/MS-DOS Setup Code - SECTION 1          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
PUSH KEY CLEAR		&& desabilita teclas de atalho def. anteriormente
ON KEY LABEL F1		DO HLP2000.SPR WITH  POPUP(),PROMPT(),PROGRAM(),;
							WONTOP(),VARREAD()

CLEAR TYPEAHEAD
SET FORMAT TO
ON KEY LABEL ENTER
PRIVATE LNcodigo,LSnome,LNcgc
LNcodigo = 0
LSnome    = SPACE(40)
LNcgc    = 0
SHOW GET LNCODIGO
SHOW GET LSNOME
SHOW GET LNCGC


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF NOT WEXIST("lerfornece") ;
	OR UPPER(WTITLE("LERFORNECE")) == "LERFORNECE.PJX" ;
	OR UPPER(WTITLE("LERFORNECE")) == "LERFORNECE.SCX" ;
	OR UPPER(WTITLE("LERFORNECE")) == "LERFORNECE.MNX" ;
	OR UPPER(WTITLE("LERFORNECE")) == "LERFORNECE.PRG" ;
	OR UPPER(WTITLE("LERFORNECE")) == "LERFORNECE.FRX" ;
	OR UPPER(WTITLE("LERFORNECE")) == "LERFORNECE.QPR"
	DEFINE WINDOW lerfornece ;
		FROM 15, 17 ;
		TO 21,81 ;
		TITLE "[ Localizacao de Registro Com Informacao da Chave ]" ;
		FOOTER "[RFORNECE]" ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		DOUBLE ;
		COLOR SCHEME 5
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     LFORNECE/MS-DOS Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("lerfornece")
	ACTIVATE WINDOW lerfornece SAME
ELSE
	ACTIVATE WINDOW lerfornece NOSHOW
ENDIF
@ 3,3 SAY "NOME........:" ;
	SIZE 1,13, 0
@ 1,3 SAY "CODIGO......:" ;
	SIZE 1,13, 0
@ 1,29 SAY "CGC/CPF.....:" ;
	SIZE 1,13, 0
@ 1,17 GET LNcodigo ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	VALID _03c0kxtea()
@ 1,43 GET LNcgc ;
	SIZE 1,14 ;
	DEFAULT 0 ;
	VALID _03c0kxtey()
@ 3,17 GET LSnome ;
	SIZE 1,41 ;
	DEFAULT " " ;
	PICTURE "@K" ;
	VALID _03c0kxtfv()

IF NOT WVISIBLE("lerfornece")
	ACTIVATE WINDOW lerfornece
ENDIF

READ CYCLE MODAL

RELEASE WINDOW lerfornece

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     LFORNECE/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
ON KEY LABEL ENTER KEYBOARD CHR(23)
POP KEY 			&& reabilita teclas de atalho def. anteriormente


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _03C0KXTEA           LNcodigo VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LFORNECE,     Record Number:    5  
*        Variable:            LNcodigo                           
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _03c0kxtea     &&  LNcodigo VALID
#REGION 1
IF EMPTY(LNcodigo)
	RETURN(1)
ENDIF
SET ORDER TO TAG codigo
SET NEAR ON
SEEK LNcodigo
SET NEAR OFF
SHOW WINDOW registros REFRESH
RETURN(0)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _03C0KXTEY           LNcgc VALID                        
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LFORNECE,     Record Number:    6  
*        Variable:            LNcgc                              
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _03c0kxtey     &&  LNcgc VALID
#REGION 1
IF EMPTY(LNcgc)
	RETURN(1)
ENDIF
SET ORDER TO TAG cgc
SET NEAR ON
SEEK LNcgc
SET NEAR OFF
SHOW WINDOW registros REFRESH
RETURN(0)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _03C0KXTFV           LSnome VALID                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LFORNECE,     Record Number:    7  
*        Variable:            LSnome                             
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _03c0kxtfv     &&  LSnome VALID
#REGION 1
IF EMPTY(ALLTRIM(LSnome))
	RETURN(1)
ENDIF
SET ORDER TO TAG nome
SET NEAR ON
SEEK RTRIM(LSnome)
SET NEAR OFF
SHOW WINDOW registros REFRESH
RETURN(0)
